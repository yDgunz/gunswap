function GifWriter(t,e,i,n){function r(t){var e=t.length;if(e<2||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}var s=0,o=void 0===(n=void 0===n?{}:n).loop?null:n.loop,a=void 0===n.palette?null:n.palette;if(e<=0||i<=0||e>65535||i>65535)throw"Width/Height invalid.";t[s++]=71,t[s++]=73,t[s++]=70,t[s++]=56,t[s++]=57,t[s++]=97;var l=0,h=0;if(null!==a){for(var c=r(a);c>>=1;)++l;if(c=1<<l,--l,void 0!==n.background){if((h=n.background)>=c)throw"Background index out of range.";if(0===h)throw"Background index explicitly passed as 0."}}if(t[s++]=255&e,t[s++]=e>>8&255,t[s++]=255&i,t[s++]=i>>8&255,t[s++]=(null!==a?128:0)|l,t[s++]=h,t[s++]=0,null!==a)for(var u=0,d=a.length;u<d;++u){var p=a[u];t[s++]=p>>16&255,t[s++]=p>>8&255,t[s++]=255&p}if(null!==o){if(o<0||o>65535)throw"Loop count invalid.";t[s++]=33,t[s++]=255,t[s++]=11,t[s++]=78,t[s++]=69,t[s++]=84,t[s++]=83,t[s++]=67,t[s++]=65,t[s++]=80,t[s++]=69,t[s++]=50,t[s++]=46,t[s++]=48,t[s++]=3,t[s++]=1,t[s++]=255&o,t[s++]=o>>8&255,t[s++]=0}var f=!1;this.addFrame=function(e,i,n,o,l,h){if(!0===f&&(--s,f=!1),h=void 0===h?{}:h,e<0||i<0||e>65535||i>65535)throw"x/y invalid.";if(n<=0||o<=0||n>65535||o>65535)throw"Width/Height invalid.";if(l.length<n*o)throw"Not enough pixels for the frame size.";var c=!0,u=h.palette;if(void 0!==u&&null!==u||(c=!1,u=a),void 0===u||null===u)throw"Must supply either a local or global palette.";for(var d=r(u),p=0;d>>=1;)++p;d=1<<p;var m=void 0===h.delay?0:h.delay,g=void 0===h.disposal?0:h.disposal;if(g<0||g>3)throw"Disposal out of range.";var v=!1,y=0;if(void 0!==h.transparent&&null!==h.transparent&&(v=!0,(y=h.transparent)<0||y>=d))throw"Transparent color index.";if((0!==g||v||0!==m)&&(t[s++]=33,t[s++]=249,t[s++]=4,t[s++]=g<<2|(!0===v?1:0),t[s++]=255&m,t[s++]=m>>8&255,t[s++]=y,t[s++]=0),t[s++]=44,t[s++]=255&e,t[s++]=e>>8&255,t[s++]=255&i,t[s++]=i>>8&255,t[s++]=255&n,t[s++]=n>>8&255,t[s++]=255&o,t[s++]=o>>8&255,t[s++]=!0===c?128|p-1:0,!0===c)for(var b=0,x=u.length;b<x;++b){var _=u[b];t[s++]=_>>16&255,t[s++]=_>>8&255,t[s++]=255&_}s=GifWriterOutputLZWCodeStream(t,s,p<2?2:p,l)},this.end=function(){return!1===f&&(t[s++]=59,f=!0),s}}function GifWriterOutputLZWCodeStream(t,e,i,n){function r(i){for(;d>=i;)t[e++]=255&p,p>>=8,d-=8,e===o+256&&(t[o]=255,o=e++)}function s(t){p|=t<<d,d+=u,r(8)}t[e++]=i;var o=e++,a=1<<i,l=a-1,h=a+1,c=h+1,u=i+1,d=0,p=0,f=n[0]&l,m={};s(a);for(var g=1,v=n.length;g<v;++g){var y=n[g]&l,b=f<<8|y,x=m[b];if(void 0===x){for(p|=f<<d,d+=u;d>=8;)t[e++]=255&p,p>>=8,d-=8,e===o+256&&(t[o]=255,o=e++);4096===c?(s(a),c=h+1,u=i+1,m={}):(c>=1<<u&&++u,m[b]=c++),f=y}else f=x}return s(f),s(h),r(1),o+1===e?t[o]=0:(t[o]=e-o-1,t[e++]=0),e}function GifReader(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||57!==t[e++]||97!==t[e++])throw"Invalid GIF 89a header.";var i=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,r=t[e++],s=r>>7,o=1<<(7&r)+1;t[e++];t[e++];var a=null;s&&(a=e,e+=3*o);var l=!0,h=[],c=0,u=null,d=0;for(this.width=i,this.height=n;l&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(0===(w=t[e++]))break;e+=w}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var p=t[e++];c=t[e++]|t[e++]<<8,u=t[e++],0==(1&p)&&(u=null),d=p>>2&7,e++;break;case 254:for(;;){if(0===(w=t[e++]))break;e+=w}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var f=t[e++]|t[e++]<<8,m=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++],b=a,x=!1;if(y>>7){x=!0;b=e,e+=3*(1<<(7&y)+1)}var _=e;for(e++;;){var w;if(0===(w=t[e++]))break;e+=w}h.push({x:f,y:m,width:g,height:v,has_local_palette:x,palette_offset:b,data_offset:_,data_length:e-_,transparent_index:u,delay:c,disposal:d});break;case 59:l=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return h.length},this.frameInfo=function(t){if(t<0||t>=h.length)throw"Frame index out of range.";return h[t]},this.decodeAndBlitFrameBGRA=function(e,n){var r=this.frameInfo(e),s=r.width*r.height,o=new Uint8Array(s);GifReaderLZWOutputIndexStream(t,r.data_offset,o,s);var a=r.palette_offset,l=r.transparent_index;null===l&&(l=256);for(var h=4*(i-r.width),c=4*(r.y*i+r.x),u=r.width,d=0,p=o.length;d<p;++d){var f=o[d];if(f===l)c+=4;else{var m=t[a+3*f],g=t[a+3*f+1],v=t[a+3*f+2];n[c++]=v,n[c++]=g,n[c++]=m,n[c++]=255}0==--u&&(c+=h,u=r.width)}},this.decodeAndBlitFrameRGBA=function(e,n){var r=this.frameInfo(e),s=r.width*r.height,o=new Uint8Array(s);GifReaderLZWOutputIndexStream(t,r.data_offset,o,s);var a=0,l=r.palette_offset,h=r.transparent_index;null===h&&(h=256);for(var c=4*(i-r.width),u=(a=4*(r.y*i+r.x),r.width),d=0,p=o.length;d<p;++d){var f=o[d];if(f===h)a+=4;else{var m=t[l+3*f],g=t[l+3*f+1],v=t[l+3*f+2];n[a++]=m,n[a++]=g,n[a++]=v,n[a++]=255}0==--u&&(a+=c,u=r.width)}}}function GifReaderLZWOutputIndexStream(t,e,i,n){for(var r=t[e++],s=1<<r,o=s+1,a=o+1,l=r+1,h=(1<<l)-1,c=0,u=0,d=0,p=t[e++],f=new Int32Array(4096),m=null;;){for(;c<16&&0!==p;)u|=t[e++]<<c,c+=8,1===p?p=t[e++]:--p;if(c<l)break;var g=u&h;if(u>>=l,c-=l,g!==s){if(g===o)break;for(var v=g<a?g:m,y=0,b=v;b>s;)b=f[b]>>8,++y;var x=b;if(d+y+(v!==g?1:0)>n)return void console.log("Warning, gif stream longer than expected.");i[d++]=x;var _=d+=y;for(v!==g&&(i[d++]=x),b=v;y--;)b=f[b],i[--_]=255&b,b>>=8;null!==m&&a<4096&&(f[a++]=m<<8|x,a>=h+1&&l<12&&(++l,h=h<<1|1)),m=g}else a=o+1,h=(1<<(l=r+1))-1,m=null}return d!==n&&console.log("Warning, gif stream shorter than expected."),i}function getURLQueryStringParameterByName(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===e?null:decodeURIComponent(e[1].replace(/\+/g," "))}function cloneObject(t){var e=t instanceof Array?[]:{};for(var i in t)"clone"!=i&&(t[i]&&"object"==typeof t[i]?e[i]=cloneObject(t[i]):e[i]=t[i]);return e}function arraysEqual(t,e){if(!(t instanceof Array&&e instanceof Array))return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]instanceof Array||e[i]instanceof Array){if(!arraysEqual(t[i],e[i]))return!1}else if(t[i]!=e[i])return!1;return!0}function cross(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}function dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}function normalize(t){var e=magnitude(t);return t.x=t.x/e,t.y=t.y/e,t.z=t.z/e,t}function multiply(t,e){return t.x*=e,t.y*=e,t.z*=e,t}function add(t,e){return t.x+=e.x,t.y+=e.y,t.z+=e.z,t}function sub(t,e){return t.x-=e.x,t.y-=e.y,t.z-=e.z,t}function negate(t){return multiply(t,-1),t}function BounceGA(t,e){if(this.gaConfig=t,this.fitnessConfig=e,void 0===e.axis1)for(var i=0;i<this.fitnessConfig.surfaces.length;i++){var n=this.fitnessConfig.surfaces[i];normalize(n.normal);var r;r=0==n.normal.x&&0==n.normal.z?{x:1,y:0,z:0}:{x:-n.normal.z,y:0,z:n.normal.x};var s=cross(n.normal,r);normalize(r),normalize(s),multiply(r,n.scale),multiply(s,n.scale),n.axis1=r,n.axis2=s}this.simple=!1,1==e.numBounces&&1==e.surfaces.length&&0==e.surfaces[0].normal.x&&0==e.surfaces[0].normal.z&&e.minT==e.maxT&&(this.simple=!0),this.generations=0,this.rankedPopulation=[],this.fittestMembers=[],this.ableToFindSolution=void 0}function updateInputSiteswap(){var t=$("#siteswap").val(),e=YAML.parse($("#inputsAdvanced").val());e.siteswap=t,$("#inputsAdvanced").val(YAML.stringify(e,1,1))}function updateInputProp(){var t=$("#prop").val(),e=YAML.parse($("#inputsAdvanced").val());e.props.splice(1),e.props[0].type=t,$("#inputsAdvanced").val(YAML.stringify(e,1,1))}function updateInputDwellPath(){var t=$("#dwellPath").val(),e=YAML.parse($("#inputsAdvanced").val());e.dwellPath=t,$("#inputsAdvanced").val(YAML.stringify(e,1,1))}function updateInputBeatDuration(){var t=$("#beatDuration").val(),e=YAML.parse($("#inputsAdvanced").val());e.beatDuration=t,$("#inputsAdvanced").val(YAML.stringify(e,1,1))}function updateInputDrawHands(){var t=$("#drawHands")[0].checked,e=YAML.parse($("#inputsAdvanced").val());e.drawHands=t,$("#inputsAdvanced").val(YAML.stringify(e,1,1))}function displayMenu(t){$(".controlDiv").hide(),$("#"+t+"Menu").show(),$("#nav a").removeClass("selected"),$("#nav a").addClass("unselected"),$("#nav #"+t).addClass("selected"),$("#nav #"+t).removeClass("unselected"),window.onresize()}function parseInputs(){for(var t=YAML.parse($("#inputsAdvanced").val()),e=cloneObject(DEFAULT_INPUTS.pattern),i=Object.keys(t),n=0;n<i.length;n++)"siteswap"==i[n]?e[i[n]]=t[i[n]].toString():e[i[n]]=t[i[n]];return e}function go(){twoWindow||displayMenu("animator");var t=parseInputs();if(window.siteswap=SiteswapJS.CreateSiteswap(t.siteswap,{beatDuration:t.beatDuration,dwellRatio:t.dwellRatio,props:t.props,dwellPath:t.dwellPath,matchVelocity:t.matchVelocity,dwellCatchScale:t.dwellCatchScale,dwellTossScale:t.dwellTossScale,emptyTossScale:t.emptyTossScale,emptyCatchScale:t.emptyCatchScale,armAngle:t.armAngle,surfaces:t.surfaces,jugglers:t.jugglers,startingHand:t.startingHand}),siteswap.stateDiagram){var e=(siteswap.stateDiagram[0].length-2)/2,i="<tr><th colspan='2'></th><th colspan='"+e+"'>L</th><th colspan='"+e+"'>R</th></tr>";siteswap.stateDiagram.map(function(t){i+="<tr>",t.map(function(t){var e=t.toString(),n="white";!isNaN(e)&&e<siteswap.props.length&&(n="random"==siteswap.props[parseInt(e)].color?randomColors.getIndexCyclic(parseInt(e)):siteswap.props[parseInt(e)]),i+="<td bgcolor='"+n+"'>"+t.toString()+"</td>"}),i+="</tr>"}),$("#stateDiagramTable").html(i)}siteswap.errorMessage?(animator.paused=!0,$("#errorMessage").show(),$("#message").text(siteswap.errorMessage)):(siteswap.collision?($("#errorMessage").show(),$("#message").text("This pattern has collisions.")):$("#errorMessage").hide(),updateCameraModeNumJugglers(siteswap.numJugglers),animator.init(siteswap,{drawHands:t.drawHands,motionBlur:t.motionBlur,backgroundColor:t.backgroundColor}),animator.usingSlider=!1,animator.animate())}function zoomIn(){animator.zoomIn()}function zoomOut(){animator.zoomOut()}function updateAnimationSpeed(){var t=parseFloat($("#animationSpeed").val());animator.updateAnimationSpeed(t)}function updateCameraMode(){var t=$("#cameraMode").val();if(cameraMode={mode:t},"custom"==t){var e=$("#cameraCustomPosition").val().split(",");cameraMode.x=parseFloat(e[0]),cameraMode.y=parseFloat(e[1]),cameraMode.z=parseFloat(e[2])}animator.updateCameraMode(cameraMode)}function updateDisplayPropPaths(){animator.displayPropPaths=!animator.displayPropPaths,animator.displayPropPaths?animator.showPropPaths():animator.hidePropPaths()}function runExample(t){$.get("examples.yml",function(e){for(var i=YAML.parse(e),n=0;n<i.length;n++)if(n==t){delete i[n].name,$("#inputsAdvanced").val(YAML.stringify(i[n],1,1));break}go()})}function buildExamples(){$.get("examples.yml",function(t){for(var e=YAML.parse(t),i=0;i<e.length;i++)$("#examplesList").append('<li><a href="#" onclick="runExample(\''+i+"');\">"+e[i].name+"</a></li>")})}function generateGIF(){$("#gifProgress").show(),$("#gifLink").empty(),animator.paused=!0;var t=Math.round(siteswap.states.length*siteswap.beatDuration*35),e=0,i=document.createElement("canvas");i.width=animator.renderer.domElement.width,i.height=animator.renderer.domElement.height;var n=i.getContext("2d"),r=new Uint8Array(i.width*i.height*t*5),s=new GifWriter(r,i.width,i.height,{loop:0}),o=new Uint8Array(i.width*i.height),a=function(){animator.step=Math.floor(e/t*siteswap.numSteps),animator.render(),n.drawImage(animator.renderer.domElement,0,0);for(var r=n.getImageData(0,0,i.width,i.height).data,h=[],c=0,u=0,d=r.length;c<d;c+=4,u++){var p=10*Math.floor(.1*r[c+0])<<16|10*Math.floor(.1*r[c+1])<<8|10*Math.floor(.1*r[c+2])<<0,f=h.indexOf(p);-1===f?(o[u]=h.length,h.push(p)):o[u]=f}for(var m=1;m<h.length;)m<<=1;h.length=m,s.addFrame(0,0,i.width,i.height,o,{palette:new Uint32Array(h),delay:5}),$("#gifProgress").val(e/t),++e==t?l():setTimeout(a,0)},l=function(){for(var t="",e=0,i=s.end();e<i;e++)t+=String.fromCharCode(r[e]);$("#gifLink").append("<a href='data:image/gif;base64,"+btoa(t)+"' target='_blank'>Download GIF</a>"),animator.paused=!1,animator.animate(),$("#gifProgress").hide()};a()}function findSiteswaps(){window.onresize(),$("#siteswapsList").empty(),$("#graphContainer").empty(),$("#activeSiteswapContainer").hide();$("#exclude").val();var t={minPeriod:1,maxPeriod:parseInt($("#explorerMaxPeriod").val()),numProps:parseInt($("#explorerNumProps").val()),maxSiteswaps:parseInt($("#explorerMaxSiteswaps").val()),includeExcited:$("#explorerIncludeExcited")[0].checked,includeMultiplex:$("#explorerIncludeMultiplex")[0].checked,async:!0,sync:$("#explorerSync")[0].checked,callbacks:{siteswapFound:function(t,e,i){$("#siteswapsList").append('<li><a class="'+(i?"excited":"ground")+' patternLink" href="#" onclick="runSiteswap(\''+t+"')\">"+t+"</a></li>")}}};SiteswapGraph.siteswapGraph(t)}function runSiteswap(t){$("#siteswap").val(t),updateInputSiteswap(),go()}function updateDrawHandsForProp(){"ball"!=$("#prop").val()&&($("#drawHands")[0].checked=!1)}function showHideCameraCustomPosition(){"custom"==$("#cameraMode").val()?$("#cameraCustomPositionContainer").show():$("#cameraCustomPositionContainer").hide()}function saveCurrentSiteswap(){var t={};t.inputs=YAML.parse($("#inputsAdvanced").val()),t.name=$("#savedName").val(),$.post("api/patterns",t).done(function(t){$("#saveSuccess").show().delay(5e3).fadeOut(),refreshSavedSiteswapsList()}).fail(function(){$("#saveFailure").show().delay(5e3).fadeOut()})}function refreshSavedSiteswapsList(){$.get("api/patterns?public=1").done(function(t){var e=$("#savedList");e.empty();for(var i=0;i<t.length;i++)e.append('\t\t\t\t<li>\t\t\t\t\t<div class="patternLink">\t\t\t\t\t\t<a href="#" onclick="runSavedSiteswap(\''+t[i]._id+"',true);\">"+t[i].name+'</a>\t\t\t\t\t\t<a href="" style="float:right;" onclick="deleteSavedSiteswap(\''+t[i]._id+"');\">X</a>\t\t\t\t\t</div>\t\t\t\t</li>")})}function runSavedSiteswap(t,e){$.get("api/patterns/"+t).done(function(i){if(0==i.inputs.surfaces.length)delete i.inputs.surfaces;else for(var n=0;n<i.inputs.surfaces.length;n++)delete i.inputs.surfaces[n]._id;if(0==i.inputs.jugglers.length)delete i.inputs.jugglers;else for(n=0;n<i.inputs.jugglers.length;n++)delete i.inputs.jugglers[n]._id;if(0==i.inputs.props.length)delete i.inputs.props;else for(n=0;n<i.inputs.props.length;n++)delete i.inputs.props[n]._id;e&&(window.location.href=window.location.origin+"?patternId="+t),$("#inputsAdvanced").val(YAML.stringify(i.inputs,1,1)),go()})}function deleteSavedSiteswap(t){$.ajax({url:"api/patterns/"+t,type:"DELETE",success:function(t){refreshSavedSiteswapsList()}})}function updateCameraModeNumJugglers(t){}!function(t,e){function i(t){var e=t.length,i=rt.type(t);return!rt.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)))}function n(t,i,n,r){if(rt.acceptData(t)){var s,o,a=rt.expando,l=t.nodeType,h=l?rt.cache:t,c=l?t[a]:t[a]&&a;if(c&&h[c]&&(r||h[c].data)||n!==e||"string"!=typeof i)return c||(c=l?t[a]=$.pop()||rt.guid++:a),h[c]||(h[c]=l?{}:{toJSON:rt.noop}),("object"==typeof i||"function"==typeof i)&&(r?h[c]=rt.extend(h[c],i):h[c].data=rt.extend(h[c].data,i)),o=h[c],r||(o.data||(o.data={}),o=o.data),n!==e&&(o[rt.camelCase(i)]=n),"string"==typeof i?null==(s=o[i])&&(s=o[rt.camelCase(i)]):s=o,s}}function r(t,e,i){if(rt.acceptData(t)){var n,r,s=t.nodeType,a=s?rt.cache:t,l=s?t[rt.expando]:rt.expando;if(a[l]){if(e&&(n=i?a[l]:a[l].data)){rt.isArray(e)?e=e.concat(rt.map(e,rt.camelCase)):e in n?e=[e]:(e=rt.camelCase(e),e=e in n?[e]:e.split(" ")),r=e.length;for(;r--;)delete n[e[r]];if(i?!o(n):!rt.isEmptyObject(n))return}(i||(delete a[l].data,o(a[l])))&&(s?rt.cleanData([t],!0):rt.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function s(t,i,n){if(n===e&&1===t.nodeType){var r="data-"+i.replace(_t,"-$1").toLowerCase();if("string"==typeof(n=t.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:xt.test(n)?rt.parseJSON(n):n)}catch(t){}rt.data(t,i,n)}else n=e}return n}function o(t){var e;for(e in t)if(("data"!==e||!rt.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function a(){return!0}function l(){return!1}function h(){try{return W.activeElement}catch(t){}}function c(t,e){do{t=t[e]}while(t&&1!==t.nodeType);return t}function u(t,e,i){if(rt.isFunction(e))return rt.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return rt.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(kt.test(e))return rt.filter(e,t,i);e=rt.filter(e,t)}return rt.grep(t,function(t){return rt.inArray(t,e)>=0!==i})}function d(t){var e=Ut.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function p(t,e){return rt.nodeName(t,"table")&&rt.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function f(t){return t.type=(null!==rt.find.attr(t,"type"))+"/"+t.type,t}function m(t){var e=Kt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function g(t,e){for(var i,n=0;null!=(i=t[n]);n++)rt._data(i,"globalEval",!e||rt._data(e[n],"globalEval"))}function v(t,e){if(1===e.nodeType&&rt.hasData(t)){var i,n,r,s=rt._data(t),o=rt._data(e,s),a=s.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,r=a[i].length;r>n;n++)rt.event.add(e,i,a[i][n])}o.data&&(o.data=rt.extend({},o.data))}}function y(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!rt.support.noCloneEvent&&e[rt.expando]){r=rt._data(e);for(n in r.events)rt.removeEvent(e,n,r.handle);e.removeAttribute(rt.expando)}"script"===i&&e.text!==t.text?(f(e).text=t.text,m(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),rt.support.html5Clone&&t.innerHTML&&!rt.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&$t.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function b(t,i){var n,r,s=0,o=typeof t.getElementsByTagName!==j?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==j?t.querySelectorAll(i||"*"):e;if(!o)for(o=[],n=t.childNodes||t;null!=(r=n[s]);s++)!i||rt.nodeName(r,i)?o.push(r):rt.merge(o,b(r,i));return i===e||i&&rt.nodeName(t,i)?rt.merge([t],o):o}function x(t){$t.test(t.type)&&(t.defaultChecked=t.checked)}function _(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=ve.length;r--;)if((e=ve[r]+i)in t)return e;return n}function w(t,e){return t=e||t,"none"===rt.css(t,"display")||!rt.contains(t.ownerDocument,t)}function E(t,e){for(var i,n,r,s=[],o=0,a=t.length;a>o;o++)(n=t[o]).style&&(s[o]=rt._data(n,"olddisplay"),i=n.style.display,e?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&w(n)&&(s[o]=rt._data(n,"olddisplay",C(n.nodeName)))):s[o]||(r=w(n),(i&&"none"!==i||!r)&&rt._data(n,"olddisplay",r?i:rt.css(n,"display"))));for(o=0;a>o;o++)(n=t[o]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[o]||"":"none"));return t}function T(t,e,i){var n=ce.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function M(t,e,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=rt.css(t,i+ge[s],!0,r)),n?("content"===i&&(o-=rt.css(t,"padding"+ge[s],!0,r)),"margin"!==i&&(o-=rt.css(t,"border"+ge[s]+"Width",!0,r))):(o+=rt.css(t,"padding"+ge[s],!0,r),"padding"!==i&&(o+=rt.css(t,"border"+ge[s]+"Width",!0,r)));return o}function S(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,s=ne(t),o=rt.support.boxSizing&&"border-box"===rt.css(t,"boxSizing",!1,s);if(0>=r||null==r){if((0>(r=re(t,e,s))||null==r)&&(r=t.style[e]),ue.test(r))return r;n=o&&(rt.support.boxSizingReliable||r===t.style[e]),r=parseFloat(r)||0}return r+M(t,e,i||(o?"border":"content"),n,s)+"px"}function C(t){var e=W,i=pe[t];return i||("none"!==(i=A(t,e))&&i||(ie=(ie||rt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),(e=(ie[0].contentWindow||ie[0].contentDocument).document).write("<!doctype html><html><body>"),e.close(),i=A(t,e),ie.detach()),pe[t]=i),i}function A(t,e){var i=rt(e.createElement(t)).appendTo(e.body),n=rt.css(i[0],"display");return i.remove(),n}function P(t,e,i,n){var r;if(rt.isArray(e))rt.each(e,function(e,r){i||be.test(t)?n(t,r):P(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==rt.type(e))n(t,e);else for(r in e)P(t+"["+r+"]",e[r],i,n)}function R(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,s=e.toLowerCase().match(ot)||[];if(rt.isFunction(i))for(;n=s[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function L(t,i,n,r){function s(l){var h;return o[l]=!0,rt.each(t[l]||[],function(t,l){var c=l(i,n,r);return"string"!=typeof c||a||o[c]?a?!(h=c):e:(i.dataTypes.unshift(c),s(c),!1)}),h}var o={},a=t===Oe;return s(i.dataTypes[0])||!o["*"]&&s("*")}function D(t,i){var n,r,s=rt.ajaxSettings.flatOptions||{};for(r in i)i[r]!==e&&((s[r]?t:n||(n={}))[r]=i[r]);return n&&rt.extend(!0,t,n),t}function I(){try{return new t.XMLHttpRequest}catch(t){}}function N(){return setTimeout(function(){Ge=e}),Ge=rt.now()}function O(t,e,i){for(var n,r=($e[e]||[]).concat($e["*"]),s=0,o=r.length;o>s;s++)if(n=r[s].call(i,e,t))return n}function k(t,e,i){var n,r,s=0,o=Ye.length,a=rt.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=Ge||N(),i=Math.max(0,h.startTime+h.duration-e),n=1-(i/h.duration||0),s=0,o=h.tweens.length;o>s;s++)h.tweens[s].run(n);return a.notifyWith(t,[h,n,i]),1>n&&o?i:(a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:rt.extend({},e),opts:rt.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Ge||N(),duration:i.duration,tweens:[],createTween:function(e,i){var n=rt.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)h.tweens[i].run(1);return e?a.resolveWith(t,[h,e]):a.rejectWith(t,[h,e]),this}}),c=h.props;for(function(t,e){var i,n,r,s,o;for(i in t)if(n=rt.camelCase(i),r=e[n],s=t[i],rt.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(o=rt.cssHooks[n])&&"expand"in o){s=o.expand(s),delete t[n];for(i in s)i in t||(t[i]=s[i],e[i]=r)}else e[n]=r}(c,h.opts.specialEasing);o>s;s++)if(n=Ye[s].call(h,t,c,h.opts))return n;return rt.map(c,O,h),rt.isFunction(h.opts.start)&&h.opts.start.call(t,h),rt.fx.timer(rt.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function z(t,e,i,n,r){return new z.prototype.init(t,e,i,n,r)}function H(t,e){var i,n={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)i=ge[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function F(t){return rt.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}var U,B,j=typeof e,G=t.location,W=t.document,V=W.documentElement,q=t.jQuery,X=t.$,Y={},$=[],J="1.10.2",Z=$.concat,K=$.push,Q=$.slice,tt=$.indexOf,et=Y.toString,it=Y.hasOwnProperty,nt=J.trim,rt=function(t,e){return new rt.fn.init(t,e,B)},st=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ot=/\S+/g,at=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^[\],:{}\s]*$/,ut=/(?:^|:|,)(?:\s*\[)+/g,dt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,pt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,ft=/^-ms-/,mt=/-([\da-z])/gi,gt=function(t,e){return e.toUpperCase()},vt=function(t){(W.addEventListener||"load"===t.type||"complete"===W.readyState)&&(yt(),rt.ready())},yt=function(){W.addEventListener?(W.removeEventListener("DOMContentLoaded",vt,!1),t.removeEventListener("load",vt,!1)):(W.detachEvent("onreadystatechange",vt),t.detachEvent("onload",vt))};rt.fn=rt.prototype={jquery:J,constructor:rt,init:function(t,i,n){var r,s;if(!t)return this;if("string"==typeof t){if(!(r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:lt.exec(t))||!r[1]&&i)return!i||i.jquery?(i||n).find(t):this.constructor(i).find(t);if(r[1]){if(i=i instanceof rt?i[0]:i,rt.merge(this,rt.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:W,!0)),ht.test(r[1])&&rt.isPlainObject(i))for(r in i)rt.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}if((s=W.getElementById(r[2]))&&s.parentNode){if(s.id!==r[2])return n.find(t);this.length=1,this[0]=s}return this.context=W,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):rt.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),rt.makeArray(t,this))},selector:"",length:0,toArray:function(){return Q.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=rt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return rt.each(this,t,e)},ready:function(t){return rt.ready.promise().done(t),this},slice:function(){return this.pushStack(Q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(rt.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:[].sort,splice:[].splice},rt.fn.init.prototype=rt.fn,rt.extend=rt.fn.extend=function(){var t,i,n,r,s,o,a=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},l=2),"object"==typeof a||rt.isFunction(a)||(a={}),h===l&&(a=this,--l);h>l;l++)if(null!=(s=arguments[l]))for(r in s)t=a[r],n=s[r],a!==n&&(c&&n&&(rt.isPlainObject(n)||(i=rt.isArray(n)))?(i?(i=!1,o=t&&rt.isArray(t)?t:[]):o=t&&rt.isPlainObject(t)?t:{},a[r]=rt.extend(c,o,n)):n!==e&&(a[r]=n));return a},rt.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===rt&&(t.$=X),e&&t.jQuery===rt&&(t.jQuery=q),rt},isReady:!1,readyWait:1,holdReady:function(t){t?rt.readyWait++:rt.ready(!0)},ready:function(t){if(!0===t?!--rt.readyWait:!rt.isReady){if(!W.body)return setTimeout(rt.ready);rt.isReady=!0,!0!==t&&--rt.readyWait>0||(U.resolveWith(W,[rt]),rt.fn.trigger&&rt(W).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===rt.type(t)},isArray:Array.isArray||function(t){return"array"===rt.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Y[et.call(t)]||"object":typeof t},isPlainObject:function(t){var i;if(!t||"object"!==rt.type(t)||t.nodeType||rt.isWindow(t))return!1;try{if(t.constructor&&!it.call(t,"constructor")&&!it.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(rt.support.ownLast)for(i in t)return it.call(t,i);for(i in t);return i===e||it.call(t,i)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||W;var n=ht.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=rt.buildFragment([t],e,r),r&&rt(r).remove(),rt.merge([],n.childNodes))},parseJSON:function(i){return t.JSON&&t.JSON.parse?t.JSON.parse(i):null===i?i:"string"==typeof i&&(i=rt.trim(i))&&ct.test(i.replace(dt,"@").replace(pt,"]").replace(ut,""))?Function("return "+i)():(rt.error("Invalid JSON: "+i),e)},parseXML:function(i){var n,r;if(!i||"string"!=typeof i)return null;try{t.DOMParser?(r=new DOMParser,n=r.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(t){n=e}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||rt.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(e){e&&rt.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(ft,"ms-").replace(mt,gt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r=0,s=t.length,o=i(t);if(n){if(o)for(;s>r&&!1!==e.apply(t[r],n);r++);else for(r in t)if(!1===e.apply(t[r],n))break}else if(o)for(;s>r&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:nt&&!nt.call("\ufeffÂ ")?function(t){return null==t?"":nt.call(t)}:function(t){return null==t?"":(t+"").replace(at,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?rt.merge(n,"string"==typeof t?[t]:t):K.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(tt)return tt.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var n=i.length,r=t.length,s=0;if("number"==typeof n)for(;n>s;s++)t[r++]=i[s];else for(;i[s]!==e;)t[r++]=i[s++];return t.length=r,t},grep:function(t,e,i){var n,r=[],s=0,o=t.length;for(i=!!i;o>s;s++)n=!!e(t[s],s),i!==n&&r.push(t[s]);return r},map:function(t,e,n){var r,s=0,o=t.length,a=[];if(i(t))for(;o>s;s++)null!=(r=e(t[s],s,n))&&(a[a.length]=r);else for(s in t)null!=(r=e(t[s],s,n))&&(a[a.length]=r);return Z.apply([],a)},guid:1,proxy:function(t,i){var n,r,s;return"string"==typeof i&&(s=t[i],i=t,t=s),rt.isFunction(t)?(n=Q.call(arguments,2),r=function(){return t.apply(i||this,n.concat(Q.call(arguments)))},r.guid=t.guid=t.guid||rt.guid++,r):e},access:function(t,i,n,r,s,o,a){var l=0,h=t.length,c=null==n;if("object"===rt.type(n)){s=!0;for(l in n)rt.access(t,i,l,n[l],!0,o,a)}else if(r!==e&&(s=!0,rt.isFunction(r)||(a=!0),c&&(a?(i.call(t,r),i=null):(c=i,i=function(t,e,i){return c.call(rt(t),i)})),i))for(;h>l;l++)i(t[l],n,a?r:r.call(t[l],l,i(t[l],n)));return s?t:c?i.call(t):h?i(t[0],n):o},now:function(){return(new Date).getTime()},swap:function(t,e,i,n){var r,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];r=i.apply(t,n||[]);for(s in e)t.style[s]=o[s];return r}}),rt.ready.promise=function(e){if(!U)if(U=rt.Deferred(),"complete"===W.readyState)setTimeout(rt.ready);else if(W.addEventListener)W.addEventListener("DOMContentLoaded",vt,!1),t.addEventListener("load",vt,!1);else{W.attachEvent("onreadystatechange",vt),t.attachEvent("onload",vt);var i=!1;try{i=null==t.frameElement&&W.documentElement}catch(t){}i&&i.doScroll&&function t(){if(!rt.isReady){try{i.doScroll("left")}catch(e){return setTimeout(t,50)}yt(),rt.ready()}}()}return U.promise(e)},rt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Y["[object "+e+"]"]=e.toLowerCase()}),B=rt(W),function(t,e){function i(t,e,i,n){var r,s,o,a,l,h,c,u,f,m;if((e?e.ownerDocument||e:z)!==P&&A(e),e=e||P,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(L&&!n){if(r=gt.exec(t))if(o=r[1]){if(9===a){if(!(s=e.getElementById(o))||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(o))&&O(e,s)&&s.id===o)return i.push(s),i}else{if(r[2])return Z.apply(i,e.getElementsByTagName(t)),i;if((o=r[3])&&x.getElementsByClassName&&e.getElementsByClassName)return Z.apply(i,e.getElementsByClassName(o)),i}if(x.qsa&&(!D||!D.test(t))){if(u=c=k,f=e,m=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=d(t),(c=e.getAttribute("id"))?u=c.replace(bt,"\\$&"):e.setAttribute("id",u),u="[id='"+u+"'] ",l=h.length;l--;)h[l]=u+p(h[l]);f=ct.test(t)&&e.parentNode||e,m=h.join(",")}if(m)try{return Z.apply(i,f.querySelectorAll(m)),i}catch(t){}finally{c||e.removeAttribute("id")}}}return function(t,e,i,n){var r,s,o,a,l,h=d(t);if(!n&&1===h.length){if((s=h[0]=h[0].slice(0)).length>2&&"ID"===(o=s[0]).type&&x.getById&&9===e.nodeType&&L&&w.relative[s[1].type]){if(!(e=(w.find.ID(o.matches[0].replace(xt,_t),e)||[])[0]))return i;t=t.slice(s.shift().value.length)}for(r=ft.needsContext.test(t)?0:s.length;r--&&(o=s[r],!w.relative[a=o.type]);)if((l=w.find[a])&&(n=l(o.matches[0].replace(xt,_t),ct.test(s[0].type)&&e.parentNode||e))){if(s.splice(r,1),!(t=n.length&&p(s)))return Z.apply(i,n),i;break}}return M(t,h)(n,e,!L,i,ct.test(t)),i}(t.replace(at,"$1"),e,i,n)}function n(){function t(i,n){return e.push(i+=" ")>w.cacheLength&&delete t[e.shift()],t[i]=n}var e=[];return t}function r(t){return t[k]=!0,t}function s(t){var e=P.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)w.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function h(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function c(t){return r(function(e){return e=+e,r(function(i,n){for(var r,s=t([],i.length,e),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))})})}function u(){}function d(t,e){var n,r,s,o,a,l,h,c=B[t+" "];if(c)return e?0:c.slice(0);for(a=t,l=[],h=w.preFilter;a;){(!n||(r=lt.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(s=[])),n=!1,(r=ht.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(at," ")}),a=a.slice(n.length));for(o in w.filter)!(r=ft[o].exec(a))||h[o]&&!(r=h[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?i.error(t):B(t,l).slice(0)}function p(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,r=i&&"parentNode"===n,s=F++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,s)}:function(e,i,o){var a,l,h,c=H+" "+s;if(o){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||r)if(h=e[k]||(e[k]={}),(l=h[n])&&l[0]===c){if(!0===(a=l[1])||a===_)return!0===a}else if(l=h[n]=[c],l[1]=t(e,i,o)||_,!0===l[1])return!0}}function m(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function g(t,e,i,n,r){for(var s,o=[],a=0,l=t.length,h=null!=e;l>a;a++)(s=t[a])&&(!i||i(s,n,r))&&(o.push(s),h&&e.push(a));return o}function v(t,e,n,s,o,a){return s&&!s[k]&&(s=v(s)),o&&!o[k]&&(o=v(o,a)),r(function(r,a,l,h){var c,u,d,p=[],f=[],m=a.length,v=r||function(t,e,n){for(var r=0,s=e.length;s>r;r++)i(t,e[r],n);return n}(e||"*",l.nodeType?[l]:l,[]),y=!t||!r&&e?v:g(v,p,t,l,h),b=n?o||(r?t:m||s)?[]:a:y;if(n&&n(y,b,l,h),s)for(c=g(b,f),s(c,[],l,h),u=c.length;u--;)(d=c[u])&&(b[f[u]]=!(y[f[u]]=d));if(r){if(o||t){if(o){for(c=[],u=b.length;u--;)(d=b[u])&&c.push(y[u]=d);o(null,b=[],c,h)}for(u=b.length;u--;)(d=b[u])&&(c=o?Q.call(r,d):p[u])>-1&&(r[c]=!(a[c]=d))}}else b=g(b===a?b.splice(m,b.length):b),o?o(null,a,b,h):Z.apply(a,b)})}function y(t){for(var e,i,n,r=t.length,s=w.relative[t[0].type],o=s||w.relative[" "],a=s?1:0,l=f(function(t){return t===e},o,!0),h=f(function(t){return Q.call(e,t)>-1},o,!0),c=[function(t,i,n){return!s&&(n||i!==S)||((e=i).nodeType?l(t,i,n):h(t,i,n))}];r>a;a++)if(i=w.relative[t[a].type])c=[f(m(c),i)];else{if((i=w.filter[t[a].type].apply(null,t[a].matches))[k]){for(n=++a;r>n&&!w.relative[t[n].type];n++);return v(a>1&&m(c),a>1&&p(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(at,"$1"),i,n>a&&y(t.slice(a,n)),r>n&&y(t=t.slice(n)),r>n&&p(t))}c.push(i)}return m(c)}var b,x,_,w,E,T,M,S,C,A,P,R,L,D,I,N,O,k="sizzle"+-new Date,z=t.document,H=0,F=0,U=n(),B=n(),j=n(),G=!1,W=function(t,e){return t===e?(G=!0,0):0},V="undefined",q=1<<31,X={}.hasOwnProperty,Y=[],$=Y.pop,J=Y.push,Z=Y.push,K=Y.slice,Q=Y.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",et="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=it.replace("w","w#"),st="\\["+et+"*("+it+")"+et+"*(?:([*^$|!~]?=)"+et+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+nt+")|)|)"+et+"*\\]",ot=":("+it+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+st.replace(3,8)+")*)|.*)\\)|)",at=RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),lt=RegExp("^"+et+"*,"+et+"*"),ht=RegExp("^"+et+"*([>+~]|"+et+")"+et+"*"),ct=RegExp(et+"*[+~]"),ut=RegExp("="+et+"*([^\\]'\"]*)"+et+"*\\]","g"),dt=RegExp(ot),pt=RegExp("^"+nt+"$"),ft={ID:RegExp("^#("+it+")"),CLASS:RegExp("^\\.("+it+")"),TAG:RegExp("^("+it.replace("w","w*")+")"),ATTR:RegExp("^"+st),PSEUDO:RegExp("^"+ot),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),bool:RegExp("^(?:"+tt+")$","i"),needsContext:RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},mt=/^[^{]+\{\s*\[native \w/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vt=/^(?:input|select|textarea|button)$/i,yt=/^h\d$/i,bt=/'|\\/g,xt=RegExp("\\\\([\\da-f]{1,6}"+et+"?|("+et+")|.)","ig"),_t=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{Z.apply(Y=K.call(z.childNodes),z.childNodes),Y[z.childNodes.length].nodeType}catch(t){Z={apply:Y.length?function(t,e){J.apply(t,K.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}T=i.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},x=i.support={},A=i.setDocument=function(t){var i=t?t.ownerDocument||t:z,n=i.defaultView;return i!==P&&9===i.nodeType&&i.documentElement?(P=i,R=i.documentElement,L=!T(i),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){A()}),x.attributes=s(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=s(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=s(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),x.getById=s(function(t){return R.appendChild(t).id=k,!i.getElementsByName||!i.getElementsByName(k).length}),x.getById?(w.find.ID=function(t,e){if(typeof e.getElementById!==V&&L){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},w.filter.ID=function(t){var e=t.replace(xt,_t);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(xt,_t);return function(t){var i=typeof t.getAttributeNode!==V&&t.getAttributeNode("id");return i&&i.value===e}}),w.find.TAG=x.getElementsByTagName?function(t,i){return typeof i.getElementsByTagName!==V?i.getElementsByTagName(t):e}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},w.find.CLASS=x.getElementsByClassName&&function(t,i){return typeof i.getElementsByClassName!==V&&L?i.getElementsByClassName(t):e},I=[],D=[],(x.qsa=mt.test(i.querySelectorAll))&&(s(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||D.push("\\["+et+"*(?:value|"+tt+")"),t.querySelectorAll(":checked").length||D.push(":checked")}),s(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&D.push("[*^$]="+et+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||D.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),D.push(",.*:")})),(x.matchesSelector=mt.test(N=R.webkitMatchesSelector||R.mozMatchesSelector||R.oMatchesSelector||R.msMatchesSelector))&&s(function(t){x.disconnectedMatch=N.call(t,"div"),N.call(t,"[s!='']:x"),I.push("!=",ot)}),D=D.length&&RegExp(D.join("|")),I=I.length&&RegExp(I.join("|")),O=mt.test(R.contains)||R.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=R.compareDocumentPosition?function(t,e){if(t===e)return G=!0,0;var n=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e);return n?1&n||!x.sortDetached&&e.compareDocumentPosition(t)===n?t===i||O(z,t)?-1:e===i||O(z,e)?1:C?Q.call(C,t)-Q.call(C,e):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var n,r=0,s=t.parentNode,o=e.parentNode,l=[t],h=[e];if(t===e)return G=!0,0;if(!s||!o)return t===i?-1:e===i?1:s?-1:o?1:C?Q.call(C,t)-Q.call(C,e):0;if(s===o)return a(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)h.unshift(n);for(;l[r]===h[r];)r++;return r?a(l[r],h[r]):l[r]===z?-1:h[r]===z?1:0},i):P},i.matches=function(t,e){return i(t,null,null,e)},i.matchesSelector=function(t,e){if((t.ownerDocument||t)!==P&&A(t),e=e.replace(ut,"='$1']"),!(!x.matchesSelector||!L||I&&I.test(e)||D&&D.test(e)))try{var n=N.call(t,e);if(n||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return i(e,P,null,[t]).length>0},i.contains=function(t,e){return(t.ownerDocument||t)!==P&&A(t),O(t,e)},i.attr=function(t,i){(t.ownerDocument||t)!==P&&A(t);var n=w.attrHandle[i.toLowerCase()],r=n&&X.call(w.attrHandle,i.toLowerCase())?n(t,i,!L):e;return r===e?x.attributes||!L?t.getAttribute(i):(r=t.getAttributeNode(i))&&r.specified?r.value:null:r},i.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)},i.uniqueSort=function(t){var e,i=[],n=0,r=0;if(G=!x.detectDuplicates,C=!x.sortStable&&t.slice(0),t.sort(W),G){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return t},E=i.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=E(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n];n++)i+=E(e);return i},(w=i.selectors={cacheLength:50,createPseudo:r,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xt,_t),t[3]=(t[4]||t[5]||"").replace(xt,_t),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||i.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&i.error(t[0]),t},PSEUDO:function(t){var i,n=!t[5]&&t[2];return ft.CHILD.test(t[0])?null:(t[3]&&t[4]!==e?t[2]=t[4]:n&&dt.test(n)&&(i=d(n,!0))&&(i=n.indexOf(")",n.length-i)-n.length)&&(t[0]=t[0].slice(0,i),t[2]=n.slice(0,i)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xt,_t).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=U[t+" "];return e||(e=RegExp("(^|"+et+")"+t+"("+et+"|$)"))&&U(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==V&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(r){var s=i.attr(r,t);return null==s?"!="===e:!e||(s+="","="===e?s===n:"!="===e?s!==n:"^="===e?n&&0===s.indexOf(n):"*="===e?n&&s.indexOf(n)>-1:"$="===e?n&&s.slice(-n.length)===n:"~="===e?(" "+s+" ").indexOf(n)>-1:"|="===e&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var h,c,u,d,p,f,m=s!==o?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(g){if(s){for(;m;){for(u=e;u=u[m];)if(a?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&y){for(p=(h=(c=g[k]||(g[k]={}))[t]||[])[0]===H&&h[1],d=h[0]===H&&h[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();)if(1===u.nodeType&&++d&&u===e){c[t]=[H,p,d];break}}else if(y&&(h=(e[k]||(e[k]={}))[t])&&h[0]===H)d=h[1];else for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[k]||(u[k]={}))[t]=[H,d]),u!==e)););return(d-=r)===n||0==d%n&&d/n>=0}}},PSEUDO:function(t,e){var n,s=w.pseudos[t]||w.setFilters[t.toLowerCase()]||i.error("unsupported pseudo: "+t);return s[k]?s(e):s.length>1?(n=[t,t,"",e],w.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,i){for(var n,r=s(t,e),o=r.length;o--;)n=Q.call(t,r[o]),t[n]=!(i[n]=r[o])}):function(t){return s(t,0,n)}):s}},pseudos:{not:r(function(t){var e=[],i=[],n=M(t.replace(at,"$1"));return n[k]?r(function(t,e,i,r){for(var s,o=n(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))}):function(t,r,s){return e[0]=t,n(e,null,s,i),!i.pop()}}),has:r(function(t){return function(e){return i(t,e).length>0}}),contains:r(function(t){return function(e){return(e.textContent||e.innerText||E(e)).indexOf(t)>-1}}),lang:r(function(t){return pt.test(t||"")||i.error("unsupported lang: "+t),t=t.replace(xt,_t).toLowerCase(),function(e){var i;do{if(i=L?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===R},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return yt.test(t.nodeName)},input:function(t){return vt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,i){return[0>i?i+e:i]}),even:c(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:c(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:c(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:c(function(t,e,i){for(var n=0>i?i+e:i;e>++n;)t.push(n);return t})}}).pseudos.nth=w.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[b]=l(b);for(b in{submit:!0,reset:!0})w.pseudos[b]=h(b);u.prototype=w.filters=w.pseudos,w.setFilters=new u,M=i.compile=function(t,e){var n,s=[],o=[],a=j[t+" "];if(!a){for(e||(e=d(t)),n=e.length;n--;)(a=y(e[n]))[k]?s.push(a):o.push(a);a=j(t,function(t,e){var n=0,s=e.length>0,o=t.length>0,a=function(r,a,l,h,c){var u,d,p,f=[],m=0,v="0",y=r&&[],b=null!=c,x=S,E=r||o&&w.find.TAG("*",c&&a.parentNode||a),T=H+=null==x?1:Math.random()||.1;for(b&&(S=a!==P&&a,_=n);null!=(u=E[v]);v++){if(o&&u){for(d=0;p=t[d++];)if(p(u,a,l)){h.push(u);break}b&&(H=T,_=++n)}s&&((u=!p&&u)&&m--,r&&y.push(u))}if(m+=v,s&&v!==m){for(d=0;p=e[d++];)p(y,f,a,l);if(r){if(m>0)for(;v--;)y[v]||f[v]||(f[v]=$.call(h));f=g(f)}Z.apply(h,f),b&&!r&&f.length>0&&m+e.length>1&&i.uniqueSort(h)}return b&&(H=T,S=x),y};return s?r(a):a}(o,s))}return a},x.sortStable=k.split("").sort(W).join("")===k,x.detectDuplicates=G,A(),x.sortDetached=s(function(t){return 1&t.compareDocumentPosition(P.createElement("div"))}),s(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,i,n){return n?e:t.getAttribute(i,"type"===i.toLowerCase()?1:2)}),x.attributes&&s(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,i,n){return n||"input"!==t.nodeName.toLowerCase()?e:t.defaultValue}),s(function(t){return null==t.getAttribute("disabled")})||o(tt,function(t,i,n){var r;return n?e:(r=t.getAttributeNode(i))&&r.specified?r.value:!0===t[i]?i.toLowerCase():null}),rt.find=i,rt.expr=i.selectors,rt.expr[":"]=rt.expr.pseudos,rt.unique=i.uniqueSort,rt.text=i.getText,rt.isXMLDoc=i.isXML,rt.contains=i.contains}(t);var bt={};rt.Callbacks=function(t){var i,n,r,s,o,a,l=[],h=!(t="string"==typeof t?bt[t]||function(t){var e=bt[t]={};return rt.each(t.match(ot)||[],function(t,i){e[i]=!0}),e}(t):rt.extend({},t)).once&&[],c=function(e){for(n=t.memory&&e,r=!0,o=a||0,a=0,s=l.length,i=!0;l&&s>o;o++)if(!1===l[o].apply(e[0],e[1])&&t.stopOnFalse){n=!1;break}i=!1,l&&(h?h.length&&c(h.shift()):n?l=[]:u.disable())},u={add:function(){if(l){var e=l.length;(function e(i){rt.each(i,function(i,n){var r=rt.type(n);"function"===r?t.unique&&u.has(n)||l.push(n):n&&n.length&&"string"!==r&&e(n)})})(arguments),i?s=l.length:n&&(a=e,c(n))}return this},remove:function(){return l&&rt.each(arguments,function(t,e){for(var n;(n=rt.inArray(e,l,n))>-1;)l.splice(n,1),i&&(s>=n&&s--,o>=n&&o--)}),this},has:function(t){return t?rt.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=h=n=e,this},disabled:function(){return!l},lock:function(){return h=e,n||u.disable(),this},locked:function(){return!h},fireWith:function(t,e){return!l||r&&!h||(e=e||[],e=[t,e.slice?e.slice():e],i?h.push(e):c(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},rt.extend({Deferred:function(t){var e=[["resolve","done",rt.Callbacks("once memory"),"resolved"],["reject","fail",rt.Callbacks("once memory"),"rejected"],["notify","progress",rt.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return rt.Deferred(function(i){rt.each(e,function(e,s){var o=s[0],a=rt.isFunction(t[e])&&t[e];r[s[1]](function(){var t=a&&a.apply(this,arguments);t&&rt.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?rt.extend(t,n):n}},r={};return n.pipe=n.then,rt.each(e,function(t,s){var o=s[2],a=s[3];n[s[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),r[s[0]]=function(){return r[s[0]+"With"](this===r?n:this,arguments),this},r[s[0]+"With"]=o.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,s=Q.call(arguments),o=s.length,a=1!==o||t&&rt.isFunction(t.promise)?o:0,l=1===a?t:rt.Deferred(),h=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?Q.call(arguments):r,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(e=Array(o),i=Array(o),n=Array(o);o>r;r++)s[r]&&rt.isFunction(s[r].promise)?s[r].promise().done(h(r,n,s)).fail(l.reject).progress(h(r,i,e)):--a;return a||l.resolveWith(n,s),l.promise()}}),rt.support=function(e){var i,n,r,s,o,a,l,h,c,u=W.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*")||[],!(n=u.getElementsByTagName("a")[0])||!n.style||!i.length)return e;a=(s=W.createElement("select")).appendChild(W.createElement("option")),r=u.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",e.getSetAttribute="t"!==u.className,e.leadingWhitespace=3===u.firstChild.nodeType,e.tbody=!u.getElementsByTagName("tbody").length,e.htmlSerialize=!!u.getElementsByTagName("link").length,e.style=/top/.test(n.getAttribute("style")),e.hrefNormalized="/a"===n.getAttribute("href"),e.opacity=/^0.5/.test(n.style.opacity),e.cssFloat=!!n.style.cssFloat,e.checkOn=!!r.value,e.optSelected=a.selected,e.enctype=!!W.createElement("form").enctype,e.html5Clone="<:nav></:nav>"!==W.createElement("nav").cloneNode(!0).outerHTML,e.inlineBlockNeedsLayout=!1,e.shrinkWrapBlocks=!1,e.pixelPosition=!1,e.deleteExpando=!0,e.noCloneEvent=!0,e.reliableMarginRight=!0,e.boxSizingReliable=!0,r.checked=!0,e.noCloneChecked=r.cloneNode(!0).checked,s.disabled=!0,e.optDisabled=!a.disabled;try{delete u.test}catch(t){e.deleteExpando=!1}(r=W.createElement("input")).setAttribute("value",""),e.input=""===r.getAttribute("value"),r.value="t",r.setAttribute("type","radio"),e.radioValue="t"===r.value,r.setAttribute("checked","t"),r.setAttribute("name","t"),(o=W.createDocumentFragment()).appendChild(r),e.appendChecked=r.checked,e.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){e.noCloneEvent=!1}),u.cloneNode(!0).click());for(c in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+c,"t"),e[c+"Bubbles"]=l in t||!1===u.attributes[l].expando;u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===u.style.backgroundClip;for(c in rt(e))break;return e.ownLast="0"!==c,rt(function(){var i,n,r,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=W.getElementsByTagName("body")[0];o&&(i=W.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=u.getElementsByTagName("td"),r[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===r[0].offsetHeight,r[0].style.display="",r[1].style.display="none",e.reliableHiddenOffsets=h&&0===r[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",rt.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===u.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(u,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(u,null)||{width:"4px"}).width,n=u.appendChild(W.createElement("div")),n.style.cssText=u.style.cssText=s,n.style.marginRight=n.style.width="0",u.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(n,null)||{}).marginRight)),typeof u.style.zoom!==j&&(u.innerHTML="",u.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==u.offsetWidth,e.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(i),i=u=r=n=null)}),i=s=o=a=n=r=null,e}({});var xt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,_t=/([A-Z])/g;rt.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return!!(t=t.nodeType?rt.cache[t[rt.expando]]:t[rt.expando])&&!o(t)},data:function(t,e,i){return n(t,e,i)},removeData:function(t,e){return r(t,e)},_data:function(t,e,i){return n(t,e,i,!0)},_removeData:function(t,e){return r(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&rt.noData[t.nodeName.toLowerCase()];return!e||!0!==e&&t.getAttribute("classid")===e}}),rt.fn.extend({data:function(t,i){var n,r,o=null,a=0,l=this[0];if(t===e){if(this.length&&(o=rt.data(l),1===l.nodeType&&!rt._data(l,"parsedAttrs"))){for(n=l.attributes;n.length>a;a++)0===(r=n[a].name).indexOf("data-")&&(r=rt.camelCase(r.slice(5)),s(l,r,o[r]));rt._data(l,"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){rt.data(this,t)}):arguments.length>1?this.each(function(){rt.data(this,t,i)}):l?s(l,t,rt.data(l,t)):null},removeData:function(t){return this.each(function(){rt.removeData(this,t)})}}),rt.extend({queue:function(t,i,n){var r;return t?(i=(i||"fx")+"queue",r=rt._data(t,i),n&&(!r||rt.isArray(n)?r=rt._data(t,i,rt.makeArray(n)):r.push(n)),r||[]):e},dequeue:function(t,e){e=e||"fx";var i=rt.queue(t,e),n=i.length,r=i.shift(),s=rt._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,function(){rt.dequeue(t,e)},s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return rt._data(t,i)||rt._data(t,i,{empty:rt.Callbacks("once memory").add(function(){rt._removeData(t,e+"queue"),rt._removeData(t,i)})})}}),rt.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),n>arguments.length?rt.queue(this[0],t):i===e?this:this.each(function(){var e=rt.queue(this,t,i);rt._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&rt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){rt.dequeue(this,t)})},delay:function(t,e){return t=rt.fx?rt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,r=1,s=rt.Deferred(),o=this,a=this.length,l=function(){--r||s.resolveWith(o,[o])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;)(n=rt._data(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(l));return l(),s.promise(i)}});var wt,Et,Tt=/[\t\r\n\f]/g,Mt=/\r/g,St=/^(?:input|select|textarea|button|object)$/i,Ct=/^(?:a|area)$/i,At=/^(?:checked|selected)$/i,Pt=rt.support.getSetAttribute,Rt=rt.support.input;rt.fn.extend({attr:function(t,e){return rt.access(this,rt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){rt.removeAttr(this,t)})},prop:function(t,e){return rt.access(this,rt.prop,t,e,arguments.length>1)},removeProp:function(t){return t=rt.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(t){}})},addClass:function(t){var e,i,n,r,s,o=0,a=this.length,l="string"==typeof t&&t;if(rt.isFunction(t))return this.each(function(e){rt(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ot)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Tt," "):" ")){for(s=0;r=e[s++];)0>n.indexOf(" "+r+" ")&&(n+=r+" ");i.className=rt.trim(n)}return this},removeClass:function(t){var e,i,n,r,s,o=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(rt.isFunction(t))return this.each(function(e){rt(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ot)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Tt," "):"")){for(s=0;r=e[s++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=t?rt.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):rt.isFunction(t)?this.each(function(i){rt(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var e,n=0,r=rt(this),s=t.match(ot)||[];e=s[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===j||"boolean"===i)&&(this.className&&rt._data(this,"__className__",this.className),this.className=this.className||!1===t?"":rt._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Tt," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,n,r,s=this[0];return arguments.length?(r=rt.isFunction(t),this.each(function(i){var s;1===this.nodeType&&(null==(s=r?t.call(this,i,rt(this).val()):t)?s="":"number"==typeof s?s+="":rt.isArray(s)&&(s=rt.map(s,function(t){return null==t?"":t+""})),(n=rt.valHooks[this.type]||rt.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&n.set(this,s,"value")!==e||(this.value=s))})):s?(n=rt.valHooks[s.type]||rt.valHooks[s.nodeName.toLowerCase()])&&"get"in n&&(i=n.get(s,"value"))!==e?i:"string"==typeof(i=s.value)?i.replace(Mt,""):null==i?"":i:void 0}}),rt.extend({valHooks:{option:{get:function(t){var e=rt.find.attr(t,"value");return null!=e?e:t.text}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,s="select-one"===t.type||0>r,o=s?null:[],a=s?r+1:n.length,l=0>r?a:s?r:0;a>l;l++)if(!(!(i=n[l]).selected&&l!==r||(rt.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&rt.nodeName(i.parentNode,"optgroup"))){if(e=rt(i).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var i,n,r=t.options,s=rt.makeArray(e),o=r.length;o--;)n=r[o],(n.selected=rt.inArray(rt(n).val(),s)>=0)&&(i=!0);return i||(t.selectedIndex=-1),s}}},attr:function(t,i,n){var r,s,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===j?rt.prop(t,i,n):(1===o&&rt.isXMLDoc(t)||(i=i.toLowerCase(),r=rt.attrHooks[i]||(rt.expr.match.bool.test(i)?Et:wt)),n===e?r&&"get"in r&&null!==(s=r.get(t,i))?s:null==(s=rt.find.attr(t,i))?e:s:null!==n?r&&"set"in r&&(s=r.set(t,n,i))!==e?s:(t.setAttribute(i,n+""),n):(rt.removeAttr(t,i),e))},removeAttr:function(t,e){var i,n,r=0,s=e&&e.match(ot);if(s&&1===t.nodeType)for(;i=s[r++];)n=rt.propFix[i]||i,rt.expr.match.bool.test(i)?Rt&&Pt||!At.test(i)?t[n]=!1:t[rt.camelCase("default-"+i)]=t[n]=!1:rt.attr(t,i,""),t.removeAttribute(Pt?i:n)},attrHooks:{type:{set:function(t,e){if(!rt.support.radioValue&&"radio"===e&&rt.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{for:"htmlFor",class:"className"},prop:function(t,i,n){var r,s,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return(1!==o||!rt.isXMLDoc(t))&&(i=rt.propFix[i]||i,s=rt.propHooks[i]),n!==e?s&&"set"in s&&(r=s.set(t,n,i))!==e?r:t[i]=n:s&&"get"in s&&null!==(r=s.get(t,i))?r:t[i]},propHooks:{tabIndex:{get:function(t){var e=rt.find.attr(t,"tabindex");return e?parseInt(e,10):St.test(t.nodeName)||Ct.test(t.nodeName)&&t.href?0:-1}}}}),Et={set:function(t,e,i){return!1===e?rt.removeAttr(t,i):Rt&&Pt||!At.test(i)?t.setAttribute(!Pt&&rt.propFix[i]||i,i):t[rt.camelCase("default-"+i)]=t[i]=!0,i}},rt.each(rt.expr.match.bool.source.match(/\w+/g),function(t,i){var n=rt.expr.attrHandle[i]||rt.find.attr;rt.expr.attrHandle[i]=Rt&&Pt||!At.test(i)?function(t,i,r){var s=rt.expr.attrHandle[i],o=r?e:(rt.expr.attrHandle[i]=e)!=n(t,i,r)?i.toLowerCase():null;return rt.expr.attrHandle[i]=s,o}:function(t,i,n){return n?e:t[rt.camelCase("default-"+i)]?i.toLowerCase():null}}),Rt&&Pt||(rt.attrHooks.value={set:function(t,i,n){return rt.nodeName(t,"input")?(t.defaultValue=i,e):wt&&wt.set(t,i,n)}}),Pt||(wt={set:function(t,i,n){var r=t.getAttributeNode(n);return r||t.setAttributeNode(r=t.ownerDocument.createAttribute(n)),r.value=i+="","value"===n||i===t.getAttribute(n)?i:e}},rt.expr.attrHandle.id=rt.expr.attrHandle.name=rt.expr.attrHandle.coords=function(t,i,n){var r;return n?e:(r=t.getAttributeNode(i))&&""!==r.value?r.value:null},rt.valHooks.button={get:function(t,i){var n=t.getAttributeNode(i);return n&&n.specified?n.value:e},set:wt.set},rt.attrHooks.contenteditable={set:function(t,e,i){wt.set(t,""!==e&&e,i)}},rt.each(["width","height"],function(t,i){rt.attrHooks[i]={set:function(t,n){return""===n?(t.setAttribute(i,"auto"),n):e}}})),rt.support.hrefNormalized||rt.each(["href","src"],function(t,e){rt.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),rt.support.style||(rt.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),rt.support.optSelected||(rt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),rt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){rt.propFix[this.toLowerCase()]=this}),rt.support.enctype||(rt.propFix.enctype="encoding"),rt.each(["radio","checkbox"],function(){rt.valHooks[this]={set:function(t,i){return rt.isArray(i)?t.checked=rt.inArray(rt(t).val(),i)>=0:e}},rt.support.checkOn||(rt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Lt=/^(?:input|select|textarea)$/i,Dt=/^key/,It=/^(?:mouse|contextmenu)|click/,Nt=/^(?:focusinfocus|focusoutblur)$/,Ot=/^([^.]*)(?:\.(.+)|)$/;rt.event={global:{},add:function(t,i,n,r,s){var o,a,l,h,c,u,d,p,f,m,g,v=rt._data(t);if(v){for(n.handler&&(h=n,n=h.handler,s=h.selector),n.guid||(n.guid=rt.guid++),(a=v.events)||(a=v.events={}),(u=v.handle)||(u=v.handle=function(t){return typeof rt===j||t&&rt.event.triggered===t.type?e:rt.event.dispatch.apply(u.elem,arguments)},u.elem=t),l=(i=(i||"").match(ot)||[""]).length;l--;)o=Ot.exec(i[l])||[],f=g=o[1],m=(o[2]||"").split(".").sort(),f&&(c=rt.event.special[f]||{},f=(s?c.delegateType:c.bindType)||f,c=rt.event.special[f]||{},d=rt.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:s,needsContext:s&&rt.expr.match.needsContext.test(s),namespace:m.join(".")},h),(p=a[f])||(p=a[f]=[],p.delegateCount=0,c.setup&&!1!==c.setup.call(t,r,m,u)||(t.addEventListener?t.addEventListener(f,u,!1):t.attachEvent&&t.attachEvent("on"+f,u))),c.add&&(c.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,d):p.push(d),rt.event.global[f]=!0);t=null}},remove:function(t,e,i,n,r){var s,o,a,l,h,c,u,d,p,f,m,g=rt.hasData(t)&&rt._data(t);if(g&&(c=g.events)){for(h=(e=(e||"").match(ot)||[""]).length;h--;)if(a=Ot.exec(e[h])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(u=rt.event.special[p]||{},d=c[p=(n?u.delegateType:u.bindType)||p]||[],a=a[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=d.length;s--;)o=d[s],!r&&m!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(d.splice(s,1),o.selector&&d.delegateCount--,u.remove&&u.remove.call(t,o));l&&!d.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||rt.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)rt.event.remove(t,p+e[h],i,n,!0);rt.isEmptyObject(c)&&(delete g.handle,rt._removeData(t,"events"))}},trigger:function(i,n,r,s){var o,a,l,h,c,u,d,p=[r||W],f=it.call(i,"type")?i.type:i,m=it.call(i,"namespace")?i.namespace.split("."):[];if(l=u=r=r||W,3!==r.nodeType&&8!==r.nodeType&&!Nt.test(f+rt.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),a=0>f.indexOf(":")&&"on"+f,i=i[rt.expando]?i:new rt.Event(f,"object"==typeof i&&i),i.isTrigger=s?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=r),n=null==n?[i]:rt.makeArray(n,[i]),c=rt.event.special[f]||{},s||!c.trigger||!1!==c.trigger.apply(r,n))){if(!s&&!c.noBubble&&!rt.isWindow(r)){for(h=c.delegateType||f,Nt.test(h+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(r.ownerDocument||W)&&p.push(u.defaultView||u.parentWindow||t)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?h:c.bindType||f,(o=(rt._data(l,"events")||{})[i.type]&&rt._data(l,"handle"))&&o.apply(l,n),(o=a&&l[a])&&rt.acceptData(l)&&o.apply&&!1===o.apply(l,n)&&i.preventDefault();if(i.type=f,!s&&!i.isDefaultPrevented()&&(!c._default||!1===c._default.apply(p.pop(),n))&&rt.acceptData(r)&&a&&r[f]&&!rt.isWindow(r)){(u=r[a])&&(r[a]=null),rt.event.triggered=f;try{r[f]()}catch(t){}rt.event.triggered=e,u&&(r[a]=u)}return i.result}},dispatch:function(t){t=rt.event.fix(t);var i,n,r,s,o,a=[],l=Q.call(arguments),h=(rt._data(this,"events")||{})[t.type]||[],c=rt.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(a=rt.event.handlers.call(this,t,h),i=0;(s=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,o=0;(r=s.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,(n=((rt.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,l))!==e&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,r,s,o,a=[],l=i.delegateCount,h=t.target;if(l&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(!0!==h.disabled||"click"!==t.type)){for(s=[],o=0;l>o;o++)r=i[o],n=r.selector+" ",s[n]===e&&(s[n]=r.needsContext?rt(n,this).index(h)>=0:rt.find(n,this,null,[h]).length),s[n]&&s.push(r);s.length&&a.push({elem:h,handlers:s})}return i.length>l&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(t){if(t[rt.expando])return t;var e,i,n,r=t.type,s=t,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=It.test(r)?this.mouseHooks:Dt.test(r)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new rt.Event(s),e=n.length;e--;)i=n[e],t[i]=s[i];return t.target||(t.target=s.srcElement||W),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,o.filter?o.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,r,s,o=i.button,a=i.fromElement;return null==t.pageX&&null!=i.clientX&&(r=t.target.ownerDocument||W,s=r.documentElement,n=r.body,t.pageX=i.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),t.pageY=i.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?i.toElement:a),t.which||o===e||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):e},delegateType:"focusout"},click:{trigger:function(){return rt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):e},_default:function(t){return rt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=rt.extend(new rt.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?rt.event.trigger(r,null,e):rt.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},rt.removeEvent=W.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===j&&(t[n]=null),t.detachEvent(n,i))},rt.Event=function(t,i){return this instanceof rt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||!1===t.returnValue||t.getPreventDefault&&t.getPreventDefault()?a:l):this.type=t,i&&rt.extend(this,i),this.timeStamp=t&&t.timeStamp||rt.now(),this[rt.expando]=!0,e):new rt.Event(t,i)},rt.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=a,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=a,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},rt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){rt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,r=t.handleObj;return(!n||n!==this&&!rt.contains(this,n))&&(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),rt.support.submitBubbles||(rt.event.special.submit={setup:function(){return!rt.nodeName(this,"form")&&(rt.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,n=rt.nodeName(i,"input")||rt.nodeName(i,"button")?i.form:e;n&&!rt._data(n,"submitBubbles")&&(rt.event.add(n,"submit._submit",function(t){t._submit_bubble=!0}),rt._data(n,"submitBubbles",!0))}),e)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&rt.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return!rt.nodeName(this,"form")&&(rt.event.remove(this,"._submit"),e)}}),rt.support.changeBubbles||(rt.event.special.change={setup:function(){return Lt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(rt.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),rt.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),rt.event.simulate("change",this,t,!0)})),!1):(rt.event.add(this,"beforeactivate._change",function(t){var e=t.target;Lt.test(e.nodeName)&&!rt._data(e,"changeBubbles")&&(rt.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||rt.event.simulate("change",this.parentNode,t,!0)}),rt._data(e,"changeBubbles",!0))}),e)},handle:function(t){var i=t.target;return this!==i||t.isSimulated||t.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?t.handleObj.handler.apply(this,arguments):e},teardown:function(){return rt.event.remove(this,"._change"),!Lt.test(this.nodeName)}}),rt.support.focusinBubbles||rt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){rt.event.simulate(e,t.target,rt.event.fix(t),!0)};rt.event.special[e]={setup:function(){0==i++&&W.addEventListener(t,n,!0)},teardown:function(){0==--i&&W.removeEventListener(t,n,!0)}}}),rt.fn.extend({on:function(t,i,n,r,s){var o,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=e);for(o in t)this.on(o,i,n,t[o],s);return this}if(null==n&&null==r?(r=i,n=i=e):null==r&&("string"==typeof i?(r=n,n=e):(r=n,n=i,i=e)),!1===r)r=l;else if(!r)return this;return 1===s&&(a=r,r=function(t){return rt().off(t),a.apply(this,arguments)},r.guid=a.guid||(a.guid=rt.guid++)),this.each(function(){rt.event.add(this,t,r,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var r,s;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,rt(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(s in t)this.off(s,i,t[s]);return this}return(!1===i||"function"==typeof i)&&(n=i,i=e),!1===n&&(n=l),this.each(function(){rt.event.remove(this,t,n,i)})},trigger:function(t,e){return this.each(function(){rt.event.trigger(t,e,this)})},triggerHandler:function(t,i){var n=this[0];return n?rt.event.trigger(t,i,n,!0):e}});var kt=/^.[^:#\[\.,]*$/,zt=/^(?:parents|prev(?:Until|All))/,Ht=rt.expr.match.needsContext,Ft={children:!0,contents:!0,next:!0,prev:!0};rt.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(rt(t).filter(function(){for(e=0;r>e;e++)if(rt.contains(n[e],this))return!0}));for(e=0;r>e;e++)rt.find(t,n[e],i);return i=this.pushStack(r>1?rt.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},has:function(t){var e,i=rt(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(rt.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(u(this,t||[],!0))},filter:function(t){return this.pushStack(u(this,t||[],!1))},is:function(t){return!!u(this,"string"==typeof t&&Ht.test(t)?rt(t):t||[],!1).length},closest:function(t,e){for(var i,n=0,r=this.length,s=[],o=Ht.test(t)||"string"!=typeof t?rt(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(11>i.nodeType&&(o?o.index(i)>-1:1===i.nodeType&&rt.find.matchesSelector(i,t))){i=s.push(i);break}return this.pushStack(s.length>1?rt.unique(s):s)},index:function(t){return t?"string"==typeof t?rt.inArray(this[0],rt(t)):rt.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?rt(t,e):rt.makeArray(t&&t.nodeType?[t]:t),n=rt.merge(this.get(),i);return this.pushStack(rt.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),rt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return rt.dir(t,"parentNode")},parentsUntil:function(t,e,i){return rt.dir(t,"parentNode",i)},next:function(t){return c(t,"nextSibling")},prev:function(t){return c(t,"previousSibling")},nextAll:function(t){return rt.dir(t,"nextSibling")},prevAll:function(t){return rt.dir(t,"previousSibling")},nextUntil:function(t,e,i){return rt.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return rt.dir(t,"previousSibling",i)},siblings:function(t){return rt.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return rt.sibling(t.firstChild)},contents:function(t){return rt.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:rt.merge([],t.childNodes)}},function(t,e){rt.fn[t]=function(i,n){var r=rt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=rt.filter(n,r)),this.length>1&&(Ft[t]||(r=rt.unique(r)),zt.test(t)&&(r=r.reverse())),this.pushStack(r)}}),rt.extend({filter:function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?rt.find.matchesSelector(n,t)?[n]:[]:rt.find.matches(t,rt.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,i,n){for(var r=[],s=t[i];s&&9!==s.nodeType&&(n===e||1!==s.nodeType||!rt(s).is(n));)1===s.nodeType&&r.push(s),s=s[i];return r},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var Ut="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Bt=/ jQuery\d+="(?:null|\d+)"/g,jt=RegExp("<(?:"+Ut+")[\\s/>]","i"),Gt=/^\s+/,Wt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Vt=/<([\w:]+)/,qt=/<tbody/i,Xt=/<|&#?\w+;/,Yt=/<(?:script|style|link)/i,$t=/^(?:checkbox|radio)$/i,Jt=/checked\s*(?:[^=]|=\s*.checked.)/i,Zt=/^$|\/(?:java|ecma)script/i,Kt=/^true\/(.*)/,Qt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,te={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:rt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ee=d(W).appendChild(W.createElement("div"));te.optgroup=te.option,te.tbody=te.tfoot=te.colgroup=te.caption=te.thead,te.th=te.td,rt.fn.extend({text:function(t){return rt.access(this,function(t){return t===e?rt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||W).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){p(this,t).appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?rt.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||rt.cleanData(b(i)),i.parentNode&&(e&&rt.contains(i.ownerDocument,i)&&g(b(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&rt.cleanData(b(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&rt.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return rt.clone(this,t,e)})},html:function(t){return rt.access(this,function(t){var i=this[0]||{},n=0,r=this.length;if(t===e)return 1===i.nodeType?i.innerHTML.replace(Bt,""):e;if(!("string"!=typeof t||Yt.test(t)||!rt.support.htmlSerialize&&jt.test(t)||!rt.support.leadingWhitespace&&Gt.test(t)||te[(Vt.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Wt,"<$1></$2>");try{for(;r>n;n++)1===(i=this[n]||{}).nodeType&&(rt.cleanData(b(i,!1)),i.innerHTML=t);i=0}catch(t){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=rt.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(i){var n=t[e++],r=t[e++];r&&(n&&n.parentNode!==r&&(n=this.nextSibling),rt(this).remove(),r.insertBefore(i,n))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=Z.apply([],t);var n,r,s,o,a,l,h=0,c=this.length,u=this,d=c-1,p=t[0],g=rt.isFunction(p);if(g||!(1>=c||"string"!=typeof p||rt.support.checkClone)&&Jt.test(p))return this.each(function(n){var r=u.eq(n);g&&(t[0]=p.call(this,n,r.html())),r.domManip(t,e,i)});if(c&&(l=rt.buildFragment(t,this[0].ownerDocument,!1,!i&&this),n=l.firstChild,1===l.childNodes.length&&(l=n),n)){for(s=(o=rt.map(b(l,"script"),f)).length;c>h;h++)r=l,h!==d&&(r=rt.clone(r,!0,!0),s&&rt.merge(o,b(r,"script"))),e.call(this[h],r,h);if(s)for(a=o[o.length-1].ownerDocument,rt.map(o,m),h=0;s>h;h++)r=o[h],Zt.test(r.type||"")&&!rt._data(r,"globalEval")&&rt.contains(a,r)&&(r.src?rt._evalUrl(r.src):rt.globalEval((r.text||r.textContent||r.innerHTML||"").replace(Qt,"")));l=n=null}return this}}),rt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){rt.fn[t]=function(t){for(var i,n=0,r=[],s=rt(t),o=s.length-1;o>=n;n++)i=n===o?this:this.clone(!0),rt(s[n])[e](i),K.apply(r,i.get());return this.pushStack(r)}}),rt.extend({clone:function(t,e,i){var n,r,s,o,a,l=rt.contains(t.ownerDocument,t);if(rt.support.html5Clone||rt.isXMLDoc(t)||!jt.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(ee.innerHTML=t.outerHTML,ee.removeChild(s=ee.firstChild)),!(rt.support.noCloneEvent&&rt.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||rt.isXMLDoc(t)))for(n=b(s),a=b(t),o=0;null!=(r=a[o]);++o)n[o]&&y(r,n[o]);if(e)if(i)for(a=a||b(t),n=n||b(s),o=0;null!=(r=a[o]);o++)v(r,n[o]);else v(t,s);return(n=b(s,"script")).length>0&&g(n,!l&&b(t,"script")),n=a=r=null,s},buildFragment:function(t,e,i,n){for(var r,s,o,a,l,h,c,u=t.length,p=d(e),f=[],m=0;u>m;m++)if((s=t[m])||0===s)if("object"===rt.type(s))rt.merge(f,s.nodeType?[s]:s);else if(Xt.test(s)){for(a=a||p.appendChild(e.createElement("div")),l=(Vt.exec(s)||["",""])[1].toLowerCase(),c=te[l]||te._default,a.innerHTML=c[1]+s.replace(Wt,"<$1></$2>")+c[2],r=c[0];r--;)a=a.lastChild;if(!rt.support.leadingWhitespace&&Gt.test(s)&&f.push(e.createTextNode(Gt.exec(s)[0])),!rt.support.tbody)for(r=(s="table"!==l||qt.test(s)?"<table>"!==c[1]||qt.test(s)?0:a:a.firstChild)&&s.childNodes.length;r--;)rt.nodeName(h=s.childNodes[r],"tbody")&&!h.childNodes.length&&s.removeChild(h);for(rt.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=p.lastChild}else f.push(e.createTextNode(s));for(a&&p.removeChild(a),rt.support.appendChecked||rt.grep(b(f,"input"),x),m=0;s=f[m++];)if((!n||-1===rt.inArray(s,n))&&(o=rt.contains(s.ownerDocument,s),a=b(p.appendChild(s),"script"),o&&g(a),i))for(r=0;s=a[r++];)Zt.test(s.type||"")&&i.push(s);return a=null,p},cleanData:function(t,e){for(var i,n,r,s,o=0,a=rt.expando,l=rt.cache,h=rt.support.deleteExpando,c=rt.event.special;null!=(i=t[o]);o++)if((e||rt.acceptData(i))&&(r=i[a],s=r&&l[r])){if(s.events)for(n in s.events)c[n]?rt.event.remove(i,n):rt.removeEvent(i,n,s.handle);l[r]&&(delete l[r],h?delete i[a]:typeof i.removeAttribute!==j?i.removeAttribute(a):i[a]=null,$.push(r))}},_evalUrl:function(t){return rt.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})}}),rt.fn.extend({wrapAll:function(t){if(rt.isFunction(t))return this.each(function(e){rt(this).wrapAll(t.call(this,e))});if(this[0]){var e=rt(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return rt.isFunction(t)?this.each(function(e){rt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=rt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=rt.isFunction(t);return this.each(function(i){rt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){rt.nodeName(this,"body")||rt(this).replaceWith(this.childNodes)}).end()}});var ie,ne,re,se=/alpha\([^)]*\)/i,oe=/opacity\s*=\s*([^)]*)/,ae=/^(top|right|bottom|left)$/,le=/^(none|table(?!-c[ea]).+)/,he=/^margin/,ce=RegExp("^("+st+")(.*)$","i"),ue=RegExp("^("+st+")(?!px)[a-z%]+$","i"),de=RegExp("^([+-])=("+st+")","i"),pe={BODY:"block"},fe={position:"absolute",visibility:"hidden",display:"block"},me={letterSpacing:0,fontWeight:400},ge=["Top","Right","Bottom","Left"],ve=["Webkit","O","Moz","ms"];rt.fn.extend({css:function(t,i){return rt.access(this,function(t,i,n){var r,s,o={},a=0;if(rt.isArray(i)){for(s=ne(t),r=i.length;r>a;a++)o[i[a]]=rt.css(t,i[a],!1,s);return o}return n!==e?rt.style(t,i,n):rt.css(t,i)},t,i,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){w(this)?rt(this).show():rt(this).hide()})}}),rt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=re(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:rt.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,o,a,l=rt.camelCase(i),h=t.style;if(i=rt.cssProps[l]||(rt.cssProps[l]=_(h,l)),a=rt.cssHooks[i]||rt.cssHooks[l],n===e)return a&&"get"in a&&(s=a.get(t,!1,r))!==e?s:h[i];if("string"===(o=typeof n)&&(s=de.exec(n))&&(n=(s[1]+1)*s[2]+parseFloat(rt.css(t,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||rt.cssNumber[l]||(n+="px"),rt.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(h[i]="inherit"),a&&"set"in a&&(n=a.set(t,n,r))===e)))try{h[i]=n}catch(t){}}},css:function(t,i,n,r){var s,o,a,l=rt.camelCase(i);return i=rt.cssProps[l]||(rt.cssProps[l]=_(t.style,l)),(a=rt.cssHooks[i]||rt.cssHooks[l])&&"get"in a&&(o=a.get(t,!0,n)),o===e&&(o=re(t,i,r)),"normal"===o&&i in me&&(o=me[i]),""===n||n?(s=parseFloat(o),!0===n||rt.isNumeric(s)?s||0:o):o}}),t.getComputedStyle?(ne=function(e){return t.getComputedStyle(e,null)},re=function(t,i,n){var r,s,o,a=n||ne(t),l=a?a.getPropertyValue(i)||a[i]:e,h=t.style;return a&&(""!==l||rt.contains(t.ownerDocument,t)||(l=rt.style(t,i)),ue.test(l)&&he.test(i)&&(r=h.width,s=h.minWidth,o=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=a.width,h.width=r,h.minWidth=s,h.maxWidth=o)),l}):W.documentElement.currentStyle&&(ne=function(t){return t.currentStyle},re=function(t,i,n){var r,s,o,a=n||ne(t),l=a?a[i]:e,h=t.style;return null==l&&h&&h[i]&&(l=h[i]),ue.test(l)&&!ae.test(i)&&(r=h.left,s=t.runtimeStyle,(o=s&&s.left)&&(s.left=t.currentStyle.left),h.left="fontSize"===i?"1em":l,l=h.pixelLeft+"px",h.left=r,o&&(s.left=o)),""===l?"auto":l}),rt.each(["height","width"],function(t,i){rt.cssHooks[i]={get:function(t,n,r){return n?0===t.offsetWidth&&le.test(rt.css(t,"display"))?rt.swap(t,fe,function(){return S(t,i,r)}):S(t,i,r):e},set:function(t,e,n){var r=n&&ne(t);return T(0,e,n?M(t,i,n,rt.support.boxSizing&&"border-box"===rt.css(t,"boxSizing",!1,r),r):0)}}}),rt.support.opacity||(rt.cssHooks.opacity={get:function(t,e){return oe.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=rt.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===rt.trim(s.replace(se,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=se.test(s)?s.replace(se,r):s+" "+r)}}),rt(function(){rt.support.reliableMarginRight||(rt.cssHooks.marginRight={get:function(t,i){return i?rt.swap(t,{display:"inline-block"},re,[t,"marginRight"]):e}}),!rt.support.pixelPosition&&rt.fn.position&&rt.each(["top","left"],function(t,i){rt.cssHooks[i]={get:function(t,n){return n?(n=re(t,i),ue.test(n)?rt(t).position()[i]+"px":n):e}}})}),rt.expr&&rt.expr.filters&&(rt.expr.filters.hidden=function(t){return 0>=t.offsetWidth&&0>=t.offsetHeight||!rt.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||rt.css(t,"display"))},rt.expr.filters.visible=function(t){return!rt.expr.filters.hidden(t)}),rt.each({margin:"",padding:"",border:"Width"},function(t,e){rt.cssHooks[t+e]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+ge[n]+e]=s[n]||s[n-2]||s[0];return r}},he.test(t)||(rt.cssHooks[t+e].set=T)});var ye=/%20/g,be=/\[\]$/,xe=/\r?\n/g,_e=/^(?:submit|button|image|reset|file)$/i,we=/^(?:input|select|textarea|keygen)/i;rt.fn.extend({serialize:function(){return rt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=rt.prop(this,"elements");return t?rt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!rt(this).is(":disabled")&&we.test(this.nodeName)&&!_e.test(t)&&(this.checked||!$t.test(t))}).map(function(t,e){var i=rt(this).val();return null==i?null:rt.isArray(i)?rt.map(i,function(t){return{name:e.name,value:t.replace(xe,"\r\n")}}):{name:e.name,value:i.replace(xe,"\r\n")}}).get()}}),rt.param=function(t,i){var n,r=[],s=function(t,e){e=rt.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=rt.ajaxSettings&&rt.ajaxSettings.traditional),rt.isArray(t)||t.jquery&&!rt.isPlainObject(t))rt.each(t,function(){s(this.name,this.value)});else for(n in t)P(n,t[n],i,s);return r.join("&").replace(ye,"+")},rt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){rt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),rt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ee,Te,Me=rt.now(),Se=/\?/,Ce=/#.*$/,Ae=/([?&])_=[^&]*/,Pe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Re=/^(?:GET|HEAD)$/,Le=/^\/\//,De=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ie=rt.fn.load,Ne={},Oe={},ke="*/".concat("*");try{Te=G.href}catch(t){(Te=W.createElement("a")).href="",Te=Te.href}Ee=De.exec(Te.toLowerCase())||[],rt.fn.load=function(t,i,n){if("string"!=typeof t&&Ie)return Ie.apply(this,arguments);var r,s,o,a=this,l=t.indexOf(" ");return l>=0&&(r=t.slice(l,t.length),t=t.slice(0,l)),rt.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(o="POST"),a.length>0&&rt.ajax({url:t,type:o,dataType:"html",data:i}).done(function(t){s=arguments,a.html(r?rt("<div>").append(rt.parseHTML(t)).find(r):t)}).complete(n&&function(t,e){a.each(n,s||[t.responseText,e,t])}),this},rt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){rt.fn[e]=function(t){return this.on(e,t)}}),rt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ee[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":rt.parseJSON,"text xml":rt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?D(D(t,rt.ajaxSettings),e):D(rt.ajaxSettings,t)},ajaxPrefilter:R(Ne),ajaxTransport:R(Oe),ajax:function(t,i){function n(t,i,n,r){var s,u,y,b,_,E=i;2!==x&&(x=2,l&&clearTimeout(l),c=e,a=r||"",w.readyState=t>0?4:0,s=t>=200&&300>t||304===t,n&&(b=function(t,i,n){for(var r,s,o,a,l=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),s===e&&(s=t.mimeType||i.getResponseHeader("Content-Type"));if(s)for(a in l)if(l[a]&&l[a].test(s)){h.unshift(a);break}if(h[0]in n)o=h[0];else{for(a in n){if(!h[0]||t.converters[a+" "+h[0]]){o=a;break}r||(r=a)}o=o||r}return o?(o!==h[0]&&h.unshift(o),n[o]):e}(d,w,n)),b=function(t,e,i,n){var r,s,o,a,l,h={},c=t.dataTypes.slice();if(c[1])for(o in t.converters)h[o.toLowerCase()]=t.converters[o];for(s=c.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=c.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(o=h[l+" "+s]||h["* "+s]))for(r in h)if((a=r.split(" "))[1]===s&&(o=h[l+" "+a[0]]||h["* "+a[0]])){!0===o?o=h[r]:!0!==h[r]&&(s=a[0],c.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(d,b,w,s),s?(d.ifModified&&((_=w.getResponseHeader("Last-Modified"))&&(rt.lastModified[o]=_),(_=w.getResponseHeader("etag"))&&(rt.etag[o]=_)),204===t||"HEAD"===d.type?E="nocontent":304===t?E="notmodified":(E=b.state,u=b.data,y=b.error,s=!y)):(y=E,(t||!E)&&(E="error",0>t&&(t=0))),w.status=t,w.statusText=(i||E)+"",s?m.resolveWith(p,[u,E,w]):m.rejectWith(p,[w,E,y]),w.statusCode(v),v=e,h&&f.trigger(s?"ajaxSuccess":"ajaxError",[w,d,s?u:y]),g.fireWith(p,[w,E]),h&&(f.trigger("ajaxComplete",[w,d]),--rt.active||rt.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var r,s,o,a,l,h,c,u,d=rt.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?rt(p):rt.event,m=rt.Deferred(),g=rt.Callbacks("once memory"),v=d.statusCode||{},y={},b={},x=0,_="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===x){if(!u)for(u={};e=Pe.exec(a);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return x||(t=b[i]=b[i]||t,y[t]=e),this},overrideMimeType:function(t){return x||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>x)for(e in t)v[e]=[v[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||_;return c&&c.abort(e),n(0,e),this}};if(m.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,d.url=((t||d.url||Te)+"").replace(Ce,"").replace(Le,Ee[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=rt.trim(d.dataType||"*").toLowerCase().match(ot)||[""],null==d.crossDomain&&(r=De.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]===Ee[1]&&r[2]===Ee[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(Ee[3]||("http:"===Ee[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=rt.param(d.data,d.traditional)),L(Ne,d,i,w),2===x)return w;(h=d.global)&&0==rt.active++&&rt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Re.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(Se.test(o)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=Ae.test(o)?o.replace(Ae,"$1_="+Me++):o+(Se.test(o)?"&":"?")+"_="+Me++)),d.ifModified&&(rt.lastModified[o]&&w.setRequestHeader("If-Modified-Since",rt.lastModified[o]),rt.etag[o]&&w.setRequestHeader("If-None-Match",rt.etag[o])),(d.data&&d.hasContent&&!1!==d.contentType||i.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+ke+"; q=0.01":""):d.accepts["*"]);for(s in d.headers)w.setRequestHeader(s,d.headers[s]);if(d.beforeSend&&(!1===d.beforeSend.call(p,w,d)||2===x))return w.abort();_="abort";for(s in{success:1,error:1,complete:1})w[s](d[s]);if(c=L(Oe,d,i,w)){w.readyState=1,h&&f.trigger("ajaxSend",[w,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){w.abort("timeout")},d.timeout));try{x=1,c.send(y,n)}catch(t){if(!(2>x))throw t;n(-1,t)}}else n(-1,"No Transport");return w},getJSON:function(t,e,i){return rt.get(t,e,i,"json")},getScript:function(t,i){return rt.get(t,e,i,"script")}}),rt.each(["get","post"],function(t,i){rt[i]=function(t,n,r,s){return rt.isFunction(n)&&(s=s||r,r=n,n=e),rt.ajax({url:t,type:i,dataType:s,data:n,success:r})}}),rt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return rt.globalEval(t),t}}}),rt.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),rt.ajaxTransport("script",function(t){if(t.crossDomain){var i,n=W.head||rt("head")[0]||W.documentElement;return{send:function(e,r){(i=W.createElement("script")).async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||r(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var ze=[],He=/(=)\?(?=&|$)|\?\?/;rt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ze.pop()||rt.expando+"_"+Me++;return this[t]=!0,t}}),rt.ajaxPrefilter("json jsonp",function(i,n,r){var s,o,a,l=!1!==i.jsonp&&(He.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&He.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(s=i.jsonpCallback=rt.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(He,"$1"+s):!1!==i.jsonp&&(i.url+=(Se.test(i.url)?"&":"?")+i.jsonp+"="+s),i.converters["script json"]=function(){return a||rt.error(s+" was not called"),a[0]},i.dataTypes[0]="json",o=t[s],t[s]=function(){a=arguments},r.always(function(){t[s]=o,i[s]&&(i.jsonpCallback=n.jsonpCallback,ze.push(s)),a&&rt.isFunction(o)&&o(a[0]),a=o=e}),"script"):e});var Fe,Ue,Be=0,je=t.ActiveXObject&&function(){var t;for(t in Fe)Fe[t](e,!0)};rt.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&I()||function(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}()}:I,Ue=rt.ajaxSettings.xhr(),rt.support.cors=!!Ue&&"withCredentials"in Ue,(Ue=rt.support.ajax=!!Ue)&&rt.ajaxTransport(function(i){if(!i.crossDomain||rt.support.cors){var n;return{send:function(r,s){var o,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(a in r)l.setRequestHeader(a,r[a])}catch(t){}l.send(i.hasContent&&i.data||null),n=function(t,r){var a,h,c,u;try{if(n&&(r||4===l.readyState))if(n=e,o&&(l.onreadystatechange=rt.noop,je&&delete Fe[o]),r)4!==l.readyState&&l.abort();else{u={},a=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{c=l.statusText}catch(t){c=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=u.text?200:404}}catch(t){r||s(-1,t)}u&&s(a,c,u,h)},i.async?4===l.readyState?setTimeout(n):(o=++Be,je&&(Fe||(Fe={},rt(t).unload(je)),Fe[o]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(e,!0)}}}});var Ge,We,Ve=/^(?:toggle|show|hide)$/,qe=RegExp("^(?:([+-])=|)("+st+")([a-z%]*)$","i"),Xe=/queueHooks$/,Ye=[function(t,e,i){var n,r,s,o,a,l,h=this,c={},u=t.style,d=t.nodeType&&w(t),p=rt._data(t,"fxshow");i.queue||(null==(a=rt._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,rt.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===rt.css(t,"display")&&"none"===rt.css(t,"float")&&(rt.support.inlineBlockNeedsLayout&&"inline"!==C(t.nodeName)?u.zoom=1:u.display="inline-block")),i.overflow&&(u.overflow="hidden",rt.support.shrinkWrapBlocks||h.always(function(){u.overflow=i.overflow[0],u.overflowX=i.overflow[1],u.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],Ve.exec(r)){if(delete e[n],s=s||"toggle"===r,r===(d?"hide":"show"))continue;c[n]=p&&p[n]||rt.style(t,n)}if(!rt.isEmptyObject(c)){p?"hidden"in p&&(d=p.hidden):p=rt._data(t,"fxshow",{}),s&&(p.hidden=!d),d?rt(t).show():h.done(function(){rt(t).hide()}),h.done(function(){var e;rt._removeData(t,"fxshow");for(e in c)rt.style(t,e,c[e])});for(n in c)o=O(d?p[n]:0,n,h),n in p||(p[n]=o.start,d&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}],$e={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=qe.exec(e),s=r&&r[3]||(rt.cssNumber[t]?"":"px"),o=(rt.cssNumber[t]||"px"!==s&&+n)&&qe.exec(rt.css(i.elem,t)),a=1,l=20;if(o&&o[3]!==s){s=s||o[3],r=r||[],o=+n||1;do{a=a||".5",o/=a,rt.style(i.elem,t,o+s)}while(a!==(a=i.cur()/n)&&1!==a&&--l)}return r&&(o=i.start=+o||+n||0,i.unit=s,i.end=r[1]?o+(r[1]+1)*r[2]:+r[2]),i}]};rt.Animation=rt.extend(k,{tweener:function(t,e){rt.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],$e[i]=$e[i]||[],$e[i].unshift(e)},prefilter:function(t,e){e?Ye.unshift(t):Ye.push(t)}}),rt.Tween=z,(z.prototype={constructor:z,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(rt.cssNumber[i]?"":"px")},cur:function(){var t=z.propHooks[this.prop];return t&&t.get?t.get(this):z.propHooks._default.get(this)},run:function(t){var e,i=z.propHooks[this.prop];return this.pos=e=this.options.duration?rt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):z.propHooks._default.set(this),this}}).init.prototype=z.prototype,(z.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=rt.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){rt.fx.step[t.prop]?rt.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[rt.cssProps[t.prop]]||rt.cssHooks[t.prop])?rt.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}}).scrollTop=z.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},rt.each(["toggle","show","hide"],function(t,e){var i=rt.fn[e];rt.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(H(e,!0),t,n,r)}}),rt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(w).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=rt.isEmptyObject(t),s=rt.speed(e,i,n),o=function(){var e=k(this,rt.extend({},t),s);(r||rt._data(this,"finish"))&&e.stop(!0)};return o.finish=o,r||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,i,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",s=rt.timers,o=rt._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Xe.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=t&&s[i].queue!==t||(s[i].anim.stop(n),e=!1,s.splice(i,1));(e||!n)&&rt.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=rt._data(this),n=i[t+"queue"],r=i[t+"queueHooks"],s=rt.timers,o=n?n.length:0;for(i.finish=!0,rt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),rt.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){rt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),rt.speed=function(t,e,i){var n=t&&"object"==typeof t?rt.extend({},t):{complete:i||!i&&e||rt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!rt.isFunction(e)&&e};return n.duration=rt.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in rt.fx.speeds?rt.fx.speeds[n.duration]:rt.fx.speeds._default,(null==n.queue||!0===n.queue)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){rt.isFunction(n.old)&&n.old.call(this),n.queue&&rt.dequeue(this,n.queue)},n},rt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},rt.timers=[],rt.fx=z.prototype.init,rt.fx.tick=function(){var t,i=rt.timers,n=0;for(Ge=rt.now();i.length>n;n++)(t=i[n])()||i[n]!==t||i.splice(n--,1);i.length||rt.fx.stop(),Ge=e},rt.fx.timer=function(t){t()&&rt.timers.push(t)&&rt.fx.start()},rt.fx.interval=13,rt.fx.start=function(){We||(We=setInterval(rt.fx.tick,rt.fx.interval))},rt.fx.stop=function(){clearInterval(We),We=null},rt.fx.speeds={slow:600,fast:200,_default:400},rt.fx.step={},rt.expr&&rt.expr.filters&&(rt.expr.filters.animated=function(t){return rt.grep(rt.timers,function(e){return t===e.elem}).length}),rt.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){rt.offset.setOffset(this,t,e)});var i,n,r={top:0,left:0},s=this[0],o=s&&s.ownerDocument;return o?(i=o.documentElement,rt.contains(i,s)?(typeof s.getBoundingClientRect!==j&&(r=s.getBoundingClientRect()),n=F(o),{top:r.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:r.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):r):void 0},rt.offset={setOffset:function(t,e,i){var n=rt.css(t,"position");"static"===n&&(t.style.position="relative");var r,s,o=rt(t),a=o.offset(),l=rt.css(t,"top"),h=rt.css(t,"left"),c={},u={};("absolute"===n||"fixed"===n)&&rt.inArray("auto",[l,h])>-1?(u=o.position(),r=u.top,s=u.left):(r=parseFloat(l)||0,s=parseFloat(h)||0),rt.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(c.top=e.top-a.top+r),null!=e.left&&(c.left=e.left-a.left+s),"using"in e?e.using.call(t,c):o.css(c)}},rt.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===rt.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),rt.nodeName(t[0],"html")||(i=t.offset()),i.top+=rt.css(t[0],"borderTopWidth",!0),i.left+=rt.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-rt.css(n,"marginTop",!0),left:e.left-i.left-rt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||V;t&&!rt.nodeName(t,"html")&&"static"===rt.css(t,"position");)t=t.offsetParent;return t||V})}}),rt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n=/Y/.test(i);rt.fn[t]=function(r){return rt.access(this,function(t,r,s){var o=F(t);return s===e?o?i in o?o[i]:o.document.documentElement[r]:t[r]:(o?o.scrollTo(n?rt(o).scrollLeft():s,n?s:rt(o).scrollTop()):t[r]=s,e)},t,r,arguments.length,null)}}),rt.each({Height:"height",Width:"width"},function(t,i){rt.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,r){rt.fn[r]=function(r,s){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===s?"margin":"border");return rt.access(this,function(i,n,r){var s;return rt.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(s=i.documentElement,Math.max(i.body["scroll"+t],s["scroll"+t],i.body["offset"+t],s["offset"+t],s["client"+t])):r===e?rt.css(i,n,a):rt.style(i,n,r,a)},i,o?r:e,o,null)}})}),rt.fn.size=function(){return this.length},rt.fn.andSelf=rt.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=rt:(t.jQuery=t.$=rt,"function"==typeof define&&define.amd&&define("jquery",[],function(){return rt}))}(window),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,n){var r,s,o,a=e.nodeName.toLowerCase();return"area"===a?(r=e.parentNode,s=r.name,!(!e.href||!s||"map"!==r.nodeName.toLowerCase())&&(!!(o=t("img[usemap='#"+s+"']")[0])&&i(o))):(/^(input|select|textarea|button|object)$/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=r(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",s)}function s(){t.datepicker._isDisabledDatepicker(g.inline?g.dpDiv.parent()[0]:g.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function o(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}function a(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),n="absolute"===i,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var e=t(this);return(!n||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&s.length?s:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var n=t.attr(i,"tabindex"),r=isNaN(n);return(r||n>=0)&&e(i,!r)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function n(e,i,n,s){return t.each(r,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var r="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?o["inner"+i].call(this):this.each(function(){t(this).css(s,n(this,e)+"px")})},t.fn["outer"+i]=function(e,r){return"number"!=typeof e?o["outer"+i].call(this,e):this.each(function(){t(this).css(s,n(this,e,!0,r)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,n,r=t(this[0]);r.length&&r[0]!==document;){if(("absolute"===(i=r.css("position"))||"relative"===i||"fixed"===i)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var r,s=t.ui[e].prototype;for(r in n)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([i,n[r]])},call:function(t,e,i,n){var r,s=t.plugins[e];if(s&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(r=0;s.length>r;r++)t.options[s[r][0]]&&s[r][1].apply(t.element,i)}};var l=0,h=Array.prototype.slice;t.cleanData=function(e){return function(i){var n,r,s;for(s=0;null!=(r=i[s]);s++)try{(n=t._data(r,"events"))&&n.remove&&t(r).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData),t.widget=function(e,i,n){var r,s,o,a,l={},h=e.split(".")[0];return e=e.split(".")[1],r=h+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][r.toLowerCase()]=function(e){return!!t.data(e,r)},t[h]=t[h]||{},s=t[h][e],o=t[h][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},r=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=r,e=n.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(l[e]=n)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||e:e},l,{constructor:o,namespace:h,widgetName:e,widgetFullName:r}),s?(t.each(s._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,o,i._proto)}),delete s._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,n,r=h.call(arguments,1),s=0,o=r.length;o>s;s++)for(i in r[s])n=r[s][i],r[s].hasOwnProperty(i)&&void 0!==n&&(e[i]=t.isPlainObject(n)?t.isPlainObject(e[i])?t.widget.extend({},e[i],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,i){var n=i.prototype.widgetFullName||e;t.fn[e]=function(r){var s="string"==typeof r,o=h.call(arguments,1),a=this;return s?this.each(function(){var i,s=t.data(this,n);return"instance"===r?(a=s,!1):s?t.isFunction(s[r])&&"_"!==r.charAt(0)?(i=s[r].apply(s,o))!==s&&void 0!==i?(a=i&&i.jquery?a.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):(o.length&&(r=t.widget.extend.apply(null,[r].concat(o))),this.each(function(){var e=t.data(this,n);e?(e.option(r||{}),e._init&&e._init()):t.data(this,n,new i(r,this))})),a}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,r,s,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(r=o[e]=t.widget.extend({},this.options[e]),s=0;n.length-1>s;s++)r[n[s]]=r[n[s]]||{},r=r[n[s]];if(e=n.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,n){var r,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=r=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),t.each(n,function(n,o){function a(){return e||!0!==s.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+s.eventNamespace,c=l[2];c?r.delegate(c,h,a):i.bind(h,a)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var r,s,o=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(r in s)r in i||(i[r]=s[r]);return this.element.trigger(i,n),!(t.isFunction(o)&&!1===o.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,r,s){"string"==typeof r&&(r={effect:r});var o,a=r?!0===r||"number"==typeof r?i:r.effect||i:e;"number"==typeof(r=r||{})&&(r={duration:r}),o=!t.isEmptyObject(r),r.complete=s,r.delay&&n.delay(r.delay),o&&t.effects&&t.effects.effect[a]?n[e](r):a!==e&&n[a]?n[a](r.duration,r.easing,s):n.queue(function(i){t(this)[e](),s&&s.call(n[0]),i()})}}),t.widget;var c=!1;t(document).mouseup(function(){c=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!c){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),c=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),c=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,i){return[parseFloat(t[0])*(d.test(t[0])?e/100:1),parseFloat(t[1])*(d.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}t.ui=t.ui||{};var n,r,s=Math.max,o=Math.abs,a=Math.round,l=/left|center|right/,h=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,d=/%$/,p=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,r=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=r.children()[0];return t("body").append(r),e=s.offsetWidth,r.css("overflow","scroll"),i=s.offsetWidth,e===i&&(i=r[0].clientWidth),r.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),r="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:r?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),r=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||r?i.width():i.outerWidth(),height:n||r?i.height():i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return p.apply(this,arguments);n=t.extend({},n);var d,f,m,g,v,y,b=t(n.of),x=t.position.getWithinInfo(n.within),_=t.position.getScrollInfo(x),w=(n.collision||"flip").split(" "),E={};return y=function(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}(b),b[0].preventDefault&&(n.at="left top"),f=y.width,m=y.height,g=y.offset,v=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):h.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=h.test(i[1])?i[1]:"center",t=c.exec(i[0]),e=c.exec(i[1]),E[this]=[t?t[0]:0,e?e[0]:0],n[this]=[u.exec(i[0])[0],u.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?v.left+=f:"center"===n.at[0]&&(v.left+=f/2),"bottom"===n.at[1]?v.top+=m:"center"===n.at[1]&&(v.top+=m/2),d=e(E.at,f,m),v.left+=d[0],v.top+=d[1],this.each(function(){var l,h,c=t(this),u=c.outerWidth(),p=c.outerHeight(),y=i(this,"marginLeft"),T=i(this,"marginTop"),M=u+y+i(this,"marginRight")+_.width,S=p+T+i(this,"marginBottom")+_.height,C=t.extend({},v),A=e(E.my,c.outerWidth(),c.outerHeight());"right"===n.my[0]?C.left-=u:"center"===n.my[0]&&(C.left-=u/2),"bottom"===n.my[1]?C.top-=p:"center"===n.my[1]&&(C.top-=p/2),C.left+=A[0],C.top+=A[1],r||(C.left=a(C.left),C.top=a(C.top)),l={marginLeft:y,marginTop:T},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](C,{targetWidth:f,targetHeight:m,elemWidth:u,elemHeight:p,collisionPosition:l,collisionWidth:M,collisionHeight:S,offset:[d[0]+A[0],d[1]+A[1]],my:n.my,at:n.at,within:x,elem:c})}),n.using&&(h=function(t){var e=g.left-C.left,i=e+f-u,r=g.top-C.top,a=r+m-p,l={target:{element:b,left:g.left,top:g.top,width:f,height:m},element:{element:c,left:C.left,top:C.top,width:u,height:p},horizontal:0>i?"left":e>0?"right":"center",vertical:0>a?"top":r>0?"bottom":"middle"};u>f&&f>o(e+i)&&(l.horizontal="center"),p>m&&m>o(r+a)&&(l.vertical="middle"),l.important=s(o(e),o(i))>s(o(r),o(a))?"horizontal":"vertical",n.using.call(this,t,l)}),c.offset(t.extend(C,{using:h}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,a=t.left-e.collisionPosition.marginLeft,l=r-a,h=a+e.collisionWidth-o-r;e.collisionWidth>o?l>0&&0>=h?(i=t.left+l+e.collisionWidth-o-r,t.left+=l-i):t.left=h>0&&0>=l?r:l>h?r+o-e.collisionWidth:r:l>0?t.left+=l:h>0?t.left-=h:t.left=s(t.left-a,t.left)},top:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollTop:n.offset.top,o=e.within.height,a=t.top-e.collisionPosition.marginTop,l=r-a,h=a+e.collisionHeight-o-r;e.collisionHeight>o?l>0&&0>=h?(i=t.top+l+e.collisionHeight-o-r,t.top+=l-i):t.top=h>0&&0>=l?r:l>h?r+o-e.collisionHeight:r:l>0?t.top+=l:h>0?t.top-=h:t.top=s(t.top-a,t.top)}},flip:{left:function(t,e){var i,n,r=e.within,s=r.offset.left+r.scrollLeft,a=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-a-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(0>(i=t.left+d+p+f+e.collisionWidth-a-s)||o(c)>i)&&(t.left+=d+p+f):u>0&&((n=t.left-e.collisionPosition.marginLeft+d+p+f-l)>0||u>o(n))&&(t.left+=d+p+f)},top:function(t,e){var i,n,r=e.within,s=r.offset.top+r.scrollTop,a=r.height,l=r.isWindow?r.scrollTop:r.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-a-l,d="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];0>c?(0>(n=t.top+d+p+f+e.collisionHeight-a-s)||o(c)>n)&&(t.top+=d+p+f):u>0&&((i=t.top-e.collisionPosition.marginTop+d+p+f-l)>0||u>o(i))&&(t.top+=d+p+f)}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,s,o,a=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in n)e.style[o]=n[o];e.appendChild(l),(i=a||document.documentElement).insertBefore(e,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",s=t(l).offset().left,r=s>10&&11>s,e.innerHTML="",i.removeChild(e)}()}(),t.ui.position,t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===i.iframeFix?"iframe":i.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(t){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==i._trigger("stop",e)&&i._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper),r=n?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,r=this.options,s=this.document[0];return this.relativeContainer=null,r.containment?"window"===r.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),i=t(r.containment),void((n=i[0])&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,r,s,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),o.grid&&(r=o.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,h=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-o.grid[1]:r+o.grid[1]:r,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,n){var r=t.extend({},i,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,r))})},stop:function(e,i,n){var r=t.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,function(){this.isOver?(this.isOver=0,n.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,r))})},drag:function(e,i,n){t.each(n.sortables,function(){var r=!1,s=this;s.positionAbs=n.positionAbs,s.helperProportions=n.helperProportions,s.offset.click=n.offset.click,s._intersectsWith(s.containerCache)&&(r=!0,t.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(r=!1),r})),r?(s.isOver||(s.isOver=1,n._parent=i.helper.parent(),s.currentItem=i.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return i.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=n.offset.click.top,s.offset.click.left=n.offset.click.left,s.offset.parent.left-=n.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=n.offset.parent.top-s.offset.parent.top,n._trigger("toSortable",e),n.dropped=s.element,t.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,s.fromOutside=n),s.currentItem&&(s._mouseDrag(e),i.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),i.helper.appendTo(n._parent),n._refreshOffsets(e),i.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,n){var r=t("body"),s=n.options;r.css("cursor")&&(s._cursor=r.css("cursor")),r.css("cursor",s.cursor)},stop:function(e,i,n){var r=n.options;r._cursor&&t("body").css("cursor",r._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,n){var r=t(i.helper),s=n.options;r.css("opacity")&&(s._opacity=r.css("opacity")),r.css("opacity",s.opacity)},stop:function(e,i,n){var r=n.options;r._opacity&&t(i.helper).css("opacity",r._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,n){var r=n.options,s=!1,o=n.scrollParentNotHidden[0],a=n.document[0];o!==a&&"HTML"!==o.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+o.offsetHeight-e.pageY<r.scrollSensitivity?o.scrollTop=s=o.scrollTop+r.scrollSpeed:e.pageY-n.overflowOffset.top<r.scrollSensitivity&&(o.scrollTop=s=o.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+o.offsetWidth-e.pageX<r.scrollSensitivity?o.scrollLeft=s=o.scrollLeft+r.scrollSpeed:e.pageX-n.overflowOffset.left<r.scrollSensitivity&&(o.scrollLeft=s=o.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-t(a).scrollTop()<r.scrollSensitivity?s=t(a).scrollTop(t(a).scrollTop()-r.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<r.scrollSensitivity&&(s=t(a).scrollTop(t(a).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-t(a).scrollLeft()<r.scrollSensitivity?s=t(a).scrollLeft(t(a).scrollLeft()-r.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<r.scrollSensitivity&&(s=t(a).scrollLeft(t(a).scrollLeft()+r.scrollSpeed)))),!1!==s&&t.ui.ddmanager&&!r.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,n){var r=n.options;n.snapElements=[],t(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var e=t(this),i=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,n){var r,s,o,a,l,h,c,u,d,p,f=n.options,m=f.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,y=i.offset.top,b=y+n.helperProportions.height;for(d=n.snapElements.length-1;d>=0;d--)l=n.snapElements[d].left-n.margins.left,h=l+n.snapElements[d].width,c=n.snapElements[d].top-n.margins.top,u=c+n.snapElements[d].height,l-m>v||g>h+m||c-m>b||y>u+m||!t.contains(n.snapElements[d].item.ownerDocument,n.snapElements[d].item)?(n.snapElements[d].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(r=m>=Math.abs(c-b),s=m>=Math.abs(u-y),o=m>=Math.abs(l-v),a=m>=Math.abs(h-g),r&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h}).left)),p=r||s||o||a,"outer"!==f.snapMode&&(r=m>=Math.abs(c-y),s=m>=Math.abs(u-b),o=m>=Math.abs(l-g),a=m>=Math.abs(h-v),r&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left)),!n.snapElements[d].snapping&&(r||s||o||a||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[d].item})),n.snapElements[d].snapping=r||s||o||a||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,n){var r,s=n.options,o=t.makeArray(t(s.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});o.length&&(r=parseInt(t(o[0]).css("zIndex"),10)||0,t(o).each(function(e){t(this).css("zIndex",r+e)}),this.css("zIndex",r+o.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,n){var r=t(i.helper),s=n.options;r.css("zIndex")&&(s._zIndex=r.css("zIndex")),r.css("zIndex",s.zIndex)},stop:function(e,i,n){var r=n.options;r._zIndex&&t(i.helper).css("zIndex",r._zIndex)}}),t.ui.draggable,t.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var n=t.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,r=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(r=!0,!1):void 0}),!r&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,n,r){if(!i.offset)return!1;var s=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,a=s+e.helperProportions.width,l=o+e.helperProportions.height,h=i.offset.left,c=i.offset.top,u=h+i.proportions().width,d=c+i.proportions().height;switch(n){case"fit":return s>=h&&u>=a&&o>=c&&d>=l;case"intersect":return s+e.helperProportions.width/2>h&&u>a-e.helperProportions.width/2&&o+e.helperProportions.height/2>c&&d>l-e.helperProportions.height/2;case"pointer":return t(r.pageY,c,i.proportions().height)&&t(r.pageX,h,i.proportions().width);case"touch":return(o>=c&&d>=o||l>=c&&d>=l||c>o&&l>d)&&(s>=h&&u>=s||a>=h&&u>=a||h>s&&a>u);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,r,s=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;s.length>n;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(r=0;a.length>r;r++)if(a[r]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===o&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,s,o=t.ui.intersect(e,this,this.options.tolerance,i),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===r})).length&&(n=t(s[0]).droppable("instance"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.ui.droppable,t.widget("ui.resizable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",r=!1;return e[n]>0||(e[n]=1,r=e[n]>0,e[n]=0,r)},_create:function(){var e,i,n,r,s,o=this,a=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;e.length>i;i++)n=t.trim(e[i]),s="ui-resizable-"+n,(r=t("<div class='ui-resizable-handle "+s+"'></div>")).css({zIndex:a.zIndex}),"se"===n&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(r);this._renderAxis=function(e){var i,n,r,s;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(n=t(this.handles[i],this.element),s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),r=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(r,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(r=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=r&&r[1]?r[1]:"se")}),a.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(t(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){a.disabled||o.resizing||(t(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,r=!1;for(i in this.handles)((n=t(this.handles[i])[0])===e.target||t.contains(n,e.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(e){var i,n,r,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),s.containment&&(i+=t(s.containment).scrollLeft()||0,n+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===r?this.axis+"-resize":r),o.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,n,r=this.originalMousePosition,s=this.axis,o=e.pageX-r.left||0,a=e.pageY-r.top||0,l=this._change[s];return this._updatePrevProperties(),!!l&&(i=l.apply(this,[e,o,a]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var i,n,r,s,o,a,l,h=this.options;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),r=n&&this._hasScroll(i[0],"left")?0:this.sizeDiff.height,s=n?0:this.sizeDiff.width,o={width:this.helper.width()-s,height:this.helper.height()-r},a=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,l=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null,h.animate||this.element.css(t.extend(o,{top:l,left:a})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!h.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,r,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,r=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),n>s.minHeight&&(s.minHeight=n),s.maxWidth>i&&(s.maxWidth=i),s.maxHeight>r&&(s.maxHeight=r)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,r=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,s=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return s&&(t.width=e.minWidth),o&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),r&&(t.height=e.maxHeight),s&&h&&(t.left=a-e.minWidth),n&&h&&(t.left=a-e.maxWidth),o&&c&&(t.top=l-e.minHeight),r&&c&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],r=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseInt(n[e],10)||0,i[e]+=parseInt(r[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),n=i.options,r=i._proportionallyResizeElements,s=r.length&&/textarea/i.test(r[0].nodeName),o=s&&i._hasScroll(r[0],"left")?0:i.sizeDiff.height,a=s?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-o},h=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,c&&h?{top:c,left:h}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};r&&r.length&&t(r[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,n,r,s,o,a,l=t(this).resizable("instance"),h=l.options,c=l.element,u=h.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(l.containerElement=t(d),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,n){i[t]=l._num(e.css("padding"+n))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},n=l.containerOffset,r=l.containerSize.height,s=l.containerSize.width,o=l._hasScroll(d,"left")?d.scrollWidth:s,a=l._hasScroll(d)?d.scrollHeight:r,l.parentData={element:d,left:n.left,top:n.top,width:o,height:a}))},resize:function(e){var i,n,r,s,o=t(this).resizable("instance"),a=o.options,l=o.containerOffset,h=o.position,c=o._aspectRatio||e.shiftKey,u={top:0,left:0},d=o.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),h.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-u.left),c&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=a.helper?l.left:0),h.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),c&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?l.top:0),r=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),r&&s?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-l.left)),n=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-l.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,c&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),n+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-n,c&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,n=e.containerOffset,r=e.containerPosition,s=e.containerElement,o=t(e.helper),a=o.offset(),l=o.outerWidth()-e.sizeDiff.width,h=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(s.css("position"))&&t(this).css({left:a.left-r.left-n.left,width:l,height:h}),e._helper&&!i.animate&&/static/.test(s.css("position"))&&t(this).css({left:a.left-r.left-n.left,width:l,height:h})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance").options;t(e.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})},resize:function(e,i){var n=t(this).resizable("instance"),r=n.options,s=n.originalSize,o=n.originalPosition,a={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-o.top||0,left:n.position.left-o.left||0};t(r.alsoResize).each(function(){var e=t(this),n=t(this).data("ui-resizable-alsoresize"),r={},s=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,function(t,e){var i=(n[e]||0)+(a[e]||0);i&&i>=0&&(r[e]=i||null)}),e.css(r)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),n=i.options,r=i.size,s=i.originalSize,o=i.originalPosition,a=i.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,h=l[0]||1,c=l[1]||1,u=Math.round((r.width-s.width)/h)*h,d=Math.round((r.height-s.height)/c)*c,p=s.width+u,f=s.height+d,m=n.maxWidth&&p>n.maxWidth,g=n.maxHeight&&f>n.maxHeight,v=n.minWidth&&n.minWidth>p,y=n.minHeight&&n.minHeight>f;n.grid=l,v&&(p+=h),y&&(f+=c),m&&(p-=h),g&&(f-=c),/^(se|s|e)$/.test(a)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.top=o.top-d):/^(sw)$/.test(a)?(i.size.width=p,i.size.height=f,i.position.left=o.left-u):((0>=f-c||0>=p-h)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=o.top-d):(f=c-e.height,i.size.height=f,i.position.top=o.top+s.height-f),p-h>0?(i.size.width=p,i.position.left=o.left-u):(p=h-e.width,i.size.width=p,i.position.left=o.left+s.width-p))}}),t.ui.resizable,t.widget("ui.selectable",t.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(e=t(i.options.filter,i.element[0])).addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,r=t.data(this,"selectable-item");return r?(n=!e.metaKey&&!e.ctrlKey||!r.$element.hasClass("ui-selected"),r.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),r.unselecting=!n,r.selecting=n,r.selected=n,n?i._trigger("selecting",e,{selecting:r.element}):i._trigger("unselecting",e,{unselecting:r.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,r=this.options,s=this.opos[0],o=this.opos[1],a=e.pageX,l=e.pageY;return s>a&&(i=a,a=s,s=i),o>l&&(i=l,l=o,o=i),this.helper.css({left:s,top:o,width:a-s,height:l-o}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),h=!1;i&&i.element!==n.element[0]&&("touch"===r.tolerance?h=!(i.left>a||s>i.right||i.top>l||o>i.bottom):"fit"===r.tolerance&&(h=i.left>s&&a>i.right&&i.top>o&&l>i.bottom),h?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,r=!1,s=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,s.widgetName+"-item")===s?(n=t(this),!1):void 0}),t.data(e.target,s.widgetName+"-item")===s&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(r=!0)}),!r))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var r,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,r,s,o=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-this.document.scrollTop()<o.scrollSensitivity?a=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<o.scrollSensitivity&&(a=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),e.pageX-this.document.scrollLeft()<o.scrollSensitivity?a=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(a=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),!1!==a&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],r=n.item[0],(s=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&r!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==r&&!t.contains(this.placeholder[0],r)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],r))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,r=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,s=t.left,o=s+t.width,a=t.top,l=a+t.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||n+h>a&&l>n+h,d="y"===this.options.axis||e+c>s&&o>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>s&&o>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>a&&l>r-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&i,r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return!!n&&(this.floating?s&&"right"===s||"down"===r?2:1:r&&("down"===r?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&i||"left"===r&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){a.push(this)}var n,r,s,o,a=[],l=[],h=this._connectWith();if(h&&e)for(n=h.length-1;n>=0;n--)for(s=t(h[n],this.document[0]),r=s.length-1;r>=0;r--)(o=t.data(s[r],this.widgetFullName))&&o!==this&&!o.options.disabled&&l.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,r,s,o,a,l,h,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(r=t(d[i],this.document[0]),n=r.length-1;n>=0;n--)(s=t.data(r[n],this.widgetFullName))&&s!==this&&!s.options.disabled&&(u.push([t.isFunction(s.options.items)?s.options.items.call(s.element[0],e,{item:this.currentItem}):t(s.options.items,s.element),s]),this.containers.push(s));for(i=u.length-1;i>=0;i--)for(o=u[i][1],a=u[i][0],n=0,h=a.length;h>n;n++)(l=t(a[n])).data(this.widgetName+"-item",o),c.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,r,s;for(i=this.items.length-1;i>=0;i--)(n=this.items[i]).instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=r.outerWidth(),n.height=r.outerHeight()),s=r.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){var i,n=(e=e||this).options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),r=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===n?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(r)):"tr"===n?e._createTrPlaceholder(e.currentItem,r):"img"===n&&r.attr("src",e.currentItem.attr("src")),i||r.css("visibility","hidden"),r},update:function(t,r){(!i||n.forcePlaceholderSize)&&(r.height()||r.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var n=this;e.children().each(function(){t("<td>&#160;</td>",n.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,n,r,s,o,a,l,h,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(r=1e4,s=null,o=(c=d.floating||this._isFloating(this.currentItem))?"left":"top",a=c?"width":"height",u=c?"clientX":"clientY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[o],h=!1,e[u]-l>this.items[n][a]/2&&(h=!0),r>Math.abs(e[u]-l)&&(r=Math.abs(e[u]-l),s=this.items[n],this.direction=h?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(e,s,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),("document"===r.containment||"window"===r.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===r.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===r.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(e=t(r.containment)[0],i=t(r.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:r.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:r.scrollLeft())*n}},_generatePosition:function(e){var i,n,r=this.options,s=e.pageX,o=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),r.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/r.grid[1])*r.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-r.grid[1]:i+r.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/r.grid[0])*r.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-r.grid[0]:n+r.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&r.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||r.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(r.push(function(t){this._trigger("remove",t,this._uiHash())}),r.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;r.length>n;n++)r[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,r=this.headers.index(e.target),s=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(r+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(r-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(t(e.target).attr("tabIndex",-1),t(s).attr("tabIndex",0),s.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=t()):!1===e.active?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,n=i.heightStyle,r=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=t(this),i=e.uniqueId().attr("id"),n=e.next(),r=n.uniqueId().attr("id");e.attr("aria-controls",r),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(e=r.height(),this.element.siblings(":visible").each(function(){var i=t(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===n&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css("height","").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,n=this.active,r=t(e.currentTarget),s=r[0]===n[0],o=s&&i.collapsible,a=o?t():r.next(),l={oldHeader:n,oldPanel:n.next(),newHeader:o?t():r,newPanel:a};e.preventDefault(),s&&!i.collapsible||!1===this._trigger("beforeActivate",e,l)||(i.active=!o&&this.headers.index(r),this.active=s?t():r,this._toggle(l),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),s||(r.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&r.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),r.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(t(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var n,r,s,o=this,a=0,l=t.css("box-sizing"),h=t.length&&(!e.length||t.index()<e.index()),c=this.options.animate||{},u=h&&c.down||c,d=function(){o._toggleComplete(i)};return"number"==typeof u&&(s=u),"string"==typeof u&&(r=u),r=r||u.easing||c.easing,s=s||u.duration||c.duration,e.length?t.length?(n=t.show().outerHeight(),e.animate(this.hideProps,{duration:s,easing:r,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:s,easing:r,complete:d,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===l&&(a+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(n-e.outerHeight()-a),a=0)}})):e.animate(this.hideProps,s,r,d):t.animate(this.showProps,s,r,d)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var i,n,r,s,o=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=!1,n=this.previousFilter||"",r=String.fromCharCode(e.keyCode),s=!1,clearTimeout(this.filterTimer),r===n?s=!0:r=n+r,i=this._filterMenuItems(r),(i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(r=String.fromCharCode(e.keyCode),i=this._filterMenuItems(r)),i.length?(this.focus(e,i),this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var e,i=this,n=this.options.icons.submenu,r=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.parent(),r=t("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(r),e.attr("aria-labelledby",i.attr("id"))}),(e=r.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var e=t(this);i._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),e.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,r,s,o,a;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,r=e.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=e.outerHeight(),0>r?this.activeMenu.scrollTop(s+r):r+a>o&&this.activeMenu.scrollTop(s+r-o+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(e){var i,n,r;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return 0>(i=t(this)).offset().top-n-r}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,r;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return(i=t(this)).offset().top-n+r>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return n.test(t.trim(t(this).text()))})}}),t.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,n,r=this.element[0].nodeName.toLowerCase(),s="textarea"===r,o="input"===r;this.isMultiLine=!!s||!o&&this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var s=t.ui.keyCode;switch(r.keyCode){case s.PAGE_UP:e=!0,this._move("previousPage",r);break;case s.PAGE_DOWN:e=!0,this._move("nextPage",r);break;case s.UP:e=!0,this._keyEvent("previous",r);break;case s.DOWN:e=!0,this._keyEvent("next",r);break;case s.ENTER:this.menu.active&&(e=!0,r.preventDefault(),this.menu.select(r));break;case s.TAB:this.menu.active&&this.menu.select(r);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(r),r.preventDefault());break;default:i=!0,this._searchTimeout(r)}},keypress:function(n){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var r=t.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:this._move("previousPage",n);break;case r.PAGE_DOWN:this._move("nextPage",n);break;case r.UP:this._keyEvent("previous",n);break;case r.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(n){n.target===e.element[0]||n.target===i||t.contains(i,n.target)||e.close()})})},menufocus:function(e,i){var n,r;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)})):(r=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:r})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(r.value),void((n=i.item.attr("aria-label")||r.value)&&t.trim(n).length&&(this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,r){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){r(t)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),n=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!n)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,function(t,i){n._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").text(i.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return n.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var u,d="ui-button ui-widget ui-state-default ui-corner-all",p="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},m=function(e){var i=e.name,n=e.form,r=t([]);return i&&(i=i.replace(/'/g,"\\'"),r=n?t(n).find("[name='"+i+"'][type=radio]"):t("[name='"+i+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),r};t.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,i=this.options,n="checkbox"===this.type||"radio"===this.type,r=n?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(d).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===u&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||t(this).removeClass(r)}).bind("click"+this.eventNamespace,function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),n&&this.element.bind("change"+this.eventNamespace,function(){e.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return!i.disabled&&void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var n=e.element[0];m(n).not(n).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return!i.disabled&&(t(this).addClass("ui-state-active"),u=this,void e.document.one("mouseup",function(){u=null}))}).bind("mouseup"+this.eventNamespace,function(){return!i.disabled&&void t(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return!i.disabled&&void((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),(i=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(d+" ui-state-active "+p).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),void(e&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?m(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"!==this.type){var e=this.buttonElement.removeClass(p),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=this.options.icons,r=n.primary&&n.secondary,s=[];n.primary||n.secondary?(this.options.text&&s.push("ui-button-text-icon"+(r?"s":n.primary?"-primary":"-secondary")),n.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(s.push(r?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):s.push("ui-button-text-only"),e.addClass(s.join(" "))}else this.options.label&&this.element.val(this.options.label)}}),t.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),n=i.filter(":ui-button");i.not(":ui-button").button(),n.button("refresh"),this.buttons=i.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.11.4"}});var g;t.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return o(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,r,s;r="div"===(n=e.nodeName.toLowerCase())||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(s=this._newInst(t(e),r)).settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,s):r&&this._inlineDatepicker(e,s)},_newInst:function(e,i){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?r(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,r,s,o=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=t("<span class='"+this._appendClass+"'>"+o+"</span>"),e[a?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),("focus"===(n=this._get(i,"showOn"))||"both"===n)&&e.focus(this._showDatepicker),("button"===n||"both"===n)&&(r=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:s,alt:r,title:r}):t("<button type='button'></button>").addClass(this._triggerClass).html(s?t("<img/>").attr({src:s,alt:r,title:r}):r)),e[a?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,r,s=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(i=0,n=0,r=0;t.length>r;r++)t[r].length>i&&(i=t[r].length,n=r);return n},s.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),t.input.attr("size",this._formatDate(t,s).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,r,s){var a,l,h,c,u,d=this._dialogInst;return d||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),o(d.settings,r||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,h/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(e){var i,n=t(e),r=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(r.append.remove(),r.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty(),g===r&&(g=null))},_enableDatepicker:function(e){var i,n,r=t(e),s=t.data(e,"datepicker");r.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&((n=r.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,r=t(e),s=t.data(e,"datepicker");r.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&((n=r.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,n){var r,s,a,l,h=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):h?"all"===i?t.extend({},h.settings):this._get(h,i):null:(r=i||{},"string"==typeof i&&(r={},r[i]=n),void(h&&(this._curInst===h&&this._hideDatepicker(),s=this._getDateDatepicker(e,!0),a=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),o(h.settings,r),null!==a&&void 0!==r.dateFormat&&void 0===r.minDate&&(h.settings.minDate=this._formatDate(h,a)),null!==l&&void 0!==r.dateFormat&&void 0===r.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in r&&(r.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),h),this._autoSize(h),this._setDate(h,s),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,r,s=t.datepicker._getInst(e.target),o=!0,a=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return(r=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",s.dpDiv))[0]&&t.datepicker._selectDay(e.target,s.selectedMonth,s.selectedYear,r[0]),(i=t.datepicker._get(s,"onSelect"))?(n=t.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,r=t.datepicker._getInst(e.target);return t.datepicker._get(r,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(r,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(e){var i=t.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal)try{t.datepicker.parseDate(t.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,t.datepicker._getFormatConfig(i))&&(t.datepicker._setDateFromField(i),t.datepicker._updateAlternate(i),t.datepicker._updateDatepicker(i))}catch(t){}return!0},_showDatepicker:function(e){if("input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,r,s,a,l,h;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),!1!==(r=(n=t.datepicker._get(i,"beforeShow"))?n.apply(e,[e,i]):{})&&(o(i.settings,r),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),s=!1,t(e).parents().each(function(){return!(s|="fixed"===t(this).css("position"))}),a={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),a=t.datepicker._checkOffset(i,a,s),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":s?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),h=t.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),h):i.dpDiv[l||"show"](l?h:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,g=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,n=this._getNumberOfMonths(e),r=n[1],o=e.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&s.apply(o.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),r>1&&e.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",17*r+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var r=e.dpDiv.outerWidth(),s=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),h=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?r-o:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+a?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+r>l&&l>r?Math.abs(i.left+r-l):0),i.top-=Math.min(i.top,i.top+s>h&&h>s?Math.abs(s+a):0),i},_findPos:function(e){for(var i,n=this._getInst(e),r=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[r?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,r,s,o=this._curInst;!o||e&&o!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),n=this._get(o,"duration"),r=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),n,r):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,r),i||r(),this._datepickerShowing=!1,(s=this._get(o,"onClose"))&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var r=t(e),s=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(s,i+("M"===n?this._get(s,"showCurrentAtPos"):0),n),this._updateDatepicker(s))},_gotoToday:function(e){var i,n=t(e),r=this._getInst(n[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(i=new Date,r.selectedDay=i.getDate(),r.drawMonth=r.selectedMonth=i.getMonth(),r.drawYear=r.selectedYear=i.getFullYear()),this._notifyChange(r),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var r=t(e),s=this._getInst(r[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(r)},_selectDay:function(e,i,n,r){var s,o=t(e);t(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=t("a",r).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,r=t(e),s=this._getInst(r[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),(n=this._get(s,"onSelect"))?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,r,s=this._get(e,"altField");s&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),r=this.formatDate(i,n,this._getFormatConfig(e)),t(s).each(function(){t(this).val(r)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(""==(i="object"==typeof i?""+i:i+""))return null;var r,s,o,a,l=0,h=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,x=function(t){var i=e.length>r+1&&e.charAt(r+1)===t;return i&&r++,i},_=function(t){var e=x(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,r="y"===t?n:1,s=RegExp("^\\d{"+r+","+n+"}"),o=i.substring(l).match(s);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},w=function(e,n,r){var s=-1,o=t.map(x(e)?r:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(o,function(t,e){var n=e[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(s=e[0],l+=n.length,!1):void 0}),-1!==s)return s+1;throw"Unknown name at position "+l},E=function(){if(i.charAt(l)!==e.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;e.length>r;r++)if(b)"'"!==e.charAt(r)||x("'")?E():b=!1;else switch(e.charAt(r)){case"d":v=_("d");break;case"D":w("D",u,d);break;case"o":y=_("o");break;case"m":g=_("m");break;case"M":g=w("M",p,f);break;case"y":m=_("y");break;case"@":m=(a=new Date(_("@"))).getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"!":m=(a=new Date((_("!")-this._ticksTo1970)/1e4)).getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"'":x("'")?E():b=!0;break;default:E()}if(i.length>l&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100)),y>-1)for(g=1,v=y;!((s=this._getDaysInMonth(m,g-1))>=v);)g++,v-=s;if((a=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||a.getMonth()+1!==g||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var n,r=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},h=function(t,e,i){var n=""+e;if(l(t))for(;i>n.length;)n="0"+n;return n},c=function(t,e,i,n){return l(t)?n[e]:i[e]},u="",d=!1;if(e)for(n=0;t.length>n;n++)if(d)"'"!==t.charAt(n)||l("'")?u+=t.charAt(n):d=!1;else switch(t.charAt(n)){case"d":u+=h("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),r,s);break;case"o":u+=h("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),o,a);break;case"y":u+=l("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,r=function(i){var n=t.length>e+1&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;t.length>e;e++)if(n)"'"!==t.charAt(e)||r("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":r("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,r=this._getDefaultDate(t),s=r,o=this._getFormatConfig(t);try{s=this.parseDate(i,n,o)||r}catch(t){n=e?"":n}t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),t.currentDay=n?s.getDate():0,t.currentMonth=n?s.getMonth():0,t.currentYear=n?s.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var r=null==i||""===i?n:"string"==typeof i?function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(t){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,r=n.getFullYear(),s=n.getMonth(),o=n.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=a.exec(i);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":s+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(r,s));break;case"y":case"Y":r+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(r,s))}l=a.exec(i)}return new Date(r,s,o)}(i):"number"==typeof i?isNaN(i)?n:function(t){var e=new Date;return e.setDate(e.getDate()+t),e}(i):new Date(i.getTime());return(r=r&&"Invalid Date"==""+r?n:r)&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,r=t.selectedMonth,s=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),r===t.selectedMonth&&s===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,r,s,o,a,l,h,c,u,d,p,f,m,g,v,y,b,x,_,w,E,T,M,S,C,A,P,R,L,D,I,N,O,k,z,H,F,U=new Date,B=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),j=this._get(t,"isRTL"),G=this._get(t,"showButtonPanel"),W=this._get(t,"hideIfNoPrevNext"),V=this._get(t,"navigationAsDateFormat"),q=this._getNumberOfMonths(t),X=this._get(t,"showCurrentAtPos"),Y=this._get(t,"stepMonths"),$=1!==q[0]||1!==q[1],J=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(t,"min"),K=this._getMinMaxDate(t,"max"),Q=t.drawMonth-X,tt=t.drawYear;if(0>Q&&(Q+=12,tt--),K)for(e=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth()-q[0]*q[1]+1,K.getDate())),e=Z&&Z>e?Z:e;this._daylightSavingAdjust(new Date(tt,Q,1))>e;)0>--Q&&(Q=11,tt--);for(t.drawMonth=Q,t.drawYear=tt,i=this._get(t,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,Q-Y,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+i+"</span></a>",r=this._get(t,"nextText"),r=V?this.formatDate(r,this._daylightSavingAdjust(new Date(tt,Q+Y,1)),this._getFormatConfig(t)):r,s=this._canAdjustMonth(t,1,tt,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+r+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+r+"</span></a>",o=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?J:B,o=V?this.formatDate(o,a,this._getFormatConfig(t)):o,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",h=G?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(j?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(j?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),x="",w=0;q[0]>w;w++){for(E="",this.maxRows=4,T=0;q[1]>T;T++){if(M=this._daylightSavingAdjust(new Date(tt,Q,t.selectedDay)),S=" ui-corner-all",C="",$){if(C+="<div class='ui-datepicker-group",q[1]>1)switch(T){case 0:C+=" ui-datepicker-group-first",S=" ui-corner-"+(j?"right":"left");break;case q[1]-1:C+=" ui-datepicker-group-last",S=" ui-corner-"+(j?"left":"right");break;default:C+=" ui-datepicker-group-middle",S=""}C+="'>"}for(C+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?j?s:n:"")+(/all|right/.test(S)&&0===w?j?n:s:"")+this._generateMonthYearHeader(t,Q,tt,Z,K,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",_=0;7>_;_++)P=(_+c)%7,A+="<th scope='col'"+((_+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[P]+"'>"+p[P]+"</span></th>";for(C+=A+"</tr></thead><tbody>",R=this._getDaysInMonth(tt,Q),tt===t.selectedYear&&Q===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,R)),L=(this._getFirstDayOfMonth(tt,Q)-c+7)%7,D=Math.ceil((L+R)/7),I=$&&this.maxRows>D?this.maxRows:D,this.maxRows=I,N=this._daylightSavingAdjust(new Date(tt,Q,1-L)),O=0;I>O;O++){for(C+="<tr>",k=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(N)+"</td>":"",_=0;7>_;_++)z=g?g.apply(t.input?t.input[0]:null,[N]):[!0,""],H=N.getMonth()!==Q,F=H&&!y||!z[0]||Z&&Z>N||K&&N>K,k+="<td class='"+((_+c+6)%7>=5?" ui-datepicker-week-end":"")+(H?" ui-datepicker-other-month":"")+(N.getTime()===M.getTime()&&Q===t.selectedMonth&&t._keyEvent||b.getTime()===N.getTime()&&b.getTime()===M.getTime()?" "+this._dayOverClass:"")+(F?" "+this._unselectableClass+" ui-state-disabled":"")+(H&&!v?"":" "+z[1]+(N.getTime()===J.getTime()?" "+this._currentClass:"")+(N.getTime()===B.getTime()?" ui-datepicker-today":""))+"'"+(H&&!v||!z[2]?"":" title='"+z[2].replace(/'/g,"&#39;")+"'")+(F?"":" data-handler='selectDay' data-event='click' data-month='"+N.getMonth()+"' data-year='"+N.getFullYear()+"'")+">"+(H&&!v?"&#xa0;":F?"<span class='ui-state-default'>"+N.getDate()+"</span>":"<a class='ui-state-default"+(N.getTime()===B.getTime()?" ui-state-highlight":"")+(N.getTime()===J.getTime()?" ui-state-active":"")+(H?" ui-priority-secondary":"")+"' href='#'>"+N.getDate()+"</a>")+"</td>",N.setDate(N.getDate()+1),N=this._daylightSavingAdjust(N);C+=k+"</tr>"}++Q>11&&(Q=0,tt++),E+=C+="</tbody></table>"+($?"</div>"+(q[0]>0&&T===q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}x+=E}return x+=h,t._keyEvent=!1,x},_generateMonthYearHeader:function(t,e,i,n,r,s,o,a){var l,h,c,u,d,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",x="";if(s||!g)x+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(l=n&&n.getFullYear()===i,h=r&&r.getFullYear()===i,x+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=n.getMonth())&&(!h||r.getMonth()>=c)&&(x+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+a[c]+"</option>");x+="</select>"}if(y||(b+=x+(!s&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",s||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),f=(p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e})(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=r?Math.min(m,r.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),y&&(b+=(!s&&g&&v?"":"&#xa0;")+x),b+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),r=t.drawMonth+("M"===i?e:0),s=Math.min(t.selectedDay,this._getDaysInMonth(n,r))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,r,s)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),r=i&&i>e?i:e;return n&&r>n?n:r},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var r=this._getNumberOfMonths(t),s=this._daylightSavingAdjust(new Date(i,n+(0>e?e:r[0]*r[1]),1));return 0>e&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(t,s)},_isInRange:function(t,e){var i,n,r=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),o=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!r||e.getTime()>=r.getTime())&&(!s||e.getTime()<=s.getTime())&&(!o||e.getFullYear()>=o)&&(!a||a>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var r=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),r,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new n,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.11.4",t.datepicker,t.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,n=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(i=this.document[0].activeElement)&&"body"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(t){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var n=!1,r=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),s=Math.max.apply(null,r);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),n=!0),n&&!i&&this._trigger("focus",e),n},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement;this.uiDialog[0]===e||t.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),r=i.filter(":last");e.target!==r[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){r.focus()}),e.preventDefault()):(this._delay(function(){n.focus()}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(t.each(i,function(i,n){var r,s;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),r=n.click,n.click=function(){r.apply(e.element[0],arguments)},s={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,t("<button></button>",n).button(s).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,r){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(r))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(r,s){var o=s.offset.left-i.document.scrollLeft(),a=s.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(a>=0?"+":"")+a,of:i.window},t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",r,e(s))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,r=n.resizable,s=this.uiDialog.css("position"),o="string"==typeof r?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,r){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(r))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(r,s){var o=i.uiDialog.offset(),a=o.left-i.document.scrollLeft(),l=o.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(l>=0?"+":"")+l,of:i.window},t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",r,e(s))}}).css("position",s)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,n=!1,r={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(r[t]=e)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,e){var i,n,r=this.uiDialog;"dialogClass"===t&&r.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&((i=r.is(":data(ui-draggable)"))&&!e&&r.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((n=r.is(":data(ui-resizable)"))&&!e&&r.resizable("destroy"),n&&"string"==typeof e&&r.resizable("option","handles",e),n||!1===e||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),t.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this;this.label=t("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),t("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=t("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var n=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&n.index!==e.focusIndex&&(e._trigger("focus",t,{item:n}),e.isOpen||e._select(n,t)),e.focusIndex=n.index,e.button.attr("aria-activedescendant",e.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(e,i){var n=this,r="";t.each(i,function(i,s){s.optgroup!==r&&(t("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(s.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:s.optgroup}).appendTo(e),r=s.optgroup),n._renderItemData(e,s)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var n=t("<li>");return i.disabled&&n.addClass("ui-state-disabled"),this._setText(n,i.label),n.appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,r=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),r+=":not(.ui-state-disabled)"),(n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](r).eq(-1):i[t+"All"](r).eq(0)).length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){"icons"===t&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"disabled"===t&&(this.menuInstance.option("disabled",e),this.button.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===t&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var i=[];e.each(function(e,n){var r=t(n),s=r.parent("optgroup");i.push({element:r,index:e,value:r.val(),label:r.text(),optgroup:s.attr("label")||"",disabled:s.prop("disabled")||r.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),t.widget("ui.slider",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s=[];for(i=n.values&&n.values.length||1,r.length>i&&(r.slice(i).remove(),r=r.slice(0,i)),e=r.length;i>e;e++)s.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=r.add(t(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,r,s,o,a,l,h=this,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(n-h.values(e));(r>i||r===i&&(e===h._lastChangedValue||h.values(e)===c.min))&&(r=i,s=t(this),o=e)}),!1!==this._start(e,o)&&(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-a.left-s.width()/2,top:e.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,r,s;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=i/e)>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),r=this._valueMax()-this._valueMin(),s=this._valueMin()+n*r,this._trimAlignValue(s)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,r,s;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&(r=this.values(),r[e]=i,s=this._trigger("slide",t,{handle:this.handles[e],value:i,values:r}),n=this.values(e?0:1),!1!==s&&this.values(e,i))):i!==this.value()&&!1!==(s=this._trigger("slide",t,{handle:this.handles[e],value:i}))&&this.value(i)},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,r,s;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,r=arguments[0],s=0;n.length>s;s+=1)n[s]=this._trimAlignValue(r[s]),this._change(null,s);this._refreshValue()},_setOption:function(e,i){var n,r=0;switch("range"===e&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(r=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!i),this._super(e,i),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;r>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;t=Math.floor(+(t-e).toFixed(this._precision())/i)*i+e,this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,n,r,s,o=this.options.range,a=this.options,l=this,h=!this._animateOff&&a.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,c["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[h?"animate":"css"](c,a.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i}):(n=this.value(),r=this._valueMin(),s=this._valueMax(),i=s!==r?(n-r)/(s-r)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](c,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var i,n,r,s=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),!1===this._start(e,s)))return}switch(r=this.options.step,i=n=this.options.values&&this.options.values.length?this.values(s):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+r);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-r)}this._slide(e,s,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}}),t.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,n){var r=i.attr(n);void 0!==r&&r.length&&(e[n]=r)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),!1!==this._start(e)&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return e=null!==n.min?n.min:0,i=t-e,i=Math.round(i/n.step)*n.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&n.min>t?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable"))},_setOptions:a(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i)),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:a(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:a(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:a(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:a(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void a(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,n;i=(e=e.cloneNode(!1)).href.replace(t,""),n=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(t){}try{n=decodeURIComponent(n)}catch(t){}return e.hash.length>1&&i===n}}(),_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each(function(i,r){return t(r).attr("aria-controls")===n?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),r=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:r=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,r),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function n(){return e>r&&(e=0),0>e&&(e=r),e}for(var r=this.tabs.length-1;-1!==t.inArray(n(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,n=this.anchors,r=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var r,s,o,a=t(n).uniqueId().attr("id"),l=t(n).closest("li"),h=l.attr("aria-controls");e._isLocal(n)?(r=n.hash,o=r.substring(1),s=e.element.find(e._sanitizeSelector(r))):(o=l.attr("aria-controls")||t({}).uniqueId()[0].id,r="#"+o,(s=e.element.find(r)).length||(s=e._createPanel(o)).insertAfter(e.panels[i-1]||e.tablist),s.attr("aria-live","polite")),s.length&&(e.panels=e.panels.add(s)),h&&l.data("ui-tabs-aria-controls",h),l.attr({"aria-controls":o,"aria-labelledby":a}),s.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(n.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)!0===e||-1!==t.inArray(n,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,r=t(e.currentTarget).closest("li"),s=r[0]===n[0],o=s&&i.collapsible,a=o?t():this._getPanelForTab(r),l=n.length?this._getPanelForTab(n):t(),h={oldTab:n,oldPanel:l,newTab:o?t():r,newPanel:a};e.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||!1===this._trigger("beforeActivate",e,h)||(i.active=!o&&this.tabs.index(r),this.active=s?t():r,this.xhr&&this.xhr.abort(),l.length||a.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(r),e),this._toggle(e,h))},_toggle:function(e,i){function n(){s.running=!1,s._trigger("activate",e,i)}function r(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,n):(o.show(),n())}var s=this,o=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),r()),a.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&a.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;!1!==i&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setupDisabled(i))},disable:function(e){var i=this.options.disabled;if(!0!==i){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setupDisabled(i)}},load:function(e,i){e=this._getIndex(e);var n=this,r=this.tabs.eq(e),s=r.find(".ui-tabs-anchor"),o=this._getPanelForTab(r),a={tab:r,panel:o},l=function(t,e){"abort"===e&&n.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr};this._isLocal(s[0])||(this.xhr=t.ajax(this._ajaxSettings(s,i,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(t,e,r){setTimeout(function(){o.html(t),n._trigger("load",i,a),l(r,e)},1)}).fail(function(t,e){setTimeout(function(){l(t,e)},1)})))},_ajaxSettings:function(e,i,n){var r=this;return{url:e.attr("href"),beforeSend:function(e,s){return r._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:s},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),r=t.inArray(i,n);-1!==r&&n.splice(r,1),e.removeData("ui-tooltip-id"),(n=t.trim(n.join(" ")))?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){n._updateContent(e.element)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,n){var r=t.Event("blur");r.target=r.currentTarget=n.element[0],e.close(r,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each(function(){var e,n=t(this);n.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._registerCloseHandlers(e,n),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,r=this,s=e?e.type:null;return"string"==typeof n?this._open(e,t,n):void((i=n.call(t[0],function(i){r._delay(function(){t.data("ui-tooltip-open")&&(e&&(e.type=s),this._open(e,t,i))})}))&&this._open(e,t,i))},_open:function(e,i,n){function r(t){h.of=t,o.is(":hidden")||o.position(h)}var s,o,a,l,h=t.extend({},this.options.position);if(n){if(s=this._find(i))return void s.tooltip.find(".ui-tooltip-content").html(n);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),s=this._tooltip(i),o=s.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),n.clone?(l=n.clone()).removeAttr("id").find("[id]").removeAttr("id"):l=n,t("<div>").html(l).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:r}),r(e)):o.position(t.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(a=this.delayedShow=setInterval(function(){o.is(":visible")&&(r(h.of),clearInterval(a))},t.fx.interval)),this._trigger("open",e,{tooltip:o})}},_registerCloseHandlers:function(e,i){var n={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var n=t.Event(e);n.currentTarget=i[0],this.close(n,!0)}}};i[0]!==this.element[0]&&(n.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(n.mouseleave="close"),e&&"focusin"!==e.type||(n.focusout="close"),this._on(!0,i,n)},close:function(e){var i,n=this,r=t(e?e.currentTarget:this.element),s=this._find(r);return s?(i=s.tooltip,void(s.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&!r.attr("title")&&r.attr("title",r.data("ui-tooltip-title")),this._removeDescribedBy(r),s.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){n._removeTooltip(t(this))}),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]}),s.closing=!0,this._trigger("close",e,{tooltip:i}),s.hiding||(s.closing=!1)))):void r.removeData("ui-tooltip-open")},_tooltip:function(e){var i=t("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),n=i.uniqueId().attr("id");return t("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,n){var r=t.Event("blur"),s=n.element;r.target=r.currentTarget=s[0],e.close(r,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title")||s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var v=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var n=c[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:t>n.max?n.max:t)}function n(i){var n=l(),r=n._rgba=[];return i=i.toLowerCase(),p(a,function(t,s){var o,a=s.re.exec(i),l=a&&s.parse(a),c=s.space||"rgba";return l?(o=n[c](l),n[h[c].cache]=o[h[c].cache],r=n._rgba=o._rgba,!1):e}),r.length?("0,0,0,0"===r.join()&&t.extend(r,s.transparent),n):s[i]}function r(t,e,i){return 1>6*(i=(i+1)%1)?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var s,o=/^([\-+])=\s*(\d+\.?\d*)/,a=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,n,r){return new t.Color.fn.parse(e,i,n,r)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=l.support={},d=t("<p>")[0],p=t.each;d.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=d.style.backgroundColor.indexOf("rgba")>-1,p(h,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(r,o,a,c){if(r===e)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(o),o=e);var u=this,d=t.type(r),f=this._rgba=[];return o!==e&&(r=[r,o,a,c],d="array"),"string"===d?this.parse(n(r)||s._default):"array"===d?(p(h.rgba.props,function(t,e){f[e.idx]=i(r[e.idx],e)}),this):"object"===d?(p(h,r instanceof l?function(t,e){r[e.cache]&&(u[e.cache]=r[e.cache].slice())}:function(e,n){var s=n.cache;p(n.props,function(t,e){if(!u[s]&&n.to){if("alpha"===t||null==r[t])return;u[s]=n.to(u._rgba)}u[s][e.idx]=i(r[t],e,!0)}),u[s]&&0>t.inArray(null,u[s].slice(0,3))&&(u[s][3]=1,n.from&&(u._rgba=n.from(u[s])))}),this):e},is:function(t){var i=l(t),n=!0,r=this;return p(h,function(t,s){var o,a=i[s.cache];return a&&(o=r[s.cache]||s.to&&s.to(r._rgba)||[],p(s.props,function(t,i){return null!=a[i.idx]?n=a[i.idx]===o[i.idx]:e})),n}),n},_space:function(){var t=[],e=this;return p(h,function(i,n){e[n.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var n=l(t),r=n._space(),s=h[r],o=0===this.alpha()?l("transparent"):this,a=o[s.cache]||s.to(o._rgba),u=a.slice();return n=n[s.cache],p(s.props,function(t,r){var s=r.idx,o=a[s],l=n[s],h=c[r.type]||{};null!==l&&(null===o?u[s]=l:(h.mod&&(l-o>h.mod/2?o+=h.mod:o-l>h.mod/2&&(o-=h.mod)),u[s]=i((l-o)*e+o,r)))}),this[r](u)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),r=l(e)._rgba;return l(t.map(i,function(t,e){return(1-n)*r[e]+n*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,h.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,r=t[1]/255,s=t[2]/255,o=t[3],a=Math.max(n,r,s),l=Math.min(n,r,s),h=a-l,c=a+l,u=.5*c;return e=l===a?0:n===a?60*(r-s)/h+360:r===a?60*(s-n)/h+120:60*(n-r)/h+240,i=0===h?0:.5>=u?h/c:h/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},h.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],o=.5>=n?n*(1+i):n+i-n*i,a=2*n-o;return[Math.round(255*r(a,o,e+1/3)),Math.round(255*r(a,o,e)),Math.round(255*r(a,o,e-1/3)),s]},p(h,function(n,r){var s=r.props,a=r.cache,h=r.to,c=r.from;l.fn[n]=function(n){if(h&&!this[a]&&(this[a]=h(this._rgba)),n===e)return this[a].slice();var r,o=t.type(n),u="array"===o||"object"===o?n:arguments,d=this[a].slice();return p(s,function(t,e){var n=u["object"===o?t:e.idx];null==n&&(n=d[e.idx]),d[e.idx]=i(n,e)}),c?(r=l(c(d)),r[a]=d,r):l(d)},p(s,function(e,i){l.fn[e]||(l.fn[e]=function(r){var s,a=t.type(r),l="alpha"===e?this._hsla?"hsla":"rgba":n,h=this[l](),c=h[i.idx];return"undefined"===a?c:("function"===a&&(r=r.call(this,c),a=t.type(r)),null==r&&i.empty?this:("string"===a&&(s=o.exec(r))&&(r=c+parseFloat(s[2])*("+"===s[1]?1:-1)),h[i.idx]=r,this[l](h)))})})}),l.hook=function(e){var i=e.split(" ");p(i,function(e,i){t.cssHooks[i]={set:function(e,r){var s,o,a="";if("transparent"!==r&&("string"!==t.type(r)||(s=n(r)))){if(r=l(s||r),!u.rgba&&1!==r._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===a||"transparent"===a)&&o&&o.style;)try{a=t.css(o,"backgroundColor"),o=o.parentNode}catch(t){}r=r.blend(a&&"transparent"!==a?a:"_default")}r=r.toRgbaString()}try{e.style[i]=r}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],function(i,n){e["border"+n+"Color"]=t}),e}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(v),function(){function e(e){var i,n,r=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,s={};if(r&&r.length&&r[0]&&r[r[0]])for(n=r.length;n--;)i=r[n],"string"==typeof r[i]&&(s[t.camelCase(i)]=r[i]);else for(i in r)"string"==typeof r[i]&&(s[i]=r[i]);return s}var i=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(v.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(r,s,o,a){var l=t.speed(s,o,a);return this.queue(function(){var s,o=t(this),a=o.attr("class")||"",h=l.children?o.find("*").addBack():o;h=h.map(function(){return{el:t(this),start:e(this)}}),(s=function(){t.each(i,function(t,e){r[e]&&o[e+"Class"](r[e])})})(),h=h.map(function(){return this.end=e(this.el[0]),this.diff=function(e,i){var r,s,o={};for(r in i)s=i[r],e[r]!==s&&(n[r]||(t.fx.step[r]||!isNaN(parseFloat(s)))&&(o[r]=s));return o}(this.start,this.end),this}),o.attr("class",a),h=h.map(function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()}),t.when.apply(t,h.get()).done(function(){s(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(i,n,r,s){return n?t.effects.animateClass.call(this,{add:i},n,r,s):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,n,r,s){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,r,s):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,n,r,s,o){return"boolean"==typeof n||void 0===n?r?t.effects.animateClass.call(this,n?{add:i}:{remove:i},r,s,o):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},n,r,s)}}(t.fn.toggleClass),switchClass:function(e,i,n,r,s){return t.effects.animateClass.call(this,{add:i,remove:e},n,r,s)}})}(),function(){function e(e,i,n,r){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(r=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(r=n,n=i,i={}),t.isFunction(n)&&(r=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=r||i.complete,e}function i(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}t.extend(t.effects,{version:"1.11.4",save:function(t,e){for(var i=0;e.length>i;i++)null!==e[i]&&t.data("ui-effects-"+e[i],t[0].style[e[i]])},restore:function(t,e){var i,n;for(n=0;e.length>n;n++)null!==e[n]&&(void 0===(i=t.data("ui-effects-"+e[n]))&&(i=""),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:e.width(),height:e.height()},s=document.activeElement;try{s.id}catch(t){s=document.body}return e.wrap(n),(e[0]===s||t.contains(e[0],s))&&t(s).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(r),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,r){return r=r||{},t.each(i,function(t,i){var s=e.cssUnit(i);s[0]>0&&(r[i]=s[0]*n+s[1])}),r}}),t.fn.extend({effect:function(){function i(e){function i(){t.isFunction(s)&&s.call(r[0]),t.isFunction(e)&&e()}var r=t(this),s=n.complete,a=n.mode;(r.is(":hidden")?"hide"===a:"show"===a)?(r[a](),i()):o.call(r[0],n,i)}var n=e.apply(this,arguments),r=n.mode,s=n.queue,o=t.effects.effect[n.effect];return t.fx.off||!o?r?this[r](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):!1===s?this.each(i):this.queue(s||"fx",i)},show:function(t){return function(n){if(i(n))return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="show",this.effect.call(this,r)}}(t.fn.show),hide:function(t){return function(n){if(i(n))return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="hide",this.effect.call(this,r)}}(t.fn.hide),toggle:function(t){return function(n){if(i(n)||"boolean"==typeof n)return t.apply(this,arguments);var r=e.apply(this,arguments);return r.mode="toggle",this.effect.call(this,r)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])}),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}(),t.effects,t.effects.effect.blind=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"hide"),h=e.direction||"up",c=/up|down|vertical/.test(h),u=c?"height":"width",d=c?"top":"left",p=/up|left|vertical|horizontal/.test(h),f={},m="show"===l;o.parent().is(".ui-effects-wrapper")?t.effects.save(o.parent(),a):t.effects.save(o,a),o.show(),r=(n=t.effects.createWrapper(o).css({overflow:"hidden"}))[u](),s=parseFloat(n.css(d))||0,f[u]=m?r:0,p||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),f[d]=m?s:r+s),m&&(n.css(u,0),p||n.css(d,s+r)),n.animate(f,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===l&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}})},t.effects.effect.bounce=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"effect"),h="hide"===l,c="show"===l,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||h?1:0),m=e.duration/f,g=e.easing,v="up"===u||"down"===u?"top":"left",y="up"===u||"left"===u,b=o.queue(),x=b.length;for((c||h)&&a.push("opacity"),t.effects.save(o,a),o.show(),t.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),c&&(s={opacity:1},s[v]=0,o.css("opacity",0).css(v,y?2*-d:2*d).animate(s,m,g)),h&&(d/=Math.pow(2,p-1)),(s={})[v]=0,n=0;p>n;n++)r={},r[v]=(y?"-=":"+=")+d,o.animate(r,m,g).animate(s,m,g),d=h?2*d:d/2;h&&(r={opacity:0},r[v]=(y?"-=":"+=")+d,o.animate(r,m,g)),o.queue(function(){h&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}),x>1&&b.splice.apply(b,[1,0].concat(b.splice(x,f+1))),o.dequeue()},t.effects.effect.clip=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","height","width"],l="show"===t.effects.setMode(o,e.mode||"hide"),h="vertical"===(e.direction||"vertical"),c=h?"height":"width",u=h?"top":"left",d={};t.effects.save(o,a),o.show(),n=t.effects.createWrapper(o).css({overflow:"hidden"}),s=(r="IMG"===o[0].tagName?n:o)[c](),l&&(r.css(c,0),r.css(u,s/2)),d[c]=l?s:0,d[u]=l?0:s/2,r.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}})},t.effects.effect.drop=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(r,e.mode||"hide"),a="show"===o,l=e.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l?"pos":"neg",u={opacity:a?1:0};t.effects.save(r,s),r.show(),t.effects.createWrapper(r),n=e.distance||r["top"===h?"outerHeight":"outerWidth"](!0)/2,a&&r.css("opacity",0).css(h,"pos"===c?-n:n),u[h]=(a?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+n,r.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}})},t.effects.effect.explode=function(e,i){function n(){v.push(this),v.length===c*u&&(d.css({visibility:"visible"}),t(v).remove(),p||d.hide(),i())}var r,s,o,a,l,h,c=e.pieces?Math.round(Math.sqrt(e.pieces)):3,u=c,d=t(this),p="show"===t.effects.setMode(d,e.mode||"hide"),f=d.show().css("visibility","hidden").offset(),m=Math.ceil(d.outerWidth()/u),g=Math.ceil(d.outerHeight()/c),v=[];for(r=0;c>r;r++)for(a=f.top+r*g,h=r-(c-1)/2,s=0;u>s;s++)o=f.left+s*m,l=s-(u-1)/2,d.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*m,top:-r*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:m,height:g,left:o+(p?l*m:0),top:a+(p?h*g:0),opacity:p?0:1}).animate({left:o+(p?0:l*m),top:a+(p?0:h*g),opacity:p?1:0},e.duration||500,e.easing,n)},t.effects.effect.fade=function(e,i){var n=t(this),r=t.effects.setMode(n,e.mode||"toggle");n.animate({opacity:r},{queue:!1,duration:e.duration,easing:e.easing,complete:i})},t.effects.effect.fold=function(e,i){var n,r,s=t(this),o=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(s,e.mode||"hide"),l="show"===a,h="hide"===a,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],m=e.duration/2,g={},v={};t.effects.save(s,o),s.show(),n=t.effects.createWrapper(s).css({overflow:"hidden"}),r=p?[n.width(),n.height()]:[n.height(),n.width()],u&&(c=parseInt(u[1],10)/100*r[h?0:1]),l&&n.css(d?{height:0,width:c}:{height:c,width:0}),g[f[0]]=l?r[0]:c,v[f[1]]=l?r[1]:0,n.animate(g,m,e.easing).animate(v,m,e.easing,function(){h&&s.hide(),t.effects.restore(s,o),t.effects.removeWrapper(s),i()})},t.effects.effect.highlight=function(e,i){var n=t(this),r=["backgroundImage","backgroundColor","opacity"],s=t.effects.setMode(n,e.mode||"show"),o={backgroundColor:n.css("backgroundColor")};"hide"===s&&(o.opacity=0),t.effects.save(n,r),n.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===s&&n.hide(),t.effects.restore(n,r),i()}})},t.effects.effect.size=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["width","height","overflow"],h=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],d=t.effects.setMode(o,e.mode||"effect"),p=e.restore||"effect"!==d,f=e.scale||"both",m=e.origin||["middle","center"],g=o.css("position"),v=p?a:["position","top","bottom","left","right","overflow","opacity"],y={height:0,width:0,outerHeight:0,outerWidth:0};"show"===d&&o.show(),n={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===d?(o.from=e.to||y,o.to=e.from||n):(o.from=e.from||("show"===d?y:n),o.to=e.to||("hide"===d?y:n)),s={from:{y:o.from.height/n.height,x:o.from.width/n.width},to:{y:o.to.height/n.height,x:o.to.width/n.width}},("box"===f||"both"===f)&&(s.from.y!==s.to.y&&(v=v.concat(c),o.from=t.effects.setTransition(o,c,s.from.y,o.from),o.to=t.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(v=v.concat(u),o.from=t.effects.setTransition(o,u,s.from.x,o.from),o.to=t.effects.setTransition(o,u,s.to.x,o.to))),("content"===f||"both"===f)&&s.from.y!==s.to.y&&(v=v.concat(h).concat(l),o.from=t.effects.setTransition(o,h,s.from.y,o.from),o.to=t.effects.setTransition(o,h,s.to.y,o.to)),t.effects.save(o,v),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(r=t.effects.getBaseline(m,n),o.from.top=(n.outerHeight-o.outerHeight())*r.y,o.from.left=(n.outerWidth-o.outerWidth())*r.x,o.to.top=(n.outerHeight-o.to.outerHeight)*r.y,o.to.left=(n.outerWidth-o.to.outerWidth)*r.x),o.css(o.from),("content"===f||"both"===f)&&(c=c.concat(["marginTop","marginBottom"]).concat(h),u=u.concat(["marginLeft","marginRight"]),l=a.concat(c).concat(u),o.find("*[width]").each(function(){var i=t(this),n=i.height(),r=i.width(),o=i.outerHeight(),a=i.outerWidth();p&&t.effects.save(i,l),i.from={height:n*s.from.y,width:r*s.from.x,outerHeight:o*s.from.y,outerWidth:a*s.from.x},i.to={height:n*s.to.y,width:r*s.to.x,outerHeight:n*s.to.y,outerWidth:r*s.to.x},s.from.y!==s.to.y&&(i.from=t.effects.setTransition(i,c,s.from.y,i.from),i.to=t.effects.setTransition(i,c,s.to.y,i.to)),s.from.x!==s.to.x&&(i.from=t.effects.setTransition(i,u,s.from.x,i.from),i.to=t.effects.setTransition(i,u,s.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){p&&t.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===d&&o.hide(),t.effects.restore(o,v),p||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],function(t,e){o.css(e,function(e,i){var n=parseInt(i,10),r=t?o.to.left:o.to.top;return"auto"===i?r+"px":n+r+"px"})})),t.effects.removeWrapper(o),i()}})},t.effects.effect.scale=function(e,i){var n=t(this),r=t.extend(!0,{},e),s=t.effects.setMode(n,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===s?0:100),a=e.direction||"both",l=e.origin,h={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},c="horizontal"!==a?o/100:1,u="vertical"!==a?o/100:1;r.effect="size",r.queue=!1,r.complete=i,"effect"!==s&&(r.origin=l||["middle","center"],r.restore=!0),r.from=e.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:h),r.to={height:h.height*c,width:h.width*u,outerHeight:h.outerHeight*c,outerWidth:h.outerWidth*u},r.fade&&("show"===s&&(r.from.opacity=0,r.to.opacity=1),"hide"===s&&(r.from.opacity=1,r.to.opacity=0)),n.effect(r)},t.effects.effect.puff=function(e,i){var n=t(this),r=t.effects.setMode(n,e.mode||"hide"),s="hide"===r,o=parseInt(e.percent,10)||150,a=o/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:r,complete:i,percent:s?o:100,from:s?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),n.effect(e)},t.effects.effect.pulsate=function(e,i){var n,r=t(this),s=t.effects.setMode(r,e.mode||"show"),o="show"===s,a="hide"===s,l=o||"hide"===s,h=2*(e.times||5)+(l?1:0),c=e.duration/h,u=0,d=r.queue(),p=d.length;for((o||!r.is(":visible"))&&(r.css("opacity",0).show(),u=1),n=1;h>n;n++)r.animate({opacity:u},c,e.easing),u=1-u;r.animate({opacity:u},c,e.easing),r.queue(function(){a&&r.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,h+1))),r.dequeue()},t.effects.effect.shake=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(r,e.mode||"effect"),a=e.direction||"left",l=e.distance||20,h=e.times||3,c=2*h+1,u=Math.round(e.duration/c),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},m={},g={},v=r.queue(),y=v.length;for(t.effects.save(r,s),r.show(),t.effects.createWrapper(r),f[d]=(p?"-=":"+=")+l,m[d]=(p?"+=":"-=")+2*l,g[d]=(p?"-=":"+=")+2*l,r.animate(f,u,e.easing),n=1;h>n;n++)r.animate(m,u,e.easing).animate(g,u,e.easing);r.animate(m,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,c+1))),r.dequeue()},t.effects.effect.slide=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(r,e.mode||"show"),a="show"===o,l=e.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,u={};t.effects.save(r,s),r.show(),n=e.distance||r["top"===h?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(r).css({overflow:"hidden"}),a&&r.css(h,c?isNaN(n)?"-"+n:-n:n),u[h]=(a?c?"+=":"-=":c?"-=":"+=")+n,r.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}})},t.effects.effect.transfer=function(e,i){var n=t(this),r=t(e.to),s="fixed"===r.css("position"),o=t("body"),a=s?o.scrollTop():0,l=s?o.scrollLeft():0,h=r.offset(),c={top:h.top-a,left:h.left-l,height:r.innerHeight(),width:r.innerWidth()},u=n.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-a,left:u.left-l,height:n.innerHeight(),width:n.innerWidth(),position:s?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})}});try{exports.GifWriter=GifWriter,exports.GifReader=GifReader}catch(t){}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE={})}(this,function(t){function e(){}function i(t,e){this.x=t||0,this.y=e||0}function n(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function r(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function s(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function o(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function a(t,e,n,r,s,l,h,c,u,d){Object.defineProperty(this,"id",{value:xr++}),this.uuid=br.generateUUID(),this.name="",this.image=void 0!==t?t:a.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:a.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==s?s:1006,this.minFilter=void 0!==l?l:1008,this.anisotropy=void 0!==u?u:1,this.format=void 0!==h?h:1023,this.type=void 0!==c?c:1009,this.offset=new i(0,0),this.repeat=new i(1,1),this.center=new i(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new o,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==d?d:3e3,this.version=0,this.onUpdate=null}function l(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function h(t,e,i){this.uuid=br.generateUUID(),this.width=t,this.height=e,this.scissor=new l(0,0,t,e),this.scissorTest=!1,this.viewport=new l(0,0,t,e),void 0===(i=i||{}).minFilter&&(i.minFilter=1006),this.texture=new a(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function c(t,e,i){h.call(this,t,e,i),this.activeMipMapLevel=this.activeCubeFace=0}function u(t,e,i,n,r,s,o,l,h,c,u,d){a.call(this,null,s,o,l,h,c,n,r,u,d),this.image={data:t,width:e,height:i},this.magFilter=void 0!==h?h:1003,this.minFilter=void 0!==c?c:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function d(t,e,i,n,r,s,o,l,h,c){a.call(this,t=void 0!==t?t:[],void 0!==e?e:301,i,n,r,s,o,l,h,c),this.flipY=!1}function p(t,e,i){var n=t[0];if(0>=n||0<n)return t;var r=e*i,s=Er[r];if(void 0===s&&(s=new Float32Array(r),Er[r]=s),0!==e)for(n.toArray(s,0),n=1,r=0;n!==e;++n)r+=i,t[n].toArray(s,r);return s}function f(t,e){var i=Tr[e];void 0===i&&(i=new Int32Array(e),Tr[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocTextureUnit();return i}function m(t,e){t.uniform1f(this.addr,e)}function g(t,e){t.uniform1i(this.addr,e)}function v(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function y(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function b(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function x(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function _(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(Sr.set(e.elements),t.uniformMatrix3fv(this.addr,!1,Sr))}function w(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(Mr.set(e.elements),t.uniformMatrix4fv(this.addr,!1,Mr))}function E(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTexture2D(e||_r,n)}function T(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTextureCube(e||wr,n)}function M(t,e){t.uniform2iv(this.addr,e)}function S(t,e){t.uniform3iv(this.addr,e)}function C(t,e){t.uniform4iv(this.addr,e)}function A(t,e){t.uniform1fv(this.addr,e)}function P(t,e){t.uniform1iv(this.addr,e)}function R(t,e){t.uniform2fv(this.addr,p(e,this.size,2))}function L(t,e){t.uniform3fv(this.addr,p(e,this.size,3))}function D(t,e){t.uniform4fv(this.addr,p(e,this.size,4))}function I(t,e){t.uniformMatrix2fv(this.addr,!1,p(e,this.size,4))}function N(t,e){t.uniformMatrix3fv(this.addr,!1,p(e,this.size,9))}function O(t,e){t.uniformMatrix4fv(this.addr,!1,p(e,this.size,16))}function k(t,e,i){var n=e.length,r=f(i,n);for(t.uniform1iv(this.addr,r),t=0;t!==n;++t)i.setTexture2D(e[t]||_r,r[t])}function z(t,e,i){var n=e.length,r=f(i,n);for(t.uniform1iv(this.addr,r),t=0;t!==n;++t)i.setTextureCube(e[t]||wr,r[t])}function H(t,e,i){this.id=t,this.addr=i,this.setValue=function(t){switch(t){case 5126:return m;case 35664:return v;case 35665:return y;case 35666:return b;case 35674:return x;case 35675:return _;case 35676:return w;case 35678:case 36198:return E;case 35680:return T;case 5124:case 35670:return g;case 35667:case 35671:return M;case 35668:case 35672:return S;case 35669:case 35673:return C}}(e.type)}function F(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return A;case 35664:return R;case 35665:return L;case 35666:return D;case 35674:return I;case 35675:return N;case 35676:return O;case 35678:return k;case 35680:return z;case 5124:case 35670:return P;case 35667:case 35671:return M;case 35668:case 35672:return S;case 35669:case 35673:return C}}(e.type)}function U(t){this.id=t,this.seq=[],this.map={}}function B(t,e,i){this.seq=[],this.map={},this.renderer=i,i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var n=0;n<i;++n){var r=t.getActiveUniform(e,n),s=t.getUniformLocation(e,r.name),o=this,a=r.name,l=a.length;for(Cr.lastIndex=0;;){var h=Cr.exec(a),c=Cr.lastIndex,u=h[1],d=h[3];if("]"===h[2]&&(u|=0),void 0===d||"["===d&&c+2===l){a=o,r=void 0===d?new H(u,r,s):new F(u,r,s),a.seq.push(r),a.map[r.id]=r;break}void 0===(d=o.map[u])&&(d=new U(u),u=o,o=d,u.seq.push(o),u.map[o.id]=o),o=d}}}function j(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}function G(t,e){this.min=void 0!==t?t:new i(1/0,1/0),this.max=void 0!==e?e:new i(-1/0,-1/0)}function W(t,e,i,n,r,s,o,l,h){a.call(this,t,e,i,n,r,s,o,l,h),this.needsUpdate=!0}function V(){Object.defineProperty(this,"id",{value:Ir++}),this.uuid=br.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function q(t){V.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function X(t){V.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new s,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(t)}function Y(t,e){this.min=void 0!==t?t:new s(1/0,1/0,1/0),this.max=void 0!==e?e:new s(-1/0,-1/0,-1/0)}function $(t,e){this.center=void 0!==t?t:new s,this.radius=void 0!==e?e:0}function J(t,e){this.normal=void 0!==t?t:new s(1,0,0),this.constant=void 0!==e?e:0}function Z(t,e,i,n,r,s){this.planes=[void 0!==t?t:new J,void 0!==e?e:new J,void 0!==i?i:new J,void 0!==n?n:new J,void 0!==r?r:new J,void 0!==s?s:new J]}function K(t,e,r){function o(e,i,n,r,s,o){var a=e.geometry,l=g,h=e.customDepthMaterial;return n&&(l=v,h=e.customDistanceMaterial),h?l=h:(h=!1,i.morphTargets&&(a&&a.isBufferGeometry?h=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(h=a.morphTargets&&0<a.morphTargets.length)),e.isSkinnedMesh&&!1===i.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e),e=e.isSkinnedMesh&&i.skinning,a=0,h&&(a|=1),e&&(a|=2),l=l[a]),t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length&&(a=l.uuid,h=i.uuid,void 0===(e=y[a])&&(e={},y[a]=e),void 0===(a=e[h])&&(a=l.clone(),e[h]=a),l=a),l.visible=i.visible,l.wireframe=i.wireframe,h=i.side,M.renderSingleSided&&2==h&&(h=0),M.renderReverseSided&&(0===h?h=1:1===h&&(h=0)),l.side=h,l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,n&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(r),l.nearDistance=s,l.farDistance=o),l}function a(i,n,r,s){var l;if(!1!==i.visible){if(i.layers.test(n.layers)&&(i.isMesh||i.isLine||i.isPoints)&&i.castShadow&&(!i.frustumCulled||c.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,i.matrixWorld);var h=e.update(i),u=i.material;if(Array.isArray(u))for(var d=h.groups,p=0,f=d.length;p<f;p++){var g=d[p];(l=u[g.materialIndex])&&l.visible&&(l=o(i,l,s,m,r.near,r.far),t.renderBufferDirect(r,null,h,l,i,g))}else u.visible&&(l=o(i,u,s,m,r.near,r.far),t.renderBufferDirect(r,null,h,l,i,null))}for(h=0,u=(i=i.children).length;h<u;h++)a(i[h],n,r,s)}}var c=new Z,u=new n,d=new i,p=new i(r,r),f=new s,m=new s,g=Array(4),v=Array(4),y={},b=[new s(1,0,0),new s(-1,0,0),new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0)],x=[new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,0,1),new s(0,0,-1)],_=[new l,new l,new l,new l,new l,new l];for(r=0;4!==r;++r){var w=0!=(1&r),E=0!=(2&r),T=new q({depthPacking:3201,morphTargets:w,skinning:E});g[r]=T,w=new X({morphTargets:w,skinning:E}),v[r]=w}var M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(e,i,n){if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)&&0!==e.length){var r=t.state;r.disable(t.context.BLEND),r.buffers.color.setClear(1,1,1,1),r.buffers.depth.setTest(!0),r.setScissorTest(!1);for(var s,o=0,l=e.length;o<l;o++){var g=e[o];s=g.shadow;var v=g&&g.isPointLight;if(void 0===s)console.warn("THREE.WebGLShadowMap:",g,"has no shadow.");else{var y=s.camera;if(d.copy(s.mapSize),d.min(p),v){var w=d.x,E=d.y;_[0].set(2*w,E,w,E),_[1].set(0,E,w,E),_[2].set(3*w,E,w,E),_[3].set(w,E,w,E),_[4].set(3*w,0,w,E),_[5].set(w,0,w,E),d.x*=4,d.y*=2}for(null===s.map&&(s.map=new h(d.x,d.y,{minFilter:1003,magFilter:1003,format:1023}),s.map.texture.name=g.name+".shadowMap",y.updateProjectionMatrix()),s.isSpotLightShadow&&s.update(g),w=s.map,E=s.matrix,m.setFromMatrixPosition(g.matrixWorld),y.position.copy(m),v?(s=6,E.makeTranslation(-m.x,-m.y,-m.z)):(s=1,f.setFromMatrixPosition(g.target.matrixWorld),y.lookAt(f),y.updateMatrixWorld(),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(y.projectionMatrix),E.multiply(y.matrixWorldInverse)),t.setRenderTarget(w),t.clear(),g=0;g<s;g++)v&&(f.copy(y.position),f.add(b[g]),y.up.copy(x[g]),y.lookAt(f),y.updateMatrixWorld(),r.viewport(_[g])),u.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),c.setFromMatrix(u),a(i,n,y,v)}}M.needsUpdate=!1}}}function Q(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||Q.DefaultOrder}function tt(){this.mask=1}function et(){Object.defineProperty(this,"id",{value:Nr++}),this.uuid=br.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=et.DefaultUp.clone();var t=new s,e=new Q,i=new r,a=new s(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:a},modelViewMatrix:{value:new n},normalMatrix:{value:new o}}),this.matrix=new n,this.matrixWorld=new n,this.matrixAutoUpdate=et.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new tt,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function it(){et.call(this),this.type="Camera",this.matrixWorldInverse=new n,this.projectionMatrix=new n}function nt(t,e,i,n,r,s){it.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()}function rt(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new s,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new j,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function st(){Object.defineProperty(this,"id",{value:Or+=2}),this.uuid=br.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function ot(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=br.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function at(t,e,i){ot.call(this,new Int8Array(t),e,i)}function lt(t,e,i){ot.call(this,new Uint8Array(t),e,i)}function ht(t,e,i){ot.call(this,new Uint8ClampedArray(t),e,i)}function ct(t,e,i){ot.call(this,new Int16Array(t),e,i)}function ut(t,e,i){ot.call(this,new Uint16Array(t),e,i)}function dt(t,e,i){ot.call(this,new Int32Array(t),e,i)}function pt(t,e,i){ot.call(this,new Uint32Array(t),e,i)}function ft(t,e,i){ot.call(this,new Float32Array(t),e,i)}function mt(t,e,i){ot.call(this,new Float64Array(t),e,i)}function gt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function vt(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}function yt(){Object.defineProperty(this,"id",{value:kr+=2}),this.uuid=br.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function bt(t,e,i,n,r,s){st.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:s},this.fromBufferGeometry(new xt(t,e,i,n,r,s)),this.mergeVertices()}function xt(t,e,i,n,r,o){function a(t,e,i,n,r,o,a,m,g,v,y){var b=o/g,x=a/v,_=o/2,w=a/2,E=m/2;a=g+1;var T,M,S=v+1,C=o=0,A=new s;for(M=0;M<S;M++){var P=M*x-w;for(T=0;T<a;T++)A[t]=(T*b-_)*n,A[e]=P*r,A[i]=E,c.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[i]=0<m?1:-1,u.push(A.x,A.y,A.z),d.push(T/g),d.push(1-M/v),o+=1}for(M=0;M<v;M++)for(T=0;T<g;T++)t=p+T+a*(M+1),e=p+(T+1)+a*(M+1),i=p+(T+1)+a*M,h.push(p+T+a*M,t,i),h.push(t,e,i),C+=6;l.addGroup(f,C,y),f+=C,p+=o}yt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var l=this;t=t||1,e=e||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1;var h=[],c=[],u=[],d=[],p=0,f=0;a("z","y","x",-1,-1,i,e,t,o=Math.floor(o)||1,r,0),a("z","y","x",1,-1,i,e,-t,o,r,1),a("x","z","y",1,1,t,i,e,n,o,2),a("x","z","y",1,-1,t,i,-e,n,o,3),a("x","y","z",1,-1,t,e,i,n,r,4),a("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(h),this.addAttribute("position",new ft(c,3)),this.addAttribute("normal",new ft(u,3)),this.addAttribute("uv",new ft(d,2))}function _t(t,e,i,n){st.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new wt(t,e,i,n)),this.mergeVertices()}function wt(t,e,i,n){yt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};var r=(t=t||1)/2,s=(e=e||1)/2,o=(i=Math.floor(i)||1)+1,a=(n=Math.floor(n)||1)+1,l=t/i,h=e/n,c=[],u=[],d=[],p=[];for(t=0;t<a;t++){var f=t*h-s;for(e=0;e<o;e++)u.push(e*l-r,-f,0),d.push(0,0,1),p.push(e/i),p.push(1-t/n)}for(t=0;t<n;t++)for(e=0;e<i;e++)r=e+o*(t+1),s=e+1+o*(t+1),a=e+1+o*t,c.push(e+o*t,r,a),c.push(r,s,a);this.setIndex(c),this.addAttribute("position",new ft(u,3)),this.addAttribute("normal",new ft(d,3)),this.addAttribute("uv",new ft(p,2))}function Et(t){V.call(this),this.type="MeshBasicMaterial",this.color=new j(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function Tt(t){V.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Mt(t,e){this.origin=void 0!==t?t:new s,this.direction=void 0!==e?e:new s}function St(t,e){this.start=void 0!==t?t:new s,this.end=void 0!==e?e:new s}function Ct(t,e,i){this.a=void 0!==t?t:new s,this.b=void 0!==e?e:new s,this.c=void 0!==i?i:new s}function At(t,e){et.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new Et({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Pt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Rt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Lt(){var t={};return{get:function(e,i){return e=e.id+","+i.id,void 0===(i=t[e])&&(i=new function(){var t=[],e=0,i=[],n=[];return{opaque:i,transparent:n,init:function(){e=0,i.length=0,n.length=0},push:function(r,s,o,a,l){var h=t[e];void 0===h?(h={id:r.id,object:r,geometry:s,material:o,program:o.program,renderOrder:r.renderOrder,z:a,group:l},t[e]=h):(h.id=r.id,h.object=r,h.geometry=s,h.material=o,h.program=o.program,h.renderOrder=r.renderOrder,h.z=a,h.group=l),(!0===o.transparent?n:i).push(h),e++},sort:function(){1<i.length&&i.sort(Pt),1<n.length&&n.sort(Rt)}}},t[e]=i),i},dispose:function(){t={}}}}function Dt(t,e){return Math.abs(e[1])-Math.abs(t[1])}function It(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];switch(e.type){case"DirectionalLight":var n={direction:new s,color:new j,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":n={position:new s,direction:new s,color:new j,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":n={position:new s,color:new j,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new s,skyColor:new j,groundColor:new j};break;case"RectAreaLight":n={color:new j,position:new s,halfWidth:new s,halfHeight:new s}}return t[e.id]=n}}},e={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new s,o=new n,a=new n;return{setup:function(i,n,s){for(var l,h=0,c=0,u=0,d=0,p=0,f=0,m=0,g=0,v=s.matrixWorldInverse,y=0,b=i.length;y<b;y++){var x=i[y];l=x.color;var _=x.intensity,w=x.distance,E=x.shadow&&x.shadow.map?x.shadow.map.texture:null;x.isAmbientLight?(h+=l.r*_,c+=l.g*_,u+=l.b*_):x.isDirectionalLight?((s=t.get(x)).color.copy(x.color).multiplyScalar(x.intensity),s.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),s.direction.sub(r),s.direction.transformDirection(v),(s.shadow=x.castShadow)&&(l=x.shadow,s.shadowBias=l.bias,s.shadowRadius=l.radius,s.shadowMapSize=l.mapSize),e.directionalShadowMap[d]=E,e.directionalShadowMatrix[d]=x.shadow.matrix,e.directional[d]=s,d++):x.isSpotLight?((s=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),s.position.applyMatrix4(v),s.color.copy(l).multiplyScalar(_),s.distance=w,s.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),s.direction.sub(r),s.direction.transformDirection(v),s.coneCos=Math.cos(x.angle),s.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),s.decay=0===x.distance?0:x.decay,(s.shadow=x.castShadow)&&(l=x.shadow,s.shadowBias=l.bias,s.shadowRadius=l.radius,s.shadowMapSize=l.mapSize),e.spotShadowMap[f]=E,e.spotShadowMatrix[f]=x.shadow.matrix,e.spot[f]=s,f++):x.isRectAreaLight?((s=t.get(x)).color.copy(l).multiplyScalar(_/(x.width*x.height)),s.position.setFromMatrixPosition(x.matrixWorld),s.position.applyMatrix4(v),a.identity(),o.copy(x.matrixWorld),o.premultiply(v),a.extractRotation(o),s.halfWidth.set(.5*x.width,0,0),s.halfHeight.set(0,.5*x.height,0),s.halfWidth.applyMatrix4(a),s.halfHeight.applyMatrix4(a),e.rectArea[m]=s,m++):x.isPointLight?((s=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),s.position.applyMatrix4(v),s.color.copy(x.color).multiplyScalar(x.intensity),s.distance=x.distance,s.decay=0===x.distance?0:x.decay,(s.shadow=x.castShadow)&&(l=x.shadow,s.shadowBias=l.bias,s.shadowRadius=l.radius,s.shadowMapSize=l.mapSize,s.shadowCameraNear=l.camera.near,s.shadowCameraFar=l.camera.far),e.pointShadowMap[p]=E,e.pointShadowMatrix[p]=x.shadow.matrix,e.point[p]=s,p++):x.isHemisphereLight&&((s=t.get(x)).direction.setFromMatrixPosition(x.matrixWorld),s.direction.transformDirection(v),s.direction.normalize(),s.skyColor.copy(x.color).multiplyScalar(_),s.groundColor.copy(x.groundColor).multiplyScalar(_),e.hemi[g]=s,g++)}e.ambient[0]=h,e.ambient[1]=c,e.ambient[2]=u,e.directional.length=d,e.spot.length=f,e.rectArea.length=m,e.point.length=p,e.hemi.length=g,e.hash=d+","+p+","+f+","+m+","+g+","+n.length},state:e}}function Nt(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),!1===t.getShaderParameter(n,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(i)),n}function Ot(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function kt(t,e){return e=Ot(e),"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function zt(t){return""!==t}function Ht(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Ft(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){if(void 0===(t=Lr[e]))throw Error("Can not resolve #include <"+e+">");return Ft(t)})}function Ut(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,i,n){for(t="",e=parseInt(e);e<parseInt(i);e++)t+=n.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function Bt(t,e,i,n,r,s){var o=t.context,a=n.defines,l=r.vertexShader,h=r.fragmentShader,c="SHADOWMAP_TYPE_BASIC";1===s.shadowMapType?c="SHADOWMAP_TYPE_PCF":2===s.shadowMapType&&(c="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(s.envMap){switch(n.envMap.mapping){case 301:case 302:u="ENVMAP_TYPE_CUBE";break;case 306:case 307:u="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:u="ENVMAP_TYPE_EQUIREC";break;case 305:u="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:d="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:p="ENVMAP_BLENDING_MULTIPLY";break;case 1:p="ENVMAP_BLENDING_MIX";break;case 2:p="ENVMAP_BLENDING_ADD"}}var f=0<t.gammaFactor?t.gammaFactor:1,m=function(t,e,i){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zt).join("\n")}(n.extensions,s,e),g=function(t){var e,i=[];for(e in t){var n=t[e];!1!==n&&i.push("#define "+e+" "+n)}return i.join("\n")}(a),v=o.createProgram();n.isRawShaderMaterial?(0<(a=[g].filter(zt).join("\n")).length&&(a+="\n"),0<(e=[m,g].filter(zt).join("\n")).length&&(e+="\n")):(a=["precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+r.name,g,s.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+s.maxBones,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+d:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.displacementMap&&s.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.useVertexTexture?"#define BONE_TEXTURE":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&!1===s.flatShading?"#define USE_MORPHNORMALS":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+c:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zt).join("\n"),e=[m,"precision "+s.precision+" float;","precision "+s.precision+" int;","#define SHADER_NAME "+r.name,g,s.alphaTest?"#define ALPHATEST "+s.alphaTest:"","#define GAMMA_FACTOR "+f,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+u:"",s.envMap?"#define "+d:"",s.envMap?"#define "+p:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.vertexColors?"#define USE_COLOR":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+s.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(s.numClippingPlanes-s.numClipIntersection),s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+c:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",s.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==s.toneMapping?"#define TONE_MAPPING":"",0!==s.toneMapping?Lr.tonemapping_pars_fragment:"",0!==s.toneMapping?function(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="Uncharted2";break;case 4:e="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}("toneMapping",s.toneMapping):"",s.dithering?"#define DITHERING":"",s.outputEncoding||s.mapEncoding||s.envMapEncoding||s.emissiveMapEncoding?Lr.encodings_pars_fragment:"",s.mapEncoding?kt("mapTexelToLinear",s.mapEncoding):"",s.envMapEncoding?kt("envMapTexelToLinear",s.envMapEncoding):"",s.emissiveMapEncoding?kt("emissiveMapTexelToLinear",s.emissiveMapEncoding):"",s.outputEncoding?function(t,e){return e=Ot(e),"vec4 "+t+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}("linearToOutputTexel",s.outputEncoding):"",s.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zt).join("\n")),l=Ht(l=Ft(l),s),h=Ht(h=Ft(h),s),n.isShaderMaterial||(l=Ut(l),h=Ut(h)),h=e+h,l=Nt(o,o.VERTEX_SHADER,a+l),h=Nt(o,o.FRAGMENT_SHADER,h),o.attachShader(v,l),o.attachShader(v,h),void 0!==n.index0AttributeName?o.bindAttribLocation(v,0,n.index0AttributeName):!0===s.morphTargets&&o.bindAttribLocation(v,0,"position"),o.linkProgram(v),s=o.getProgramInfoLog(v),r=o.getShaderInfoLog(l),c=o.getShaderInfoLog(h),d=u=!0,!1===o.getProgramParameter(v,o.LINK_STATUS)?(u=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(v,o.VALIDATE_STATUS),"gl.getProgramInfoLog",s,r,c)):""!==s?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",s):""!==r&&""!==c||(d=!1),d&&(this.diagnostics={runnable:u,material:n,programLog:s,vertexShader:{log:r,prefix:a},fragmentShader:{log:c,prefix:e}}),o.deleteShader(l),o.deleteShader(h);var y;this.getUniforms=function(){return void 0===y&&(y=new B(o,v,t)),y};var b;return this.getAttributes=function(){if(void 0===b){for(var t={},e=o.getProgramParameter(v,o.ACTIVE_ATTRIBUTES),i=0;i<e;i++){var n=o.getActiveAttrib(v,i).name;t[n]=o.getAttribLocation(v,n)}b=t}return b},this.destroy=function(){o.deleteProgram(v),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=zr++,this.code=i,this.usedTimes=1,this.program=v,this.vertexShader=l,this.fragmentShader=h,this}function jt(t,e,i,n){it.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Gt(t){jt.call(this),this.cameras=t||[]}function Wt(t){function e(){if(null!==r&&r.isPresenting){var e=(n=r.getEyeParameters("left")).renderWidth,n=n.renderHeight;p=t.getPixelRatio(),d=t.getSize(),t.setDrawingBufferSize(2*e,n,1)}else i.enabled&&t.setDrawingBufferSize(d.width,d.height,p)}var i=this,r=null,s=null,o=null;"undefined"!=typeof window&&"VRFrameData"in window&&(s=new window.VRFrameData);var a=new n,h=new jt;h.bounds=new l(0,0,.5,1),h.layers.enable(1);var c=new jt;c.bounds=new l(.5,0,.5,1),c.layers.enable(2);var u=new Gt([h,c]);u.layers.enable(1),u.layers.enable(2);var d,p;"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t)},this.setPoseTarget=function(t){void 0!==t&&(o=t)},this.getCamera=function(t){if(null===r)return t;r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(s);var e=s.pose,i=null!==o?o:t;return null!==e.position?i.position.fromArray(e.position):i.position.set(0,0,0),null!==e.orientation&&i.quaternion.fromArray(e.orientation),i.updateMatrixWorld(),!1===r.isPresenting?t:(h.near=t.near,c.near=t.near,h.far=t.far,c.far=t.far,u.matrixWorld.copy(t.matrixWorld),u.matrixWorldInverse.copy(t.matrixWorldInverse),h.matrixWorldInverse.fromArray(s.leftViewMatrix),c.matrixWorldInverse.fromArray(s.rightViewMatrix),null!==(t=i.parent)&&(a.getInverse(t.matrixWorld),h.matrixWorldInverse.multiply(a),c.matrixWorldInverse.multiply(a)),h.matrixWorld.getInverse(h.matrixWorldInverse),c.matrixWorld.getInverse(c.matrixWorldInverse),h.projectionMatrix.fromArray(s.leftProjectionMatrix),c.projectionMatrix.fromArray(s.rightProjectionMatrix),u.projectionMatrix.copy(h.projectionMatrix),(t=r.getLayers()).length&&(null!==(t=t[0]).leftBounds&&4===t.leftBounds.length&&h.bounds.fromArray(t.leftBounds),null!==t.rightBounds&&4===t.rightBounds.length&&c.bounds.fromArray(t.rightBounds)),u)},this.submitFrame=function(){r&&r.isPresenting&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function Vt(t,e){return{convert:function(i){if(1e3===i)return t.REPEAT;if(1001===i)return t.CLAMP_TO_EDGE;if(1002===i)return t.MIRRORED_REPEAT;if(1003===i)return t.NEAREST;if(1004===i)return t.NEAREST_MIPMAP_NEAREST;if(1005===i)return t.NEAREST_MIPMAP_LINEAR;if(1006===i)return t.LINEAR;if(1007===i)return t.LINEAR_MIPMAP_NEAREST;if(1008===i)return t.LINEAR_MIPMAP_LINEAR;if(1009===i)return t.UNSIGNED_BYTE;if(1017===i)return t.UNSIGNED_SHORT_4_4_4_4;if(1018===i)return t.UNSIGNED_SHORT_5_5_5_1;if(1019===i)return t.UNSIGNED_SHORT_5_6_5;if(1010===i)return t.BYTE;if(1011===i)return t.SHORT;if(1012===i)return t.UNSIGNED_SHORT;if(1013===i)return t.INT;if(1014===i)return t.UNSIGNED_INT;if(1015===i)return t.FLOAT;if(1016===i){var n=e.get("OES_texture_half_float");if(null!==n)return n.HALF_FLOAT_OES}if(1021===i)return t.ALPHA;if(1022===i)return t.RGB;if(1023===i)return t.RGBA;if(1024===i)return t.LUMINANCE;if(1025===i)return t.LUMINANCE_ALPHA;if(1026===i)return t.DEPTH_COMPONENT;if(1027===i)return t.DEPTH_STENCIL;if(100===i)return t.FUNC_ADD;if(101===i)return t.FUNC_SUBTRACT;if(102===i)return t.FUNC_REVERSE_SUBTRACT;if(200===i)return t.ZERO;if(201===i)return t.ONE;if(202===i)return t.SRC_COLOR;if(203===i)return t.ONE_MINUS_SRC_COLOR;if(204===i)return t.SRC_ALPHA;if(205===i)return t.ONE_MINUS_SRC_ALPHA;if(206===i)return t.DST_ALPHA;if(207===i)return t.ONE_MINUS_DST_ALPHA;if(208===i)return t.DST_COLOR;if(209===i)return t.ONE_MINUS_DST_COLOR;if(210===i)return t.SRC_ALPHA_SATURATE;if((2001===i||2002===i||2003===i||2004===i)&&null!==(n=e.get("WEBGL_compressed_texture_s3tc"))){if(2001===i)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===i)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===i)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===i)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===i||2101===i||2102===i||2103===i)&&null!==(n=e.get("WEBGL_compressed_texture_pvrtc"))){if(2100===i)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===i)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===i)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===i)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===i&&null!==(n=e.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((103===i||104===i)&&null!==(n=e.get("EXT_blend_minmax"))){if(103===i)return n.MIN_EXT;if(104===i)return n.MAX_EXT}return 1020===i&&null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:0}}}function qt(t){function e(){(_t=new function(t){var e={};return{get:function(i){if(void 0!==e[i])return e[i];switch(i){case"WEBGL_depth_texture":var n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n}}}(bt)).get("WEBGL_depth_texture"),_t.get("OES_texture_float"),_t.get("OES_texture_float_linear"),_t.get("OES_texture_half_float"),_t.get("OES_texture_half_float_linear"),_t.get("OES_standard_derivatives"),_t.get("OES_element_index_uint"),_t.get("ANGLE_instanced_arrays"),Yt=new Vt(bt,_t),Mt=new function(t,e,i){function n(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var r,s=void 0!==i.precision?i.precision:"highp";(o=n(s))!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o),i=!0===i.logarithmicDepthBuffer;var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),a=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),c=t.getParameter(t.MAX_VERTEX_ATTRIBS),u=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),p=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),f=0<a,m=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var i=e.get("EXT_texture_filter_anisotropic");return r=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:s,logarithmicDepthBuffer:i,maxTextures:o,maxVertexTextures:a,maxTextureSize:l,maxCubemapSize:h,maxAttributes:c,maxVertexUniforms:u,maxVaryings:d,maxFragmentUniforms:p,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:f&&m}}(bt,_t,t),(St=new function(t,e,i){function n(e,i,n){var r=new Uint8Array(4),s=t.createTexture();for(t.bindTexture(e,s),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST),e=0;e<n;e++)t.texImage2D(i+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return s}function r(e){!0!==b[e]&&(t.enable(e),b[e]=!0)}function s(e){!1!==b[e]&&(t.disable(e),b[e]=!1)}function o(e,n,o,a,l,h,c,u){if(0!==e?r(t.BLEND):s(t.BLEND),5!==e){if(e!==w||u!==P)switch(e){case 2:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case 3:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case 4:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}A=C=S=M=T=E=null}else l=l||n,h=h||o,c=c||a,n===E&&l===S||(t.blendEquationSeparate(i.convert(n),i.convert(l)),E=n,S=l),o===T&&a===M&&h===C&&c===A||(t.blendFuncSeparate(i.convert(o),i.convert(a),i.convert(h),i.convert(c)),T=o,M=a,C=h,A=c);w=e,P=u}function a(e){R!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),R=e)}function h(e){0!==e?(r(t.CULL_FACE),e!==L&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):s(t.CULL_FACE),L=e}function c(e,i,n){e?(r(t.POLYGON_OFFSET_FILL),(I!==i||N!==n)&&(t.polygonOffset(i,n),I=i,N=n)):s(t.POLYGON_OFFSET_FILL)}function u(e){void 0===e&&(e=t.TEXTURE0+O-1),z!==e&&(t.activeTexture(e),z=e)}var d=new function(){var e=!1,i=new l,n=null,r=new l(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,s,o,a){!0===a&&(e*=o,n*=o,s*=o),i.set(e,n,s,o),!1===r.equals(i)&&(t.clearColor(e,n,s,o),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}},p=new function(){var e=!1,i=null,n=null,o=null;return{setTest:function(e){e?r(t.DEPTH_TEST):s(t.DEPTH_TEST)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){o!==e&&(t.clearDepth(e),o=e)},reset:function(){e=!1,o=n=i=null}}},f=new function(){var e=!1,i=null,n=null,o=null,a=null,l=null,h=null,c=null,u=null;return{setTest:function(e){e?r(t.STENCIL_TEST):s(t.STENCIL_TEST)},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,r){n===e&&o===i&&a===r||(t.stencilFunc(e,i,r),n=e,o=i,a=r)},setOp:function(e,i,n){l===e&&h===i&&c===n||(t.stencilOp(e,i,n),l=e,h=i,c=n)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,u=c=h=l=a=o=n=i=null}}},m=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=new Uint8Array(m),v=new Uint8Array(m),y=new Uint8Array(m),b={},x=null,_=null,w=null,E=null,T=null,M=null,S=null,C=null,A=null,P=!1,R=null,L=null,D=null,I=null,N=null,O=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),k=(m=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),1<=parseFloat(m)),z=null,H={},F=new l,U=new l,B={};return B[t.TEXTURE_2D]=n(t.TEXTURE_2D,t.TEXTURE_2D,1),B[t.TEXTURE_CUBE_MAP]=n(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),d.setClear(0,0,0,1),p.setClear(1),f.setClear(0),r(t.DEPTH_TEST),p.setFunc(3),a(!1),h(1),r(t.CULL_FACE),r(t.BLEND),o(1),{buffers:{color:d,depth:p,stencil:f},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(i){g[i]=1,0===v[i]&&(t.enableVertexAttribArray(i),v[i]=1),0!==y[i]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),y[i]=0)},enableAttributeAndDivisor:function(i,n){g[i]=1,0===v[i]&&(t.enableVertexAttribArray(i),v[i]=1),y[i]!==n&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,n),y[i]=n)},disableUnusedAttributes:function(){for(var e=0,i=v.length;e!==i;++e)v[e]!==g[e]&&(t.disableVertexAttribArray(e),v[e]=0)},enable:r,disable:s,getCompressedTextureFormats:function(){if(null===x&&(x=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)x.push(i[n]);return x},useProgram:function(e){return _!==e&&(t.useProgram(e),_=e,!0)},setBlending:o,setMaterial:function(e,i){2===e.side?s(t.CULL_FACE):r(t.CULL_FACE);var n=1===e.side;i&&(n=!n),a(n),!0===e.transparent?o(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):o(0),p.setFunc(e.depthFunc),p.setTest(e.depthTest),p.setMask(e.depthWrite),d.setMask(e.colorWrite),c(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:a,setCullFace:h,setLineWidth:function(e){e!==D&&(k&&t.lineWidth(e),D=e)},setPolygonOffset:c,setScissorTest:function(e){e?r(t.SCISSOR_TEST):s(t.SCISSOR_TEST)},activeTexture:u,bindTexture:function(e,i){null===z&&u();var n=H[z];void 0===n&&(n={type:void 0,texture:void 0},H[z]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||B[e]),n.type=e,n.texture=i)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===F.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),F.copy(e))},viewport:function(e){!1===U.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),U.copy(e))},reset:function(){for(var e=0;e<v.length;e++)1===v[e]&&(t.disableVertexAttribArray(e),v[e]=0);b={},z=x=null,H={},L=R=w=_=null,d.reset(),p.reset(),f.reset()}}}(bt,_t,Yt)).scissor(Y.copy(st).multiplyScalar(it)),St.viewport(X.copy(rt).multiplyScalar(it)),Ct=new function(){var t={};return{get:function(e){e=e.uuid;var i=t[e];return void 0===i&&(i={},t[e]=i),i},remove:function(e){delete t[e.uuid]},clear:function(){t={}}}},Pt=new function(t,e,i,n,r,s,o){function a(t,e){if(t.width>e||t.height>e){e/=Math.max(t.width,t.height);var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return i.width=Math.floor(t.width*e),i.height=Math.floor(t.height*e),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function l(t){return br.isPowerOfTwo(t.width)&&br.isPowerOfTwo(t.height)}function h(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function c(e){return 1003===e||1004===e||1005===e?t.NEAREST:t.LINEAR}function u(e){(e=e.target).removeEventListener("dispose",u);t:{var i=n.get(e);if(e.image&&i.__image__webglTextureCube)t.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)break t;t.deleteTexture(i.__webglTexture)}n.remove(e)}e.isVideoTexture&&delete y[e.id],o.textures--}function d(e){(e=e.target).removeEventListener("dispose",d);var i=n.get(e),r=n.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(r=0;6>r;r++)t.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[r]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer);n.remove(e.texture),n.remove(e)}o.textures--}function p(e,c){var d=n.get(e);if(0<e.version&&d.__version!==e.version)if(void 0===(m=e.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==m.complete){void 0===d.__webglInit&&(d.__webglInit=!0,e.addEventListener("dispose",u),d.__webglTexture=t.createTexture(),e.isVideoTexture&&(y[e.id]=e),o.textures++),i.activeTexture(t.TEXTURE0+c),i.bindTexture(t.TEXTURE_2D,d.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment);var p=a(e.image,r.maxTextureSize);(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)&&!1===l(p)&&((c=p)instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof ImageBitmap?(m=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m.width=br.floorPowerOfTwo(c.width),m.height=br.floorPowerOfTwo(c.height),m.getContext("2d").drawImage(c,0,0,m.width,m.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+c.width+"x"+c.height+"). Resized to "+m.width+"x"+m.height,c),p=m):p=c),c=l(p);var m=s.convert(e.format),g=s.convert(e.type);f(t.TEXTURE_2D,e,c);var b=e.mipmaps;if(e.isDepthTexture){if(b=t.DEPTH_COMPONENT,1015===e.type){if(!v)throw Error("Float Depth Texture only supported in WebGL2.0");b=t.DEPTH_COMPONENT32F}else v&&(b=t.DEPTH_COMPONENT16);1026===e.format&&b===t.DEPTH_COMPONENT&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,g=s.convert(e.type)),1027===e.format&&(b=t.DEPTH_STENCIL,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,g=s.convert(e.type))),i.texImage2D(t.TEXTURE_2D,0,b,p.width,p.height,0,m,g,null)}else if(e.isDataTexture)if(0<b.length&&c){for(var x=0,_=b.length;x<_;x++)p=b[x],i.texImage2D(t.TEXTURE_2D,x,m,p.width,p.height,0,m,g,p.data);e.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,m,p.width,p.height,0,m,g,p.data);else if(e.isCompressedTexture)for(x=0,_=b.length;x<_;x++)p=b[x],1023!==e.format&&1022!==e.format?-1<i.getCompressedTextureFormats().indexOf(m)?i.compressedTexImage2D(t.TEXTURE_2D,x,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(t.TEXTURE_2D,x,m,p.width,p.height,0,m,g,p.data);else if(0<b.length&&c){for(x=0,_=b.length;x<_;x++)p=b[x],i.texImage2D(t.TEXTURE_2D,x,m,m,g,p);e.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,m,m,g,p);return h(e,c)&&t.generateMipmap(t.TEXTURE_2D),d.__version=e.version,void(e.onUpdate&&e.onUpdate(e))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}i.activeTexture(t.TEXTURE0+c),i.bindTexture(t.TEXTURE_2D,d.__webglTexture)}function f(i,o,a){a?(t.texParameteri(i,t.TEXTURE_WRAP_S,s.convert(o.wrapS)),t.texParameteri(i,t.TEXTURE_WRAP_T,s.convert(o.wrapT)),t.texParameteri(i,t.TEXTURE_MAG_FILTER,s.convert(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,s.convert(o.minFilter))):(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),1001===o.wrapS&&1001===o.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),t.texParameteri(i,t.TEXTURE_MAG_FILTER,c(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,c(o.minFilter)),1003!==o.minFilter&&1006!==o.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),!(a=e.get("EXT_texture_filter_anisotropic"))||1015===o.type&&null===e.get("OES_texture_float_linear")||1016===o.type&&null===e.get("OES_texture_half_float_linear")||!(1<o.anisotropy||n.get(o).__currentAnisotropy)||(t.texParameterf(i,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}function m(e,r,o,a){var l=s.convert(r.texture.format),h=s.convert(r.texture.type);i.texImage2D(a,0,l,r.width,r.height,0,l,h,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,o,a,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function g(e,i){t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer&&!i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):i.depthBuffer&&i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i.width,i.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}var v="undefined"!=typeof WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext,y={};this.setTexture2D=p,this.setTextureCube=function(e,c){var d=n.get(e);if(6===e.image.length)if(0<e.version&&d.__version!==e.version){d.__image__webglTextureCube||(e.addEventListener("dispose",u),d.__image__webglTextureCube=t.createTexture(),o.textures++),i.activeTexture(t.TEXTURE0+c),i.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),c=e&&e.isCompressedTexture;for(var p=e.image[0]&&e.image[0].isDataTexture,m=[],g=0;6>g;g++)m[g]=c||p?p?e.image[g].image:e.image[g]:a(e.image[g],r.maxCubemapSize);var v=l(m[0]),y=s.convert(e.format),b=s.convert(e.type);for(f(t.TEXTURE_CUBE_MAP,e,v),g=0;6>g;g++)if(c)for(var x,_=m[g].mipmaps,w=0,E=_.length;w<E;w++)x=_[w],1023!==e.format&&1022!==e.format?-1<i.getCompressedTextureFormats().indexOf(y)?i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,w,y,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,w,y,x.width,x.height,0,y,b,x.data);else p?i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,y,m[g].width,m[g].height,0,y,b,m[g].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,y,y,b,m[g]);h(e,v)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),d.__version=e.version,e.onUpdate&&e.onUpdate(e)}else i.activeTexture(t.TEXTURE0+c),i.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,r){i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)},this.setupRenderTarget=function(e){var r=n.get(e),s=n.get(e.texture);e.addEventListener("dispose",d),s.__webglTexture=t.createTexture(),o.textures++;var a=!0===e.isWebGLRenderTargetCube,c=l(e);if(a){r.__webglFramebuffer=[];for(var u=0;6>u;u++)r.__webglFramebuffer[u]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(a){for(i.bindTexture(t.TEXTURE_CUBE_MAP,s.__webglTexture),f(t.TEXTURE_CUBE_MAP,e.texture,c),u=0;6>u;u++)m(r.__webglFramebuffer[u],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+u);h(e.texture,c)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),i.bindTexture(t.TEXTURE_CUBE_MAP,null)}else i.bindTexture(t.TEXTURE_2D,s.__webglTexture),f(t.TEXTURE_2D,e.texture,c),m(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),h(e.texture,c)&&t.generateMipmap(t.TEXTURE_2D),i.bindTexture(t.TEXTURE_2D,null);if(e.depthBuffer){if(r=n.get(e),s=!0===e.isWebGLRenderTargetCube,e.depthTexture){if(s)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(n.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),p(e.depthTexture,0),r=n.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,r,0);else{if(1027!==e.depthTexture.format)throw Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,r,0)}}else if(s)for(r.__webglDepthbuffer=[],s=0;6>s;s++)t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[s]),r.__webglDepthbuffer[s]=t.createRenderbuffer(),g(r.__webglDepthbuffer[s],e);else t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),g(r.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(e){var r=e.texture;h(r,l(e))&&(e=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,r=n.get(r).__webglTexture,i.bindTexture(e,r),t.generateMipmap(e),i.bindTexture(e,null))},this.updateVideoTextures=function(){for(var t in y)y[t].update()}}(bt,_t,St,Ct,Mt,Yt,mt),Rt=new function(t){var e={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e[t.uuid]},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var n=e[i.uuid];n&&(t.deleteBuffer(n.buffer),delete e[i.uuid])},update:function(i,n){if(i.isInterleavedBufferAttribute&&(i=i.data),void 0===(r=e[i.uuid])){var r=i.uuid,s=i.array,o=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,s,o),i.onUploadCallback(),n=t.FLOAT,s instanceof Float32Array?n=t.FLOAT:s instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):s instanceof Uint16Array?n=t.UNSIGNED_SHORT:s instanceof Int16Array?n=t.SHORT:s instanceof Uint32Array?n=t.UNSIGNED_INT:s instanceof Int32Array?n=t.INT:s instanceof Int8Array?n=t.BYTE:s instanceof Uint8Array&&(n=t.UNSIGNED_BYTE),e[r]={buffer:a,type:n,bytesPerElement:s.BYTES_PER_ELEMENT,version:i.version}}else r.version<i.version&&(s=i,a=s.array,o=s.updateRange,t.bindBuffer(n,r.buffer),!1===s.dynamic?t.bufferData(n,a,t.STATIC_DRAW):-1===o.count?t.bufferSubData(n,0,a):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1),r.version=i.version)}}}(bt),Nt=new function(t,e,i){function n(t){t=t.target;var o=r[t.id];null!==o.index&&e.remove(o.index);for(var a in o.attributes)e.remove(o.attributes[a]);t.removeEventListener("dispose",n),delete r[t.id],(a=s[t.id])&&(e.remove(a),delete s[t.id]),(a=s[o.id])&&(e.remove(a),delete s[o.id]),i.geometries--}var r={},s={};return{get:function(t,e){var s=r[e.id];return s||(e.addEventListener("dispose",n),e.isBufferGeometry?s=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new yt).setFromObject(t)),s=e._bufferGeometry),r[e.id]=s,i.geometries++,s)},update:function(i){var n=i.index,r=i.attributes;null!==n&&e.update(n,t.ELEMENT_ARRAY_BUFFER);for(var s in r)e.update(r[s],t.ARRAY_BUFFER);i=i.morphAttributes;for(s in i){n=i[s],r=0;for(var o=n.length;r<o;r++)e.update(n[r],t.ARRAY_BUFFER)}},getWireframeAttribute:function(i){var n=s[i.id];if(n)return n;n=[];var r=i.index,o=i.attributes;if(null!==r)for(var a=r.array,l=0,h=a.length;l<h;l+=3){var c=a[l+0];o=a[l+1],r=a[l+2],n.push(c,o,o,r,r,c)}else for(a=o.position.array,l=0,h=a.length/3-1;l<h;l+=3)c=l+0,o=l+1,r=l+2,n.push(c,o,o,r,r,c);return n=new(65535<vt(n)?pt:ut)(n,1),e.update(n,t.ELEMENT_ARRAY_BUFFER),s[i.id]=n}}}(bt,Rt,mt),Ot=new function(t,e){var i={};return{update:function(n){var r=e.frame,s=n.geometry,o=t.get(n,s);return i[o.id]!==r&&(s.isGeometry&&o.updateFromObject(n),t.update(o),i[o.id]=r),o},clear:function(){i={}}}}(Nt,gt),Ut=new function(t){var e={},i=new Float32Array(8);return{update:function(n,r,s,o){var a=n.morphTargetInfluences,l=a.length;if(void 0===(n=e[r.id])){n=[];for(var h=0;h<l;h++)n[h]=[h,0];e[r.id]=n}var c=s.morphTargets&&r.morphAttributes.position;for(s=s.morphNormals&&r.morphAttributes.normal,h=0;h<l;h++){var u=n[h];0!==u[1]&&(c&&r.removeAttribute("morphTarget"+h),s&&r.removeAttribute("morphNormal"+h))}for(h=0;h<l;h++)u=n[h],u[0]=h,u[1]=a[h];for(n.sort(Dt),h=0;8>h;h++)(u=n[h])&&(a=u[0],u=u[1])?(c&&r.addAttribute("morphTarget"+h,c[a]),s&&r.addAttribute("morphNormal"+h,s[a]),i[h]=u):i[h]=0;o.getUniforms().setValue(t,"morphTargetInfluences",i)}}}(bt),zt=new function(t,e,i){function n(t,e){if(t)t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding);else var i=3e3;return 3e3===i&&e&&(i=3007),i}var r=[],s={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(e,r,o,a,l,h,c){var u=s[e.type];if(c.isSkinnedMesh){var d=c.skeleton.bones;if(i.floatVertexTextures)d=1024;else{var p=Math.min(Math.floor((i.maxVertexUniforms-20)/4),d.length);p<d.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+d.length+" bones. This GPU supports "+p+"."),d=0):d=p}}else d=0;p=i.precision,null!==e.precision&&(p=i.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",p,"instead.");var f=t.getRenderTarget();return{shaderID:u,precision:p,supportsVertexTextures:i.vertexTextures,outputEncoding:n(f?f.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:n(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:n(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(306===e.envMap.mapping||307===e.envMap.mapping),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:n(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!a,useFog:e.fog,fogExp:a&&a.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:i.logarithmicDepthBuffer,skinning:e.skinning&&0<d,maxBones:d,useVertexTexture:i.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:l,numClipIntersection:h,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&0<o.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:2===e.side,flipSided:1===e.side,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,i){var n=[];if(i.shaderID?n.push(i.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);for(r=0;r<o.length;r++)n.push(i[o[r]]);return n.push(e.onBeforeCompile.toString()),n.push(t.gammaOutput),n.join()},this.acquireProgram=function(i,n,s,o){for(var a,l=0,h=r.length;l<h;l++){var c=r[l];if(c.code===o){++(a=c).usedTimes;break}}return void 0===a&&(a=new Bt(t,e,o,i,n,s),r.push(a)),a},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}(O,_t,Mt),kt=new It,Ht=new Lt,Ft=new function(t,e,i,n){function r(t,i){e.buffers.color.setClear(t.r,t.g,t.b,i,n)}var s,o,a,l=new j(0),h=0;return{getClearColor:function(){return l},setClearColor:function(t,e){l.set(t),r(l,h=void 0!==e?e:1)},getClearAlpha:function(){return h},setClearAlpha:function(t){r(l,h=t)},render:function(e,n,c,u){null===(n=n.background)?r(l,h):n&&n.isColor&&(r(n,1),u=!0),(t.autoClear||u)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),n&&n.isCubeTexture?(void 0===a&&((a=new At(new xt(1,1,1),new Tt({uniforms:Dr.cube.uniforms,vertexShader:Dr.cube.vertexShader,fragmentShader:Dr.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},i.update(a.geometry)),a.material.uniforms.tCube.value=n,e.push(a,a.geometry,a.material,0,null)):n&&n.isTexture&&(void 0===s&&(s=new nt(-1,1,1,-1,0,1),o=new At(new wt(2,2),new Et({depthTest:!1,depthWrite:!1,fog:!1})),i.update(o.geometry)),o.material.map=n,t.renderBufferDirect(s,null,o.geometry,o.material,o,null))}}}(O,St,Nt,C),jt=new function(t,e,i){var n;this.setMode=function(t){n=t},this.render=function(e,r){t.drawArrays(n,e,r),i.calls++,i.vertices+=r,n===t.TRIANGLES?i.faces+=r/3:n===t.POINTS&&(i.points+=r)},this.renderInstances=function(r,s,o){var a=e.get("ANGLE_instanced_arrays");if(null===a)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var l=r.attributes.position;l.isInterleavedBufferAttribute?(o=l.data.count,a.drawArraysInstancedANGLE(n,0,o,r.maxInstancedCount)):a.drawArraysInstancedANGLE(n,s,o,r.maxInstancedCount),i.calls++,i.vertices+=o*r.maxInstancedCount,n===t.TRIANGLES?i.faces+=r.maxInstancedCount*o/3:n===t.POINTS&&(i.points+=r.maxInstancedCount*o)}}}(bt,_t,gt),Gt=new function(t,e,i){var n,r,s;this.setMode=function(t){n=t},this.setIndex=function(t){r=t.type,s=t.bytesPerElement},this.render=function(e,o){t.drawElements(n,o,r,e*s),i.calls++,i.vertices+=o,n===t.TRIANGLES?i.faces+=o/3:n===t.POINTS&&(i.points+=o)},this.renderInstances=function(o,a,l){var h=e.get("ANGLE_instanced_arrays");null===h?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(h.drawElementsInstancedANGLE(n,l,r,a*s,o.maxInstancedCount),i.calls++,i.vertices+=l*o.maxInstancedCount,n===t.TRIANGLES?i.faces+=o.maxInstancedCount*l/3:n===t.POINTS&&(i.points+=o.maxInstancedCount*l))}}(bt,_t,gt),qt=new function(t,e,n,r,o){var a,l,h,c,u,d,p,f,m,g,v,y,b,x,_;this.render=function(t,w,E,T){if(0!==t.length){w=new s;var M=T.w/T.z,S=.5*T.z,C=.5*T.w,A=new i((D=16/T.w)*M,D),P=new s(1,1,0),R=new i(1,1),L=new G;if(L.min.set(T.x,T.y),L.max.set(T.x+(T.z-16),T.y+(T.w-16)),void 0===b){var D=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),I=new Uint16Array([0,1,2,0,2,3]);v=e.createBuffer(),y=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,D,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,y),e.bufferData(e.ELEMENT_ARRAY_BUFFER,I,e.STATIC_DRAW),x=e.createTexture(),_=e.createTexture(),n.bindTexture(e.TEXTURE_2D,x),e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),n.bindTexture(e.TEXTURE_2D,_),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),D={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\n\tvUV = uv;\n\tvec2 pos = position;\n\tif ( renderType == 2 ) {\n\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\t\tvVisibility =        visibility.r / 9.0;\n\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\tvVisibility *=       visibility.b / 9.0;\n\t\tvVisibility *= 1.0 - visibility.a / 9.0;\n\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\n\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n\t}\n\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\n\tif ( renderType == 0 ) {\n\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n\t} else if ( renderType == 1 ) {\n\t\tgl_FragColor = texture2D( map, vUV );\n\t} else {\n\t\tvec4 texture = texture2D( map, vUV );\n\t\ttexture.a *= opacity * vVisibility;\n\t\tgl_FragColor = texture;\n\t\tgl_FragColor.rgb *= color;\n\t}\n}"},I=e.createProgram();var N=e.createShader(e.FRAGMENT_SHADER),O=e.createShader(e.VERTEX_SHADER),k="precision "+o.precision+" float;\n";e.shaderSource(N,k+D.fragmentShader),e.shaderSource(O,k+D.vertexShader),e.compileShader(N),e.compileShader(O),e.attachShader(I,N),e.attachShader(I,O),e.linkProgram(I),b=I,m=e.getAttribLocation(b,"position"),g=e.getAttribLocation(b,"uv"),a=e.getUniformLocation(b,"renderType"),l=e.getUniformLocation(b,"map"),h=e.getUniformLocation(b,"occlusionMap"),c=e.getUniformLocation(b,"opacity"),u=e.getUniformLocation(b,"color"),d=e.getUniformLocation(b,"scale"),p=e.getUniformLocation(b,"rotation"),f=e.getUniformLocation(b,"screenPosition")}for(n.useProgram(b),n.initAttributes(),n.enableAttribute(m),n.enableAttribute(g),n.disableUnusedAttributes(),e.uniform1i(h,0),e.uniform1i(l,1),e.bindBuffer(e.ARRAY_BUFFER,v),e.vertexAttribPointer(m,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(g,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,y),n.disable(e.CULL_FACE),n.buffers.depth.setMask(!1),I=0,N=t.length;I<N;I++)if(D=16/T.w,A.set(D*M,D),O=t[I],w.set(O.matrixWorld.elements[12],O.matrixWorld.elements[13],O.matrixWorld.elements[14]),w.applyMatrix4(E.matrixWorldInverse),w.applyMatrix4(E.projectionMatrix),P.copy(w),R.x=T.x+P.x*S+S-8,R.y=T.y+P.y*C+C-8,!0===L.containsPoint(R)){n.activeTexture(e.TEXTURE0),n.bindTexture(e.TEXTURE_2D,null),n.activeTexture(e.TEXTURE1),n.bindTexture(e.TEXTURE_2D,x),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,R.x,R.y,16,16,0),e.uniform1i(a,0),e.uniform2f(d,A.x,A.y),e.uniform3f(f,P.x,P.y,P.z),n.disable(e.BLEND),n.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),n.activeTexture(e.TEXTURE0),n.bindTexture(e.TEXTURE_2D,_),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,R.x,R.y,16,16,0),e.uniform1i(a,1),n.disable(e.DEPTH_TEST),n.activeTexture(e.TEXTURE1),n.bindTexture(e.TEXTURE_2D,x),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),O.positionScreen.copy(P),O.customUpdateCallback?O.customUpdateCallback(O):O.updateLensFlares(),e.uniform1i(a,2),n.enable(e.BLEND),k=0;for(var z=O.lensFlares.length;k<z;k++){var H=O.lensFlares[k];.001<H.opacity&&.001<H.scale&&(P.x=H.x,P.y=H.y,P.z=H.z,D=H.size*H.scale/T.w,A.x=D*M,A.y=D,e.uniform3f(f,P.x,P.y,P.z),e.uniform2f(d,A.x,A.y),e.uniform1f(p,H.rotation),e.uniform1f(c,H.opacity),e.uniform3f(u,H.color.r,H.color.g,H.color.b),n.setBlending(H.blending,H.blendEquation,H.blendSrc,H.blendDst),r.setTexture2D(H.texture,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}}n.enable(e.CULL_FACE),n.enable(e.DEPTH_TEST),n.buffers.depth.setMask(!0),n.reset()}}}(O,bt,St,Pt,Mt),Xt=new function(t,e,i,n,o){function a(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var l,h,c,u,d,p,f,m,g,v,y,b,x,_,w,E,T,M,S,C,A,P=new s,R=new r,L=new s;this.render=function(r,s,D){if(0!==r.length){if(void 0===C){var I=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),N=new Uint16Array([0,1,2,0,2,3]);M=e.createBuffer(),S=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,M),e.bufferData(e.ARRAY_BUFFER,I,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,S),e.bufferData(e.ELEMENT_ARRAY_BUFFER,N,e.STATIC_DRAW),I=e.createProgram(),N=e.createShader(e.VERTEX_SHADER);var O=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(N,["precision "+o.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvUV = uvOffset + uv * uvScale;\n\tvec2 alignedPosition = position * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\tfogDepth = - mvPosition.z;\n}"].join("\n")),e.shaderSource(O,["precision "+o.precision+" float;","#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvec4 texture = texture2D( map, vUV );\n\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n\tif ( gl_FragColor.a < alphaTest ) discard;\n\tif ( fogType > 0 ) {\n\t\tfloat fogFactor = 0.0;\n\t\tif ( fogType == 1 ) {\n\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t\t} else {\n\t\t\tconst float LOG2 = 1.442695;\n\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );\n\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\t\t}\n\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\t}\n}"].join("\n")),e.compileShader(N),e.compileShader(O),e.attachShader(I,N),e.attachShader(I,O),e.linkProgram(I),C=I,E=e.getAttribLocation(C,"position"),T=e.getAttribLocation(C,"uv"),l=e.getUniformLocation(C,"uvOffset"),h=e.getUniformLocation(C,"uvScale"),c=e.getUniformLocation(C,"rotation"),u=e.getUniformLocation(C,"scale"),d=e.getUniformLocation(C,"color"),p=e.getUniformLocation(C,"map"),f=e.getUniformLocation(C,"opacity"),m=e.getUniformLocation(C,"modelViewMatrix"),g=e.getUniformLocation(C,"projectionMatrix"),v=e.getUniformLocation(C,"fogType"),y=e.getUniformLocation(C,"fogDensity"),b=e.getUniformLocation(C,"fogNear"),x=e.getUniformLocation(C,"fogFar"),_=e.getUniformLocation(C,"fogColor"),e.getUniformLocation(C,"fogDepth"),w=e.getUniformLocation(C,"alphaTest"),(I=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=8,I.height=8,(N=I.getContext("2d")).fillStyle="white",N.fillRect(0,0,8,8),A=new W(I)}i.useProgram(C),i.initAttributes(),i.enableAttribute(E),i.enableAttribute(T),i.disableUnusedAttributes(),i.disable(e.CULL_FACE),i.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,M),e.vertexAttribPointer(E,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(T,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,S),e.uniformMatrix4fv(g,!1,D.projectionMatrix.elements),i.activeTexture(e.TEXTURE0),e.uniform1i(p,0),N=I=0,(O=s.fog)?(e.uniform3f(_,O.color.r,O.color.g,O.color.b),O.isFog?(e.uniform1f(b,O.near),e.uniform1f(x,O.far),e.uniform1i(v,1),N=I=1):O.isFogExp2&&(e.uniform1f(y,O.density),e.uniform1i(v,2),N=I=2)):(e.uniform1i(v,0),N=I=0);for(var k=0,z=r.length;k<z;k++)(O=r[k]).modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,O.matrixWorld),O.z=-O.modelViewMatrix.elements[14];r.sort(a);var H=[];for(k=0,z=r.length;k<z;k++){var F=(O=r[k]).material;if(!1!==F.visible){O.onBeforeRender(t,s,D,void 0,F,void 0),e.uniform1f(w,F.alphaTest),e.uniformMatrix4fv(m,!1,O.modelViewMatrix.elements),O.matrixWorld.decompose(P,R,L),H[0]=L.x,H[1]=L.y;var U=0;s.fog&&F.fog&&(U=N),I!==U&&(e.uniform1i(v,U),I=U),null!==F.map?(e.uniform2f(l,F.map.offset.x,F.map.offset.y),e.uniform2f(h,F.map.repeat.x,F.map.repeat.y)):(e.uniform2f(l,0,0),e.uniform2f(h,1,1)),e.uniform1f(f,F.opacity),e.uniform3f(d,F.color.r,F.color.g,F.color.b),e.uniform1f(c,F.rotation),e.uniform2fv(u,H),i.setBlending(F.blending,F.blendEquation,F.blendSrc,F.blendDst,F.blendEquationAlpha,F.blendSrcAlpha,F.blendDstAlpha,F.premultipliedAlpha),i.buffers.depth.setTest(F.depthTest),i.buffers.depth.setMask(F.depthWrite),i.buffers.color.setMask(F.colorWrite),n.setTexture2D(F.map||A,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),O.onAfterRender(t,s,D,void 0,F,void 0)}}i.enable(e.CULL_FACE),i.reset()}}}(O,bt,St,Pt,Mt),O.info.programs=zt.programs,O.context=bt,O.capabilities=Mt,O.extensions=_t,O.properties=Ct,O.renderLists=Ht,O.state=St}function a(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function h(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1,e()}function c(t){(t=t.target).removeEventListener("dispose",c),d(t),Ct.remove(t)}function d(t){var e=Ct.get(t).program;t.program=void 0,void 0!==e&&zt.releaseProgram(e)}function p(t){null!==Kt&&Kt(t),(t=$t.getDevice())&&t.isPresenting?t.requestAnimationFrame(p):window.requestAnimationFrame(p)}function f(t,e,i){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isLight)R.push(t),t.castShadow&&L.push(t);else if(t.isSprite)t.frustumCulled&&!at.intersectsSprite(t)||I.push(t);else if(t.isLensFlare)N.push(t);else if(t.isImmediateRenderObject)i&&ft.setFromMatrixPosition(t.matrixWorld).applyMatrix4(dt),D.push(t,null,t.material,ft.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||at.intersectsObject(t))){i&&ft.setFromMatrixPosition(t.matrixWorld).applyMatrix4(dt);var n=Ot.update(t),r=t.material;if(Array.isArray(r))for(var s=n.groups,o=0,a=s.length;o<a;o++){var l=s[o],h=r[l.materialIndex];h&&h.visible&&D.push(t,n,h,ft.z,l)}else r.visible&&D.push(t,n,r,ft.z,null)}for(o=0,a=(t=t.children).length;o<a;o++)f(t[o],e,i)}}function m(t,e,i,n){for(var r=0,s=t.length;r<s;r++){var o=(h=t[r]).object,a=h.geometry,l=void 0===n?h.material:n,h=h.group;if(i.isArrayCamera){q=i;for(var c=i.cameras,u=0,d=c.length;u<d;u++){var p=c[u];if(o.layers.test(p.layers)){var f=p.bounds;St.viewport(X.set(f.x*tt,f.y*et,f.z*tt,f.w*et).multiplyScalar(it)),g(o,e,p,a,l,h)}}}else q=null,g(o,e,i,a,l,h)}}function g(t,e,i,n,r,s){if(t.onBeforeRender(O,e,i,n,r,s),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=t.isMesh&&0>t.matrixWorld.determinant();St.setMaterial(r,o),o=y(i,e.fog,r,t),U="",function(t,e,i){t.render(function(t){O.renderBufferImmediate(t,e,i)})}(t,o,r)}else O.renderBufferDirect(i,e.fog,n,r,t,s);t.onAfterRender(O,e,i,n,r,s)}function v(t,e,i){var n=Ct.get(t);i=zt.getParameters(t,kt.state,L,e,lt.numPlanes,lt.numIntersection,i);var r=zt.getProgramCode(t,i),s=n.program,o=!0;if(void 0===s)t.addEventListener("dispose",c);else if(s.code!==r)d(t);else{if(void 0!==i.shaderID)return;o=!1}if(o&&(i.shaderID?(s=Dr[i.shaderID],n.shader={name:t.type,uniforms:Rr.clone(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}):n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(n.shader),s=zt.acquireProgram(t,n.shader,i,r),n.program=s,t.program=s),i=s.getAttributes(),t.morphTargets)for(r=t.numSupportedMorphTargets=0;r<O.maxMorphTargets;r++)0<=i["morphTarget"+r]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(r=t.numSupportedMorphNormals=0;r<O.maxMorphNormals;r++)0<=i["morphNormal"+r]&&t.numSupportedMorphNormals++;i=n.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=lt.numPlanes,n.numIntersection=lt.numIntersection,i.clippingPlanes=lt.uniform),n.fog=e,n.lightsHash=kt.state.hash,t.lights&&(i.ambientLightColor.value=kt.state.ambient,i.directionalLights.value=kt.state.directional,i.spotLights.value=kt.state.spot,i.rectAreaLights.value=kt.state.rectArea,i.pointLights.value=kt.state.point,i.hemisphereLights.value=kt.state.hemi,i.directionalShadowMap.value=kt.state.directionalShadowMap,i.directionalShadowMatrix.value=kt.state.directionalShadowMatrix,i.spotShadowMap.value=kt.state.spotShadowMap,i.spotShadowMatrix.value=kt.state.spotShadowMatrix,i.pointShadowMap.value=kt.state.pointShadowMap,i.pointShadowMatrix.value=kt.state.pointShadowMatrix),t=n.program.getUniforms(),t=B.seqWithValue(t.seq,i),n.uniformsList=t}function y(t,e,i,n){Q=0;var r=Ct.get(i);ht&&(ct||t!==V)&&lt.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,t===V&&i.id===F),!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:i.lights&&r.lightsHash!==kt.state.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===lt.numPlanes&&r.numIntersection===lt.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(v(i,e,n),i.needsUpdate=!1);var s=!1,o=!1,a=!1,l=r.program,h=l.getUniforms(),c=r.shader.uniforms;if(St.useProgram(l.program)&&(a=o=s=!0),i.id!==F&&(F=i.id,o=!0),(s||t!==V)&&(h.setValue(bt,"projectionMatrix",t.projectionMatrix),Mt.logarithmicDepthBuffer&&h.setValue(bt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),V!==(q||t)&&(V=q||t,a=o=!0),(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)&&void 0!==(s=h.map.cameraPosition)&&s.setValue(bt,ft.setFromMatrixPosition(t.matrixWorld)),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&h.setValue(bt,"viewMatrix",t.matrixWorldInverse)),i.skinning&&(h.setOptional(bt,n,"bindMatrix"),h.setOptional(bt,n,"bindMatrixInverse"),t=n.skeleton))if(s=t.bones,Mt.floatVertexTextures){if(void 0===t.boneTexture){s=Math.sqrt(4*s.length),s=br.ceilPowerOfTwo(s),s=Math.max(s,4);var d=new Float32Array(s*s*4);d.set(t.boneMatrices);var p=new u(d,s,s,1023,1015);t.boneMatrices=d,t.boneTexture=p,t.boneTextureSize=s}h.setValue(bt,"boneTexture",t.boneTexture),h.setValue(bt,"boneTextureSize",t.boneTextureSize)}else h.setOptional(bt,t,"boneMatrices");return o&&(h.setValue(bt,"toneMappingExposure",O.toneMappingExposure),h.setValue(bt,"toneMappingWhitePoint",O.toneMappingWhitePoint),i.lights&&(o=a,c.ambientLightColor.needsUpdate=o,c.directionalLights.needsUpdate=o,c.pointLights.needsUpdate=o,c.spotLights.needsUpdate=o,c.rectAreaLights.needsUpdate=o,c.hemisphereLights.needsUpdate=o),e&&i.fog&&(c.fogColor.value=e.color,e.isFog?(c.fogNear.value=e.near,c.fogFar.value=e.far):e.isFogExp2&&(c.fogDensity.value=e.density)),i.isMeshBasicMaterial?b(c,i):i.isMeshLambertMaterial?(b(c,i),i.emissiveMap&&(c.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(b(c,i),i.isMeshToonMaterial?(x(c,i),i.gradientMap&&(c.gradientMap.value=i.gradientMap)):x(c,i)):i.isMeshStandardMaterial?(b(c,i),i.isMeshPhysicalMaterial&&(c.clearCoat.value=i.clearCoat,c.clearCoatRoughness.value=i.clearCoatRoughness),c.roughness.value=i.roughness,c.metalness.value=i.metalness,i.roughnessMap&&(c.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(c.metalnessMap.value=i.metalnessMap),i.emissiveMap&&(c.emissiveMap.value=i.emissiveMap),i.bumpMap&&(c.bumpMap.value=i.bumpMap,c.bumpScale.value=i.bumpScale),i.normalMap&&(c.normalMap.value=i.normalMap,c.normalScale.value.copy(i.normalScale)),i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias),i.envMap&&(c.envMapIntensity.value=i.envMapIntensity)):i.isMeshDepthMaterial?(b(c,i),i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(b(c,i),i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias),c.referencePosition.value.copy(i.referencePosition),c.nearDistance.value=i.nearDistance,c.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(b(c,i),i.bumpMap&&(c.bumpMap.value=i.bumpMap,c.bumpScale.value=i.bumpScale),i.normalMap&&(c.normalMap.value=i.normalMap,c.normalScale.value.copy(i.normalScale)),i.displacementMap&&(c.displacementMap.value=i.displacementMap,c.displacementScale.value=i.displacementScale,c.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(c.diffuse.value=i.color,c.opacity.value=i.opacity,i.isLineDashedMaterial&&(c.dashSize.value=i.dashSize,c.totalSize.value=i.dashSize+i.gapSize,c.scale.value=i.scale)):i.isPointsMaterial?(c.diffuse.value=i.color,c.opacity.value=i.opacity,c.size.value=i.size*it,c.scale.value=.5*et,c.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&(e=i.map.offset,o=i.map.repeat,a=i.map.center,i.map.matrix.setUvTransform(e.x,e.y,o.x,o.y,i.map.rotation,a.x,a.y)),c.uvTransform.value.copy(i.map.matrix))):i.isShadowMaterial&&(c.color.value=i.color,c.opacity.value=i.opacity),void 0!==c.ltcMat&&(c.ltcMat.value=Pr.LTC_MAT_TEXTURE),void 0!==c.ltcMag&&(c.ltcMag.value=Pr.LTC_MAG_TEXTURE),B.upload(bt,r.uniformsList,c,O)),h.setValue(bt,"modelViewMatrix",n.modelViewMatrix),h.setValue(bt,"normalMatrix",n.normalMatrix),h.setValue(bt,"modelMatrix",n.matrixWorld),l}function b(t,e){if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map)var i=e.map;else e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap);if(void 0!==i){if(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate){e=i.offset;var n=i.repeat,r=i.center;i.matrix.setUvTransform(e.x,e.y,n.x,n.y,i.rotation,r.x,r.y)}t.uvTransform.value.copy(i.matrix)}}function x(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}console.log("THREE.WebGLRenderer","89");var _=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),w=void 0!==t.context?t.context:null,E=void 0!==t.alpha&&t.alpha,T=void 0===t.depth||t.depth,M=void 0===t.stencil||t.stencil,S=void 0!==t.antialias&&t.antialias,C=void 0===t.premultipliedAlpha||t.premultipliedAlpha,A=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,P=void 0!==t.powerPreference?t.powerPreference:"default",R=[],L=[],D=null,I=[],N=[];this.domElement=_,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var O=this,k=!1,z=null,H=null,F=-1,U="",V=null,q=null,X=new l,Y=new l,$=null,Q=0,tt=_.width,et=_.height,it=1,rt=new l(0,0,tt,et),st=new l(0,0,tt,et),ot=!1,at=new Z,lt=new function(){function t(){c.value!==n&&(c.value=n,c.needsUpdate=0<r),i.numPlanes=r,i.numIntersection=0}function e(t,e,n,r){var s=null!==t?t.length:0,o=null;if(0!==s){if(o=c.value,!0!==r||null===o)for(r=n+4*s,e=e.matrixWorldInverse,h.getNormalMatrix(e),(null===o||o.length<r)&&(o=new Float32Array(r)),r=0;r!==s;++r,n+=4)l.copy(t[r]).applyMatrix4(e,h),l.normal.toArray(o,n),o[n+3]=l.constant;c.value=o,c.needsUpdate=!0}return i.numPlanes=s,o}var i=this,n=null,r=0,s=!1,a=!1,l=new J,h=new o,c={value:null,needsUpdate:!1};this.uniform=c,this.numIntersection=this.numPlanes=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==r||s;return s=i,n=e(t,o,0),r=t.length,a},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(i,o,l,h,u,d){if(!s||null===i||0===i.length||a&&!l)a?e(null):t();else{var p=4*(l=a?0:r),f=u.clippingState||null;for(c.value=f,f=e(i,h,p,d),i=0;i!==p;++i)f[i]=n[i];u.clippingState=f,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=l}}},ht=!1,ct=!1,dt=new n,ft=new s,mt={geometries:0,textures:0},gt={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:gt,memory:mt,programs:null};try{E={alpha:E,depth:T,stencil:M,antialias:S,premultipliedAlpha:C,preserveDrawingBuffer:A,powerPreference:P},_.addEventListener("webglcontextlost",a,!1),_.addEventListener("webglcontextrestored",h,!1);var bt=w||_.getContext("webgl",E)||_.getContext("experimental-webgl",E);if(null===bt){if(null!==_.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===bt.getShaderPrecisionFormat&&(bt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}var _t,Mt,St,Ct,Pt,Rt,Nt,Ot,kt,zt,Ht,Ft,Ut,jt,Gt,qt,Xt,Yt;e();var $t=new Wt(O);this.vr=$t;var Jt=new K(O,Ot,Mt.maxTextureSize);this.shadowMap=Jt,this.getContext=function(){return bt},this.getContextAttributes=function(){return bt.getContextAttributes()},this.forceContextLoss=function(){var t=_t.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=_t.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return it},this.setPixelRatio=function(t){void 0!==t&&(it=t,this.setSize(tt,et,!1))},this.getSize=function(){return{width:tt,height:et}},this.setSize=function(t,e,i){var n=$t.getDevice();n&&n.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(tt=t,et=e,_.width=t*it,_.height=e*it,!1!==i&&(_.style.width=t+"px",_.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:tt*it,height:et*it}},this.setDrawingBufferSize=function(t,e,i){tt=t,et=e,it=i,_.width=t*i,_.height=e*i,this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,n){rt.set(t,et-e-n,i,n),St.viewport(X.copy(rt).multiplyScalar(it))},this.setScissor=function(t,e,i,n){st.set(t,et-e-n,i,n),St.scissor(Y.copy(st).multiplyScalar(it))},this.setScissorTest=function(t){St.setScissorTest(ot=t)},this.getClearColor=function(){return Ft.getClearColor()},this.setClearColor=function(){Ft.setClearColor.apply(Ft,arguments)},this.getClearAlpha=function(){return Ft.getClearAlpha()},this.setClearAlpha=function(){Ft.setClearAlpha.apply(Ft,arguments)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=bt.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=bt.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=bt.STENCIL_BUFFER_BIT),bt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.dispose=function(){_.removeEventListener("webglcontextlost",a,!1),_.removeEventListener("webglcontextrestored",h,!1),Ht.dispose(),$t.dispose()},this.renderBufferImmediate=function(t,e,i){St.initAttributes();var n=Ct.get(t);if(t.hasPositions&&!n.position&&(n.position=bt.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=bt.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=bt.createBuffer()),t.hasColors&&!n.color&&(n.color=bt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(bt.bindBuffer(bt.ARRAY_BUFFER,n.position),bt.bufferData(bt.ARRAY_BUFFER,t.positionArray,bt.DYNAMIC_DRAW),St.enableAttribute(e.position),bt.vertexAttribPointer(e.position,3,bt.FLOAT,!1,0,0)),t.hasNormals){if(bt.bindBuffer(bt.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&!0===i.flatShading)for(var r=0,s=3*t.count;r<s;r+=9){var o=t.normalArray,a=(o[r+0]+o[r+3]+o[r+6])/3,l=(o[r+1]+o[r+4]+o[r+7])/3,h=(o[r+2]+o[r+5]+o[r+8])/3;o[r+0]=a,o[r+1]=l,o[r+2]=h,o[r+3]=a,o[r+4]=l,o[r+5]=h,o[r+6]=a,o[r+7]=l,o[r+8]=h}bt.bufferData(bt.ARRAY_BUFFER,t.normalArray,bt.DYNAMIC_DRAW),St.enableAttribute(e.normal),bt.vertexAttribPointer(e.normal,3,bt.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(bt.bindBuffer(bt.ARRAY_BUFFER,n.uv),bt.bufferData(bt.ARRAY_BUFFER,t.uvArray,bt.DYNAMIC_DRAW),St.enableAttribute(e.uv),bt.vertexAttribPointer(e.uv,2,bt.FLOAT,!1,0,0)),t.hasColors&&0!==i.vertexColors&&(bt.bindBuffer(bt.ARRAY_BUFFER,n.color),bt.bufferData(bt.ARRAY_BUFFER,t.colorArray,bt.DYNAMIC_DRAW),St.enableAttribute(e.color),bt.vertexAttribPointer(e.color,3,bt.FLOAT,!1,0,0)),St.disableUnusedAttributes(),bt.drawArrays(bt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,s){var o=r.isMesh&&0>r.matrixWorld.determinant();St.setMaterial(n,o);var a=y(t,e,n,r),l=!1;(t=i.id+"_"+a.id+"_"+(!0===n.wireframe))!==U&&(U=t,l=!0),r.morphTargetInfluences&&(Ut.update(r,i,n,a),l=!0);o=i.index;var h=i.attributes.position;if(e=1,!0===n.wireframe&&(o=Nt.getWireframeAttribute(i),e=2),t=jt,null!==o){var c=Rt.get(o);(t=Gt).setIndex(c)}if(l){if(l=void 0,i&&i.isInstancedBufferGeometry&&null===_t.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===l&&(l=0),St.initAttributes();var u=i.attributes,d=(a=a.getAttributes(),n.defaultAttributeValues);for(E in a){var p=a[E];if(0<=p){if(void 0!==(w=u[E])){var f=w.normalized,m=w.itemSize;if(void 0!==(b=Rt.get(w))){var g=b.buffer,v=b.type,b=b.bytesPerElement;if(w.isInterleavedBufferAttribute){var x=w.data,_=x.stride,w=w.offset;x&&x.isInstancedInterleavedBuffer?(St.enableAttributeAndDivisor(p,x.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=x.meshPerAttribute*x.count)):St.enableAttribute(p),bt.bindBuffer(bt.ARRAY_BUFFER,g),bt.vertexAttribPointer(p,m,v,f,_*b,(l*_+w)*b)}else w.isInstancedBufferAttribute?(St.enableAttributeAndDivisor(p,w.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=w.meshPerAttribute*w.count)):St.enableAttribute(p),bt.bindBuffer(bt.ARRAY_BUFFER,g),bt.vertexAttribPointer(p,m,v,f,0,l*m*b)}}else if(void 0!==d&&void 0!==(f=d[E]))switch(f.length){case 2:bt.vertexAttrib2fv(p,f);break;case 3:bt.vertexAttrib3fv(p,f);break;case 4:bt.vertexAttrib4fv(p,f);break;default:bt.vertexAttrib1fv(p,f)}}}St.disableUnusedAttributes()}null!==o&&bt.bindBuffer(bt.ELEMENT_ARRAY_BUFFER,c.buffer)}c=0,null!==o?c=o.count:void 0!==h&&(c=h.count),o=i.drawRange.start*e,h=null!==s?s.start*e:0;var E=Math.max(o,h);if(0!==(s=Math.max(0,Math.min(c,o+i.drawRange.count*e,h+(null!==s?s.count*e:1/0))-1-E+1))){if(r.isMesh)if(!0===n.wireframe)St.setLineWidth(n.wireframeLinewidth*(null===z?it:1)),t.setMode(bt.LINES);else switch(r.drawMode){case 0:t.setMode(bt.TRIANGLES);break;case 1:t.setMode(bt.TRIANGLE_STRIP);break;case 2:t.setMode(bt.TRIANGLE_FAN)}else r.isLine?(void 0===(n=n.linewidth)&&(n=1),St.setLineWidth(n*(null===z?it:1)),r.isLineSegments?t.setMode(bt.LINES):r.isLineLoop?t.setMode(bt.LINE_LOOP):t.setMode(bt.LINE_STRIP)):r.isPoints&&t.setMode(bt.POINTS);i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&t.renderInstances(i,E,s):t.render(E,s)}},this.compile=function(t,e){R.length=0,L.length=0,t.traverse(function(t){t.isLight&&(R.push(t),t.castShadow&&L.push(t))}),kt.setup(R,L,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var i=0;i<e.material.length;i++)v(e.material[i],t.fog,e);else v(e.material,t.fog,e)})};var Zt=!1,Kt=null;this.animate=function(t){Kt=t,Zt||((t=$t.getDevice())&&t.isPresenting?t.requestAnimationFrame(p):window.requestAnimationFrame(p),Zt=!0)},this.render=function(t,e,i,n){if(e&&e.isCamera){if(!k){U="",F=-1,V=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),$t.enabled&&(e=$t.getCamera(e)),dt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),at.setFromMatrix(dt),R.length=0,L.length=0,I.length=0,N.length=0,ct=this.localClippingEnabled,ht=lt.init(this.clippingPlanes,ct,e),(D=Ht.get(t,e)).init(),f(t,e,O.sortObjects),!0===O.sortObjects&&D.sort(),Pt.updateVideoTextures(),ht&&lt.beginShadows(),Jt.render(L,t,e),kt.setup(R,L,e),ht&&lt.endShadows(),gt.frame++,gt.calls=0,gt.vertices=0,gt.faces=0,gt.points=0,void 0===i&&(i=null),this.setRenderTarget(i),Ft.render(D,t,e,n),n=D.opaque;var r=D.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;n.length&&m(n,t,e,s),r.length&&m(r,t,e,s)}else n.length&&m(n,t,e),r.length&&m(r,t,e);Xt.render(I,t,e),qt.render(N,t,e,X),i&&Pt.updateRenderTargetMipmap(i),St.buffers.depth.setTest(!0),St.buffers.depth.setMask(!0),St.buffers.color.setMask(!0),St.setPolygonOffset(!1),$t.enabled&&$t.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){St.setCullFace(t),St.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=Q;return t>=Mt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+Mt.maxTextures),Q+=1,t},this.setTexture2D=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Pt.setTexture2D(e,i)}}(),this.setTexture=function(){var t=!1;return function(e,i){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Pt.setTexture2D(e,i)}}(),this.setTextureCube=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Pt.setTextureCube(e,i):Pt.setTextureCubeDynamic(e,i)}}(),this.getRenderTarget=function(){return z},this.setRenderTarget=function(t){(z=t)&&void 0===Ct.get(t).__webglFramebuffer&&Pt.setupRenderTarget(t);var e=null,i=!1;t?(e=Ct.get(t).__webglFramebuffer,t.isWebGLRenderTargetCube&&(e=e[t.activeCubeFace],i=!0),X.copy(t.viewport),Y.copy(t.scissor),$=t.scissorTest):(X.copy(rt).multiplyScalar(it),Y.copy(st).multiplyScalar(it),$=ot),H!==e&&(bt.bindFramebuffer(bt.FRAMEBUFFER,e),H=e),St.viewport(X),St.scissor(Y),St.setScissorTest($),i&&(i=Ct.get(t.texture),bt.framebufferTexture2D(bt.FRAMEBUFFER,bt.COLOR_ATTACHMENT0,bt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel))},this.readRenderTargetPixels=function(t,e,i,n,r,s){if(t&&t.isWebGLRenderTarget){var o=Ct.get(t).__webglFramebuffer;if(o){var a=!1;o!==H&&(bt.bindFramebuffer(bt.FRAMEBUFFER,o),a=!0);try{var l=t.texture,h=l.format,c=l.type;1023!==h&&Yt.convert(h)!==bt.getParameter(bt.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===c||Yt.convert(c)===bt.getParameter(bt.IMPLEMENTATION_COLOR_READ_TYPE)||1015===c&&(_t.get("OES_texture_float")||_t.get("WEBGL_color_buffer_float"))||1016===c&&_t.get("EXT_color_buffer_half_float")?bt.checkFramebufferStatus(bt.FRAMEBUFFER)===bt.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-n&&0<=i&&i<=t.height-r&&bt.readPixels(e,i,n,r,Yt.convert(h),Yt.convert(c),s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{a&&bt.bindFramebuffer(bt.FRAMEBUFFER,H)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function Xt(t,e){this.name="",this.color=new j(t),this.density=void 0!==e?e:25e-5}function Yt(t,e,i){this.name="",this.color=new j(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function $t(){et.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function Jt(t,e,i,n,r){et.call(this),this.lensFlares=[],this.positionScreen=new s,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)}function Zt(t){V.call(this),this.type="SpriteMaterial",this.color=new j(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function Kt(t){et.call(this),this.type="Sprite",this.material=void 0!==t?t:new Zt}function Qt(){et.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function te(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new n)}function ee(){et.call(this),this.type="Bone"}function ie(t,e){At.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new n,this.bindMatrixInverse=new n,t=new te(t=this.initBones()),this.bind(t,this.matrixWorld),this.normalizeSkinWeights()}function ne(t){V.call(this),this.type="LineBasicMaterial",this.color=new j(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function re(t,e,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new se(t,e);et.call(this),this.type="Line",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new ne({color:16777215*Math.random()})}function se(t,e){re.call(this,t,e),this.type="LineSegments"}function oe(t,e){re.call(this,t,e),this.type="LineLoop"}function ae(t){V.call(this),this.type="PointsMaterial",this.color=new j(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function le(t,e){et.call(this),this.type="Points",this.geometry=void 0!==t?t:new yt,this.material=void 0!==e?e:new ae({color:16777215*Math.random()})}function he(){et.call(this),this.type="Group"}function ce(t,e,i,n,r,s,o,l,h){function c(){t.removeEventListener("loadeddata",c,!1),u.needsUpdate=!0}a.call(this,t,e,i,n,r,s,o,l,h),this.generateMipmaps=!1;var u=this;t.addEventListener("loadeddata",c,!1)}function ue(t,e,i,n,r,s,o,l,h,c,u,d){a.call(this,null,s,o,l,h,c,n,r,u,d),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function de(t,e,i,n,r,s,o,l,h,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&1026===c&&(i=1012),void 0===i&&1027===c&&(i=1020),a.call(this,null,n,r,s,o,l,c,i,h),this.image={width:t,height:e},this.magFilter=void 0!==o?o:1003,this.minFilter=void 0!==l?l:1003,this.generateMipmaps=this.flipY=!1}function pe(t){yt.call(this),this.type="WireframeGeometry";var e,i,n,r=[],o=[0,0],a={},l=["a","b","c"];if(t&&t.isGeometry){var h=t.faces,c=0;for(i=h.length;c<i;c++){var u=h[c];for(e=0;3>e;e++){var d=u[l[e]],p=u[l[(e+1)%3]];o[0]=Math.min(d,p),o[1]=Math.max(d,p),void 0===a[d=o[0]+","+o[1]]&&(a[d]={index1:o[0],index2:o[1]})}}for(d in a)c=a[d],l=t.vertices[c.index1],r.push(l.x,l.y,l.z),l=t.vertices[c.index2],r.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){l=new s;if(null!==t.index){h=t.attributes.position,u=t.index;var f=t.groups;for(0===f.length&&(f=[{start:0,count:u.count,materialIndex:0}]),t=0,n=f.length;t<n;++t)for(c=f[t],e=c.start,i=c.count,c=e,i=e+i;c<i;c+=3)for(e=0;3>e;e++)d=u.getX(c+e),p=u.getX(c+(e+1)%3),o[0]=Math.min(d,p),o[1]=Math.max(d,p),d=o[0]+","+o[1],void 0===a[d]&&(a[d]={index1:o[0],index2:o[1]});for(d in a)c=a[d],l.fromBufferAttribute(h,c.index1),r.push(l.x,l.y,l.z),l.fromBufferAttribute(h,c.index2),r.push(l.x,l.y,l.z)}else for(h=t.attributes.position,c=0,i=h.count/3;c<i;c++)for(e=0;3>e;e++)a=3*c+e,l.fromBufferAttribute(h,a),r.push(l.x,l.y,l.z),a=3*c+(e+1)%3,l.fromBufferAttribute(h,a),r.push(l.x,l.y,l.z)}this.addAttribute("position",new ft(r,3))}function fe(t,e,i){st.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new me(t,e,i)),this.mergeVertices()}function me(t,e,i){yt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,o=[],a=[],l=[],h=[],c=new s,u=new s,d=new s,p=new s,f=new s,m=e+1;for(n=0;n<=i;n++){var g=n/i;for(r=0;r<=e;r++){var v=r/e;u=t(v,g,u);a.push(u.x,u.y,u.z),0<=v-1e-5?(d=t(v-1e-5,g,d),p.subVectors(u,d)):(d=t(v+1e-5,g,d),p.subVectors(d,u)),0<=g-1e-5?(d=t(v,g-1e-5,d),f.subVectors(u,d)):(d=t(v,g+1e-5,d),f.subVectors(d,u)),c.crossVectors(p,f).normalize(),l.push(c.x,c.y,c.z),h.push(v,g)}}for(n=0;n<i;n++)for(r=0;r<e;r++)t=n*m+r+1,c=(n+1)*m+r+1,u=(n+1)*m+r,o.push(n*m+r,t,u),o.push(t,c,u);this.setIndex(o),this.addAttribute("position",new ft(a,3)),this.addAttribute("normal",new ft(l,3)),this.addAttribute("uv",new ft(h,2))}function ge(t,e,i,n){st.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new ve(t,e,i,n)),this.mergeVertices()}function ve(t,e,n,r){function o(t){h.push(t.x,t.y,t.z)}function a(e,i){e*=3,i.x=t[e+0],i.y=t[e+1],i.z=t[e+2]}function l(t,e,i,n){0>n&&1===t.x&&(c[e]=t.x-1),0===i.x&&0===i.z&&(c[e]=n/2/Math.PI+.5)}yt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var h=[],c=[];!function(t){for(var i=new s,n=new s,r=new s,l=0;l<e.length;l+=3){a(e[l+0],i),a(e[l+1],n),a(e[l+2],r);var h,c,u=i,d=n,p=r,f=Math.pow(2,t),m=[];for(c=0;c<=f;c++){m[c]=[];var g=u.clone().lerp(p,c/f),v=d.clone().lerp(p,c/f),y=f-c;for(h=0;h<=y;h++)m[c][h]=0===h&&c===f?g:g.clone().lerp(v,h/y)}for(c=0;c<f;c++)for(h=0;h<2*(f-c)-1;h++)u=Math.floor(h/2),0==h%2?(o(m[c][u+1]),o(m[c+1][u]),o(m[c][u])):(o(m[c][u+1]),o(m[c+1][u+1]),o(m[c+1][u]))}}(r=r||0),function(t){for(var e=new s,i=0;i<h.length;i+=3)e.x=h[i+0],e.y=h[i+1],e.z=h[i+2],e.normalize().multiplyScalar(t),h[i+0]=e.x,h[i+1]=e.y,h[i+2]=e.z}(n),function(){for(var t=new s,e=0;e<h.length;e+=3)t.x=h[e+0],t.y=h[e+1],t.z=h[e+2],c.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));t=new s,e=new s;for(var n=new s,r=new s,o=new i,a=new i,u=new i,d=0,p=0;d<h.length;d+=9,p+=6){t.set(h[d+0],h[d+1],h[d+2]),e.set(h[d+3],h[d+4],h[d+5]),n.set(h[d+6],h[d+7],h[d+8]),o.set(c[p+0],c[p+1]),a.set(c[p+2],c[p+3]),u.set(c[p+4],c[p+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=Math.atan2(r.z,-r.x);l(o,p+0,t,f),l(a,p+2,e,f),l(u,p+4,n,f)}for(t=0;t<c.length;t+=6)e=c[t+0],n=c[t+2],r=c[t+4],o=Math.min(e,n,r),.9<Math.max(e,n,r)&&.1>o&&(.2>e&&(c[t+0]+=1),.2>n&&(c[t+2]+=1),.2>r&&(c[t+4]+=1))}(),this.addAttribute("position",new ft(h,3)),this.addAttribute("normal",new ft(h.slice(),3)),this.addAttribute("uv",new ft(c,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function ye(t,e){st.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new be(t,e)),this.mergeVertices()}function be(t,e){ve.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function xe(t,e){st.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new _e(t,e)),this.mergeVertices()}function _e(t,e){ve.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function we(t,e){st.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ee(t,e)),this.mergeVertices()}function Ee(t,e){var i=(1+Math.sqrt(5))/2;ve.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Te(t,e){st.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Me(t,e)),this.mergeVertices()}function Me(t,e){var i=(1+Math.sqrt(5))/2,n=1/i;ve.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Se(t,e,i,n,r,s){st.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==s&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Ce(t,e,i,n,r),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Ce(t,e,n,r,o){function a(i){f=t.getPointAt(i/e,f);var s=l.normals[i];for(i=l.binormals[i],c=0;c<=r;c++){var o=c/r*Math.PI*2,a=Math.sin(o);o=-Math.cos(o);d.x=o*s.x+a*i.x,d.y=o*s.y+a*i.y,d.z=o*s.z+a*i.z,d.normalize(),g.push(d.x,d.y,d.z),u.x=f.x+n*d.x,u.y=f.y+n*d.y,u.z=f.z+n*d.z,m.push(u.x,u.y,u.z)}}yt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:o},e=e||64,n=n||1,r=r||8,o=o||!1;var l=t.computeFrenetFrames(e,o);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;var h,c,u=new s,d=new s,p=new i,f=new s,m=[],g=[],v=[],y=[];for(h=0;h<e;h++)a(h);for(a(!1===o?e:0),h=0;h<=e;h++)for(c=0;c<=r;c++)p.x=h/e,p.y=c/r,v.push(p.x,p.y);!function(){for(c=1;c<=e;c++)for(h=1;h<=r;h++){var t=(r+1)*c+(h-1),i=(r+1)*c+h,n=(r+1)*(c-1)+h;y.push((r+1)*(c-1)+(h-1),t,n),y.push(t,i,n)}}(),this.setIndex(y),this.addAttribute("position",new ft(m,3)),this.addAttribute("normal",new ft(g,3)),this.addAttribute("uv",new ft(v,2))}function Ae(t,e,i,n,r,s,o){st.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:s},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Pe(t,e,i,n,r,s)),this.mergeVertices()}function Pe(t,e,i,n,r,o){function a(t,e,i,n,r){var s=Math.sin(t);e=i/e*t,i=Math.cos(e),r.x=n*(2+i)*.5*Math.cos(t),r.y=n*(2+i)*s*.5,r.z=n*Math.sin(e)*.5}yt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:o},t=t||1,e=e||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,o=o||3;var l,h=[],c=[],u=[],d=[],p=new s,f=new s,m=new s,g=new s,v=new s,y=new s,b=new s;for(l=0;l<=i;++l){var x=l/i*r*Math.PI*2;for(a(x,r,o,t,m),a(x+.01,r,o,t,g),y.subVectors(g,m),b.addVectors(g,m),v.crossVectors(y,b),b.crossVectors(v,y),v.normalize(),b.normalize(),x=0;x<=n;++x){var _=x/n*Math.PI*2,w=-e*Math.cos(_);_=e*Math.sin(_);p.x=m.x+(w*b.x+_*v.x),p.y=m.y+(w*b.y+_*v.y),p.z=m.z+(w*b.z+_*v.z),c.push(p.x,p.y,p.z),f.subVectors(p,m).normalize(),u.push(f.x,f.y,f.z),d.push(l/i),d.push(x/n)}}for(x=1;x<=i;x++)for(l=1;l<=n;l++)t=(n+1)*x+(l-1),e=(n+1)*x+l,r=(n+1)*(x-1)+l,h.push((n+1)*(x-1)+(l-1),t,r),h.push(t,e,r);this.setIndex(h),this.addAttribute("position",new ft(c,3)),this.addAttribute("normal",new ft(u,3)),this.addAttribute("uv",new ft(d,2))}function Re(t,e,i,n,r){st.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Le(t,e,i,n,r)),this.mergeVertices()}function Le(t,e,i,n,r){yt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||1,e=e||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var o,a,l=[],h=[],c=[],u=[],d=new s,p=new s,f=new s;for(o=0;o<=i;o++)for(a=0;a<=n;a++){var m=a/n*r,g=o/i*Math.PI*2;p.x=(t+e*Math.cos(g))*Math.cos(m),p.y=(t+e*Math.cos(g))*Math.sin(m),p.z=e*Math.sin(g),h.push(p.x,p.y,p.z),d.x=t*Math.cos(m),d.y=t*Math.sin(m),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),u.push(a/n),u.push(o/i)}for(o=1;o<=i;o++)for(a=1;a<=n;a++)t=(n+1)*(o-1)+a-1,e=(n+1)*(o-1)+a,r=(n+1)*o+a,l.push((n+1)*o+a-1,t,r),l.push(t,e,r);this.setIndex(l),this.addAttribute("position",new ft(h,3)),this.addAttribute("normal",new ft(c,3)),this.addAttribute("uv",new ft(u,2))}function De(t,e,i,n,r){for(var s,o=0,a=e,l=i-n;a<i;a+=n)o+=(t[l]-t[a])*(t[a+1]+t[l+1]),l=a;if(r===0<o)for(r=e;r<i;r+=n)s=Ve(r,t[r],t[r+1],s);else for(r=i-n;r>=e;r-=n)s=Ve(r,t[r],t[r+1],s);return s&&Be(s,s.next)&&(qe(s),s=s.next),s}function Ie(t,e){if(!t)return t;e||(e=t);do{var i=!1;if(t.steiner||!Be(t,t.next)&&0!==Ue(t.prev,t,t.next))t=t.next;else{if(qe(t),(t=e=t.prev)===t.next)break;i=!0}}while(i||t!==e);return e}function Ne(t,e,i,n,r,s,o){if(t){if(!o&&s){var a=d=t;do{null===a.z&&(a.z=ze(a.x,a.y,n,r,s)),a.prevZ=a.prev,a=a.nextZ=a.next}while(a!==d);a.prevZ.nextZ=null,a.prevZ=null;var l,h,c,u,d=a,p=1;do{a=d;var f=d=null;for(h=0;a;){h++;var m=a;for(l=c=0;l<p&&(c++,m=m.nextZ);l++);for(u=p;0<c||0<u&&m;)0!==c&&(0===u||!m||a.z<=m.z)?(l=a,a=a.nextZ,c--):(l=m,m=m.nextZ,u--),f?f.nextZ=l:d=l,l.prevZ=f,f=l;a=m}f.nextZ=null,p*=2}while(1<h)}for(d=t;t.prev!==t.next;){if(a=t.prev,m=t.next,s)t:{u=n;var g=r,v=s;if(h=(f=t).prev,c=f,p=f.next,0<=Ue(h,c,p))f=!1;else{var y=h.x>c.x?h.x>p.x?h.x:p.x:c.x>p.x?c.x:p.x,b=h.y>c.y?h.y>p.y?h.y:p.y:c.y>p.y?c.y:p.y;for(l=ze(h.x<c.x?h.x<p.x?h.x:p.x:c.x<p.x?c.x:p.x,h.y<c.y?h.y<p.y?h.y:p.y:c.y<p.y?c.y:p.y,u,g,v),u=ze(y,b,u,g,v),g=f.nextZ;g&&g.z<=u;){if(g!==f.prev&&g!==f.next&&Fe(h.x,h.y,c.x,c.y,p.x,p.y,g.x,g.y)&&0<=Ue(g.prev,g,g.next)){f=!1;break t}g=g.nextZ}for(g=f.prevZ;g&&g.z>=l;){if(g!==f.prev&&g!==f.next&&Fe(h.x,h.y,c.x,c.y,p.x,p.y,g.x,g.y)&&0<=Ue(g.prev,g,g.next)){f=!1;break t}g=g.prevZ}f=!0}}else t:if(f=t,h=f.prev,c=f,p=f.next,0<=Ue(h,c,p))f=!1;else{for(l=f.next.next;l!==f.prev;){if(Fe(h.x,h.y,c.x,c.y,p.x,p.y,l.x,l.y)&&0<=Ue(l.prev,l,l.next)){f=!1;break t}l=l.next}f=!0}if(f)e.push(a.i/i),e.push(t.i/i),e.push(m.i/i),qe(t),d=t=m.next;else if((t=m)===d){if(o){if(1===o){o=e,d=i,a=t;do{m=a.prev,f=a.next.next,!Be(m,f)&&je(m,a,a.next,f)&&Ge(m,f)&&Ge(f,m)&&(o.push(m.i/d),o.push(a.i/d),o.push(f.i/d),qe(a),qe(a.next),a=t=f),a=a.next}while(a!==t);Ne(t=a,e,i,n,r,s,2)}else if(2===o)t:{o=t;do{for(d=o.next.next;d!==o.prev;){if(a=o.i!==d.i){if(a=o,m=d,f=a.next.i!==m.i&&a.prev.i!==m.i){e:{f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==m.i&&f.next.i!==m.i&&je(f,f.next,a,m)){f=!0;break e}f=f.next}while(f!==a);f=!1}f=!f}if(f=f&&Ge(a,m)&&Ge(m,a)){f=a,h=!1,c=(a.x+m.x)/2,m=(a.y+m.y)/2;do{f.y>m!=f.next.y>m&&f.next.y!==f.y&&c<(f.next.x-f.x)*(m-f.y)/(f.next.y-f.y)+f.x&&(h=!h),f=f.next}while(f!==a);f=h}a=f}if(a){t=We(o,d),o=Ie(o,o.next),t=Ie(t,t.next),Ne(o,e,i,n,r,s),Ne(t,e,i,n,r,s);break t}d=d.next}o=o.next}while(o!==t)}}else Ne(Ie(t),e,i,n,r,s,1);break}}}}function Oe(t,e){return t.x-e.x}function ke(t,e){var i=e,n=t.x,r=t.y,s=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){if((l=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y))<=n&&l>s){if(s=l,l===n){if(r===i.y)return i;if(r===i.next.y)return i.next}var o=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!o)return null;if(n===s)return o.prev;e=o;var a,l=o.x,h=o.y,c=1/0;for(i=o.next;i!==e;)n>=i.x&&i.x>=l&&n!==i.x&&Fe(r<h?n:s,r,l,h,r<h?s:n,r,i.x,i.y)&&((a=Math.abs(r-i.y)/(n-i.x))<c||a===c&&i.x>o.x)&&Ge(i,t)&&(o=i,c=a),i=i.next;return o}function ze(t,e,i,n,r){return t=32767*(t-i)*r,e=32767*(e-n)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),1431655765&(t|t<<1)|(1431655765&(e|e<<1))<<1}function He(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function Fe(t,e,i,n,r,s,o,a){return 0<=(r-o)*(e-a)-(t-o)*(s-a)&&0<=(t-o)*(n-a)-(i-o)*(e-a)&&0<=(i-o)*(s-a)-(r-o)*(n-a)}function Ue(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Be(t,e){return t.x===e.x&&t.y===e.y}function je(t,e,i,n){return!!(Be(t,e)&&Be(i,n)||Be(t,n)&&Be(i,e))||0<Ue(t,e,i)!=0<Ue(t,e,n)&&0<Ue(i,n,t)!=0<Ue(i,n,e)}function Ge(t,e){return 0>Ue(t.prev,t,t.next)?0<=Ue(t,e,t.next)&&0<=Ue(t,t.prev,e):0>Ue(t,e,t.prev)||0>Ue(t,t.next,e)}function We(t,e){var i=new Xe(t.i,t.x,t.y),n=new Xe(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Ve(t,e,i,n){return t=new Xe(t,e,i),n?(t.next=n.next,t.prev=n,n.next.prev=t,n.next=t):(t.prev=t,t.next=t),t}function qe(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Xe(t,e,i){this.i=t,this.x=e,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Ye(t,e){st.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new $e(t,e)),this.mergeVertices()}function $e(t,e){void 0!==t&&(yt.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function Je(t,e){st.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Ze(t,e)),this.mergeVertices()}function Ze(t,e){var i=(e=e||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new st;t=i.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),$e.call(this,t,e),this.type="TextBufferGeometry"}function Ke(t,e,i,n,r,s,o){st.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},this.fromBufferGeometry(new Qe(t,e,i,n,r,s,o)),this.mergeVertices()}function Qe(t,e,i,n,r,o,a){yt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var l,h,c=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),u=0,d=[],p=new s,f=new s,m=[],g=[],v=[],y=[];for(h=0;h<=i;h++){var b=[],x=h/i;for(l=0;l<=e;l++){var _=l/e;p.x=-t*Math.cos(n+_*r)*Math.sin(o+x*a),p.y=t*Math.cos(o+x*a),p.z=t*Math.sin(n+_*r)*Math.sin(o+x*a),g.push(p.x,p.y,p.z),f.set(p.x,p.y,p.z).normalize(),v.push(f.x,f.y,f.z),y.push(_,1-x),b.push(u++)}d.push(b)}for(h=0;h<i;h++)for(l=0;l<e;l++)t=d[h][l+1],n=d[h][l],r=d[h+1][l],a=d[h+1][l+1],(0!==h||0<o)&&m.push(t,n,a),(h!==i-1||c<Math.PI)&&m.push(n,r,a);this.setIndex(m),this.addAttribute("position",new ft(g,3)),this.addAttribute("normal",new ft(v,3)),this.addAttribute("uv",new ft(y,2))}function ti(t,e,i,n,r,s){st.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:s},this.fromBufferGeometry(new ei(t,e,i,n,r,s)),this.mergeVertices()}function ei(t,e,n,r,o,a){yt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:a},t=t||.5,e=e||1,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var l,h,c=[],u=[],d=[],p=[],f=t,m=(e-t)/(r=void 0!==r?Math.max(1,r):1),g=new s,v=new i;for(l=0;l<=r;l++){for(h=0;h<=n;h++)t=o+h/n*a,g.x=f*Math.cos(t),g.y=f*Math.sin(t),u.push(g.x,g.y,g.z),d.push(0,0,1),v.x=(g.x/e+1)/2,v.y=(g.y/e+1)/2,p.push(v.x,v.y);f+=m}for(l=0;l<r;l++)for(e=l*(n+1),h=0;h<n;h++)t=h+e,o=t+n+1,a=t+n+2,f=t+1,c.push(t,o,f),c.push(o,a,f);this.setIndex(c),this.addAttribute("position",new ft(u,3)),this.addAttribute("normal",new ft(d,3)),this.addAttribute("uv",new ft(p,2))}function ii(t,e,i,n){st.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new ni(t,e,i,n)),this.mergeVertices()}function ni(t,e,n,r){yt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=br.clamp(r,0,2*Math.PI);var o,a=[],l=[],h=[],c=1/e,u=new s,d=new i;for(o=0;o<=e;o++){var p=n+o*c*r,f=Math.sin(p),m=Math.cos(p);for(p=0;p<=t.length-1;p++)u.x=t[p].x*f,u.y=t[p].y,u.z=t[p].x*m,l.push(u.x,u.y,u.z),d.x=o/e,d.y=p/(t.length-1),h.push(d.x,d.y)}for(o=0;o<e;o++)for(p=0;p<t.length-1;p++)n=p+o*t.length,c=n+t.length,u=n+t.length+1,d=n+1,a.push(n,c,d),a.push(c,u,d);if(this.setIndex(a),this.addAttribute("position",new ft(l,3)),this.addAttribute("uv",new ft(h,2)),this.computeVertexNormals(),r===2*Math.PI)for(r=this.attributes.normal.array,a=new s,l=new s,h=new s,n=e*t.length*3,p=o=0;o<t.length;o++,p+=3)a.x=r[p+0],a.y=r[p+1],a.z=r[p+2],l.x=r[n+p+0],l.y=r[n+p+1],l.z=r[n+p+2],h.addVectors(a,l).normalize(),r[p+0]=r[n+p+0]=h.x,r[p+1]=r[n+p+1]=h.y,r[p+2]=r[n+p+2]=h.z}function ri(t,e){st.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new si(t,e)),this.mergeVertices()}function si(t,e){function i(t){var i,a=r.length/3,h=(t=t.extractPoints(e)).shape,c=t.holes;if(!1===Fr.isClockWise(h))for(h=h.reverse(),t=0,i=c.length;t<i;t++){var u=c[t];!0===Fr.isClockWise(u)&&(c[t]=u.reverse())}var d=Fr.triangulateShape(h,c);for(t=0,i=c.length;t<i;t++)u=c[t],h=h.concat(u);for(t=0,i=h.length;t<i;t++)u=h[t],r.push(u.x,u.y,0),s.push(0,0,1),o.push(u.x,u.y);for(t=0,i=d.length;t<i;t++)h=d[t],n.push(h[0]+a,h[1]+a,h[2]+a),l+=3}yt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],s=[],o=[],a=0,l=0;if(!1===Array.isArray(t))i(t);else for(var h=0;h<t.length;h++)i(t[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(n),this.addAttribute("position",new ft(r,3)),this.addAttribute("normal",new ft(s,3)),this.addAttribute("uv",new ft(o,2))}function oi(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,n=t.length;i<n;i++)e.shapes.push(t[i].uuid);else e.shapes.push(t.uuid);return e}function ai(t,e){yt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var i=[];e=Math.cos(br.DEG2RAD*(void 0!==e?e:1));var n=[0,0],r={},s=["a","b","c"];if(t.isBufferGeometry){var o=new st;o.fromBufferGeometry(t)}else o=t.clone();o.mergeVertices(),o.computeFaceNormals(),t=o.vertices;for(var a=0,l=(o=o.faces).length;a<l;a++)for(var h=o[a],c=0;3>c;c++){var u=h[s[c]],d=h[s[(c+1)%3]];n[0]=Math.min(u,d),n[1]=Math.max(u,d),void 0===r[u=n[0]+","+n[1]]?r[u]={index1:n[0],index2:n[1],face1:a,face2:void 0}:r[u].face2=a}for(u in r)(void 0===(n=r[u]).face2||o[n.face1].normal.dot(o[n.face2].normal)<=e)&&(s=t[n.index1],i.push(s.x,s.y,s.z),s=t[n.index2],i.push(s.x,s.y,s.z));this.addAttribute("position",new ft(i,3))}function li(t,e,i,n,r,s,o,a){st.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new hi(t,e,i,n,r,s,o,a)),this.mergeVertices()}function hi(t,e,n,r,o,a,l,h){function c(n){var o,a=new i,c=new s,v=0,x=!0===n?t:e,_=!0===n?1:-1,w=g;for(o=1;o<=r;o++)p.push(0,y*_,0),f.push(0,_,0),m.push(.5,.5),g++;var E=g;for(o=0;o<=r;o++){var T=o/r*h+l,M=Math.cos(T);T=Math.sin(T);c.x=x*T,c.y=y*_,c.z=x*M,p.push(c.x,c.y,c.z),f.push(0,_,0),a.x=.5*M+.5,a.y=.5*T*_+.5,m.push(a.x,a.y),g++}for(o=0;o<r;o++)a=w+o,c=E+o,!0===n?d.push(c,c+1,a):d.push(c+1,c,a),v+=3;u.addGroup(b,v,!0===n?1:2),b+=v}yt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:l,thetaLength:h};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,o=Math.floor(o)||1,a=void 0!==a&&a,l=void 0!==l?l:0,h=void 0!==h?h:2*Math.PI;var d=[],p=[],f=[],m=[],g=0,v=[],y=n/2,b=0;!function(){var i,a,c=new s,x=new s,_=0,w=(e-t)/n;for(a=0;a<=o;a++){var E=[],T=a/o,M=T*(e-t)+t;for(i=0;i<=r;i++){var S=i/r,C=S*h+l,A=Math.sin(C);C=Math.cos(C);x.x=M*A,x.y=-T*n+y,x.z=M*C,p.push(x.x,x.y,x.z),c.set(A,w,C).normalize(),f.push(c.x,c.y,c.z),m.push(S,1-T),E.push(g++)}v.push(E)}for(i=0;i<r;i++)for(a=0;a<o;a++)c=v[a+1][i],x=v[a+1][i+1],w=v[a][i+1],d.push(v[a][i],c,w),d.push(c,x,w),_+=6;u.addGroup(b,_,0),b+=_}(),!1===a&&(0<t&&c(!0),0<e&&c(!1)),this.setIndex(d),this.addAttribute("position",new ft(p,3)),this.addAttribute("normal",new ft(f,3)),this.addAttribute("uv",new ft(m,2))}function ci(t,e,i,n,r,s,o){li.call(this,0,t,e,i,n,r,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}function ui(t,e,i,n,r,s,o){hi.call(this,0,t,e,i,n,r,s,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}function di(t,e,i,n){st.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new pi(t,e,i,n)),this.mergeVertices()}function pi(t,e,n,r){yt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var o,a=[],l=[],h=[],c=[],u=new s,d=new i;l.push(0,0,0),h.push(0,0,1),c.push(.5,.5);var p=0;for(o=3;p<=e;p++,o+=3){var f=n+p/e*r;u.x=t*Math.cos(f),u.y=t*Math.sin(f),l.push(u.x,u.y,u.z),h.push(0,0,1),d.x=(l[o]/t+1)/2,d.y=(l[o+1]/t+1)/2,c.push(d.x,d.y)}for(o=1;o<=e;o++)a.push(o,o+1,0);this.setIndex(a),this.addAttribute("position",new ft(l,3)),this.addAttribute("normal",new ft(h,3)),this.addAttribute("uv",new ft(c,2))}function fi(t){V.call(this),this.type="ShadowMaterial",this.color=new j(0),this.opacity=1,this.transparent=this.lights=!0,this.setValues(t)}function mi(t){Tt.call(this,t),this.type="RawShaderMaterial"}function gi(t){V.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new j(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function vi(t){gi.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function yi(t){V.call(this),this.type="MeshPhongMaterial",this.color=new j(16777215),this.specular=new j(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function bi(t){yi.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function xi(t){V.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function _i(t){V.call(this),this.type="MeshLambertMaterial",this.color=new j(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function wi(t){ne.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Ei(t,e,i){var n=this,r=!1,s=0,o=0,a=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,!1===r&&void 0!==n.onStart&&n.onStart(t,s,o),r=!0},this.itemEnd=function(t){s++,void 0!==n.onProgress&&n.onProgress(t,s,o),s===o&&(r=!1,void 0!==n.onLoad)&&n.onLoad()},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this}}function Ti(t){this.manager=void 0!==t?t:Gr}function Mi(t){this.manager=void 0!==t?t:Gr,this._parser=null}function Si(t){this.manager=void 0!==t?t:Gr,this._parser=null}function Ci(t){this.manager=void 0!==t?t:Gr}function Ai(t){this.manager=void 0!==t?t:Gr}function Pi(t){this.manager=void 0!==t?t:Gr}function Ri(){this.type="Curve",this.arcLengthDivisions=200}function Li(t,e,i,n,r,s,o,a){Ri.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=s||2*Math.PI,this.aClockwise=o||!1,this.aRotation=a||0}function Di(t,e,i,n,r,s){Li.call(this,t,e,i,i,n,r,s),this.type="ArcCurve"}function Ii(){var t=0,e=0,i=0,n=0;return{initCatmullRom:function(r,s,o,a,l){t=s,e=r=l*(o-r),i=-3*s+3*o-2*r-(a=l*(a-s)),n=2*s-2*o+r+a},initNonuniformCatmullRom:function(r,s,o,a,l,h,c){t=s,e=r=((s-r)/l-(o-r)/(l+h)+(o-s)/h)*h,i=-3*s+3*o-2*r-(a=((o-s)/h-(a-s)/(h+c)+(a-o)/c)*h),n=2*s-2*o+r+a},calc:function(r){var s=r*r;return t+e*r+i*s+n*s*r}}}function Ni(t,e,i,n){Ri.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=n||.5}function Oi(t,e,i,n,r){var s=t*t;return(2*i-2*n+(e=.5*(n-e))+(r=.5*(r-i)))*t*s+(-3*i+3*n-2*e-r)*s+e*t+i}function ki(t,e,i,n){var r=1-t;return r*r*e+2*(1-t)*t*i+t*t*n}function zi(t,e,i,n,r){var s=1-t,o=1-t;return s*s*s*e+3*o*o*t*i+3*(1-t)*t*t*n+t*t*t*r}function Hi(t,e,n,r){Ri.call(this),this.type="CubicBezierCurve",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i,this.v3=r||new i}function Fi(t,e,i,n){Ri.call(this),this.type="CubicBezierCurve3",this.v0=t||new s,this.v1=e||new s,this.v2=i||new s,this.v3=n||new s}function Ui(t,e){Ri.call(this),this.type="LineCurve",this.v1=t||new i,this.v2=e||new i}function Bi(t,e){Ri.call(this),this.type="LineCurve3",this.v1=t||new s,this.v2=e||new s}function ji(t,e,n){Ri.call(this),this.type="QuadraticBezierCurve",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i}function Gi(t,e,i){Ri.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new s,this.v1=e||new s,this.v2=i||new s}function Wi(t){Ri.call(this),this.type="SplineCurve",this.points=t||[]}function Vi(){Ri.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function qi(t){Vi.call(this),this.type="Path",this.currentPoint=new i,t&&this.setFromPoints(t)}function Xi(t){qi.call(this,t),this.uuid=br.generateUUID(),this.type="Shape",this.holes=[]}function Yi(t,e){et.call(this),this.type="Light",this.color=new j(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function $i(t,e,i){Yi.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(et.DefaultUp),this.updateMatrix(),this.groundColor=new j(e)}function Ji(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new n}function Zi(){Ji.call(this,new jt(50,1,.5,500))}function Ki(t,e,i,n,r,s){Yi.call(this,t,e),this.type="SpotLight",this.position.copy(et.DefaultUp),this.updateMatrix(),this.target=new et,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==s?s:1,this.shadow=new Zi}function Qi(t,e,i,n){Yi.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Ji(new jt(90,1,.5,500))}function tn(){Ji.call(this,new nt(-5,5,5,-5,.5,500))}function en(t,e){Yi.call(this,t,e),this.type="DirectionalLight",this.position.copy(et.DefaultUp),this.updateMatrix(),this.target=new et,this.shadow=new tn}function nn(t,e){Yi.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function rn(t,e,i,n){Yi.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function sn(t,e,i,n){mn.call(this,t,e,i,n)}function on(t,e,i){mn.call(this,t,e,i)}function an(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function ln(t,e,i,n){an.call(this,t,e,i,n)}function hn(t,e,i,n){mn.call(this,t,e,i,n)}function cn(t,e,i,n){mn.call(this,t,e,i,n)}function un(t,e,i,n){mn.call(this,t,e,i,n)}function dn(t,e,i,n){an.call(this,t,e,i,n),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function pn(t,e,i,n){an.call(this,t,e,i,n)}function fn(t,e,i,n){an.call(this,t,e,i,n)}function mn(t,e,i,n){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Jr.convertArray(e,this.TimeBufferType),this.values=Jr.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function gn(t,e,i,n){mn.call(this,t,e,i,n)}function vn(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=br.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function yn(t){this.manager=void 0!==t?t:Gr,this.textures={}}function bn(t){this.manager=void 0!==t?t:Gr}function xn(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function _n(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Gr,this.withCredentials=!1}function wn(t){this.manager=void 0!==t?t:Gr,this.texturePath=""}function En(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Gr,this.options=void 0}function Tn(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Mn(t){this.type="Font",this.data=t}function Sn(t){this.manager=void 0!==t?t:Gr}function Cn(t){this.manager=void 0!==t?t:Gr}function An(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Pn(t,e,i){et.call(this),this.type="CubeCamera";var n=new jt(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new s(1,0,0)),this.add(n);var r=new jt(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new s(-1,0,0)),this.add(r);var o=new jt(90,1,t,e);o.up.set(0,0,1),o.lookAt(new s(0,1,0)),this.add(o);var a=new jt(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new s(0,-1,0)),this.add(a);var l=new jt(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new s(0,0,1)),this.add(l);var h=new jt(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new s(0,0,-1)),this.add(h),this.renderTarget=new c(i,i,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,s=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,r,i),i.activeCubeFace=2,t.render(e,o,i),i.activeCubeFace=3,t.render(e,a,i),i.activeCubeFace=4,t.render(e,l,i),i.texture.generateMipmaps=s,i.activeCubeFace=5,t.render(e,h,i),t.setRenderTarget(null)},this.clear=function(t,e,i,n){for(var r=this.renderTarget,s=0;6>s;s++)r.activeCubeFace=s,t.setRenderTarget(r),t.clear(e,i,n);t.setRenderTarget(null)}}function Rn(){et.call(this),this.type="AudioListener",this.context=ns.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ln(t){et.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Dn(t){Ln.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function In(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Nn(t,e,i){switch(this.binding=t,this.valueSize=i,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*i),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function On(t,e,i){i=i||kn.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,i)}function kn(t,e,i){this.path=e,this.parsedPath=i||kn.parseTrackName(e),this.node=kn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function zn(){this.uuid=br.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Hn(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null,e=(t=e.tracks).length,i=Array(e);for(var n={endingStart:2400,endingEnd:2400},r=0;r!==e;++r){var s=t[r].createInterpolant(null);i[r]=s,s.settings=n}this._interpolantSettings=n,this._interpolants=i,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Fn(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Un(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function Bn(){yt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function jn(t,e,i,n){this.uuid=br.generateUUID(),this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function Gn(t,e){this.uuid=br.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Wn(t,e,i){Gn.call(this,t,e),this.meshPerAttribute=i||1}function Vn(t,e,i){ot.call(this,t,e),this.meshPerAttribute=i||1}function qn(t,e,i,n){this.ray=new Mt(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Xn(t,e){return t.distance-e.distance}function Yn(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n)){n=0;for(var r=(t=t.children).length;n<r;n++)Yn(t[n],e,i,!0)}}function $n(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Jn(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function Zn(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function Kn(t){et.call(this),this.material=t,this.render=function(){}}function Qn(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16711680,n=void 0!==n?n:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=3*i.faces.length:i&&i.isBufferGeometry&&(e=i.attributes.normal.count),i=new yt,e=new ft(6*e,3),i.addAttribute("position",e),se.call(this,i,new ne({color:t,linewidth:n})),this.matrixAutoUpdate=!1,this.update()}function tr(t,e){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new yt,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,n=1;32>i;i++,n++){var r=i/32*Math.PI*2,s=n/32*Math.PI*2;e.push(Math.cos(r),Math.sin(r),1,Math.cos(s),Math.sin(s),1)}t.addAttribute("position",new ft(e,3)),e=new ne({fog:!1}),this.cone=new se(t,e),this.add(this.cone),this.update()}function er(t){var e=[];t&&t.isBone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,er(t.children[i]));return e}function ir(t){for(var e=er(t),i=new yt,n=[],r=[],s=new j(0,0,1),o=new j(0,1,0),a=0;a<e.length;a++){var l=e[a];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}i.addAttribute("position",new ft(n,3)),i.addAttribute("color",new ft(r,3)),n=new ne({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),se.call(this,i,n),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function nr(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new Qe(e,4,2),e=new Et({wireframe:!0,fog:!1}),At.call(this,t,e),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function rr(t,e){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new ne({fog:!1}),(e=new yt).addAttribute("position",new ot(new Float32Array(15),3)),this.line=new re(e,t),this.add(this.line),this.update()}function sr(t,e,i){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,(t=new _e(e)).rotateY(.5*Math.PI),this.material=new Et({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.addAttribute("color",new ot(e,3)),this.add(new At(t,this.material)),this.update()}function or(t,e,i,n){t=t||10,e=e||10,i=new j(void 0!==i?i:4473924),n=new j(void 0!==n?n:8947848);var r=e/2,s=t/e,o=t/2;t=[];for(var a=[],l=0,h=0,c=-o;l<=e;l++,c+=s){t.push(-o,0,c,o,0,c),t.push(c,0,-o,c,0,o);var u=l===r?i:n;u.toArray(a,h),h+=3,u.toArray(a,h),h+=3,u.toArray(a,h),h+=3,u.toArray(a,h),h+=3}(e=new yt).addAttribute("position",new ft(t,3)),e.addAttribute("color",new ft(a,3)),i=new ne({vertexColors:2}),se.call(this,e,i)}function ar(t,e,i,n,r,s){t=t||10,e=e||16,i=i||8,n=n||64,r=new j(void 0!==r?r:4473924),s=new j(void 0!==s?s:8947848);var o,a=[],l=[];for(o=0;o<=e;o++){var h=o/e*2*Math.PI,c=Math.sin(h)*t;h=Math.cos(h)*t,a.push(0,0,0),a.push(c,0,h);var u=1&o?r:s;l.push(u.r,u.g,u.b),l.push(u.r,u.g,u.b)}for(o=0;o<=i;o++){u=1&o?r:s;var d=t-t/i*o;for(e=0;e<n;e++)h=e/n*2*Math.PI,c=Math.sin(h)*d,h=Math.cos(h)*d,a.push(c,0,h),l.push(u.r,u.g,u.b),h=(e+1)/n*2*Math.PI,c=Math.sin(h)*d,h=Math.cos(h)*d,a.push(c,0,h),l.push(u.r,u.g,u.b)}(t=new yt).addAttribute("position",new ft(a,3)),t.addAttribute("color",new ft(l,3)),a=new ne({vertexColors:2}),se.call(this,t,a)}function lr(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16776960,n=void 0!==n?n:1,e=0,(i=this.object.geometry)&&i.isGeometry?e=i.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),i=new yt,e=new ft(6*e,3),i.addAttribute("position",e),se.call(this,i,new ne({color:t,linewidth:n})),this.matrixAutoUpdate=!1,this.update()}function hr(t,e,i){et.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1),(t=new yt).addAttribute("position",new ft([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new ne({fog:!1}),this.lightPlane=new re(t,e),this.add(this.lightPlane),(t=new yt).addAttribute("position",new ft([0,0,0,0,0,1],3)),this.targetLine=new re(t,e),this.add(this.targetLine),this.update()}function cr(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){s.push(0,0,0),o.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(s.length/3-1)}var n=new yt,r=new ne({color:16777215,vertexColors:1}),s=[],o=[],a={},l=new j(16755200),h=new j(16711680),c=new j(43775),u=new j(16777215),d=new j(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",h),e("p","n2",h),e("p","n3",h),e("p","n4",h),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",u),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),n.addAttribute("position",new ft(s,3)),n.addAttribute("color",new ft(o,3)),se.call(this,n,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function ur(t,e){this.object=t,void 0===e&&(e=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24),n=new yt;n.setIndex(new ot(t,1)),n.addAttribute("position",new ot(i,3)),se.call(this,n,new ne({color:e})),this.matrixAutoUpdate=!1,this.update()}function dr(t,e){this.type="Box3Helper",this.box=t,t=void 0!==e?e:16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new yt;i.setIndex(new ot(e,1)),i.addAttribute("position",new ft([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),se.call(this,i,new ne({color:t})),this.geometry.computeBoundingSphere()}function pr(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e,t=void 0!==i?i:16776960,(e=new yt).addAttribute("position",new ft([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),e.computeBoundingSphere(),re.call(this,e,new ne({color:t})),(e=new yt).addAttribute("position",new ft([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),this.add(new At(e,new Et({color:t,opacity:.2,transparent:!0,depthWrite:!1})))}function fr(t,e,i,n,r,s){et.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===s&&(s=.2*r),void 0===rs&&((rs=new yt).addAttribute("position",new ft([0,0,0,0,1,0],3)),(ss=new hi(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new re(rs,new ne({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new At(ss,new Et({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,s)}function mr(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new yt).addAttribute("position",new ft(e,3)),t.addAttribute("color",new ft([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new ne({vertexColors:2}),se.call(this,t,e)}function gr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ni.call(this,t),this.type="catmullrom",this.closed=!0}function vr(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ni.call(this,t),this.type="catmullrom"}function yr(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ni.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&void 0!==(t=this._listeners[t])&&-1!==(e=t.indexOf(e))&&t.splice(e,1)},dispatchEvent:function(t){if(void 0!==this._listeners){if(void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,i=0,n=(e=e.slice(0)).length;i<n;i++)e[i].call(this,t)}}}});var br={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;256>e;e++)t[e]=(16>e?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*br.DEG2RAD},radToDeg:function(t){return t*br.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.defineProperties(i.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(i.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6],this.y=t[1]*e+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new i,e=new i;return function(i,n){return t.set(i,i),e.set(n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e);e=Math.sin(e);var n=this.x-t.x,r=this.y-t.y;return this.x=n*i-r*e+t.x,this.y=n*e+r*i+t.y,this}}),Object.assign(n.prototype,{isMatrix4:!0,set:function(t,e,i,n,r,s,o,a,l,h,c,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new n).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t=new s;return function(e){var i=this.elements,n=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),s=1/t.setFromMatrixColumn(e,1).length();return e=1/t.setFromMatrixColumn(e,2).length(),i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[8]=n[8]*e,i[9]=n[9]*e,i[10]=n[10]*e,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,s=Math.cos(i),o=(i=Math.sin(i),Math.cos(n)),a=(n=Math.sin(n),Math.cos(r));r=Math.sin(r);if("XYZ"===t.order){var l=s*a,h=s*r,c=i*a;t=i*r,e[0]=o*a,e[4]=-o*r,e[8]=n,e[1]=h+c*n,e[5]=l-t*n,e[9]=-i*o,e[2]=t-l*n,e[6]=c+h*n,e[10]=s*o}else"YXZ"===t.order?(l=o*a,h=o*r,c=n*a,t=n*r,e[0]=l+t*i,e[4]=c*i-h,e[8]=s*n,e[1]=s*r,e[5]=s*a,e[9]=-i,e[2]=h*i-c,e[6]=t+l*i,e[10]=s*o):"ZXY"===t.order?(l=o*a,h=o*r,c=n*a,t=n*r,e[0]=l-t*i,e[4]=-s*r,e[8]=c+h*i,e[1]=h+c*i,e[5]=s*a,e[9]=t-l*i,e[2]=-s*n,e[6]=i,e[10]=s*o):"ZYX"===t.order?(l=s*a,h=s*r,c=i*a,t=i*r,e[0]=o*a,e[4]=c*n-h,e[8]=l*n+t,e[1]=o*r,e[5]=t*n+l,e[9]=h*n-c,e[2]=-n,e[6]=i*o,e[10]=s*o):"YZX"===t.order?(l=s*o,h=s*n,c=i*o,t=i*n,e[0]=o*a,e[4]=t-l*r,e[8]=c*r+h,e[1]=r,e[5]=s*a,e[9]=-i*a,e[2]=-n*a,e[6]=h*r+c,e[10]=l-t*r):"XZY"===t.order&&(l=s*o,h=s*n,c=i*o,t=i*n,e[0]=o*a,e[4]=-r,e[8]=n*a,e[1]=l*r+t,e[5]=s*a,e[9]=h*r-c,e[2]=c*r-h,e[6]=i*a,e[10]=t*r+l);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t._x,n=t._y,r=t._z,s=t._w,o=r+r;t=i*(h=i+i);var a=i*(c=n+n),l=(i=i*o,n*c),h=(n=n*o,r=r*o,s*h),c=s*c;s*=o;return e[0]=1-(l+r),e[4]=a-s,e[8]=i+c,e[1]=a+s,e[5]=1-(t+r),e[9]=n-h,e[2]=i-c,e[6]=n+h,e[10]=1-(t+l),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new s,e=new s,i=new s;return function(n,r,s){var o=this.elements;return i.subVectors(n,r),0===i.lengthSq()&&(i.z=1),i.normalize(),t.crossVectors(s,i),0===t.lengthSq()&&(1===Math.abs(s.z)?i.x+=1e-4:i.z+=1e-4,i.normalize(),t.crossVectors(s,i)),t.normalize(),e.crossVectors(i,t),o[0]=t.x,o[4]=e.x,o[8]=i.x,o[1]=t.y,o[5]=e.y,o[9]=i.y,o[2]=t.z,o[6]=e.z,o[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements;e=this.elements,t=i[0];var r=i[4],s=i[8],o=i[12],a=i[1],l=i[5],h=i[9],c=i[13],u=i[2],d=i[6],p=i[10],f=i[14],m=i[3],g=i[7],v=i[11],y=(i=i[15],n[0]),b=n[4],x=n[8],_=n[12],w=n[1],E=n[5],T=n[9],M=n[13],S=n[2],C=n[6],A=n[10],P=n[14],R=n[3],L=n[7],D=n[11];n=n[15];return e[0]=t*y+r*w+s*S+o*R,e[4]=t*b+r*E+s*C+o*L,e[8]=t*x+r*T+s*A+o*D,e[12]=t*_+r*M+s*P+o*n,e[1]=a*y+l*w+h*S+c*R,e[5]=a*b+l*E+h*C+c*L,e[9]=a*x+l*T+h*A+c*D,e[13]=a*_+l*M+h*P+c*n,e[2]=u*y+d*w+p*S+f*R,e[6]=u*b+d*E+p*C+f*L,e[10]=u*x+d*T+p*A+f*D,e[14]=u*_+d*M+p*P+f*n,e[3]=m*y+g*w+v*S+i*R,e[7]=m*b+g*E+v*C+i*L,e[11]=m*x+g*T+v*A+i*D,e[15]=m*_+g*M+v*P+i*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new s;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix4(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],s=t[1],o=t[5],a=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+r*a*c-n*l*c-r*o*u+i*l*u+n*o*d-i*a*d)+t[7]*(+e*a*d-e*l*u+r*s*u-n*s*d+n*l*h-r*a*h)+t[11]*(+e*l*c-e*o*d-r*s*c+i*s*d+r*o*h-i*l*h)+t[15]*(-n*o*h-e*a*c+e*o*u+n*s*c-i*s*u+i*a*h)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements;t=(n=t.elements)[0];var n,r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],h=n[6],c=n[7],u=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=d*v*c-g*p*c+g*h*f-l*v*f-d*h*(n=n[15])+l*p*n,b=m*p*c-u*v*c-m*h*f+a*v*f+u*h*n-a*p*n,x=u*g*c-m*d*c+m*l*f-a*g*f-u*l*n+a*d*n,_=m*d*h-u*g*h-m*l*p+a*g*p+u*l*v-a*d*v,w=t*y+r*b+s*x+o*_;if(0===w){if(!0===e)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return e=1/w,i[0]=y*e,i[1]=(g*p*o-d*v*o-g*s*f+r*v*f+d*s*n-r*p*n)*e,i[2]=(l*v*o-g*h*o+g*s*c-r*v*c-l*s*n+r*h*n)*e,i[3]=(d*h*o-l*p*o-d*s*c+r*p*c+l*s*f-r*h*f)*e,i[4]=b*e,i[5]=(u*v*o-m*p*o+m*s*f-t*v*f-u*s*n+t*p*n)*e,i[6]=(m*h*o-a*v*o-m*s*c+t*v*c+a*s*n-t*h*n)*e,i[7]=(a*p*o-u*h*o+u*s*c-t*p*c-a*s*f+t*h*f)*e,i[8]=x*e,i[9]=(m*d*o-u*g*o-m*r*f+t*g*f+u*r*n-t*d*n)*e,i[10]=(a*g*o-m*l*o+m*r*c-t*g*c-a*r*n+t*l*n)*e,i[11]=(u*l*o-a*d*o-u*r*c+t*d*c+a*r*f-t*l*f)*e,i[12]=_*e,i[13]=(u*g*s-m*d*s+m*r*p-t*g*p-u*r*v+t*d*v)*e,i[14]=(m*l*s-a*g*s-m*r*h+t*g*h+a*r*v-t*l*v)*e,i[15]=(a*d*s-u*l*s+u*r*h-t*d*h-a*r*p+t*l*p)*e,this},scale:function(t){var e=this.elements,i=t.x,n=t.y;return t=t.z,e[0]*=i,e[4]*=n,e[8]*=t,e[1]*=i,e[5]*=n,e[9]*=t,e[2]*=i,e[6]*=n,e[10]*=t,e[3]*=i,e[7]*=n,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e);e=Math.sin(e);var n=1-i,r=t.x,s=t.y;t=t.z;var o=n*r,a=n*s;return this.set(o*r+i,o*s-e*t,o*t+e*s,0,o*s+e*t,a*s+i,a*t-e*r,0,o*t-e*s,a*t+e*r,n*t*t+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t=new s,e=new n;return function(i,n,r){var s=this.elements,o=t.set(s[0],s[1],s[2]).length(),a=t.set(s[4],s[5],s[6]).length(),l=t.set(s[8],s[9],s[10]).length();0>this.determinant()&&(o=-o),i.x=s[12],i.y=s[13],i.z=s[14],e.copy(this),i=1/o;s=1/a;var h=1/l;return e.elements[0]*=i,e.elements[1]*=i,e.elements[2]*=i,e.elements[4]*=s,e.elements[5]*=s,e.elements[6]*=s,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,n.setFromRotationMatrix(e),r.x=o,r.y=a,r.z=l,this}}(),makePerspective:function(t,e,i,n,r,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;return o[0]=2*r/(e-t),o[4]=0,o[8]=(e+t)/(e-t),o[12]=0,o[1]=0,o[5]=2*r/(i-n),o[9]=(i+n)/(i-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(s+r)/(s-r),o[14]=-2*s*r/(s-r),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,i,n,r,s){var o=this.elements,a=1/(e-t),l=1/(i-n),h=1/(s-r);return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-(e+t)*a,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-(i+n)*l,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-(s+r)*h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;16>i;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;16>i;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}),Object.assign(r,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,s,o){var a=i[n+0],l=i[n+1],h=i[n+2];i=i[n+3],n=r[s+0];var c=r[s+1],u=r[s+2];if(r=r[s+3],i!==r||a!==n||l!==c||h!==u){s=1-o;var d=a*n+l*c+h*u+i*r,p=0<=d?1:-1,f=1-d*d;f>Number.EPSILON&&(f=Math.sqrt(f),d=Math.atan2(f,d*p),s=Math.sin(s*d)/f,o=Math.sin(o*d)/f),a=a*s+n*(p*=o),l=l*s+c*p,h=h*s+u*p,i=i*s+r*p,s===1-o&&(o=1/Math.sqrt(a*a+l*l+h*h+i*i),a*=o,l*=o,h*=o,i*=o)}t[e]=a,t[e+1]=l,t[e+2]=h,t[e+3]=i}}),Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(r.prototype,{set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,n=t._y,r=t._z;t=t.order;var s=Math.cos,o=Math.sin,a=s(i/2),l=s(n/2);s=s(r/2),i=o(i/2),n=o(n/2),r=o(r/2);return"XYZ"===t?(this._x=i*l*s+a*n*r,this._y=a*n*s-i*l*r,this._z=a*l*r+i*n*s,this._w=a*l*s-i*n*r):"YXZ"===t?(this._x=i*l*s+a*n*r,this._y=a*n*s-i*l*r,this._z=a*l*r-i*n*s,this._w=a*l*s+i*n*r):"ZXY"===t?(this._x=i*l*s-a*n*r,this._y=a*n*s+i*l*r,this._z=a*l*r+i*n*s,this._w=a*l*s-i*n*r):"ZYX"===t?(this._x=i*l*s-a*n*r,this._y=a*n*s+i*l*r,this._z=a*l*r-i*n*s,this._w=a*l*s+i*n*r):"YZX"===t?(this._x=i*l*s+a*n*r,this._y=a*n*s+i*l*r,this._z=a*l*r-i*n*s,this._w=a*l*s-i*n*r):"XZY"===t&&(this._x=i*l*s-a*n*r,this._y=a*n*s-i*l*r,this._z=a*l*r+i*n*s,this._w=a*l*s+i*n*r),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){e/=2;var i=Math.sin(e);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(e),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=(i=t.elements)[0];t=i[4];var i,n=i[8],r=i[1],s=i[5],o=i[9],a=i[2],l=i[6],h=e+s+(i=i[10]);return 0<h?(e=.5/Math.sqrt(h+1),this._w=.25/e,this._x=(l-o)*e,this._y=(n-a)*e,this._z=(r-t)*e):e>s&&e>i?(e=2*Math.sqrt(1+e-s-i),this._w=(l-o)/e,this._x=.25*e,this._y=(t+r)/e,this._z=(n+a)/e):s>i?(e=2*Math.sqrt(1+s-e-i),this._w=(n-a)/e,this._x=(t+r)/e,this._y=.25*e,this._z=(o+l)/e):(e=2*Math.sqrt(1+i-e-s),this._w=(r-t)/e,this._x=(n+a)/e,this._y=(o+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new s;return function(i,n){return void 0===e&&(e=new s),1e-6>(t=i.dot(n)+1)?(t=0,Math.abs(i.x)>Math.abs(i.z)?e.set(-i.y,i.x,0):e.set(0,-i.z,i.y)):e.crossVectors(i,n),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z;t=t._w;var s=e._x,o=e._y,a=e._z;return e=e._w,this._x=i*e+t*s+n*a-r*o,this._y=n*e+t*o+r*s-i*a,this._z=r*e+t*a+i*o-n*s,this._w=t*e-i*s-n*o-r*a,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,s=this._w;if(0>(a=s*t._w+i*t._x+n*t._y+r*t._z)?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=s,this._x=i,this._y=n,this._z=r,this;if(t=Math.sqrt(1-a*a),.001>Math.abs(t))return this._w=.5*(s+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var o=Math.atan2(t,a),a=Math.sin((1-e)*o)/t;return e=Math.sin(e*o)/t,this._w=s*a+this._w*e,this._x=i*a+this._x*e,this._y=n*a+this._y*e,this._z=r*a+this._z*e,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(s.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new r;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new r;return function(e,i){return this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6]*n,this.y=t[1]*e+t[4]*i+t[7]*n,this.z=t[2]*e+t[5]*i+t[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=1/((t=t.elements)[3]*e+t[7]*i+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*i+t[8]*n+t[12])*r,this.y=(t[1]*e+t[5]*i+t[9]*n+t[13])*r,this.z=(t[2]*e+t[6]*i+t[10]*n+t[14])*r,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,o=t.z,a=(t=t.w)*e+s*n-o*i,l=t*i+o*e-r*n,h=t*n+r*i-s*e;e=-r*e-s*i-o*n;return this.x=a*t+e*-r+l*-o-h*-s,this.y=l*t+e*-s+h*-r-a*-o,this.z=h*t+e*-o+a*-s-l*-r,this},project:function(){var t=new n;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new n;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n,this.y=t[1]*e+t[5]*i+t[9]*n,this.z=t[2]*e+t[6]*i+t[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new s,e=new s;return function(i,n){return t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,n=t.y;t=t.z;var r=e.x,s=e.y;return e=e.z,this.x=n*e-t*s,this.y=t*r-i*e,this.z=i*s-n*r,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new s;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new s;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(br.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return t=this.z-t.z,e*e+i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(o.prototype,{isMatrix3:!0,set:function(t,e,i,n,r,s,o,a,l){var h=this.elements;return h[0]=t,h[1]=n,h[2]=o,h[3]=e,h[4]=r,h[5]=a,h[6]=i,h[7]=s,h[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var t=new s;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix3(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements;e=this.elements,t=i[0];var r=i[3],s=i[6],o=i[1],a=i[4],l=i[7],h=i[2],c=i[5],u=(i=i[8],n[0]),d=n[3],p=n[6],f=n[1],m=n[4],g=n[7],v=n[2],y=n[5];n=n[8];return e[0]=t*u+r*f+s*v,e[3]=t*d+r*m+s*y,e[6]=t*p+r*g+s*n,e[1]=o*u+a*f+l*v,e[4]=o*d+a*m+l*y,e[7]=o*p+a*g+l*n,e[2]=h*u+c*f+i*v,e[5]=h*d+c*m+i*y,e[8]=h*p+c*g+i*n,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7];return e*s*(t=t[8])-e*o*l-i*r*t+i*o*a+n*r*l-n*s*a},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements;t=this.elements;var n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],h=i[6],c=i[7],u=(i=i[8])*a-l*c,d=l*h-i*o,p=c*o-a*h,f=n*u+r*d+s*p;if(0===f){if(!0===e)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return e=1/f,t[0]=u*e,t[1]=(s*c-i*r)*e,t[2]=(l*r-s*a)*e,t[3]=d*e,t[4]=(i*n-s*h)*e,t[5]=(s*o-l*n)*e,t[6]=p*e,t[7]=(r*h-c*n)*e,t[8]=(a*n-r*o)*e,this},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,n,r,s,o){var a=Math.cos(r);r=Math.sin(r),this.set(i*a,i*r,-i*(a*s+r*o)+s+t,-n*r,n*a,-n*(-r*s+a*o)+o+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t);t=Math.sin(t);var i=this.elements,n=i[0],r=i[3],s=i[6],o=i[1],a=i[4],l=i[7];return i[0]=e*n+t*o,i[3]=e*r+t*a,i[6]=e*s+t*l,i[1]=-t*n+e*o,i[4]=-t*r+e*a,i[7]=-t*s+e*l,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var i=0;9>i;i++)if(e[i]!==t[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;9>i;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var xr=0;a.DEFAULT_IMAGE=void 0,a.DEFAULT_MAPPING=300,a.prototype=Object.assign(Object.create(e.prototype),{constructor:a,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=br.generateUUID()),!e&&void 0===t.images[n.uuid]){var r=t.images,s=n.uuid,o=n.uuid;if(n instanceof HTMLCanvasElement)var a=n;else{(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=n.width,a.height=n.height;var l=a.getContext("2d");n instanceof ImageData?l.putImageData(n,0,0):l.drawImage(n,0,0,n.width,n.height)}a=2048<a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png"),r[s]={uuid:o,url:a}}i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(a.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(l.prototype,{isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n+t[12]*r,this.y=t[1]*e+t[5]*i+t[9]*n+t[13]*r,this.z=t[2]*e+t[6]*i+t[10]*n+t[14]*r,this.w=t[3]*e+t[7]*i+t[11]*n+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e=(t=t.elements)[0],i=t[4],n=t[8],r=t[1],s=t[5],o=t[9],a=t[2],l=t[6],h=t[10];return.01>Math.abs(i-r)&&.01>Math.abs(n-a)&&.01>Math.abs(o-l)?.1>Math.abs(i+r)&&.1>Math.abs(n+a)&&.1>Math.abs(o+l)&&.1>Math.abs(e+s+h-3)?(this.set(1,0,0,0),this):(t=Math.PI,e=(e+1)/2,s=(s+1)/2,h=(h+1)/2,i=(i+r)/4,n=(n+a)/4,o=(o+l)/4,e>s&&e>h?.01>e?(l=0,i=a=.707106781):(l=Math.sqrt(e),a=i/l,i=n/l):s>h?.01>s?(l=.707106781,a=0,i=.707106781):(a=Math.sqrt(s),l=i/a,i=o/a):.01>h?(a=l=.707106781,i=0):(i=Math.sqrt(h),l=n/i,a=o/i),this.set(l,a,i,t),this):(t=Math.sqrt((l-o)*(l-o)+(n-a)*(n-a)+(r-i)*(r-i)),.001>Math.abs(t)&&(t=1),this.x=(l-o)/t,this.y=(n-a)/t,this.z=(r-i)/t,this.w=Math.acos((e+s+h-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new l,e=new l),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),h.prototype=Object.assign(Object.create(e.prototype),{constructor:h,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(c.prototype=Object.create(h.prototype)).constructor=c,c.prototype.isWebGLRenderTargetCube=!0,(u.prototype=Object.create(a.prototype)).constructor=u,u.prototype.isDataTexture=!0,(d.prototype=Object.create(a.prototype)).constructor=d,d.prototype.isCubeTexture=!0,Object.defineProperty(d.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var _r=new a,wr=new d,Er=[],Tr=[],Mr=new Float32Array(16),Sr=new Float32Array(9);U.prototype.setValue=function(t,e){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var s=i[n];s.setValue(t,e[s.id])}};var Cr=/([\w\d_]+)(\])?(\[|\.)?/g;B.prototype.setValue=function(t,e,i){void 0!==(e=this.map[e])&&e.setValue(t,i,this.renderer)},B.prototype.setOptional=function(t,e,i){void 0!==(e=e[i])&&this.setValue(t,i,e)},B.upload=function(t,e,i,n){for(var r=0,s=e.length;r!==s;++r){var o=e[r],a=i[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,n)}},B.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var s=t[n];s.id in e&&i.push(s)}return i};var Ar={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(j.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return 0>i&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:.5>i?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(e,i,n){return e=br.euclideanModulo(e,1),i=br.clamp(i,0,1),n=br.clamp(n,0,1),0===i?this.r=this.g=this.b=n:(i=.5>=n?n*(1+i):n+i-n*i,n=2*n-i,this.r=t(n,i,e+1/3),this.g=t(n,i,e),this.b=t(n,i,e-1/3)),this}}(),setStyle:function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){n=parseFloat(i[1])/360;var r=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(n,r,s)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(i=i[1],3===(n=i.length))return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&0<t.length&&(void 0!==(i=Ar[t])?this.setHex(i):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return void 0===e&&(e=2),e=0<e?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,i=this.r,n=this.g,r=this.b,s=Math.max(i,n,r),o=((l=Math.min(i,n,r))+s)/2;if(l===s)l=e=0;else{var a=s-l,l=.5>=o?a/(s+l):a/(2-s-l);switch(s){case i:e=(n-r)/a+(n<r?6:0);break;case n:e=(r-i)/a+2;break;case r:e=(i-n)/a+4}e/=6}return t.h=e,t.s=l,t.l=o,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Pr={common:{diffuse:{value:new j(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new o},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new j(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new j(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new o}}},Rr={merge:function(t){for(var e={},i=0;i<t.length;i++){var n,r=this.clone(t[i]);for(n in r)e[n]=r[n]}return e},clone:function(t){var e,i={};for(e in t){i[e]={};for(var n in t[e]){var r=t[e][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?i[e][n]=r.clone():Array.isArray(r)?i[e][n]=r.slice():i[e][n]=r}}return i}},Lr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Dr={basic:{uniforms:Rr.merge([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.fog]),vertexShader:Lr.meshbasic_vert,fragmentShader:Lr.meshbasic_frag},lambert:{uniforms:Rr.merge([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.fog,Pr.lights,{emissive:{value:new j(0)}}]),vertexShader:Lr.meshlambert_vert,fragmentShader:Lr.meshlambert_frag},phong:{uniforms:Rr.merge([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.gradientmap,Pr.fog,Pr.lights,{emissive:{value:new j(0)},specular:{value:new j(1118481)},shininess:{value:30}}]),vertexShader:Lr.meshphong_vert,fragmentShader:Lr.meshphong_frag},standard:{uniforms:Rr.merge([Pr.common,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.roughnessmap,Pr.metalnessmap,Pr.fog,Pr.lights,{emissive:{value:new j(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Lr.meshphysical_vert,fragmentShader:Lr.meshphysical_frag},points:{uniforms:Rr.merge([Pr.points,Pr.fog]),vertexShader:Lr.points_vert,fragmentShader:Lr.points_frag},dashed:{uniforms:Rr.merge([Pr.common,Pr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Lr.linedashed_vert,fragmentShader:Lr.linedashed_frag},depth:{uniforms:Rr.merge([Pr.common,Pr.displacementmap]),vertexShader:Lr.depth_vert,fragmentShader:Lr.depth_frag},normal:{uniforms:Rr.merge([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,{opacity:{value:1}}]),vertexShader:Lr.normal_vert,fragmentShader:Lr.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Lr.cube_vert,fragmentShader:Lr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Lr.equirect_vert,fragmentShader:Lr.equirect_frag},distanceRGBA:{uniforms:Rr.merge([Pr.common,Pr.displacementmap,{referencePosition:{value:new s},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Lr.distanceRGBA_vert,fragmentShader:Lr.distanceRGBA_frag},shadow:{uniforms:Rr.merge([Pr.lights,Pr.fog,{color:{value:new j(0)},opacity:{value:1}}]),vertexShader:Lr.shadow_vert,fragmentShader:Lr.shadow_frag}};Dr.physical={uniforms:Rr.merge([Dr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Lr.meshphysical_vert,fragmentShader:Lr.meshphysical_frag},Object.assign(G.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,i){return i=t.copy(i).multiplyScalar(.5),this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new i,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new i,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new i).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new i).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),(W.prototype=Object.create(a.prototype)).constructor=W;var Ir=0;V.prototype=Object.assign(Object.create(e.prototype),{constructor:V,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0===i)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if("shading"===e)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;else{var n=this[e];void 0===n?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]="overdraw"===e?Number(i):i}}},toJSON:function(t){function e(t){var e,i=[];for(e in t){var n=t[e];delete n.metadata,i.push(n)}return i}var i=void 0===t||"string"==typeof t;i&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),1>this.opacity&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),i&&(i=e(t.textures),t=e(t.images),0<i.length&&(n.textures=i),0<t.length&&(n.images=t)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=null;if(null!==(t=t.clippingPlanes))for(var i=t.length,n=(e=Array(i),0);n!==i;++n)e[n]=t[n].clone();return this.clippingPlanes=e,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(q.prototype=Object.create(V.prototype)).constructor=q,q.prototype.isMeshDepthMaterial=!0,q.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(X.prototype=Object.create(V.prototype)).constructor=X,X.prototype.isMeshDistanceMaterial=!0,X.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(Y.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0,a=0,l=t.length;a<l;a+=3){var h=t[a],c=t[a+1],u=t[a+2];h<e&&(e=h),c<i&&(i=c),u<n&&(n=u),h>r&&(r=h),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0,a=0,l=t.count;a<l;a++){var h=t.getX(a),c=t.getY(a),u=t.getZ(a);h<e&&(e=h),c<i&&(i=c),u<n&&(n=u),h>r&&(r=h),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new s;return function(e,i){return i=t.copy(i).multiplyScalar(.5),this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new s,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new s,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){function t(t){var s=t.geometry;if(void 0!==s)if(s.isGeometry)for(s=s.vertices,i=0,n=s.length;i<n;i++)r.copy(s[i]),r.applyMatrix4(t.matrixWorld),e.expandByPoint(r);else if(s.isBufferGeometry&&void 0!==(s=s.attributes.position))for(i=0,n=s.count;i<n;i++)r.fromBufferAttribute(s,i).applyMatrix4(t.matrixWorld),e.expandByPoint(r)}var e,i,n,r=new s;return function(i){return e=this,i.updateMatrixWorld(!0),i.traverse(t),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new s).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new s;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){if(0<t.normal.x)var e=t.normal.x*this.min.x,i=t.normal.x*this.max.x;else e=t.normal.x*this.max.x,i=t.normal.x*this.min.x;return 0<t.normal.y?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){return(e||new s).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new s;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new s;return function(e){return e=e||new $,this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new s,new s,new s,new s,new s,new s,new s,new s];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign($.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new Y;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).getCenter(n);for(var r=i=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t);return(e=e||new s).copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return(t=t||new Y).set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(J.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new s,e=new s;return function(i,n,r){return n=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize(),this.setFromNormalAndCoplanarPoint(n,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return(e||new s).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new s;return function(e,i){i=i||new s;var n=e.delta(t),r=this.normal.dot(n);if(0===r){if(0===this.distanceToPoint(e.start))return i.copy(e.start)}else if(!(0>(r=-(e.start.dot(this.normal)+this.constant)/r)||1<r))return i.copy(n).multiplyScalar(r).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new s).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new s,e=new o;return function(i,n){return n=n||e.getNormalMatrix(i),i=this.coplanarPoint(t).applyMatrix4(i),n=this.normal.applyMatrix3(n).normalize(),this.constant=-i.dot(n),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Z.prototype,{set:function(t,e,i,n,r,s){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes;t=(g=t.elements)[0];var i=g[1],n=g[2],r=g[3],s=g[4],o=g[5],a=g[6],l=g[7],h=g[8],c=g[9],u=g[10],d=g[11],p=g[12],f=g[13],m=g[14],g=g[15];return e[0].setComponents(r-t,l-s,d-h,g-p).normalize(),e[1].setComponents(r+t,l+s,d+h,g+p).normalize(),e[2].setComponents(r+i,l+o,d+c,g+f).normalize(),e[3].setComponents(r-i,l-o,d-c,g-f).normalize(),e[4].setComponents(r-n,l-a,d-u,g-m).normalize(),e[5].setComponents(r+n,l+a,d+u,g+m).normalize(),this},intersectsObject:function(){var t=new $;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new $;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,i=t.center;t=-t.radius;for(var n=0;6>n;n++)if(e[n].distanceToPoint(i)<t)return!1;return!0},intersectsBox:function(){var t=new s,e=new s;return function(i){for(var n=this.planes,r=0;6>r;r++){var s=n[r];t.x=0<s.normal.x?i.min.x:i.max.x,e.x=0<s.normal.x?i.max.x:i.min.x,t.y=0<s.normal.y?i.min.y:i.max.y,e.y=0<s.normal.y?i.max.y:i.min.y,t.z=0<s.normal.z?i.min.z:i.max.z,e.z=0<s.normal.z?i.max.z:i.min.z;var o=s.distanceToPoint(t);s=s.distanceToPoint(e);if(0>o&&0>s)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(0>e[i].distanceToPoint(t))return!1;return!0}}),Q.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),Q.DefaultOrder="XYZ",Object.defineProperties(Q.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(Q.prototype,{isEuler:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=br.clamp;t=(u=t.elements)[0];var r=u[4],s=u[8],o=u[1],a=u[5],l=u[9],h=u[2],c=u[6],u=u[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-l,u),this._z=Math.atan2(-r,t)):(this._x=Math.atan2(c,a),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(s,u),this._z=Math.atan2(o,a)):(this._y=Math.atan2(-h,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(c,-1,1)),.99999>Math.abs(c)?(this._y=Math.atan2(-h,u),this._z=Math.atan2(-r,a)):(this._y=0,this._z=Math.atan2(o,t))):"ZYX"===e?(this._y=Math.asin(-n(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(c,u),this._z=Math.atan2(o,t)):(this._x=0,this._z=Math.atan2(-r,a))):"YZX"===e?(this._z=Math.asin(n(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(-l,a),this._y=Math.atan2(-h,t)):(this._x=0,this._y=Math.atan2(s,u))):"XZY"===e?(this._z=Math.asin(-n(r,-1,1)),.99999>Math.abs(r)?(this._x=Math.atan2(c,a),this._y=Math.atan2(s,t)):(this._x=Math.atan2(-l,u),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new n;return function(e,i,n){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new r;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new s(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(tt.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var Nr=0;et.DefaultUp=new s(0,1,0),et.DefaultMatrixAutoUpdate=!0,et.prototype=Object.assign(Object.create(e.prototype),{constructor:et,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new r;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new r;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new s(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new s(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new s(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new s;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new s(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new s(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new s(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new n;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new n,e=new s;return function(i,n,r){i.isVector3?e.copy(i):e.set(i,n,r),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return t=t||new s,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new s,e=new s;return function(i){return i=i||new r,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new r;return function(e){return e=e||new Q,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new s,e=new r;return function(i){return i=i||new s,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new r;return function(e){return e=e||new s,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},toJSON:function(t){function e(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}function i(t){var e,i=[];for(e in t){var n=t[e];delete n.metadata,i.push(n)}return i}var n={};(l=void 0===t||"string"==typeof t)&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),void 0!==this.geometry){r.geometry=e(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var o=0,a=s.length;o<a;o++)e(t.shapes,s[o]);else e(t.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],o=0,a=this.material.length;o<a;o++)s.push(e(t.materials,this.material[o]));r.material=s}else r.material=e(t.materials,this.material);if(0<this.children.length)for(r.children=[],o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object);if(l){var l=i(t.geometries),h=(o=i(t.materials),a=i(t.textures),i(t.images));s=i(t.shapes),0<l.length&&(n.geometries=l),0<o.length&&(n.materials=o),0<a.length&&(n.textures=a),0<h.length&&(n.images=h),0<s.length&&(n.shapes=s)}return n.object=r,n},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}}),it.prototype=Object.assign(Object.create(et.prototype),{constructor:it,isCamera:!0,copy:function(t,e){return et.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new r;return function(e){return e=e||new s,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){et.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),nt.prototype=Object.assign(Object.create(it.prototype),{constructor:nt,isOrthographicCamera:!0,copy:function(t,e){return it.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(n=(this.right+this.left)/2)-t,n=n+t;t=(s=(this.top+this.bottom)/2)+e,e=s-e;if(null!==this.view&&this.view.enabled){n=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight);var r=(this.right-this.left)/this.view.width,s=(this.top-this.bottom)/this.view.height;i=i+this.view.offsetX/n*r,n=i+this.view.width/n*r,t=t-this.view.offsetY/e*s,e=t-this.view.height/e*s}this.projectionMatrix.makeOrthographic(i,n,t,e,this.near,this.far)},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(rt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Or=0;st.prototype=Object.assign(Object.create(e.prototype),{constructor:st,isGeometry:!0,applyMatrix:function(t){for(var e=(new o).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(i=0,n=this.faces.length;i<n;i++){(t=this.faces[i]).normal.applyMatrix3(e).normalize();for(var r=0,s=t.vertexNormals.length;r<s;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var t=new n;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new n;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new n;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new n;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new n;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new et;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,i,r){r=new rt(t,e,i,void 0!==l?[d[t].clone(),d[e].clone(),d[i].clone()]:[],void 0!==h?[n.colors[t].clone(),n.colors[e].clone(),n.colors[i].clone()]:[],r),n.faces.push(r),void 0!==c&&n.faceVertexUvs[0].push([p[t].clone(),p[e].clone(),p[i].clone()]),void 0!==u&&n.faceVertexUvs[1].push([f[t].clone(),f[e].clone(),f[i].clone()])}var n=this,r=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,l=void 0!==o.normal?o.normal.array:void 0,h=void 0!==o.color?o.color.array:void 0,c=void 0!==o.uv?o.uv.array:void 0,u=void 0!==o.uv2?o.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var d=[],p=[],f=[],m=o=0;o<a.length;o+=3,m+=2)n.vertices.push(new s(a[o],a[o+1],a[o+2])),void 0!==l&&d.push(new s(l[o],l[o+1],l[o+2])),void 0!==h&&n.colors.push(new j(h[o],h[o+1],h[o+2])),void 0!==c&&p.push(new i(c[m],c[m+1])),void 0!==u&&f.push(new i(u[m],u[m+1]));var g=t.groups;if(0<g.length)for(o=0;o<g.length;o++){a=g[o];var v=a.start,y=a.count;for(m=v,v=v+y;m<v;m+=3)void 0!==r?e(r[m],r[m+1],r[m+2],a.materialIndex):e(m,m+1,m+2,a.materialIndex)}else if(void 0!==r)for(o=0;o<r.length;o+=3)e(r[o],r[o+1],r[o+2]);else for(o=0;o<a.length/3;o+=3)e(o,o+1,o+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,i=new n;return i.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new s,e=new s,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b];t.subVectors(this.vertices[r.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,i=Array(this.vertices.length),n=0;for(e=this.vertices.length;n<e;n++)i[n]=new s;if(t){var r=new s,o=new s;for(t=0,n=this.faces.length;t<n;t++){e=this.faces[t];var a=this.vertices[e.a],l=this.vertices[e.b],h=this.vertices[e.c];r.subVectors(h,l),o.subVectors(a,l),r.cross(o),i[e.a].add(r),i[e.b].add(r),i[e.c].add(r)}}else for(this.computeFaceNormals(),t=0,n=this.faces.length;t<n;t++)e=this.faces[t],i[e.a].add(e.normal),i[e.b].add(e.normal),i[e.c].add(e.normal);for(n=0,e=this.vertices.length;n<e;n++)i[n].normalize();for(t=0,n=this.faces.length;t<n;t++)e=this.faces[t],3===(a=e.vertexNormals).length?(a[0].copy(i[e.a]),a[1].copy(i[e.b]),a[2].copy(i[e.c])):(a[0]=i[e.a].clone(),a[1]=i[e.b].clone(),a[2]=i[e.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t;this.computeFaceNormals();var e=0;for(t=this.faces.length;e<t;e++){var i=this.faces[e],n=i.vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i=0;for(e=this.faces.length;i<e;i++){var n=this.faces[i];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);var r=0;for(t=n.vertexNormals.length;r<t;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}var o=new st;for(o.faces=this.faces,r=0,t=this.morphTargets.length;r<t;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[],n=this.morphNormals[r].faceNormals;var a=this.morphNormals[r].vertexNormals;for(i=0,e=this.faces.length;i<e;i++){var l=new s,h={a:new s,b:new s,c:new s};n.push(l),a.push(h)}}for(a=this.morphNormals[r],o.vertices=this.morphTargets[r].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,e=this.faces.length;i<e;i++)n=this.faces[i],l=a.faceNormals[i],h=a.vertexNormals[i],l.copy(n.normal),h.a.copy(n.vertexNormals[0]),h.b.copy(n.vertexNormals[1]),h.c.copy(n.vertexNormals[2])}for(i=0,e=this.faces.length;i<e;i++)n=this.faces[i],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;i<n;i++)0<i&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Y),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var n,r=this.vertices.length,s=this.vertices,a=t.vertices,l=this.faces,h=t.faces,c=this.faceVertexUvs[0],u=t.faceVertexUvs[0],d=this.colors,p=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new o).getNormalMatrix(e)),t=0;for(var f=a.length;t<f;t++){var m=a[t].clone();void 0!==e&&m.applyMatrix4(e),s.push(m)}for(t=0,f=p.length;t<f;t++)d.push(p[t].clone());for(t=0,f=h.length;t<f;t++){var g=(a=h[t]).vertexNormals;p=a.vertexColors;for((d=new rt(a.a+r,a.b+r,a.c+r)).normal.copy(a.normal),void 0!==n&&d.normal.applyMatrix3(n).normalize(),e=0,s=g.length;e<s;e++)m=g[e].clone(),void 0!==n&&m.applyMatrix3(n).normalize(),d.vertexNormals.push(m);for(d.color.copy(a.color),e=0,s=p.length;e<s;e++)m=p[e],d.vertexColors.push(m.clone());d.materialIndex=a.materialIndex+i,l.push(d)}for(t=0,f=u.length;t<f;t++)if(i=u[t],n=[],void 0!==i){for(e=0,s=i.length;e<s;e++)n.push(i[e].clone());c.push(n)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e={},i=[],n=[],r=Math.pow(10,4),s=0;for(t=this.vertices.length;s<t;s++){var o=this.vertices[s];void 0===e[o=Math.round(o.x*r)+"_"+Math.round(o.y*r)+"_"+Math.round(o.z*r)]?(e[o]=s,i.push(this.vertices[s]),n[s]=i.length-1):n[s]=n[e[o]]}for(e=[],s=0,t=this.faces.length;s<t;s++)for(r=this.faces[s],r.a=n[r.a],r.b=n[r.b],r.c=n[r.c],r=[r.a,r.b,r.c],o=0;3>o;o++)if(r[o]===r[(o+1)%3]){e.push(s);break}for(s=e.length-1;0<=s;s--)for(r=e[s],this.faces.splice(r,1),n=0,t=this.faceVertexUvs.length;n<t;n++)this.faceVertexUvs[n].splice(r,1);return s=this.vertices.length-i.length,this.vertices=i,s},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new s(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,r,s=this.faceVertexUvs[0],o=this.faceVertexUvs[1];for(s&&s.length===e&&(n=[]),o&&o.length===e&&(r=[]),i=0;i<e;i++){var a=t[i]._id;n&&n.push(s[a]),r&&r.push(o[a])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==h[e]?h[e]:(h[e]=l.length/3,l.push(t.x,t.y,t.z),h[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=c.length,c.push(t.getHex()),u[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e])}var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),void 0!==this.parameters){var s,o=this.parameters;for(s in o)void 0!==o[s]&&(r[s]=o[s]);return r}for(o=[],s=0;s<this.vertices.length;s++){var a=this.vertices[s];o.push(a.x,a.y,a.z)}a=[];var l=[],h={},c=[],u={},d=[],p={};for(s=0;s<this.faces.length;s++){var f=this.faces[s],m=void 0!==this.faceVertexUvs[0][s],g=0<f.normal.length(),v=0<f.vertexNormals.length,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,b=0<f.vertexColors.length,x=t(x=t(x=t(x=t(x=t(x=t(x=t(x=t(x=0,0,0),1,!0),2,!1),3,m),4,g),5,v),6,y),7,b);a.push(x),a.push(f.a,f.b,f.c),a.push(f.materialIndex),m&&(m=this.faceVertexUvs[0][s],a.push(n(m[0]),n(m[1]),n(m[2]))),g&&a.push(e(f.normal)),v&&(g=f.vertexNormals,a.push(e(g[0]),e(g[1]),e(g[2]))),y&&a.push(i(f.color)),b&&(f=f.vertexColors,a.push(i(f[0]),i(f[1]),i(f[2])))}return r.data={},r.data.vertices=o,r.data.normals=l,0<c.length&&(r.data.colors=c),0<d.length&&(r.data.uvs=[d]),r.data.faces=a,r},clone:function(){return(new st).copy(this)},copy:function(t){var e,i,n;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var r=t.vertices,s=0;for(e=r.length;s<e;s++)this.vertices.push(r[s].clone());for(s=0,e=(r=t.colors).length;s<e;s++)this.colors.push(r[s].clone());for(s=0,e=(r=t.faces).length;s<e;s++)this.faces.push(r[s].clone());for(s=0,e=t.faceVertexUvs.length;s<e;s++){var o=t.faceVertexUvs[s];for(void 0===this.faceVertexUvs[s]&&(this.faceVertexUvs[s]=[]),r=0,i=o.length;r<i;r++){var a=o[r],l=[],h=0;for(n=a.length;h<n;h++)l.push(a[h].clone());this.faceVertexUvs[s].push(l)}}for(s=0,e=(h=t.morphTargets).length;s<e;s++){if(n={},n.name=h[s].name,void 0!==h[s].vertices)for(n.vertices=[],r=0,i=h[s].vertices.length;r<i;r++)n.vertices.push(h[s].vertices[r].clone());if(void 0!==h[s].normals)for(n.normals=[],r=0,i=h[s].normals.length;r<i;r++)n.normals.push(h[s].normals[r].clone());this.morphTargets.push(n)}for(s=0,e=(h=t.morphNormals).length;s<e;s++){if(n={},void 0!==h[s].vertexNormals)for(n.vertexNormals=[],r=0,i=h[s].vertexNormals.length;r<i;r++)o=h[s].vertexNormals[r],a={},a.a=o.a.clone(),a.b=o.b.clone(),a.c=o.c.clone(),n.vertexNormals.push(a);if(void 0!==h[s].faceNormals)for(n.faceNormals=[],r=0,i=h[s].faceNormals.length;r<i;r++)n.faceNormals.push(h[s].faceNormals[r].clone());this.morphNormals.push(n)}for(s=0,e=(r=t.skinWeights).length;s<e;s++)this.skinWeights.push(r[s].clone());for(s=0,e=(r=t.skinIndices).length;s<e;s++)this.skinIndices.push(r[s].clone());for(s=0,e=(r=t.lineDistances).length;s<e;s++)this.lineDistances.push(r[s]);return null!==(s=t.boundingBox)&&(this.boundingBox=s.clone()),null!==(s=t.boundingSphere)&&(this.boundingSphere=s.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ot.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ot.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var s=t[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new j),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var s=t[n];e[i++]=s.a,e[i++]=s.b,e[i++]=s.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,s=t.length;r<s;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new i),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new s),e[i++]=o.x,e[i++]=o.y,e[i++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var s=t[n];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new l),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(at.prototype=Object.create(ot.prototype)).constructor=at,(lt.prototype=Object.create(ot.prototype)).constructor=lt,(ht.prototype=Object.create(ot.prototype)).constructor=ht,(ct.prototype=Object.create(ot.prototype)).constructor=ct,(ut.prototype=Object.create(ot.prototype)).constructor=ut,(dt.prototype=Object.create(ot.prototype)).constructor=dt,(pt.prototype=Object.create(ot.prototype)).constructor=pt,(ft.prototype=Object.create(ot.prototype)).constructor=ft,(mt.prototype=Object.create(ot.prototype)).constructor=mt,Object.assign(gt.prototype,{computeGroups:function(t){var e=[],i=void 0;t=t.faces;for(var n=0;n<t.length;n++){var r=t[n];if(r.materialIndex!==i){i=r.materialIndex,void 0!==s&&(s.count=3*n-s.start,e.push(s));var s={start:3*n,materialIndex:i}}}void 0!==s&&(s.count=3*n-s.start,e.push(s)),this.groups=e},fromGeometry:function(t){var e=t.faces,n=t.vertices,r=t.faceVertexUvs,s=r[0]&&0<r[0].length,o=r[1]&&0<r[1].length,a=t.morphTargets,l=a.length;if(0<l){for(var h=[],c=0;c<l;c++)h[c]=[];this.morphTargets.position=h}var u=t.morphNormals,d=u.length;if(0<d){var p=[];for(c=0;c<d;c++)p[c]=[];this.morphTargets.normal=p}var f=t.skinIndices,m=t.skinWeights,g=f.length===n.length,v=m.length===n.length;for(c=0;c<e.length;c++){var y=e[c];this.vertices.push(n[y.a],n[y.b],n[y.c]);var b=y.vertexNormals;for(3===b.length?this.normals.push(b[0],b[1],b[2]):(b=y.normal,this.normals.push(b,b,b)),3===(b=y.vertexColors).length?this.colors.push(b[0],b[1],b[2]):(b=y.color,this.colors.push(b,b,b)),!0===s&&(void 0!==(b=r[0][c])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new i,new i,new i))),!0===o&&(void 0!==(b=r[1][c])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new i,new i,new i))),b=0;b<l;b++){var x=a[b].vertices;h[b].push(x[y.a],x[y.b],x[y.c])}for(b=0;b<d;b++)x=u[b].vertexNormals[c],p[b].push(x.a,x.b,x.c);g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var kr=1;yt.prototype=Object.assign(Object.create(e.prototype),{constructor:yt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<vt(t)?pt:ut)(t,1):this.index=t},addAttribute:function(t,e,i){if(e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute){if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new ot(e,i))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)&&((new o).getNormalMatrix(t).applyToBufferAttribute(e),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new n;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new n;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new n;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new n;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new n;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new et;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){t=new ft(3*e.vertices.length,3);var i=new ft(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new ft(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new ft(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var i=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(i=void 0,e.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(e);i.verticesNeedUpdate=e.verticesNeedUpdate,i.normalsNeedUpdate=e.normalsNeedUpdate,i.colorsNeedUpdate=e.colorsNeedUpdate,i.uvsNeedUpdate=e.uvsNeedUpdate,i.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=i}return!0===e.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(e.vertices),i.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(e.normals),i.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(e.colors),i.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(e.uvs),i.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(e.lineDistances),i.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new gt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.addAttribute("position",new ot(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new ot(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new ot(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new ot(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new ot(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<vt(t.indices)?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new ot(e,1).copyIndicesArray(t.indices))),this.groups=t.groups;for(var i in t.morphTargets){e=[];for(var n=t.morphTargets[i],r=0,s=n.length;r<s;r++){var o=n[r],a=new ft(3*o.length,3);e.push(a.copyVector3sArray(o))}this.morphAttributes[i]=e}return 0<t.skinIndices.length&&(i=new ft(4*t.skinIndices.length,4),this.addAttribute("skinIndex",i.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(i=new ft(4*t.skinWeights.length,4),this.addAttribute("skinWeight",i.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Y);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new Y,e=new s;return function(){null===this.boundingSphere&&(this.boundingSphere=new $);var i=this.attributes.position;if(i){var n=this.boundingSphere.center;t.setFromBufferAttribute(i),t.getCenter(n);for(var r=0,s=0,o=i.count;s<o;s++)e.x=i.getX(s),e.y=i.getY(s),e.z=i.getZ(s),r=Math.max(r,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new ot(new Float32Array(n.length),3));else for(var r=e.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;r=e.normal.array;var l=new s,h=new s,c=new s,u=new s,d=new s;if(t){t=t.array,0===i.length&&this.addGroup(0,t.length);for(var p=0,f=i.length;p<f;++p){a=(o=i[p]).start;var m=o.count;for(o=a,a+=m;o<a;o+=3){m=3*t[o+0];var g=3*t[o+1],v=3*t[o+2];l.fromArray(n,m),h.fromArray(n,g),c.fromArray(n,v),u.subVectors(c,h),d.subVectors(l,h),u.cross(d),r[m]+=u.x,r[m+1]+=u.y,r[m+2]+=u.z,r[g]+=u.x,r[g+1]+=u.y,r[g+2]+=u.z,r[v]+=u.x,r[v+1]+=u.y,r[v+2]+=u.z}}}else for(o=0,a=n.length;o<a;o+=9)l.fromArray(n,o),h.fromArray(n,o+3),c.fromArray(n,o+6),u.subVectors(c,h),d.subVectors(l,h),u.cross(d),r[o]=u.x,r[o+1]=u.y,r[o+2]=u.z,r[o+3]=u.x,r[o+4]=u.y,r[o+5]=u.z,r[o+6]=u.x,r[o+7]=u.y,r[o+8]=u.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var i,n=this.attributes;for(i in n)if(void 0!==t.attributes[i]){var r=n[i].array,s=t.attributes[i],o=s.array,a=0;for(s=s.itemSize*e;a<o.length;a++,s++)r[s]=o[a]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new s;return function(){for(var e=this.attributes.normal,i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.normalize(),e.setXYZ(i,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new yt,i=this.index.array,n=this.attributes;for(t in n){for(var r,s=(o=n[t]).array,o=o.itemSize,a=new s.constructor(i.length*o),l=0,h=0,c=i.length;h<c;h++){r=i[h]*o;for(var u=0;u<o;u++)a[l++]=s[r++]}e.addAttribute(t,new ot(a,o))}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;null!==n&&(e=Array.prototype.slice.call(n.array),t.data.index={type:n.array.constructor.name,array:e}),n=this.attributes;for(i in n){var r=n[i];e=Array.prototype.slice.call(r.array),t.data.attributes[i]={itemSize:r.itemSize,type:r.array.constructor.name,array:e,normalized:r.normalized}}return 0<(i=this.groups).length&&(t.data.groups=JSON.parse(JSON.stringify(i))),null!==(i=this.boundingSphere)&&(t.data.boundingSphere={center:i.center.toArray(),radius:i.radius}),t},clone:function(){return(new yt).copy(this)},copy:function(t){var e;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone()),i=t.attributes;for(o in i)this.addAttribute(o,i[o].clone());var n=t.morphAttributes;for(o in n){var r=[],s=n[o];for(i=0,e=s.length;i<e;i++)r.push(s[i].clone());this.morphAttributes[o]=r}var o=t.groups;for(i=0,e=o.length;i<e;i++)n=o[i],this.addGroup(n.start,n.count,n.materialIndex);return null!==(o=t.boundingBox)&&(this.boundingBox=o.clone()),null!==(o=t.boundingSphere)&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(bt.prototype=Object.create(st.prototype)).constructor=bt,(xt.prototype=Object.create(yt.prototype)).constructor=xt,(_t.prototype=Object.create(st.prototype)).constructor=_t,(wt.prototype=Object.create(yt.prototype)).constructor=wt,(Et.prototype=Object.create(V.prototype)).constructor=Et,Et.prototype.isMeshBasicMaterial=!0,Et.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},(Tt.prototype=Object.create(V.prototype)).constructor=Tt,Tt.prototype.isShaderMaterial=!0,Tt.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Rr.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Tt.prototype.toJSON=function(t){return t=V.prototype.toJSON.call(this,t),t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(Mt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new s).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new s;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){return(e=e||new s).subVectors(t,this.origin),0>(t=e.dot(this.direction))?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new s;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return 0>i?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new s,e=new s,i=new s;return function(n,r,s,o){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var a=.5*n.distanceTo(r),l=-this.direction.dot(e),h=i.dot(this.direction),c=-i.dot(e),u=i.lengthSq(),d=Math.abs(1-l*l);if(0<d){r=l*h-c;var p=a*d;0<=(n=l*c-h)?r>=-p?r<=p?(a=1/d,n*=a,r*=a,l=n*(n+l*r+2*h)+r*(l*n+r+2*c)+u):(r=a,n=Math.max(0,-(l*r+h)),l=-n*n+r*(r+2*c)+u):(r=-a,n=Math.max(0,-(l*r+h)),l=-n*n+r*(r+2*c)+u):r<=-p?(n=Math.max(0,-(-l*a+h)),r=0<n?-a:Math.min(Math.max(-a,-c),a),l=-n*n+r*(r+2*c)+u):r<=p?(n=0,r=Math.min(Math.max(-a,-c),a),l=r*(r+2*c)+u):(n=Math.max(0,-(l*a+h)),r=0<n?a:Math.min(Math.max(-a,-c),a),l=-n*n+r*(r+2*c)+u)}else r=0<l?-a:a,n=Math.max(0,-(l*r+h)),l=-n*n+r*(r+2*c)+u;return s&&s.copy(this.direction).multiplyScalar(n).add(this.origin),o&&o.copy(e).multiplyScalar(r).add(t),l}}(),intersectSphere:function(){var t=new s;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n;return e=e.radius*e.radius,r>e?null:(e=Math.sqrt(e-r),r=n-e,n+=e,0>r&&0>n?null:0>r?this.at(n,i):this.at(r,i))}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},intersectBox:function(t,e){var i=1/this.direction.x,n=1/this.direction.y,r=1/this.direction.z,s=this.origin;if(0<=i){var o=(t.min.x-s.x)*i;i*=t.max.x-s.x}else o=(t.max.x-s.x)*i,i*=t.min.x-s.x;if(0<=n){var a=(t.min.y-s.y)*n;n*=t.max.y-s.y}else a=(t.max.y-s.y)*n,n*=t.min.y-s.y;return o>n||a>i?null:((a>o||o!=o)&&(o=a),(n<i||i!=i)&&(i=n),0<=r?(a=(t.min.z-s.z)*r,t=(t.max.z-s.z)*r):(a=(t.max.z-s.z)*r,t=(t.min.z-s.z)*r),o>t||a>i?null:((a>o||o!=o)&&(o=a),(t<i||i!=i)&&(i=t),0>i?null:this.at(0<=o?o:i,e)))},intersectsBox:function(){var t=new s;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new s,e=new s,i=new s,n=new s;return function(r,s,o,a,l){if(e.subVectors(s,r),i.subVectors(o,r),n.crossVectors(e,i),0<(s=this.direction.dot(n))){if(a)return null;a=1}else{if(!(0>s))return null;a=-1,s=-s}return t.subVectors(this.origin,r),0>(r=a*this.direction.dot(i.crossVectors(t,i)))?null:0>(o=a*this.direction.dot(e.cross(t)))||r+o>s?null:0>(r=-a*t.dot(n))?null:this.at(r/s,l)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(St.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new s).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new s).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return e=e||new s,this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new s,e=new s;return function(i,n){return t.subVectors(i,this.start),e.subVectors(this.end,this.start),i=e.dot(e),i=e.dot(t)/i,n&&(i=br.clamp(i,0,1)),i}}(),closestPointToPoint:function(t,e,i){return t=this.closestPointToPointParameter(t,e),i=i||new s,this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Ct,{normal:function(){var t=new s;return function(e,i,n,r){return(r=r||new s).subVectors(n,i),t.subVectors(e,i),r.cross(t),0<(e=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(e)):r.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new s,e=new s,i=new s;return function(n,r,o,a,l){t.subVectors(a,r),e.subVectors(o,r),i.subVectors(n,r),n=t.dot(t),r=t.dot(e),o=t.dot(i);var h=e.dot(e);a=e.dot(i);var c=n*h-r*r;return l=l||new s,0===c?l.set(-2,-1,-1):(c=1/c,h=(h*o-r*a)*c,n=(n*a-r*o)*c,l.set(1-h-n,n,h))}}(),containsPoint:function(){var t=new s;return function(e,i,n,r){return 0<=(e=Ct.barycoordFromPoint(e,i,n,r,t)).x&&0<=e.y&&1>=e.x+e.y}}()}),Object.assign(Ct.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new s,e=new s;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new s).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return Ct.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new J).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return Ct.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Ct.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t=new J,e=[new St,new St,new St],i=new s,n=new s;return function(r,o){o=o||new s;var a=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,i),!0===this.containsPoint(i))o.copy(i);else for(e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a),r=0;r<e.length;r++){e[r].closestPointToPoint(i,!0,n);var l=i.distanceToSquared(n);l<a&&(a=l,o.copy(n))}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),At.prototype=Object.assign(Object.create(et.prototype),{constructor:At,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return et.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length){var i=t[e[0]];if(void 0!==i)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=i.length;t<e;t++){var n=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}else if(void 0!==(i=t.morphTargets)&&0<i.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=i.length;t<e;t++)n=i[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t},raycast:function(){function t(t,e,i,n,r,s,o){return Ct.barycoordFromPoint(t,e,i,n,y),r.multiplyScalar(y.x),s.multiplyScalar(y.y),o.multiplyScalar(y.z),r.add(s).add(o),r.clone()}function e(t,e,i,n,r,s,o,a){return null===(1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a))?null:(x.copy(a),x.applyMatrix4(t.matrixWorld),(e=i.ray.origin.distanceTo(x))<i.near||e>i.far?null:{distance:e,point:x.clone(),object:t})}function r(i,n,r,s,o,a,l,d){return h.fromBufferAttribute(s,a),c.fromBufferAttribute(s,l),u.fromBufferAttribute(s,d),(i=e(i,i.material,n,r,h,c,u,b))&&(o&&(m.fromBufferAttribute(o,a),g.fromBufferAttribute(o,l),v.fromBufferAttribute(o,d),i.uv=t(b,h,c,u,m,g,v)),i.face=new rt(a,l,d,Ct.normal(h,c,u)),i.faceIndex=a),i}var o=new n,a=new Mt,l=new $,h=new s,c=new s,u=new s,d=new s,p=new s,f=new s,m=new i,g=new i,v=new i,y=new s,b=new s,x=new s;return function(i,n){var s=this.geometry,y=this.material,x=this.matrixWorld;if(void 0!==y&&(null===s.boundingSphere&&s.computeBoundingSphere(),l.copy(s.boundingSphere),l.applyMatrix4(x),!1!==i.ray.intersectsSphere(l)&&(o.getInverse(x),a.copy(i.ray).applyMatrix4(o),null===s.boundingBox||!1!==a.intersectsBox(s.boundingBox)))){var _;if(s.isBufferGeometry){y=s.index;var w,E=s.attributes.position;x=s.attributes.uv;if(null!==y){var T=0;for(w=y.count;T<w;T+=3){s=y.getX(T);var M=y.getX(T+1),S=y.getX(T+2);(_=r(this,i,a,E,x,s,M,S))&&(_.faceIndex=Math.floor(T/3),n.push(_))}}else if(void 0!==E)for(T=0,w=E.count;T<w;T+=3)s=T,M=T+1,S=T+2,(_=r(this,i,a,E,x,s,M,S))&&(_.index=s,n.push(_))}else if(s.isGeometry){x=Array.isArray(y);T=s.vertices,w=s.faces,0<(M=s.faceVertexUvs[0]).length&&(E=M);for(var C=0,A=w.length;C<A;C++){var P=w[C];if(void 0!==(_=x?y[P.materialIndex]:y)){M=T[P.a],S=T[P.b];var R=T[P.c];if(!0===_.morphTargets){var L=s.morphTargets,D=this.morphTargetInfluences;h.set(0,0,0),c.set(0,0,0),u.set(0,0,0);for(var I=0,N=L.length;I<N;I++){var O=D[I];if(0!==O){var k=L[I].vertices;h.addScaledVector(d.subVectors(k[P.a],M),O),c.addScaledVector(p.subVectors(k[P.b],S),O),u.addScaledVector(f.subVectors(k[P.c],R),O)}}h.add(M),c.add(S),u.add(R),M=h,S=c,R=u}(_=e(this,_,i,a,M,S,R,b))&&(E&&E[C]&&(L=E[C],m.copy(L[0]),g.copy(L[1]),v.copy(L[2]),_.uv=t(b,M,S,R,m,g,v)),_.face=P,_.faceIndex=C,n.push(_))}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var zr=0;jt.prototype=Object.assign(Object.create(it.prototype),{constructor:jt,isPerspectiveCamera:!0,copy:function(t,e){return it.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*br.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*br.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*br.RAD2DEG*Math.atan(Math.tan(.5*br.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=2*(o=t*Math.tan(.5*br.DEG2RAD*this.fov)/this.zoom),i=-.5*(a=this.aspect*e),n=this.view;if(null!==this.view&&this.view.enabled){var r=n.fullWidth,s=n.fullHeight,o=(i=i+n.offsetX*a/r,o-n.offsetY*e/s),a=n.width/r*a;e=n.height/s*e}0!==(n=this.filmOffset)&&(i+=t*n/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+a,o,o-e,t,this.far)},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Gt.prototype=Object.assign(Object.create(jt.prototype),{constructor:Gt,isArrayCamera:!0}),Xt.prototype.isFogExp2=!0,Xt.prototype.clone=function(){return new Xt(this.color.getHex(),this.density)},Xt.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Yt.prototype.isFog=!0,Yt.prototype.clone=function(){return new Yt(this.color.getHex(),this.near,this.far)},Yt.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},$t.prototype=Object.assign(Object.create(et.prototype),{constructor:$t,copy:function(t,e){return et.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=et.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),Jt.prototype=Object.assign(Object.create(et.prototype),{constructor:Jt,isLensFlare:!0,copy:function(t){et.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;e<i;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,i,n,r,s){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===s&&(s=1),void 0===r&&(r=new j(16777215)),void 0===n&&(n=1),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:s,color:r,blending:n})},updateLensFlares:function(){var t,e=this.lensFlares.length,i=2*-this.positionScreen.x,n=2*-this.positionScreen.y;for(t=0;t<e;t++){var r=this.lensFlares[t];r.x=this.positionScreen.x+i*r.distance,r.y=this.positionScreen.y+n*r.distance,r.wantedRotation=r.x*Math.PI*.25,r.rotation+=.25*(r.wantedRotation-r.rotation)}}}),(Zt.prototype=Object.create(V.prototype)).constructor=Zt,Zt.prototype.isSpriteMaterial=!0,Zt.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Kt.prototype=Object.assign(Object.create(et.prototype),{constructor:Kt,isSprite:!0,raycast:function(){var t=new s,e=new s,i=new s;return function(n,r){e.setFromMatrixPosition(this.matrixWorld),n.ray.closestPointToPoint(e,t),i.setFromMatrixScale(this.matrixWorld);var s=i.x*i.y/4;e.distanceToSquared(t)>s||(s=n.ray.origin.distanceTo(t))<n.near||s>n.far||r.push({distance:s,point:t.clone(),face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),Qt.prototype=Object.assign(Object.create(et.prototype),{constructor:Qt,copy:function(t){et.prototype.copy.call(this,t,!1);for(var e=0,i=(t=t.levels).length;e<i;e++){var n=t[e];this.addLevel(n.object.clone(),n.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},raycast:function(){var t=new s;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new s,e=new s;return function(i){var n=this.levels;if(1<n.length){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),i=t.distanceTo(e),n[0].object.visible=!0;for(var r=1,s=n.length;r<s&&i>=n[r].distance;r++)n[r-1].object.visible=!1,n[r].object.visible=!0;for(;r<s;r++)n[r].object.visible=!1}}}(),toJSON:function(t){(t=et.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,i=0,n=e.length;i<n;i++){var r=e[i];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),Object.assign(te.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new n;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,e,i=0;for(e=this.bones.length;i<e;i++)(t=this.bones[i])&&t.matrixWorld.getInverse(this.boneInverses[i]);for(i=0,e=this.bones.length;i<e;i++)(t=this.bones[i])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new n,e=new n;return function(){for(var i=this.bones,n=this.boneInverses,r=this.boneMatrices,s=this.boneTexture,o=0,a=i.length;o<a;o++)t.multiplyMatrices(i[o]?i[o].matrixWorld:e,n[o]),t.toArray(r,16*o);void 0!==s&&(s.needsUpdate=!0)}}(),clone:function(){return new te(this.bones,this.boneInverses)}}),ee.prototype=Object.assign(Object.create(et.prototype),{constructor:ee,isBone:!0}),ie.prototype=Object.assign(Object.create(At.prototype),{constructor:ie,isSkinnedMesh:!0,initBones:function(){var t,e=[];if(this.geometry&&void 0!==this.geometry.bones){var i=0;for(t=this.geometry.bones.length;i<t;i++){var n=this.geometry.bones[i],r=new ee;e.push(r),r.name=n.name,r.position.fromArray(n.pos),r.quaternion.fromArray(n.rotq),void 0!==n.scl&&r.scale.fromArray(n.scl)}for(i=0,t=this.geometry.bones.length;i<t;i++)-1!==(n=this.geometry.bones[i]).parent&&null!==n.parent&&void 0!==e[n.parent]?e[n.parent].add(e[i]):this.add(e[i])}return this.updateMatrixWorld(!0),e},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var e=1/(i=this.geometry.skinWeights[t]).manhattanLength();1/0!==e?i.multiplyScalar(e):i.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new l,n=this.geometry.attributes.skinWeight;for(t=0;t<n.count;t++)i.x=n.getX(t),i.y=n.getY(t),i.z=n.getZ(t),i.w=n.getW(t),e=1/i.manhattanLength(),1/0!==e?i.multiplyScalar(e):i.set(1,0,0,0),n.setXYZW(t,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function(t){At.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),(ne.prototype=Object.create(V.prototype)).constructor=ne,ne.prototype.isLineBasicMaterial=!0,ne.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},re.prototype=Object.assign(Object.create(et.prototype),{constructor:re,isLine:!0,raycast:function(){var t=new n,e=new Mt,i=new $;return function(n,r){var o=(o=n.linePrecision)*o,a=this.geometry,l=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),i.copy(a.boundingSphere),i.applyMatrix4(l),!1!==n.ray.intersectsSphere(i)){t.getInverse(l),e.copy(n.ray).applyMatrix4(t);var h=new s,c=new s,u=(l=new s,new s),d=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var p=a.index,f=a.attributes.position.array;if(null!==p)for(var m=p.array,g=(a=0,m.length-1);a<g;a+=d)p=m[a+1],h.fromArray(f,3*m[a]),c.fromArray(f,3*p),(p=e.distanceSqToSegment(h,c,u,l))>o||(u.applyMatrix4(this.matrixWorld),(p=n.ray.origin.distanceTo(u))<n.near||p>n.far||r.push({distance:p,point:l.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));else for(a=0,g=f.length/3-1;a<g;a+=d)h.fromArray(f,3*a),c.fromArray(f,3*a+3),(p=e.distanceSqToSegment(h,c,u,l))>o||(u.applyMatrix4(this.matrixWorld),(p=n.ray.origin.distanceTo(u))<n.near||p>n.far||r.push({distance:p,point:l.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}else if(a.isGeometry)for(h=a.vertices,c=h.length,a=0;a<c-1;a+=d)(p=e.distanceSqToSegment(h[a],h[a+1],u,l))>o||(u.applyMatrix4(this.matrixWorld),(p=n.ray.origin.distanceTo(u))<n.near||p>n.far||r.push({distance:p,point:l.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),se.prototype=Object.assign(Object.create(re.prototype),{constructor:se,isLineSegments:!0}),oe.prototype=Object.assign(Object.create(re.prototype),{constructor:oe,isLineLoop:!0}),(ae.prototype=Object.create(V.prototype)).constructor=ae,ae.prototype.isPointsMaterial=!0,ae.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},le.prototype=Object.assign(Object.create(et.prototype),{constructor:le,isPoints:!0,raycast:function(){var t=new n,e=new Mt,i=new $;return function(n,r){function o(t,i){var s=e.distanceSqToPoint(t);if(s<u){(t=e.closestPointToPoint(t)).applyMatrix4(h);var o=n.ray.origin.distanceTo(t);o<n.near||o>n.far||r.push({distance:o,distanceToRay:Math.sqrt(s),point:t.clone(),index:i,face:null,object:a})}}var a=this,l=this.geometry,h=this.matrixWorld,c=n.params.Points.threshold;if(null===l.boundingSphere&&l.computeBoundingSphere(),i.copy(l.boundingSphere),i.applyMatrix4(h),i.radius+=c,!1!==n.ray.intersectsSphere(i)){t.getInverse(h),e.copy(n.ray).applyMatrix4(t);var u=(c=c/((this.scale.x+this.scale.y+this.scale.z)/3))*c;c=new s;if(l.isBufferGeometry){var d=l.index;l=l.attributes.position.array;if(null!==d)for(var p=d.array,f=(d=0,p.length);d<f;d++){var m=p[d];c.fromArray(l,3*m),o(c,m)}else for(d=0,p=l.length/3;d<p;d++)c.fromArray(l,3*d),o(c,d)}else for(c=l.vertices,d=0,p=c.length;d<p;d++)o(c[d],d)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),he.prototype=Object.assign(Object.create(et.prototype),{constructor:he,isGroup:!0}),ce.prototype=Object.assign(Object.create(a.prototype),{constructor:ce,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(ue.prototype=Object.create(a.prototype)).constructor=ue,ue.prototype.isCompressedTexture=!0,(de.prototype=Object.create(a.prototype)).constructor=de,de.prototype.isDepthTexture=!0,(pe.prototype=Object.create(yt.prototype)).constructor=pe,(fe.prototype=Object.create(st.prototype)).constructor=fe,(me.prototype=Object.create(yt.prototype)).constructor=me,(ge.prototype=Object.create(st.prototype)).constructor=ge,(ve.prototype=Object.create(yt.prototype)).constructor=ve,(ye.prototype=Object.create(st.prototype)).constructor=ye,(be.prototype=Object.create(ve.prototype)).constructor=be,(xe.prototype=Object.create(st.prototype)).constructor=xe,(_e.prototype=Object.create(ve.prototype)).constructor=_e,(we.prototype=Object.create(st.prototype)).constructor=we,(Ee.prototype=Object.create(ve.prototype)).constructor=Ee,(Te.prototype=Object.create(st.prototype)).constructor=Te,(Me.prototype=Object.create(ve.prototype)).constructor=Me,(Se.prototype=Object.create(st.prototype)).constructor=Se,(Ce.prototype=Object.create(yt.prototype)).constructor=Ce,(Ae.prototype=Object.create(st.prototype)).constructor=Ae,(Pe.prototype=Object.create(yt.prototype)).constructor=Pe,(Re.prototype=Object.create(st.prototype)).constructor=Re,(Le.prototype=Object.create(yt.prototype)).constructor=Le;var Hr=function(t,e,i){i=i||2;var n=(h=e&&e.length)?e[0]*i:t.length,r=De(t,0,n,i,!0),s=[];if(!r)return s;var o;if(h){var a,l=i,h=[],c=0;for(a=e.length;c<a;c++){var u=e[c]*l;(u=De(t,u,c<a-1?e[c+1]*l:t.length,l,!1))===u.next&&(u.steiner=!0),h.push(He(u))}for(h.sort(Oe),c=0;c<h.length;c++)(l=ke(e=h[c],l=r))&&(e=We(l,e),Ie(e,e.next)),r=Ie(r,r.next)}if(t.length>80*i){var d=o=t[0],p=h=t[1];for(l=i;l<n;l+=i)c=t[l],e=t[l+1],c<d&&(d=c),e<p&&(p=e),c>o&&(o=c),e>h&&(h=e);o=0!==(o=Math.max(o-d,h-p))?1/o:0}return Ne(r,s,i,d,p,o),s},Fr={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return 0>Fr.area(t)},triangulateShape:function(t,e){function i(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function n(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}var r=[],s=[],o=[];i(t),n(r,t);var a=t.length;for(e.forEach(i),t=0;t<e.length;t++)s.push(a),a+=e[t].length,n(r,e[t]);for(e=Hr(r,s),t=0;t<e.length;t+=3)o.push(e.slice(t,t+3));return o}};(Ye.prototype=Object.create(st.prototype)).constructor=Ye,($e.prototype=Object.create(yt.prototype)).constructor=$e,$e.prototype.getArrays=function(){var t,e,i;return{position:t=(t=this.getAttribute("position"))?Array.prototype.slice.call(t.array):[],uv:e=(e=this.getAttribute("uv"))?Array.prototype.slice.call(e.array):[],index:i=(i=this.index)?Array.prototype.slice.call(i.array):[]}},$e.prototype.addShapeList=function(t,e){var i=t.length;e.arrays=this.getArrays();for(var n=0;n<i;n++)this.addShape(t[n],e);this.setIndex(e.arrays.index),this.addAttribute("position",new ft(e.arrays.position,3)),this.addAttribute("uv",new ft(e.arrays.uv,2))},$e.prototype.addShape=function(t,e){function n(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}function r(t,e,n){var r=t.x-e.x,s=t.y-e.y,o=n.x-t.x,a=n.y-t.y,l=r*r+s*s;if(Math.abs(r*a-s*o)>Number.EPSILON){var h=Math.sqrt(l),c=Math.sqrt(o*o+a*a);l=e.x-s/h;if(e=e.y+r/h,a=((n.x-a/c-l)*a-(n.y+o/c-e)*o)/(r*a-s*o),o=l+r*a-t.x,r=e+s*a-t.y,2>=(s=o*o+r*r))return new i(o,r);s=Math.sqrt(s/2)}else t=!1,r>Number.EPSILON?o>Number.EPSILON&&(t=!0):r<-Number.EPSILON?o<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(a)&&(t=!0),t?(o=-s,s=Math.sqrt(l)):(o=r,r=s,s=Math.sqrt(l/2));return new i(o/s,r/s)}function o(t,e){for(B=t.length;0<=--B;){var i=B,n=B-1;0>n&&(n=t.length-1);var r,s=_+2*y;for(r=0;r<s;r++){var o=F*r,a=e+n+o,l=e+n+(d=F*(r+1)),d=e+i+d;h(e+i+o),h(a),h(d),h(a),h(l),h(d),o=u.length/3,c((o=T.generateSideWallUV(L,u,o-6,o-3,o-2,o-1))[0]),c(o[1]),c(o[3]),c(o[1]),c(o[2]),c(o[3])}}}function a(t,e,i){f.push(t),f.push(e),f.push(i)}function l(t,e,i){h(t),h(e),h(i),t=u.length/3,c((t=T.generateTopUV(L,u,t-3,t-2,t-1))[0]),c(t[1]),c(t[2])}function h(t){d.push(u.length/3),u.push(f[3*t+0]),u.push(f[3*t+1]),u.push(f[3*t+2])}function c(t){p.push(t.x),p.push(t.y)}var u=(m=e.arrays?e.arrays:this.getArrays()).position,d=m.index,p=m.uv,f=[],m=void 0!==e.amount?e.amount:100,g=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:g-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,b=void 0===e.bevelEnabled||e.bevelEnabled,x=void 0!==e.curveSegments?e.curveSegments:12,_=void 0!==e.steps?e.steps:1,w=e.extrudePath,E=!1,T=void 0!==e.UVGenerator?e.UVGenerator:Ye.WorldUVGenerator;if(w){var M=w.getSpacedPoints(_);E=!0,b=!1;var S=void 0!==e.frames?e.frames:w.computeFrenetFrames(_,!1),C=new s,A=new s,P=new s}b||(v=g=y=0);var R,L=this;t=(x=t.extractPoints(x)).shape;var D=x.holes;if(!Fr.isClockWise(t)){t=t.reverse();var I=0;for(R=D.length;I<R;I++){var N=D[I];Fr.isClockWise(N)&&(D[I]=N.reverse())}}var O=Fr.triangulateShape(t,D),k=t;for(I=0,R=D.length;I<R;I++)N=D[I],t=t.concat(N);var z,H,F=t.length,U=O.length,B=(x=[],0),j=k.length,G=j-1;for(z=B+1;B<j;B++,G++,z++)G===j&&(G=0),z===j&&(z=0),x[B]=r(k[B],k[G],k[z]);w=[];var W=x.concat();for(I=0,R=D.length;I<R;I++){N=D[I];var V=[];for(B=0,G=(j=N.length)-1,z=B+1;B<j;B++,G++,z++)G===j&&(G=0),z===j&&(z=0),V[B]=r(N[B],N[G],N[z]);w.push(V),W=W.concat(V)}for(G=0;G<y;G++){j=G/y;var q=g*Math.cos(j*Math.PI/2);for(z=v*Math.sin(j*Math.PI/2),B=0,j=k.length;B<j;B++){var X=n(k[B],x[B],z);a(X.x,X.y,-q)}for(I=0,R=D.length;I<R;I++)for(N=D[I],V=w[I],B=0,j=N.length;B<j;B++)X=n(N[B],V[B],z),a(X.x,X.y,-q)}for(z=v,B=0;B<F;B++)X=b?n(t[B],W[B],z):t[B],E?(A.copy(S.normals[0]).multiplyScalar(X.x),C.copy(S.binormals[0]).multiplyScalar(X.y),P.copy(M[0]).add(A).add(C),a(P.x,P.y,P.z)):a(X.x,X.y,0);for(j=1;j<=_;j++)for(B=0;B<F;B++)X=b?n(t[B],W[B],z):t[B],E?(A.copy(S.normals[j]).multiplyScalar(X.x),C.copy(S.binormals[j]).multiplyScalar(X.y),P.copy(M[j]).add(A).add(C),a(P.x,P.y,P.z)):a(X.x,X.y,m/_*j);for(G=y-1;0<=G;G--){for(j=G/y,q=g*Math.cos(j*Math.PI/2),z=v*Math.sin(j*Math.PI/2),B=0,j=k.length;B<j;B++)X=n(k[B],x[B],z),a(X.x,X.y,m+q);for(I=0,R=D.length;I<R;I++)for(N=D[I],V=w[I],B=0,j=N.length;B<j;B++)X=n(N[B],V[B],z),E?a(X.x,X.y+M[_-1].y,M[_-1].x+q):a(X.x,X.y,m+q)}!function(){var t=u.length/3;if(b){var i=0*F;for(B=0;B<U;B++)H=O[B],l(H[2]+i,H[1]+i,H[0]+i);for(i=F*(_+2*y),B=0;B<U;B++)H=O[B],l(H[0]+i,H[1]+i,H[2]+i)}else{for(B=0;B<U;B++)H=O[B],l(H[2],H[1],H[0]);for(B=0;B<U;B++)H=O[B],l(H[0]+F*_,H[1]+F*_,H[2]+F*_)}L.addGroup(t,u.length/3-t,void 0!==e.material?e.material:0)}(),function(){var t=u.length/3,i=0;for(o(k,i),i+=k.length,I=0,R=D.length;I<R;I++)N=D[I],o(N,i),i+=N.length;L.addGroup(t,u.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}(),e.arrays||(this.setIndex(d),this.addAttribute("position",new ft(u,3)),this.addAttribute("uv",new ft(p,2)))},Ye.WorldUVGenerator={generateTopUV:function(t,e,n,r,s){t=e[3*r],r=e[3*r+1];var o=e[3*s];return s=e[3*s+1],[new i(e[3*n],e[3*n+1]),new i(t,r),new i(o,s)]},generateSideWallUV:function(t,e,n,r,s,o){t=e[3*n];var a=e[3*n+1];n=e[3*n+2];var l=e[3*r],h=e[3*r+1];r=e[3*r+2];var c=e[3*s],u=e[3*s+1];s=e[3*s+2];var d=e[3*o],p=e[3*o+1];return e=e[3*o+2],.01>Math.abs(a-h)?[new i(t,1-n),new i(l,1-r),new i(c,1-s),new i(d,1-e)]:[new i(a,1-n),new i(h,1-r),new i(u,1-s),new i(p,1-e)]}},(Je.prototype=Object.create(st.prototype)).constructor=Je,(Ze.prototype=Object.create($e.prototype)).constructor=Ze,(Ke.prototype=Object.create(st.prototype)).constructor=Ke,(Qe.prototype=Object.create(yt.prototype)).constructor=Qe,(ti.prototype=Object.create(st.prototype)).constructor=ti,(ei.prototype=Object.create(yt.prototype)).constructor=ei,(ii.prototype=Object.create(st.prototype)).constructor=ii,(ni.prototype=Object.create(yt.prototype)).constructor=ni,(ri.prototype=Object.create(st.prototype)).constructor=ri,ri.prototype.toJSON=function(){var t=st.prototype.toJSON.call(this);return oi(this.parameters.shapes,t)},(si.prototype=Object.create(yt.prototype)).constructor=si,si.prototype.toJSON=function(){var t=yt.prototype.toJSON.call(this);return oi(this.parameters.shapes,t)},(ai.prototype=Object.create(yt.prototype)).constructor=ai,(li.prototype=Object.create(st.prototype)).constructor=li,(hi.prototype=Object.create(yt.prototype)).constructor=hi,(ci.prototype=Object.create(li.prototype)).constructor=ci,(ui.prototype=Object.create(hi.prototype)).constructor=ui,(di.prototype=Object.create(st.prototype)).constructor=di,(pi.prototype=Object.create(yt.prototype)).constructor=pi;var Ur=Object.freeze({WireframeGeometry:pe,ParametricGeometry:fe,ParametricBufferGeometry:me,TetrahedronGeometry:ye,TetrahedronBufferGeometry:be,OctahedronGeometry:xe,OctahedronBufferGeometry:_e,IcosahedronGeometry:we,IcosahedronBufferGeometry:Ee,DodecahedronGeometry:Te,DodecahedronBufferGeometry:Me,PolyhedronGeometry:ge,PolyhedronBufferGeometry:ve,TubeGeometry:Se,TubeBufferGeometry:Ce,TorusKnotGeometry:Ae,TorusKnotBufferGeometry:Pe,TorusGeometry:Re,TorusBufferGeometry:Le,TextGeometry:Je,TextBufferGeometry:Ze,SphereGeometry:Ke,SphereBufferGeometry:Qe,RingGeometry:ti,RingBufferGeometry:ei,PlaneGeometry:_t,PlaneBufferGeometry:wt,LatheGeometry:ii,LatheBufferGeometry:ni,ShapeGeometry:ri,ShapeBufferGeometry:si,ExtrudeGeometry:Ye,ExtrudeBufferGeometry:$e,EdgesGeometry:ai,ConeGeometry:ci,ConeBufferGeometry:ui,CylinderGeometry:li,CylinderBufferGeometry:hi,CircleGeometry:di,CircleBufferGeometry:pi,BoxGeometry:bt,BoxBufferGeometry:xt});(fi.prototype=Object.create(V.prototype)).constructor=fi,fi.prototype.isShadowMaterial=!0,(mi.prototype=Object.create(Tt.prototype)).constructor=mi,mi.prototype.isRawShaderMaterial=!0,(gi.prototype=Object.create(V.prototype)).constructor=gi,gi.prototype.isMeshStandardMaterial=!0,gi.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(vi.prototype=Object.create(gi.prototype)).constructor=vi,vi.prototype.isMeshPhysicalMaterial=!0,vi.prototype.copy=function(t){return gi.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},(yi.prototype=Object.create(V.prototype)).constructor=yi,yi.prototype.isMeshPhongMaterial=!0,yi.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(bi.prototype=Object.create(yi.prototype)).constructor=bi,bi.prototype.isMeshToonMaterial=!0,bi.prototype.copy=function(t){return yi.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},(xi.prototype=Object.create(V.prototype)).constructor=xi,xi.prototype.isMeshNormalMaterial=!0,xi.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(_i.prototype=Object.create(V.prototype)).constructor=_i,_i.prototype.isMeshLambertMaterial=!0,_i.prototype.copy=function(t){return V.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(wi.prototype=Object.create(ne.prototype)).constructor=wi,wi.prototype.isLineDashedMaterial=!0,wi.prototype.copy=function(t){return ne.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Br=Object.freeze({ShadowMaterial:fi,SpriteMaterial:Zt,RawShaderMaterial:mi,ShaderMaterial:Tt,PointsMaterial:ae,MeshPhysicalMaterial:vi,MeshStandardMaterial:gi,MeshPhongMaterial:yi,MeshToonMaterial:bi,MeshNormalMaterial:xi,MeshLambertMaterial:_i,MeshDepthMaterial:q,MeshDistanceMaterial:X,MeshBasicMaterial:Et,LineDashedMaterial:wi,LineBasicMaterial:ne,Material:V}),jr={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Gr=new Ei,Wr={};Object.assign(Ti.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,s=jr.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;if(void 0===Wr[t]){if(a=t.match(/^data:(.*?)(;base64)?,(.*)$/)){i=a[1];var o=!!a[2],a=a[3];a=window.decodeURIComponent(a);o&&(a=window.atob(a));try{var l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":var h=new Uint8Array(a.length);for(o=0;o<a.length;o++)h[o]=a.charCodeAt(o);var c="blob"===l?new Blob([h.buffer],{type:i}):h.buffer;break;case"document":c=(new DOMParser).parseFromString(a,i);break;case"json":c=JSON.parse(a);break;default:c=a}window.setTimeout(function(){e&&e(c),r.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)},0)}}else{Wr[t]=[],Wr[t].push({onLoad:e,onProgress:i,onError:n});var u=new XMLHttpRequest;u.open("GET",t,!0),u.addEventListener("load",function(e){var i=this.response;jr.add(t,i);var n=Wr[t];if(delete Wr[t],200===this.status){for(var s=0,o=n.length;s<o;s++){var a=n[s];a.onLoad&&a.onLoad(i)}r.manager.itemEnd(t)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),s=0,o=n.length;s<o;s++)(a=n[s]).onLoad&&a.onLoad(i);r.manager.itemEnd(t)}else{for(s=0,o=n.length;s<o;s++)(a=n[s]).onError&&a.onError(e);r.manager.itemEnd(t),r.manager.itemError(t)}},!1),u.addEventListener("progress",function(e){for(var i=Wr[t],n=0,r=i.length;n<r;n++){var s=i[n];s.onProgress&&s.onProgress(e)}},!1),u.addEventListener("error",function(e){var i=Wr[t];delete Wr[t];for(var n=0,s=i.length;n<s;n++){var o=i[n];o.onError&&o.onError(e)}r.manager.itemEnd(t),r.manager.itemError(t)},!1),void 0!==this.responseType&&(u.responseType=this.responseType),void 0!==this.withCredentials&&(u.withCredentials=this.withCredentials),u.overrideMimeType&&u.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(o in this.requestHeader)u.setRequestHeader(o,this.requestHeader[o]);u.send(null)}return r.manager.itemStart(t),u}Wr[t].push({onLoad:e,onProgress:i,onError:n})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Mi.prototype,{load:function(t,e,i,n){function r(r){h.load(t[r],function(t){t=o._parser(t,!0),a[r]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(s+=1)&&(1===t.mipmapCount&&(l.minFilter=1006),l.format=t.format,l.needsUpdate=!0,e&&e(l))},i,n)}var s,o=this,a=[],l=new ue;l.image=a;var h=new Ti(this.manager);if(h.setPath(this.path),h.setResponseType("arraybuffer"),Array.isArray(t))for(var c=s=0,u=t.length;c<u;++c)r(c);else h.load(t,function(t){if((t=o._parser(t,!0)).isCubemap)for(var i=t.mipmaps.length/t.mipmapCount,n=0;n<i;n++){a[n]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)a[n].mipmaps.push(t.mipmaps[n*t.mipmapCount+r]),a[n].format=t.format,a[n].width=t.width,a[n].height=t.height}else l.image.width=t.width,l.image.height=t.height,l.mipmaps=t.mipmaps;1===t.mipmapCount&&(l.minFilter=1006),l.format=t.format,l.needsUpdate=!0,e&&e(l)},i,n);return l},setPath:function(t){return this.path=t,this}}),Object.assign(Si.prototype,{load:function(t,e,i,n){var r=this,s=new u,o=new Ti(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?s.image=t.image:void 0!==t.data&&(s.image.width=t.width,s.image.height=t.height,s.image.data=t.data),s.wrapS=void 0!==t.wrapS?t.wrapS:1001,s.wrapT=void 0!==t.wrapT?t.wrapT:1001,s.magFilter=void 0!==t.magFilter?t.magFilter:1006,s.minFilter=void 0!==t.minFilter?t.minFilter:1008,s.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(s.format=t.format),void 0!==t.type&&(s.type=t.type),void 0!==t.mipmaps&&(s.mipmaps=t.mipmaps),1===t.mipmapCount&&(s.minFilter=1006),s.needsUpdate=!0,e&&e(s,t))},i,n),s}}),Object.assign(Ci.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,s=jr.get(t);return void 0!==s?(r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s):((i=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){jr.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),i.addEventListener("error",function(e){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin),r.manager.itemStart(t),i.src=t,i)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Ai.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){function r(i){o.load(t[i],function(t){s.images[i]=t,6===++a&&(s.needsUpdate=!0,e&&e(s))},void 0,n)}var s=new d,o=new Ci(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;for(i=0;i<t.length;++i)r(i);return s},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Pi.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){var r=new a,s=new Ci(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(i){r.image=i,i=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/),r.format=i?1022:1023,r.needsUpdate=!0,void 0!==e&&e(r)},i,n),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Ri.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i=[],n=this.getPoint(0),r=0;for(i.push(0),e=1;e<=t;e++){var s=this.getPoint(e/t);r+=s.distanceTo(n),i.push(r),n=s}return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i=this.getLengths(),n=i.length;e=e||t*i[n-1];for(var r,s=0,o=n-1;s<=o;)if(t=Math.floor(s+(o-s)/2),0>(r=i[t]-e))s=t+1;else{if(!(0<r)){o=t;break}o=t-1}return t=o,i[t]===e?t/(n-1):(s=i[t],(t+(e-s)/(i[t+1]-s))/(n-1))},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){var i,r=new s,o=[],a=[],l=[],h=new s,c=new n;for(i=0;i<=t;i++){var u=i/t;o[i]=this.getTangentAt(u),o[i].normalize()}a[0]=new s,l[0]=new s,i=Number.MAX_VALUE,u=Math.abs(o[0].x);var d=Math.abs(o[0].y),p=Math.abs(o[0].z);for(u<=i&&(i=u,r.set(1,0,0)),d<=i&&(i=d,r.set(0,1,0)),p<=i&&r.set(0,0,1),h.crossVectors(o[0],r).normalize(),a[0].crossVectors(o[0],h),l[0].crossVectors(o[0],a[0]),i=1;i<=t;i++)a[i]=a[i-1].clone(),l[i]=l[i-1].clone(),h.crossVectors(o[i-1],o[i]),h.length()>Number.EPSILON&&(h.normalize(),r=Math.acos(br.clamp(o[i-1].dot(o[i]),-1,1)),a[i].applyMatrix4(c.makeRotationAxis(h,r))),l[i].crossVectors(o[i],a[i]);if(!0===e)for(r=Math.acos(br.clamp(a[0].dot(a[t]),-1,1)),r/=t,0<o[0].dot(h.crossVectors(a[0],a[t]))&&(r=-r),i=1;i<=t;i++)a[i].applyMatrix4(c.makeRotationAxis(o[i],r*i)),l[i].crossVectors(o[i],a[i]);return{tangents:o,normals:a,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(Li.prototype=Object.create(Ri.prototype)).constructor=Li,Li.prototype.isEllipseCurve=!0,Li.prototype.getPoint=function(t,e){e=e||new i;for(var n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;0>r;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=s?0:n),!0!==this.aClockwise||s||(r=r===n?-n:r-n),n=this.aStartAngle+t*r,t=this.aX+this.xRadius*Math.cos(n);var o=this.aY+this.yRadius*Math.sin(n);return 0!==this.aRotation&&(n=Math.cos(this.aRotation),r=Math.sin(this.aRotation),s=t-this.aX,o-=this.aY,t=s*n-o*r+this.aX,o=s*r+o*n+this.aY),e.set(t,o)},Li.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Li.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Li.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(Di.prototype=Object.create(Li.prototype)).constructor=Di,Di.prototype.isArcCurve=!0;var Vr=new s,qr=new Ii,Xr=new Ii,Yr=new Ii;(Ni.prototype=Object.create(Ri.prototype)).constructor=Ni,Ni.prototype.isCatmullRomCurve3=!0,Ni.prototype.getPoint=function(t,e){e=e||new s;var i=this.points;t*=(l=i.length)-(this.closed?0:1);if(t-=h=Math.floor(t),this.closed?h+=0<h?0:(Math.floor(Math.abs(h)/i.length)+1)*i.length:0===t&&h===l-1&&(h=l-2,t=1),this.closed||0<h)var n=i[(h-1)%l];else Vr.subVectors(i[0],i[1]).add(i[0]),n=Vr;var r=i[h%l],o=i[(h+1)%l];if(this.closed||h+2<l?i=i[(h+2)%l]:(Vr.subVectors(i[l-1],i[l-2]).add(i[l-1]),i=Vr),"centripetal"===this.curveType||"chordal"===this.curveType){var a="chordal"===this.curveType?.5:.25,l=Math.pow(n.distanceToSquared(r),a),h=Math.pow(r.distanceToSquared(o),a);a=Math.pow(o.distanceToSquared(i),a);1e-4>h&&(h=1),1e-4>l&&(l=h),1e-4>a&&(a=h),qr.initNonuniformCatmullRom(n.x,r.x,o.x,i.x,l,h,a),Xr.initNonuniformCatmullRom(n.y,r.y,o.y,i.y,l,h,a),Yr.initNonuniformCatmullRom(n.z,r.z,o.z,i.z,l,h,a)}else"catmullrom"===this.curveType&&(qr.initCatmullRom(n.x,r.x,o.x,i.x,this.tension),Xr.initCatmullRom(n.y,r.y,o.y,i.y,this.tension),Yr.initCatmullRom(n.z,r.z,o.z,i.z,this.tension));return e.set(qr.calc(t),Xr.calc(t),Yr.calc(t)),e},Ni.prototype.copy=function(t){Ri.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Ni.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Ni.prototype.fromJSON=function(t){Ri.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new s).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(Hi.prototype=Object.create(Ri.prototype)).constructor=Hi,Hi.prototype.isCubicBezierCurve=!0,Hi.prototype.getPoint=function(t,e){e=e||new i;var n=this.v0,r=this.v1,s=this.v2,o=this.v3;return e.set(zi(t,n.x,r.x,s.x,o.x),zi(t,n.y,r.y,s.y,o.y)),e},Hi.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Hi.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Hi.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(Fi.prototype=Object.create(Ri.prototype)).constructor=Fi,Fi.prototype.isCubicBezierCurve3=!0,Fi.prototype.getPoint=function(t,e){e=e||new s;var i=this.v0,n=this.v1,r=this.v2,o=this.v3;return e.set(zi(t,i.x,n.x,r.x,o.x),zi(t,i.y,n.y,r.y,o.y),zi(t,i.z,n.z,r.z,o.z)),e},Fi.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Fi.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Fi.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(Ui.prototype=Object.create(Ri.prototype)).constructor=Ui,Ui.prototype.isLineCurve=!0,Ui.prototype.getPoint=function(t,e){return e=e||new i,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Ui.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Ui.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Ui.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ui.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ui.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Bi.prototype=Object.create(Ri.prototype)).constructor=Bi,Bi.prototype.isLineCurve3=!0,Bi.prototype.getPoint=function(t,e){return e=e||new s,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Bi.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Bi.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Bi.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Bi.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(ji.prototype=Object.create(Ri.prototype)).constructor=ji,ji.prototype.isQuadraticBezierCurve=!0,ji.prototype.getPoint=function(t,e){e=e||new i;var n=this.v0,r=this.v1,s=this.v2;return e.set(ki(t,n.x,r.x,s.x),ki(t,n.y,r.y,s.y)),e},ji.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ji.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ji.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Gi.prototype=Object.create(Ri.prototype)).constructor=Gi,Gi.prototype.isQuadraticBezierCurve3=!0,Gi.prototype.getPoint=function(t,e){e=e||new s;var i=this.v0,n=this.v1,r=this.v2;return e.set(ki(t,i.x,n.x,r.x),ki(t,i.y,n.y,r.y),ki(t,i.z,n.z,r.z)),e},Gi.prototype.copy=function(t){return Ri.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gi.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gi.prototype.fromJSON=function(t){return Ri.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Wi.prototype=Object.create(Ri.prototype)).constructor=Wi,Wi.prototype.isSplineCurve=!0,Wi.prototype.getPoint=function(t,e){e=e||new i;var n=(n=((a=this.points).length-1)*t)-(t=Math.floor(n)),r=a[0===t?t:t-1],s=a[t],o=a[t>a.length-2?a.length-1:t+1],a=a[t>a.length-3?a.length-1:t+2];return e.set(Oi(n,r.x,s.x,o.x,a.x),Oi(n,r.y,s.y,o.y,a.y)),e},Wi.prototype.copy=function(t){Ri.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++)this.points.push(t.points[e].clone());return this},Wi.prototype.toJSON=function(){var t=Ri.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++)t.points.push(this.points[e].toArray());return t},Wi.prototype.fromJSON=function(t){Ri.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new i).fromArray(r))}return this};var $r=Object.freeze({ArcCurve:Di,CatmullRomCurve3:Ni,CubicBezierCurve:Hi,CubicBezierCurve3:Fi,EllipseCurve:Li,LineCurve:Ui,LineCurve3:Bi,QuadraticBezierCurve:ji,QuadraticBezierCurve3:Gi,SplineCurve:Wi});Vi.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Vi,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ui(e,t))},getPoint:function(t){var e=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=e)return e=i[t]-e,t=this.curves[t],i=t.getLength(),t.getPointAt(0===i?0:1-e/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var s=r[n],o=(s=s.getPoints(s&&s.isEllipseCurve?2*t:s&&s.isLineCurve?1:s&&s.isSplineCurve?t*s.points.length:t),0);o<s.length;o++){var a=s[o];e&&e.equals(a)||(i.push(a),e=a)}return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){Ri.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Ri.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){Ri.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push((new $r[n.type]).fromJSON(n))}return this}}),qi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:qi,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Ui(this.currentPoint.clone(),new i(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){t=new ji(this.currentPoint.clone(),new i(t,e),new i(n,r)),this.curves.push(t),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,s,o){t=new Hi(this.currentPoint.clone(),new i(t,e),new i(n,r),new i(s,o)),this.curves.push(t),this.currentPoint.set(s,o)},splineThru:function(t){var e=new Wi(e=[this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,s){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,i,n,r,s)},absarc:function(t,e,i,n,r,s){this.absellipse(t,e,i,i,n,r,s)},ellipse:function(t,e,i,n,r,s,o,a){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,i,n,r,s,o,a)},absellipse:function(t,e,i,n,r,s,o,a){t=new Li(t,e,i,n,r,s,o,a),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)},copy:function(t){return Vi.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Vi.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Vi.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Xi.prototype=Object.assign(Object.create(qi.prototype),{constructor:Xi,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){qi.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=qi.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){qi.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push((new qi).fromJSON(n))}return this}}),Yi.prototype=Object.assign(Object.create(et.prototype),{constructor:Yi,isLight:!0,copy:function(t){return et.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=et.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),$i.prototype=Object.assign(Object.create(Yi.prototype),{constructor:$i,isHemisphereLight:!0,copy:function(t){return Yi.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Ji.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Zi.prototype=Object.assign(Object.create(Ji.prototype),{constructor:Zi,isSpotLightShadow:!0,update:function(t){var e=this.camera,i=2*br.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height;t=t.distance||e.far,i===e.fov&&n===e.aspect&&t===e.far||(e.fov=i,e.aspect=n,e.far=t,e.updateProjectionMatrix())}}),Ki.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Ki,isSpotLight:!0,copy:function(t){return Yi.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Qi.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Qi,isPointLight:!0,copy:function(t){return Yi.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),tn.prototype=Object.assign(Object.create(Ji.prototype),{constructor:tn}),en.prototype=Object.assign(Object.create(Yi.prototype),{constructor:en,isDirectionalLight:!0,copy:function(t){return Yi.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),nn.prototype=Object.assign(Object.create(Yi.prototype),{constructor:nn,isAmbientLight:!0}),rn.prototype=Object.assign(Object.create(Yi.prototype),{constructor:rn,isRectAreaLight:!0,copy:function(t){return Yi.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=Yi.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}}),sn.prototype=Object.assign(Object.create(mn.prototype),{constructor:sn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),on.prototype=Object.assign(Object.create(mn.prototype),{constructor:on,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(an.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{i:{n:if(!(t<n)){for(var s=i+2;;){if(void 0===n){if(t<r)break n;return this._cachedIndex=i=e.length,this.afterEnd_(i-1,t,r)}if(i===s)break;if(r=n,n=e[++i],t<n)break e}n=e.length;break i}if(t>=r)break t;for(t<(s=e[1])&&(i=2,r=s),s=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===s)break;if(n=r,r=e[--i-1],t>=r)break e}n=i,i=0}for(;i<n;)r=i+n>>>1,t<e[r]?n=r:i=r+1;if(n=e[i],void 0===(r=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return this._cachedIndex=i=e.length,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize;t*=n;for(var r=0;r!==n;++r)e[r]=i[t+r];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(an.prototype,{beforeStart_:an.prototype.copySampleValue_,afterEnd_:an.prototype.copySampleValue_}),ln.prototype=Object.assign(Object.create(an.prototype),{constructor:ln,interpolate_:function(t,e,i,n){var s=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(e=(i-e)/(n-e),i=(t*=a)+a;t!==i;t+=4)r.slerpFlat(s,0,o,t-a,o,t,e);return s}}),hn.prototype=Object.assign(Object.create(mn.prototype),{constructor:hn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new ln(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),cn.prototype=Object.assign(Object.create(mn.prototype),{constructor:cn,ValueTypeName:"color"}),un.prototype=Object.assign(Object.create(mn.prototype),{constructor:un,ValueTypeName:"number"}),dn.prototype=Object.assign(Object.create(an.prototype),{constructor:dn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,s=t+1,o=n[r],a=n[s];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=t,o=2*e-i;break;case 2402:o=e+n[r=n.length-2]-n[r+1];break;default:r=t,o=i}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:s=t,a=2*i-e;break;case 2402:s=1,a=i+n[1]-n[0];break;default:s=t-1,a=e}t=.5*(i-e),n=this.valueSize,this._weightPrev=t/(e-o),this._weightNext=t/(a-i),this._offsetPrev=r*n,this._offsetNext=s*n},interpolate_:function(t,e,i,n){var r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(t*=o)-o,l=this._offsetPrev,h=this._offsetNext,c=this._weightPrev,u=this._weightNext,d=(i-e)/(n-e);for(e=-c*(n=(i=d*d)*d)+2*c*i-c*d,c=(1+c)*n+(-1.5-2*c)*i+(-.5+c)*d+1,d=(-1-u)*n+(1.5+u)*i+.5*d,u=u*n-u*i,i=0;i!==o;++i)r[i]=e*s[l+i]+c*s[a+i]+d*s[t+i]+u*s[h+i];return r}}),pn.prototype=Object.assign(Object.create(an.prototype),{constructor:pn,interpolate_:function(t,e,i,n){var r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(t*=o)-o;for(i=1-(e=(i-e)/(n-e)),n=0;n!==o;++n)r[n]=s[a+n]*i+s[t+n]*e;return r}}),fn.prototype=Object.assign(Object.create(an.prototype),{constructor:fn,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Jr={arraySlice:function(t,e,i){return Jr.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,i=Array(e),n=0;n!==e;++n)i[n]=n;return i.sort(function(e,i){return t[e]-t[i]}),i},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),s=0,o=0;o!==n;++s)for(var a=i[s]*e,l=0;l!==e;++l)r[o++]=t[a+l];return r},flattenJSON:function(t,e,i,n){for(var r=1,s=t[0];void 0!==s&&void 0===s[n];)s=t[r++];if(void 0!==s){var o=s[n];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=s[n])&&(e.push(s.time),i.push.apply(i,o)),s=t[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{void 0!==(o=s[n])&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++]}while(void 0!==s);else do{void 0!==(o=s[n])&&(e.push(s.time),i.push(o)),s=t[r++]}while(void 0!==s)}}};Object.assign(mn,{parse:function(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=mn._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];Jr.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){if(void 0!==(e=t.constructor).toJSON)e=e.toJSON(t);else{var e={name:t.name,times:Jr.convertArray(t.times,Array),values:Jr.convertArray(t.values,Array)},i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return un;case"vector":case"vector2":case"vector3":case"vector4":return gn;case"color":return cn;case"quaternion":return hn;case"bool":case"boolean":return on;case"string":return sn}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(mn.prototype,{constructor:mn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new fn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new pn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new dn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,s=n-1;r!==n&&i[r]<t;)++r;for(;-1!==s&&i[s]>e;)--s;return++s,0===r&&s===n||(r>=s&&(s=Math.max(s,1),r=s-1),t=this.getValueSize(),this.times=Jr.arraySlice(i,r,s),this.values=Jr.arraySlice(this.values,r*t,s*t)),this},validate:function(){var t=!0;0!=(i=this.getValueSize())-Math.floor(i)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var e=this.times,i=this.values,n=e.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var r=null,s=0;s!==n;s++){var o=e[s];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,o),t=!1;break}if(null!==r&&r>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,o,r),t=!1;break}r=o}if(void 0!==i&&Jr.isTypedArray(i))for(s=0,e=i.length;s!==e;++s)if(n=i[s],isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,n),t=!1;break}return t},optimize:function(){for(var t,e,i=this.times,n=this.values,r=this.getValueSize(),s=2302===this.getInterpolation(),o=1,a=i.length-1,l=1;l<a;++l){t=!1;if((u=i[l])!==i[l+1]&&(1!==l||u!==u[0]))if(s)t=!0;else for(var h=(e=l*r)-r,c=e+r,u=0;u!==r;++u){var d=n[e+u];if(d!==n[h+u]||d!==n[c+u]){t=!0;break}}if(t){if(l!==o)for(i[o]=i[l],e=l*r,t=o*r,u=0;u!==r;++u)n[t+u]=n[e+u];++o}}if(0<a){for(i[o]=i[a],e=a*r,t=o*r,u=0;u!==r;++u)n[t+u]=n[e+u];++o}return o!==i.length&&(this.times=Jr.arraySlice(i,0,o),this.values=Jr.arraySlice(n,0,o*r)),this}}),gn.prototype=Object.assign(Object.create(mn.prototype),{constructor:gn,ValueTypeName:"vector"}),Object.assign(vn,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,s=i.length;r!==s;++r)e.push(mn.parse(i[r]).scale(n));return new vn(t.name,t.duration,e)},toJSON:function(t){var e=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var n=0,r=i.length;n!==r;++n)e.push(mn.toJSON(i[n]));return t},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,s=[],o=0;o<r;o++){var a=[];(h=[]).push((o+r-1)%r,o,(o+1)%r),a.push(0,1,0);var l=Jr.getKeyframeOrder(h),h=Jr.sortedArray(h,1,l);a=Jr.sortedArray(a,1,l);n||0!==h[0]||(h.push(r),a.push(a[0])),s.push(new un(".morphTargetInfluences["+e[o].name+"]",h,a).scale(1/i))}return new vn(t,-1,s)},findByName:function(t,e){var i=t;for(Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations),t=0;t<i.length;t++)if(i[t].name===e)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n,r={},s=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var l=t[o],h=l.name.match(s);h&&1<h.length&&(n=h[1],(h=r[n])||(r[n]=h=[]),h.push(l))}t=[];for(n in r)t.push(vn.CreateFromMorphTargetSequence(n,r[n],e,i));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var i=function(t,e,i,n,r){if(0!==i.length){var s=[],o=[];Jr.flattenJSON(i,s,o,n),0!==s.length&&r.push(new t(e,s,o))}},n=[],r=t.name||"default",s=t.length||-1,o=t.fps||30;t=t.hierarchy||[];for(var a=0;a<t.length;a++){var l=t[a].keys;if(l&&0!==l.length)if(l[0].morphTargets){s={};for(var h=0;h<l.length;h++)if(l[h].morphTargets)for(var c=0;c<l[h].morphTargets.length;c++)s[l[h].morphTargets[c]]=-1;for(var u in s){var d=[],p=[];for(c=0;c!==l[h].morphTargets.length;++c){var f=l[h];d.push(f.time),p.push(f.morphTarget===u?1:0)}n.push(new un(".morphTargetInfluence["+u+"]",d,p))}s=s.length*(o||1)}else h=".bones["+e[a].name+"]",i(gn,h+".position",l,"pos",n),i(hn,h+".quaternion",l,"rot",n),i(gn,h+".scale",l,"scl",n)}return 0===n.length?null:new vn(r,s,n)}}),Object.assign(vn.prototype,{resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(yn.prototype,{load:function(t,e,i,n){var r=this;new Ti(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,r=new Br[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new i).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),r}}),Object.assign(bn.prototype,{load:function(t,e,i,n){var r=this;new Ti(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new yt,i=t.data.index;void 0!==i&&(i=new Zr[i.type](i.array),e.setIndex(new ot(i,1)));var n=t.data.attributes;for(o in n){var r=n[o];i=new Zr[r.type](r.array),e.addAttribute(o,new ot(i,r.itemSize,r.normalized))}var o=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==o)for(i=0,n=o.length;i!==n;++i)r=o[i],e.addGroup(r.start,r.count,r.materialIndex);return void 0!==(t=t.data.boundingSphere)&&(o=new s,void 0!==t.center&&o.fromArray(t.center),e.boundingSphere=new $(o,t.radius)),e}});var Zr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};xn.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var r=e[i+1];if(e[i].test(t))return r}return null}},Object.assign(xn.prototype,{crossOrigin:void 0,initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:function(){var t={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},e=new j,i=new Pi,n=new yn;return function(r,s,o){function a(t,e,n,r,a){t=s+t;var l=xn.Handlers.get(t);return null!==l?t=l.load(t):(i.setCrossOrigin(o),t=i.load(t)),void 0!==e&&(t.repeat.fromArray(e),1!==e[0]&&(t.wrapS=1e3),1!==e[1]&&(t.wrapT=1e3)),void 0!==n&&t.offset.fromArray(n),void 0!==r&&("repeat"===r[0]&&(t.wrapS=1e3),"mirror"===r[0]&&(t.wrapS=1002),"repeat"===r[1]&&(t.wrapT=1e3),"mirror"===r[1]&&(t.wrapT=1002)),void 0!==a&&(t.anisotropy=a),e=br.generateUUID(),h[e]=t,e}var l,h={},c={uuid:br.generateUUID(),type:"MeshLambertMaterial"};for(l in r){var u=r[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=u;break;case"blending":c.blending=t[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=e.fromArray(u).getHex();break;case"colorSpecular":c.specular=e.fromArray(u).getHex();break;case"colorEmissive":c.emissive=e.fromArray(u).getHex();break;case"specularCoef":c.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=a(u,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=a(u,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=a(u,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=a(u,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=a(u,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=a(u,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=a(u,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=a(u,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=a(u,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=a(u,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=1;break;case"doubleSided":c.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=u;break;case"vertexColors":!0===u&&(c.vertexColors=2),"face"===u&&(c.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,u)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,1>c.opacity&&(c.transparent=!0),n.setTextures(h),n.parse(c)}}()});var Kr={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);return e},extractUrlBase:function(t){return 1===(t=t.split("/")).length?"./":(t.pop(),t.join("/")+"/")}};Object.assign(_n.prototype,{load:function(t,e,i,n){var r=this,s=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Kr.extractUrlBase(t),o=new Ti(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(i){var n=(i=JSON.parse(i)).metadata;if(void 0!==n&&void 0!==(n=n.type)){if("object"===n.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===n.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}i=r.parse(i,s),e(i.geometry,i.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){void 0!==t.data&&(t=t.data),t.scale=void 0!==t.scale?1/t.scale:1;var n,r,o,a=new st,h=t,c=h.faces,u=h.vertices,d=h.normals,p=h.colors,f=h.scale,m=0;if(void 0!==h.uvs){for(n=0;n<h.uvs.length;n++)h.uvs[n].length&&m++;for(n=0;n<m;n++)a.faceVertexUvs[n]=[]}var g=0;for(o=u.length;g<o;)n=new s,n.x=u[g++]*f,n.y=u[g++]*f,n.z=u[g++]*f,a.vertices.push(n);for(g=0,o=c.length;g<o;){var v=1&(u=c[g++]),y=2&u;n=8&u;var b=16&u,x=32&u;if(f=64&u,u&=128,v){(v=new rt).a=c[g],v.b=c[g+1],v.c=c[g+3];var _=new rt;if(_.a=c[g+1],_.b=c[g+2],_.c=c[g+3],g+=4,y&&(y=c[g++],v.materialIndex=y,_.materialIndex=y),y=a.faces.length,n)for(n=0;n<m;n++){var w=h.uvs[n];for(a.faceVertexUvs[n][y]=[],a.faceVertexUvs[n][y+1]=[],r=0;4>r;r++){var E=c[g++],T=w[2*E];T=new i(T,E=w[2*E+1]),2!==r&&a.faceVertexUvs[n][y].push(T),0!==r&&a.faceVertexUvs[n][y+1].push(T)}}if(b&&(b=3*c[g++],v.normal.set(d[b++],d[b++],d[b]),_.normal.copy(v.normal)),x)for(n=0;4>n;n++)b=3*c[g++],x=new s(d[b++],d[b++],d[b]),2!==n&&v.vertexNormals.push(x),0!==n&&_.vertexNormals.push(x);if(f&&(f=c[g++],f=p[f],v.color.setHex(f),_.color.setHex(f)),u)for(n=0;4>n;n++)f=c[g++],f=p[f],2!==n&&v.vertexColors.push(new j(f)),0!==n&&_.vertexColors.push(new j(f));a.faces.push(v),a.faces.push(_)}else{if(v=new rt,v.a=c[g++],v.b=c[g++],v.c=c[g++],y&&(y=c[g++],v.materialIndex=y),y=a.faces.length,n)for(n=0;n<m;n++)for(w=h.uvs[n],a.faceVertexUvs[n][y]=[],r=0;3>r;r++)E=c[g++],T=w[2*E],E=w[2*E+1],T=new i(T,E),a.faceVertexUvs[n][y].push(T);if(b&&(b=3*c[g++],v.normal.set(d[b++],d[b++],d[b])),x)for(n=0;3>n;n++)b=3*c[g++],x=new s(d[b++],d[b++],d[b]),v.vertexNormals.push(x);if(f&&(f=c[g++],v.color.setHex(p[f])),u)for(n=0;3>n;n++)f=c[g++],v.vertexColors.push(new j(p[f]));a.faces.push(v)}}if(h=t,g=void 0!==h.influencesPerVertex?h.influencesPerVertex:2,h.skinWeights)for(o=0,c=h.skinWeights.length;o<c;o+=g)a.skinWeights.push(new l(h.skinWeights[o],1<g?h.skinWeights[o+1]:0,2<g?h.skinWeights[o+2]:0,3<g?h.skinWeights[o+3]:0));if(h.skinIndices)for(o=0,c=h.skinIndices.length;o<c;o+=g)a.skinIndices.push(new l(h.skinIndices[o],1<g?h.skinIndices[o+1]:0,2<g?h.skinIndices[o+2]:0,3<g?h.skinIndices[o+3]:0));if(a.bones=h.bones,a.bones&&0<a.bones.length&&(a.skinWeights.length!==a.skinIndices.length||a.skinIndices.length!==a.vertices.length)&&console.warn("When skinning, number of vertices ("+a.vertices.length+"), skinIndices ("+a.skinIndices.length+"), and skinWeights ("+a.skinWeights.length+") should match."),o=t,c=o.scale,void 0!==o.morphTargets)for(h=0,g=o.morphTargets.length;h<g;h++)for(a.morphTargets[h]={},a.morphTargets[h].name=o.morphTargets[h].name,a.morphTargets[h].vertices=[],d=a.morphTargets[h].vertices,p=o.morphTargets[h].vertices,m=0,u=p.length;m<u;m+=3)f=new s,f.x=p[m]*c,f.y=p[m+1]*c,f.z=p[m+2]*c,d.push(f);if(void 0!==o.morphColors&&0<o.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),c=a.faces,o=o.morphColors[0].colors,h=0,g=c.length;h<g;h++)c[h].color.fromArray(o,3*h);for(h=[],g=[],void 0!==(o=t).animation&&g.push(o.animation),void 0!==o.animations&&(o.animations.length?g=g.concat(o.animations):g.push(o.animations)),o=0;o<g.length;o++)(c=vn.parseAnimation(g[o],a.bones))&&h.push(c);return a.morphTargets&&(g=vn.CreateClipsFromMorphTargetSequences(a.morphTargets,10),h=h.concat(g)),0<h.length&&(a.animations=h),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:a}:(t=xn.prototype.initMaterials(t.materials,e,this.crossOrigin),{geometry:a,materials:t})}}),Object.assign(wn.prototype,{load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this;new Ti(r.manager).load(t,function(i){var s=null;try{s=JSON.parse(i)}catch(e){return void 0!==n&&n(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}void 0===(i=s.metadata)||void 0===i.type||"geometry"===i.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):r.parse(s,e)},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseShape(t.shapes),n=(i=this.parseGeometries(t.geometries,i),this.parseImages(t.images,function(){void 0!==e&&e(r)})),r=(n=this.parseTextures(t.textures,n),n=this.parseMaterials(t.materials,n),this.parseObject(t.object,i,n));return t.animations&&(r.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(r),r},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,n=t.length;i<n;i++){var r=(new Xi).fromJSON(t[i]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var n=new _n,r=new bn,s=0,o=t.length;s<o;s++){var a=t[s];switch(a.type){case"PlaneGeometry":case"PlaneBufferGeometry":var l=new Ur[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":l=new Ur[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":l=new Ur[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":l=new Ur[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":l=new Ur[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":l=new Ur[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":l=new Ur[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":l=new Ur[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":l=new Ur[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":l=new Ur[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"LatheGeometry":case"LatheBufferGeometry":l=new Ur[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":l=new Ur[a.type](a.vertices,a.indices,a.radius,a.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(l=[],s=0,o=a.shapes.length;s<o;s++)l.push(e[a.shapes[s]]);l=new Ur[a.type](l,a.curveSegments);break;case"BufferGeometry":l=r.parse(a);break;case"Geometry":l=n.parse(a,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),i[a.uuid]=l}return i},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new yn;n.setTextures(e),e=0;for(var r=t.length;e<r;e++){var s=t[e];if("MultiMaterial"===s.type){for(var o=[],a=0;a<s.materials.length;a++)o.push(n.parse(s.materials[a]));i[s.uuid]=o}else i[s.uuid]=n.parse(s)}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=vn.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){function i(t){return n.manager.itemStart(t),s.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemEnd(t),n.manager.itemError(t)})}var n=this,r={};if(void 0!==t&&0<t.length){var s=new Ci(e=new Ei(e));s.setCrossOrigin(this.crossOrigin),e=0;for(var o=t.length;e<o;e++){var a=t[e],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a.url)?a.url:n.texturePath+a.url;r[a.uuid]=i(l)}}return r},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var r=0,s=t.length;r<s;r++){var o=t[r];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var l=new a(e[o.image]);l.needsUpdate=!0,l.uuid=o.uuid,void 0!==o.name&&(l.name=o.name),void 0!==o.mapping&&(l.mapping=i(o.mapping,Qr)),void 0!==o.offset&&l.offset.fromArray(o.offset),void 0!==o.repeat&&l.repeat.fromArray(o.repeat),void 0!==o.center&&l.center.fromArray(o.center),void 0!==o.rotation&&(l.rotation=o.rotation),void 0!==o.wrap&&(l.wrapS=i(o.wrap[0],ts),l.wrapT=i(o.wrap[1],ts)),void 0!==o.minFilter&&(l.minFilter=i(o.minFilter,es)),void 0!==o.magFilter&&(l.magFilter=i(o.magFilter,es)),void 0!==o.anisotropy&&(l.anisotropy=o.anisotropy),void 0!==o.flipY&&(l.flipY=o.flipY),n[o.uuid]=l}return n},parseObject:function(){var t=new n;return function(e,i,n){function r(t){return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),i[t]}function s(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],i=0,r=t.length;i<r;i++){var s=t[i];void 0===n[s]&&console.warn("THREE.ObjectLoader: Undefined material",s),e.push(n[s])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(e.type){case"Scene":var o=new $t;void 0!==e.background&&Number.isInteger(e.background)&&(o.background=new j(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new Yt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Xt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new jt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new nt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":o=new nn(e.color,e.intensity);break;case"DirectionalLight":o=new en(e.color,e.intensity);break;case"PointLight":o=new Qi(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new rn(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Ki(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new $i(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":o=r(e.geometry);var a=s(e.material);o=o.bones&&0<o.bones.length?new ie(o,a):new At(o,a);break;case"LOD":o=new Qt;break;case"Line":o=new re(r(e.geometry),s(e.material),e.mode);break;case"LineLoop":o=new oe(r(e.geometry),s(e.material));break;case"LineSegments":o=new se(r(e.geometry),s(e.material));break;case"PointCloud":case"Points":o=new le(r(e.geometry),s(e.material));break;case"Sprite":o=new Kt(s(e.material));break;case"Group":o=new he;break;default:o=new et}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.children){a=e.children;for(var l=0;l<a.length;l++)o.add(this.parseObject(a[l],i,n))}if("LOD"===e.type)for(e=e.levels,a=0;a<e.length;a++){l=e[a];var h=o.getObjectByProperty("uuid",l.object);void 0!==h&&o.addLevel(h,l.distance)}return o}}()});var Qr={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},ts={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},es={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};En.prototype={constructor:En,setOptions:function(t){return this.options=t,this},load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,s=jr.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,r.options)}).then(function(i){jr.add(t,i),e&&e(i),r.manager.itemEnd(t)}).catch(function(e){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Tn.prototype,{moveTo:function(t,e){this.currentPath=new qi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,s){this.currentPath.bezierCurveTo(t,e,i,n,r,s)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],s=new Xi;s.curves=r.curves,e.push(s)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,s=0;s<i;r=s++){var o=e[r],a=e[s],l=a.x-o.x,h=a.y-o.y;if(Math.abs(h)>Number.EPSILON){if(0>h&&(o=e[s],l=-l,a=e[r],h=-h),!(t.y<o.y||t.y>a.y))if(t.y===o.y){if(t.x===o.x)return!0}else{if(0==(r=h*(t.x-o.x)-l*(t.y-o.y)))return!0;0>r||(n=!n)}}else if(t.y===o.y&&(a.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=a.x))return!0}return n}var r=Fr.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===e)return i(s);if(e=[],1===s.length){var o=s[0],a=new Xi;return a.curves=o.curves,e.push(a),e}var l=!r(s[0].getPoints());l=t?!l:l;a=[];var h=[],c=[],u=0;h[u]=void 0,c[u]=[];for(var d=0,p=s.length;d<p;d++){var f=(o=s[d]).getPoints(),m=r(f);(m=t?!m:m)?(!l&&h[u]&&u++,h[u]={s:new Xi,p:f},h[u].s.curves=o.curves,l&&u++,c[u]=[]):c[u].push({h:o,p:f[0]})}if(!h[0])return i(s);if(1<h.length){for(d=!1,t=[],r=0,s=h.length;r<s;r++)a[r]=[];for(r=0,s=h.length;r<s;r++)for(o=c[r],m=0;m<o.length;m++){for(l=o[m],u=!0,f=0;f<h.length;f++)n(l.p,h[f].p)&&(r!==f&&t.push({froms:r,tos:f,hole:m}),u?(u=!1,a[f].push(l)):d=!0);u&&a[r].push(l)}0<t.length&&(d||(c=a))}for(d=0,r=h.length;d<r;d++)for(a=h[d].s,e.push(a),t=c[d],s=0,o=t.length;s<o;s++)a.holes.push(t[s].h);return e}}),Object.assign(Mn.prototype,{isFont:!0,generateShapes:function(t,e,i){void 0===e&&(e=100),i=this.data,t=String(t).split("");var n=e/i.resolution,r=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*n,s=0,o=0;e=[];for(var a=0;a<t.length;a++){var l=t[a];if("\n"===l)s=0,o-=r;else{var h=n,c=s,u=o;if(l=i.glyphs[l]||i.glyphs["?"]){var d=new Tn;if(l.o)for(var p=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),f=0,m=p.length;f<m;)switch(p[f++]){case"m":var g=p[f++]*h+c,v=p[f++]*h+u;d.moveTo(g,v);break;case"l":g=p[f++]*h+c,v=p[f++]*h+u,d.lineTo(g,v);break;case"q":var y=p[f++]*h+c,b=p[f++]*h+u,x=p[f++]*h+c,_=p[f++]*h+u;d.quadraticCurveTo(x,_,y,b);break;case"b":y=p[f++]*h+c,b=p[f++]*h+u,x=p[f++]*h+c,_=p[f++]*h+u,g=p[f++]*h+c,v=p[f++]*h+u,d.bezierCurveTo(x,_,g,v,y,b)}h={offsetX:l.ha*h,path:d}}else h=void 0;s+=h.offsetX,e.push(h.path)}}for(i=[],t=0,n=e.length;t<n;t++)Array.prototype.push.apply(i,e[t].toShapes());return i}}),Object.assign(Sn.prototype,{load:function(t,e,i,n){var r=this,s=new Ti(this.manager);s.setPath(this.path),s.load(t,function(t){try{var i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}t=r.parse(i),e&&e(t)},i,n)},parse:function(t){return new Mn(t)},setPath:function(t){return this.path=t,this}});var is,ns={getContext:function(){return void 0===is&&(is=new(window.AudioContext||window.webkitAudioContext)),is},setContext:function(t){is=t}};Object.assign(Cn.prototype,{load:function(t,e,i,n){var r=new Ti(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){ns.getContext().decodeAudioData(t,function(t){e(t)})},i,n)}}),Object.assign(An.prototype,{update:function(){var t,e,i,r,s,o,a,l,h=new n,c=new n;return function(n){if(t!==this||e!==n.focus||i!==n.fov||r!==n.aspect*this.aspect||s!==n.near||o!==n.far||a!==n.zoom||l!==this.eyeSep){t=this,e=n.focus,i=n.fov,r=n.aspect*this.aspect,s=n.near,o=n.far,a=n.zoom;var u=n.projectionMatrix.clone(),d=(l=this.eyeSep/2)*s/e,p=s*Math.tan(br.DEG2RAD*i*.5)/a;c.elements[12]=-l,h.elements[12]=l;var f=-p*r+d,m=p*r+d;u.elements[0]=2*s/(m-f),u.elements[8]=(m+f)/(m-f),this.cameraL.projectionMatrix.copy(u),f=-p*r-d,m=p*r-d,u.elements[0]=2*s/(m-f),u.elements[8]=(m+f)/(m-f),this.cameraR.projectionMatrix.copy(u)}this.cameraL.matrixWorld.copy(n.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(n.matrixWorld).multiply(h)}}()}),(Pn.prototype=Object.create(et.prototype)).constructor=Pn,Rn.prototype=Object.assign(Object.create(et.prototype),{constructor:Rn,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new s,e=new r,i=new s,n=new s;return function(r){et.prototype.updateMatrixWorld.call(this,r),r=this.context.listener;var s=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),r.positionX?(r.positionX.setValueAtTime(t.x,this.context.currentTime),r.positionY.setValueAtTime(t.y,this.context.currentTime),r.positionZ.setValueAtTime(t.z,this.context.currentTime),r.forwardX.setValueAtTime(n.x,this.context.currentTime),r.forwardY.setValueAtTime(n.y,this.context.currentTime),r.forwardZ.setValueAtTime(n.z,this.context.currentTime),r.upX.setValueAtTime(s.x,this.context.currentTime),r.upY.setValueAtTime(s.y,this.context.currentTime),r.upZ.setValueAtTime(s.z,this.context.currentTime)):(r.setPosition(t.x,t.y,t.z),r.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z))}}()}),Ln.prototype=Object.assign(Object.create(et.prototype),{constructor:Ln,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Dn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Dn,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new s;return function(e){et.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(In.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(Nn.prototype,{accumulate:function(t,e){var i=this.buffer,n=this.valueSize;t=t*n+n;var r=this.cumulativeWeight;if(0===r){for(r=0;r!==n;++r)i[t+r]=i[r];r=e}else r+=e,this._mixBufferRegion(i,t,0,e/r,n);this.cumulativeWeight=r},apply:function(t){var e=this.valueSize,i=this.buffer;t=t*e+e;var n=this.cumulativeWeight,r=this.binding;this.cumulativeWeight=0,1>n&&this._mixBufferRegion(i,t,3*e,1-n,e);n=e;for(var s=e+e;n!==s;++n)if(i[n]!==i[n+e]){r.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,i=3*e;this.binding.getValue(t,i);for(var n=e;n!==i;++n)t[n]=t[i+n%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,i,n,r){if(.5<=n)for(n=0;n!==r;++n)t[e+n]=t[i+n]},_slerp:function(t,e,i,n){r.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var s=1-n,o=0;o!==r;++o){var a=e+o;t[a]=t[a]*s+t[i+o]*n}}}),Object.assign(On.prototype,{getValue:function(t,e){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(kn,{Composite:On,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new kn.Composite(t,e,i):new kn(t,e,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var t=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),e=["material","materials","bones"];return function(i){if(!(n=t.exec(i)))throw Error("PropertyBinding: Cannot parse trackName: "+i);var n,r=(n={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]}).nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var s=n.nodeName.substring(r+1);-1!==e.indexOf(s)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(null===n.propertyName||0===n.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+i);return n}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var n=t.bones[i];if(n.name===e)return n}return null}(t.skeleton);if(i)return i}if(t.children){var n=function(t){for(var i=0;i<t.length;i++){var r=t[i];if(r.name===e||r.uuid===e||(r=n(r.children)))return r}return null};if(t=n(t.children))return t}return null}}),Object.assign(kn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(this.node=t=kn.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var s=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===s){s=i;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==s){if(void 0===t[s])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[s]}}if(void 0===(s=t[n]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+n+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),i=this.BindingType.Direct,void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(i=0;i<this.node.geometry.morphAttributes.position.length;i++)if(t.geometry.morphAttributes.position[i].name===r){r=i;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(i=0;i<this.node.geometry.morphTargets.length;i++)if(t.geometry.morphTargets[i].name===r){r=i;break}}}i=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(i=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(i=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(kn.prototype,{_getValue_unbound:kn.prototype.getValue,_setValue_unbound:kn.prototype.setValue}),Object.assign(zn.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length,l=0,h=arguments.length;l!==h;++l){var c=arguments[l],u=n[d=c.uuid];if(void 0===u){u=e++,n[d]=u,t.push(c);for(var d=0,p=a;d!==p;++d)o[d].push(new kn(c,r[d],s[d]))}else if(u<i){var f=--i;for(n[(p=t[f]).uuid]=u,t[u]=p,n[d]=f,t[f]=c,d=0,p=a;d!==p;++d){var m=o[d],g=m[u];m[u]=m[f],void 0===g&&(g=new kn(c,r[d],s[d])),m[f]=g}}else void 0!==t[u]&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,s=0,o=arguments.length;s!==o;++s){var a=arguments[s],l=a.uuid,h=i[l];if(void 0!==h&&h>=e){var c=e++;for(i[(u=t[c]).uuid]=h,t[h]=u,i[l]=c,t[c]=a,a=0,l=r;a!==l;++a){var u,d=(u=n[a])[h];u[h]=u[c],u[c]=d}}}this.nCachedObjects_=e},uncache:function(){for(var t,e,i=this._objects,n=i.length,r=this.nCachedObjects_,s=this._indicesByUUID,o=this._bindings,a=o.length,l=0,h=arguments.length;l!==h;++l){var c=s[e=arguments[l].uuid];if(void 0!==c)if(delete s[e],c<r){var u=--r,d=i[u];t=i[e=--n],s[d.uuid]=c,i[c]=d,s[t.uuid]=u,i[u]=t,i.pop();d=0;for(var p=a;d!==p;++d){var f=(t=o[d])[e];t[c]=t[u],t[u]=f,t.pop()}}else for(e=--n,t=i[e],s[t.uuid]=c,i[c]=t,i.pop(),d=0,p=a;d!==p;++d)t=o[d],t[c]=t[e],t.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var s=this._paths,o=this._parsedPaths,a=this._objects,l=this.nCachedObjects_,h=Array(a.length);n=r.length;for(i[t]=n,s.push(t),o.push(e),r.push(h),i=l,n=a.length;i!==n;++i)h[i]=new kn(a[i],t,e);return h},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];e[t[o]]=i,s[i]=a,s.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}}),Object.assign(Hn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){i=this._clip.duration;var n=t._clip.duration,r=i/n;t.warp(1,n/i,e),this.warp(r,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,s=this._timeScaleInterpolant,o=this.timeScale;return null===s&&(this._timeScaleInterpolant=s=n._lendControlInterpolant()),n=s.parameterPositions,s=s.sampleValues,n[0]=r,n[1]=r+i,s[0]=t/o,s[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){if(this.enabled){if(null!==(r=this._startTime)){if(0>(e=(t-r)*i)||0===i)return;this._startTime=null,e*=i}if(e*=this._updateTimeScale(t),i=this._updateTime(e),0<(t=this._updateWeight(t))){e=this._interpolants;for(var r=this._propertyBindings,s=0,o=e.length;s!==o;++s)e[s].evaluate(i),r[s].accumulate(n,t)}}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e=e*n;t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){e=e*i.evaluate(t)[0];t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(2200===n)t:{if(-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1)),e>=i)e=i;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(n=2202===n,-1===r&&(0<=t?(r=0,this._setEndings(!0,0===this.repetitions,n)):this._setEndings(0===this.repetitions,!0,n)),e>=i||0>e){var s=Math.floor(e/i),o=(e=e-i*s,r=r+Math.abs(s),this.repetitions-r);0>o?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0===o?(t=0>t,this._setEndings(t,!t,n)):this._setEndings(!1,!1,n),this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s}))}if(n&&1==(1&r))return this.time=e,i-e}return this.time=e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,s=this._weightInterpolant;return null===s&&(this._weightInterpolant=s=n._lendControlInterpolant()),n=s.parameterPositions,s=s.sampleValues,n[0]=r,s[0]=e,n[1]=r+t,s[1]=i,this}}),Fn.prototype=Object.assign(Object.create(e.prototype),{constructor:Fn,_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,s=t._propertyBindings;t=t._interpolants;var o=i.uuid,a=this._bindingsByRootAndName,l=a[o];for(void 0===l&&(l={},a[o]=l),a=0;a!==r;++a){var h=n[a],c=h.name,u=l[c];if(void 0===u){if(void 0!==(u=s[a])){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,o,c));continue}++(u=new Nn(kn.create(i,c,e&&e._propertyBindings[a].binding.parsedPath),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(u,o,c)}s[a]=u,t[a].resultBuffer=u.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(i=0,n=(e=t._propertyBindings).length;i!==n;++i){var r=e[i];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,s=r[e];void 0===s?(s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s):(e=s.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),s.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=(n=this._actions)[n.length-1],i=t._cacheIndex;e._cacheIndex=i,n[i]=e,n.pop(),t._cacheIndex=null;var n=t._clip.uuid,r=(i=(e=this._actionsByClip)[n]).knownActions,s=r[r.length-1],o=t._byClipCacheIndex;s._byClipCacheIndex=o,r[o]=s,r.pop(),t._byClipCacheIndex=null,delete i.actionByRoot[(t._localRoot||this._root).uuid],0===r.length&&delete e[n],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,i=(t=t._propertyBindings).length;e!==i;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],s=this._bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=s.length,s.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=(n=t.binding).rootNode.uuid,n=n.path,r=this._bindingsByRootAndName,s=r[i],o=e[e.length-1];t=t._cacheIndex,o._cacheIndex=t,e[t]=o,e.pop(),delete s[n];t:{for(var a in s)break t;delete r[i]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new pn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i,n=(i=e||this._root).uuid;t=null!==(i="string"==typeof t?vn.findByName(i,t):t)?i.uuid:t;var r=this._actionsByClip[t],s=null;if(void 0!==r){if(void 0!==(s=r.actionByRoot[n]))return s;s=r.knownActions[0],null===i&&(i=s._clip)}return null===i?null:(e=new Hn(this,i,e),this._bindAction(e,s),this._addInactiveAction(e,t,n),e)},existingAction:function(t,e){var i=e||this._root;return e=i.uuid,i="string"==typeof t?vn.findByName(i,t):t,void 0!==(t=this._actionsByClip[i?i.uuid:t])?t.actionByRoot[e]||null:null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings,r=this._nActiveBindings=this._nActiveActions=0;r!==e;++r)t[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1,o=0;o!==i;++o)e[o]._update(n,t,r,s);for(t=this._bindings,e=this._nActiveBindings,o=0;o!==e;++o)t[o].apply(s);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var i=this._actionsByClip;if(void 0!==(n=i[t])){for(var n,r=0,s=(n=n.knownActions).length;r!==s;++r){var o=n[r];this._deactivateAction(o);var a=o._cacheIndex,l=e[e.length-1];o._cacheIndex=null,o._byClipCacheIndex=null,l._cacheIndex=a,e[a]=l,e.pop(),this._removeInactiveBindingsForAction(o)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(n in e){var i=e[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var r in n)(t=n[r]).restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Un.prototype.clone=function(){return new Un(void 0===this.value.clone?this.value:this.value.clone())},Bn.prototype=Object.assign(Object.create(yt.prototype),{constructor:Bn,isInstancedBufferGeometry:!0,copy:function(t){return yt.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(jn.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(jn.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}}),Object.defineProperty(Gn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Gn.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Wn.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Wn,isInstancedInterleavedBuffer:!0,copy:function(t){return Gn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Vn.prototype=Object.assign(Object.create(ot.prototype),{constructor:Vn,isInstancedBufferAttribute:!0,copy:function(t){return ot.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(qn.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return Yn(t,this,i,e),i.sort(Xn),i},intersectObjects:function(t,e){var i=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=t.length;n<r;n++)Yn(t[n],this,i,e);return i.sort(Xn),i}}),Object.assign($n.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3;this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Jn.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(br.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Zn.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),(Kn.prototype=Object.create(et.prototype)).constructor=Kn,Kn.prototype.isImmediateRenderObject=!0,(Qn.prototype=Object.create(se.prototype)).constructor=Qn,Qn.prototype.update=function(){var t=new s,e=new s,i=new o;return function(){var n,r=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var s=this.object.matrixWorld,o=this.geometry.attributes.position;if((n=this.object.geometry)&&n.isGeometry)for(var a=n.vertices,l=n.faces,h=n=0,c=l.length;h<c;h++)for(var u=l[h],d=0,p=u.vertexNormals.length;d<p;d++){var f=u.vertexNormals[d];t.copy(a[u[r[d]]]).applyMatrix4(s),e.copy(f).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),o.setXYZ(n,t.x,t.y,t.z),n+=1,o.setXYZ(n,e.x,e.y,e.z),n+=1}else if(n&&n.isBufferGeometry)for(r=n.attributes.position,a=n.attributes.normal,d=n=0,p=r.count;d<p;d++)t.set(r.getX(d),r.getY(d),r.getZ(d)).applyMatrix4(s),e.set(a.getX(d),a.getY(d),a.getZ(d)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),o.setXYZ(n,t.x,t.y,t.z),n+=1,o.setXYZ(n,e.x,e.y,e.z),n+=1;o.needsUpdate=!0}}(),(tr.prototype=Object.create(et.prototype)).constructor=tr,tr.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},tr.prototype.update=function(){var t=new s,e=new s;return function(){this.light.updateMatrixWorld();var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),(ir.prototype=Object.create(se.prototype)).constructor=ir,ir.prototype.updateMatrixWorld=function(){var t=new s,e=new n,i=new n;return function(n){var r=this.bones,s=this.geometry,o=s.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var a=0,l=0;a<r.length;a++){var h=r[a];h.parent&&h.parent.isBone&&(e.multiplyMatrices(i,h.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(l,t.x,t.y,t.z),e.multiplyMatrices(i,h.parent.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(l+1,t.x,t.y,t.z),l+=2)}s.getAttribute("position").needsUpdate=!0,et.prototype.updateMatrixWorld.call(this,n)}}(),(nr.prototype=Object.create(At.prototype)).constructor=nr,nr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},nr.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},(rr.prototype=Object.create(et.prototype)).constructor=rr,rr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},rr.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,i=this.line.geometry.attributes.position,n=i.array;n[0]=t,n[1]=-e,n[2]=0,n[3]=t,n[4]=e,n[5]=0,n[6]=-t,n[7]=e,n[8]=0,n[9]=-t,n[10]=-e,n[11]=0,n[12]=t,n[13]=-e,n[14]=0,i.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},(sr.prototype=Object.create(et.prototype)).constructor=sr,sr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},sr.prototype.update=function(){var t=new s,e=new j,i=new j;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var r=n.geometry.getAttribute("color");e.copy(this.light.color),i.copy(this.light.groundColor);for(var s=0,o=r.count;s<o;s++){var a=s<o/2?e:i;r.setXYZ(s,a.r,a.g,a.b)}r.needsUpdate=!0}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),(or.prototype=Object.create(se.prototype)).constructor=or,(ar.prototype=Object.create(se.prototype)).constructor=ar,(lr.prototype=Object.create(se.prototype)).constructor=lr,lr.prototype.update=function(){var t=new s,e=new s,i=new o;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n,r=this.object.matrixWorld,s=this.geometry.attributes.position,o=(n=this.object.geometry).vertices,a=0,l=0,h=(n=n.faces).length;l<h;l++){var c=n[l],u=c.normal;t.copy(o[c.a]).add(o[c.b]).add(o[c.c]).divideScalar(3).applyMatrix4(r),e.copy(u).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),s.setXYZ(a,t.x,t.y,t.z),a+=1,s.setXYZ(a,e.x,e.y,e.z),a+=1}s.needsUpdate=!0}}(),(hr.prototype=Object.create(et.prototype)).constructor=hr,hr.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},hr.prototype.update=function(){var t=new s,e=new s,i=new s;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t),this.lightPlane.lookAt(i),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(i),this.targetLine.scale.z=i.length()}}(),(cr.prototype=Object.create(se.prototype)).constructor=cr,cr.prototype.update=function(){function t(t,s,o,a){if(n.set(s,o,a).unproject(r),void 0!==(t=i[t]))for(s=e.getAttribute("position"),o=0,a=t.length;o<a;o++)s.setXYZ(t[o],n.x,n.y,n.z)}var e,i,n=new s,r=new it;return function(){e=this.geometry,i=this.pointMap,r.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),(ur.prototype=Object.create(se.prototype)).constructor=ur,ur.prototype.update=function(){var t=new Y;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){e=t.min;var i=t.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=e.x,r[4]=i.y,r[5]=i.z,r[6]=e.x,r[7]=e.y,r[8]=i.z,r[9]=i.x,r[10]=e.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=e.z,r[15]=e.x,r[16]=i.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=i.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),ur.prototype.setFromObject=function(t){return this.object=t,this.update(),this},(dr.prototype=Object.create(se.prototype)).constructor=dr,dr.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),et.prototype.updateMatrixWorld.call(this,t))},(pr.prototype=Object.create(re.prototype)).constructor=pr,pr.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;1e-8>Math.abs(e)&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),et.prototype.updateMatrixWorld.call(this,t)};var rs,ss;(fr.prototype=Object.create(et.prototype)).constructor=fr,fr.prototype.setDirection=function(){var t,e=new s;return function(i){.99999<i.y?this.quaternion.set(0,0,0,1):-.99999>i.y?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),fr.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},fr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(mr.prototype=Object.create(se.prototype)).constructor=mr,Ri.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ri.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Vi.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new st,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new s(r.x,r.y,r.z||0))}return e}}),Object.assign(qi.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),gr.prototype=Object.create(Ni.prototype),vr.prototype=Object.create(Ni.prototype),yr.prototype=Object.create(Ni.prototype),Object.assign(yr.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),or.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ir.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(xn.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Kr.extractUrlBase(t)}}),Object.assign(G.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Y.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),St.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(br,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),br.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),br.ceilPowerOfTwo(t)}}),Object.assign(o.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(n.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new s),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,s)}}),J.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},r.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Mt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Xi.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ye(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ri(this,t)}}),Object.assign(i.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(s.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(l.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),st.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(et.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(et.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Qt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(te.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Ri.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),jt.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Yi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(ot.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(yt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(yt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Un.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(V.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new j}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}}}),Object.defineProperties(yi.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Tt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(qt.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(qt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(K.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){t=1!==t,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(h.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign(Wt.prototype,{getStandingMatrix:function(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}}),Object.defineProperties(Wt.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ln.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Cn).load(t,function(t){e.setBuffer(t)}),this},In.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Pn.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},t.WebGLRenderTargetCube=c,t.WebGLRenderTarget=h,t.WebGLRenderer=qt,t.ShaderLib=Dr,t.UniformsLib=Pr,t.UniformsUtils=Rr,t.ShaderChunk=Lr,t.FogExp2=Xt,t.Fog=Yt,t.Scene=$t,t.LensFlare=Jt,t.Sprite=Kt,t.LOD=Qt,t.SkinnedMesh=ie,t.Skeleton=te,t.Bone=ee,t.Mesh=At,t.LineSegments=se,t.LineLoop=oe,t.Line=re,t.Points=le,t.Group=he,t.VideoTexture=ce,t.DataTexture=u,t.CompressedTexture=ue,t.CubeTexture=d,t.CanvasTexture=W,t.DepthTexture=de,t.Texture=a,t.CompressedTextureLoader=Mi,t.DataTextureLoader=Si,t.CubeTextureLoader=Ai,t.TextureLoader=Pi,t.ObjectLoader=wn,t.MaterialLoader=yn,t.BufferGeometryLoader=bn,t.DefaultLoadingManager=Gr,t.LoadingManager=Ei,t.JSONLoader=_n,t.ImageLoader=Ci,t.ImageBitmapLoader=En,t.FontLoader=Sn,t.FileLoader=Ti,t.Loader=xn,t.LoaderUtils=Kr,t.Cache=jr,t.AudioLoader=Cn,t.SpotLightShadow=Zi,t.SpotLight=Ki,t.PointLight=Qi,t.RectAreaLight=rn,t.HemisphereLight=$i,t.DirectionalLightShadow=tn,t.DirectionalLight=en,t.AmbientLight=nn,t.LightShadow=Ji,t.Light=Yi,t.StereoCamera=An,t.PerspectiveCamera=jt,t.OrthographicCamera=nt,t.CubeCamera=Pn,t.ArrayCamera=Gt,t.Camera=it,t.AudioListener=Rn,t.PositionalAudio=Dn,t.AudioContext=ns,t.AudioAnalyser=In,t.Audio=Ln,t.VectorKeyframeTrack=gn,t.StringKeyframeTrack=sn,t.QuaternionKeyframeTrack=hn,t.NumberKeyframeTrack=un,t.ColorKeyframeTrack=cn,t.BooleanKeyframeTrack=on,t.PropertyMixer=Nn,t.PropertyBinding=kn,t.KeyframeTrack=mn,t.AnimationUtils=Jr,t.AnimationObjectGroup=zn,t.AnimationMixer=Fn,t.AnimationClip=vn,t.Uniform=Un,t.InstancedBufferGeometry=Bn,t.BufferGeometry=yt,t.Geometry=st,t.InterleavedBufferAttribute=jn,t.InstancedInterleavedBuffer=Wn,t.InterleavedBuffer=Gn,t.InstancedBufferAttribute=Vn,t.Face3=rt,t.Object3D=et,t.Raycaster=qn,t.Layers=tt,t.EventDispatcher=e,t.Clock=$n,t.QuaternionLinearInterpolant=ln,t.LinearInterpolant=pn,t.DiscreteInterpolant=fn,t.CubicInterpolant=dn,t.Interpolant=an,t.Triangle=Ct,t.Math=br,t.Spherical=Jn,t.Cylindrical=Zn,t.Plane=J,t.Frustum=Z,t.Sphere=$,t.Ray=Mt,t.Matrix4=n,t.Matrix3=o,t.Box3=Y,t.Box2=G,t.Line3=St,t.Euler=Q,t.Vector4=l,t.Vector3=s,t.Vector2=i,t.Quaternion=r,t.Color=j,t.ImmediateRenderObject=Kn,t.VertexNormalsHelper=Qn,t.SpotLightHelper=tr,t.SkeletonHelper=ir,t.PointLightHelper=nr,t.RectAreaLightHelper=rr,t.HemisphereLightHelper=sr,t.GridHelper=or,t.PolarGridHelper=ar,t.FaceNormalsHelper=lr,t.DirectionalLightHelper=hr,t.CameraHelper=cr,t.BoxHelper=ur,t.Box3Helper=dr,t.PlaneHelper=pr,t.ArrowHelper=fr,t.AxesHelper=mr,t.Shape=Xi,t.Path=qi,t.ShapePath=Tn,t.Font=Mn,t.CurvePath=Vi,t.Curve=Ri,t.ShapeUtils=Fr,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new he,n=0,r=e.length;n<r;n++)i.add(new At(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){t.applyMatrix((new n).getInverse(i.matrixWorld)),e.remove(t),i.add(t)}},t.WebGLUtils=Vt,t.WireframeGeometry=pe,t.ParametricGeometry=fe,t.ParametricBufferGeometry=me,t.TetrahedronGeometry=ye,t.TetrahedronBufferGeometry=be,t.OctahedronGeometry=xe,t.OctahedronBufferGeometry=_e,t.IcosahedronGeometry=we,t.IcosahedronBufferGeometry=Ee,t.DodecahedronGeometry=Te,t.DodecahedronBufferGeometry=Me,t.PolyhedronGeometry=ge,t.PolyhedronBufferGeometry=ve,t.TubeGeometry=Se,t.TubeBufferGeometry=Ce,t.TorusKnotGeometry=Ae,t.TorusKnotBufferGeometry=Pe,t.TorusGeometry=Re,t.TorusBufferGeometry=Le,t.TextGeometry=Je,t.TextBufferGeometry=Ze,t.SphereGeometry=Ke,t.SphereBufferGeometry=Qe,t.RingGeometry=ti,t.RingBufferGeometry=ei,t.PlaneGeometry=_t,t.PlaneBufferGeometry=wt,t.LatheGeometry=ii,t.LatheBufferGeometry=ni,t.ShapeGeometry=ri,t.ShapeBufferGeometry=si,t.ExtrudeGeometry=Ye,t.ExtrudeBufferGeometry=$e,t.EdgesGeometry=ai,t.ConeGeometry=ci,t.ConeBufferGeometry=ui,t.CylinderGeometry=li,t.CylinderBufferGeometry=hi,t.CircleGeometry=di,t.CircleBufferGeometry=pi,t.BoxGeometry=bt,t.BoxBufferGeometry=xt,t.ShadowMaterial=fi,t.SpriteMaterial=Zt,t.RawShaderMaterial=mi,t.ShaderMaterial=Tt,t.PointsMaterial=ae,t.MeshPhysicalMaterial=vi,t.MeshStandardMaterial=gi,t.MeshPhongMaterial=yi,t.MeshToonMaterial=bi,t.MeshNormalMaterial=xi,t.MeshLambertMaterial=_i,t.MeshDepthMaterial=q,t.MeshDistanceMaterial=X,t.MeshBasicMaterial=Et,t.LineDashedMaterial=wi,t.LineBasicMaterial=ne,t.Material=V,t.Float64BufferAttribute=mt,t.Float32BufferAttribute=ft,t.Uint32BufferAttribute=pt,t.Int32BufferAttribute=dt,t.Uint16BufferAttribute=ut,t.Int16BufferAttribute=ct,t.Uint8ClampedBufferAttribute=ht,t.Uint8BufferAttribute=lt,t.Int8BufferAttribute=at,t.BufferAttribute=ot,t.ArcCurve=Di,t.CatmullRomCurve3=Ni,t.CubicBezierCurve=Hi,t.CubicBezierCurve3=Fi,t.EllipseCurve=Li,t.LineCurve=Ui,t.LineCurve3=Bi,t.QuadraticBezierCurve=ji,t.QuadraticBezierCurve3=Gi,t.SplineCurve=Wi,t.REVISION="89",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=bt,t.Face4=function(t,e,i,n,r,s,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new rt(t,e,i,r,s,o)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new le(t,e)},t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Kt(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new le(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.Vertex=function(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new s(t,e,i)},t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new ot(t,e).setDynamic(!0)},t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new at(t,e)},t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new lt(t,e)},t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ht(t,e)},t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ct(t,e)},t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ut(t,e)},t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new dt(t,e)},t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new pt(t,e)},t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ft(t,e)},t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new mt(t,e)},t.ClosedSplineCurve3=gr,t.SplineCurve3=vr,t.Spline=yr,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new mr(t)},t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ur(t,e)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new se(new ai(t.geometry),new ne({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new se(new pe(t.geometry),new ne({color:void 0!==e?e:16777215}))},t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ti(t)},t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Si(t)},t.GeometryUtils={merge:function(t,e,i){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh){e.matrixAutoUpdate&&e.updateMatrix();var n=e.matrix;e=e.geometry}t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Pi;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,i,void 0,n),e&&(t.mapping=e),t},loadTextureCube:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Ai;return r.setCrossOrigin(this.crossOrigin),t=r.load(t,i,void 0,n),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e,i){function n(s,o){if(!e[s]){if(!t[s]){var a="function"==typeof require&&require;if(!o&&a)return a(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=e[s]={exports:{}};t[s][0].call(h.exports,function(e){var i=t[s][1][e];return n(i||e)},h,h.exports,t,t,e,i)}return e[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s])}({1:[function(t,e,i){var n,r,s;s=t("./Utils"),r=t("./Inline"),n=function(){function t(){}return t.indentation=4,t.prototype.dump=function(t,e,i,n,o){var a,l,h,c,u,d,p;if(null==e&&(e=0),null==i&&(i=0),null==n&&(n=!1),null==o&&(o=null),c="",u=i?s.strRepeat(" ",i):"",e<=0||"object"!=typeof t||t instanceof Date||s.isEmpty(t))c+=u+r.dump(t,n,o);else if(t instanceof Array)for(a=0,h=t.length;a<h;a++)d=t[a],c+=u+"-"+((p=e-1<=0||"object"!=typeof d||s.isEmpty(d))?" ":"\n")+this.dump(d,e-1,p?0:i+this.indentation,n,o)+(p?"\n":"");else for(l in t)d=t[l],p=e-1<=0||"object"!=typeof d||s.isEmpty(d),c+=u+r.dump(l,n,o)+":"+(p?" ":"\n")+this.dump(d,e-1,p?0:i+this.indentation,n,o)+(p?"\n":"");return c},t}(),e.exports=n},{"./Inline":5,"./Utils":9}],2:[function(t,e,i){var n,r;r=t("./Pattern"),n=function(){function t(){}var e;return t.LIST_ESCAPEES=["\\","\\\\",'\\"','"',"\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",(e=String.fromCharCode)(133),e(160),e(8232),e(8233)],t.LIST_ESCAPED=["\\\\",'\\"','\\"','\\"',"\\0","\\x01","\\x02","\\x03","\\x04","\\x05","\\x06","\\a","\\b","\\t","\\n","\\v","\\f","\\r","\\x0e","\\x0f","\\x10","\\x11","\\x12","\\x13","\\x14","\\x15","\\x16","\\x17","\\x18","\\x19","\\x1a","\\e","\\x1c","\\x1d","\\x1e","\\x1f","\\N","\\_","\\L","\\P"],t.MAPPING_ESCAPEES_TO_ESCAPED=function(){var e,i,n,r;for(n={},e=i=0,r=t.LIST_ESCAPEES.length;0<=r?i<r:i>r;e=0<=r?++i:--i)n[t.LIST_ESCAPEES[e]]=t.LIST_ESCAPED[e];return n}(),t.PATTERN_CHARACTERS_TO_ESCAPE=new r("[\\x00-\\x1f]|ÃÂ|ÃÂ |Ã¢ÂÂ¨|Ã¢ÂÂ©"),t.PATTERN_MAPPING_ESCAPEES=new r(t.LIST_ESCAPEES.join("|").split("\\").join("\\\\")),t.PATTERN_SINGLE_QUOTING=new r("[\\s'\":{}[\\],&*#?]|^[-?|<>=!%@`]"),t.requiresDoubleQuoting=function(t){return this.PATTERN_CHARACTERS_TO_ESCAPE.test(t)},t.escapeWithDoubleQuotes=function(t){return'"'+this.PATTERN_MAPPING_ESCAPEES.replace(t,function(t){return function(e){return t.MAPPING_ESCAPEES_TO_ESCAPED[e]}}(this))+'"'},t.requiresSingleQuoting=function(t){return this.PATTERN_SINGLE_QUOTING.test(t)},t.escapeWithSingleQuotes=function(t){return"'"+t.replace(/'/g,"''")+"'"},t}(),e.exports=n},{"./Pattern":7}],3:[function(t,e,i){var n,r={}.hasOwnProperty;n=function(t){function e(t,e,i){this.message=t,this.parsedLine=e,this.snippet=i}return function(t,e){function i(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,Error),e.prototype.toString=function(){return null!=this.parsedLine&&null!=this.snippet?"<DumpException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')":"<DumpException> "+this.message},e}(),e.exports=n},{}],4:[function(t,e,i){var n,r={}.hasOwnProperty;n=function(t){function e(t,e,i){this.message=t,this.parsedLine=e,this.snippet=i}return function(t,e){function i(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,Error),e.prototype.toString=function(){return null!=this.parsedLine&&null!=this.snippet?"<ParseException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')":"<ParseException> "+this.message},e}(),e.exports=n},{}],5:[function(t,e,i){var n,r,s,o,a,l,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};o=t("./Pattern"),a=t("./Unescaper"),n=t("./Escaper"),l=t("./Utils"),s=t("./Exception/ParseException"),t("./Exception/DumpException"),r=function(){function t(){}return t.REGEX_QUOTED_STRING="(?:\"(?:[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"|'(?:[^']*(?:''[^']*)*)')",t.PATTERN_TRAILING_COMMENTS=new o("^\\s*#.*$"),t.PATTERN_QUOTED_SCALAR=new o("^"+t.REGEX_QUOTED_STRING),t.PATTERN_THOUSAND_NUMERIC_SCALAR=new o("^(-|\\+)?[0-9,]+(\\.[0-9]+)?$"),t.PATTERN_SCALAR_BY_DELIMITERS={},t.settings={},t.configure=function(t,e){null==t&&(t=null),null==e&&(e=null),this.settings.exceptionOnInvalidType=t,this.settings.objectDecoder=e},t.parse=function(t,e,i){var n,r;if(null==e&&(e=!1),null==i&&(i=null),this.settings.exceptionOnInvalidType=e,this.settings.objectDecoder=i,null==t)return"";if(0===(t=l.trim(t)).length)return"";switch(n={exceptionOnInvalidType:e,objectDecoder:i,i:0},t.charAt(0)){case"[":r=this.parseSequence(t,n),++n.i;break;case"{":r=this.parseMapping(t,n),++n.i;break;default:r=this.parseScalar(t,null,['"',"'"],n)}if(""!==this.PATTERN_TRAILING_COMMENTS.replace(t.slice(n.i),""))throw new s('Unexpected characters near "'+t.slice(n.i)+'".');return r},t.dump=function(t,e,i){var r,s,o;return null==e&&(e=!1),null==i&&(i=null),null==t?"null":"object"==(o=typeof t)?t instanceof Date?t.toISOString():null==i||"string"!=typeof(s=i(t))&&null==s?this.dumpObject(t):s:"boolean"===o?t?"true":"false":l.isDigits(t)?"string"===o?"'"+t+"'":String(parseInt(t)):l.isNumeric(t)?"string"===o?"'"+t+"'":String(parseFloat(t)):"number"===o?t===1/0?".Inf":t===-1/0?"-.Inf":isNaN(t)?".NaN":t:n.requiresDoubleQuoting(t)?n.escapeWithDoubleQuotes(t):n.requiresSingleQuoting(t)?n.escapeWithSingleQuotes(t):""===t?'""':l.PATTERN_DATE.test(t)?"'"+t+"'":"null"===(r=t.toLowerCase())||"~"===r||"true"===r||"false"===r?"'"+t+"'":t},t.dumpObject=function(t,e,i){var n,r,s,o,a;if(null==i&&(i=null),t instanceof Array){for(o=[],n=0,s=t.length;n<s;n++)a=t[n],o.push(this.dump(a));return"["+o.join(", ")+"]"}o=[];for(r in t)a=t[r],o.push(this.dump(r)+": "+this.dump(a));return"{"+o.join(", ")+"}"},t.parseScalar=function(t,e,i,n,r){var a,c,u,d,p,f,m,g,v;if(null==e&&(e=null),null==i&&(i=['"',"'"]),null==n&&(n=null),null==r&&(r=!0),null==n&&(n={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}),a=n.i,f=t.charAt(a),h.call(i,f)>=0){if(d=this.parseQuotedScalar(t,n),a=n.i,null!=e&&(v=l.ltrim(t.slice(a)," "),m=v.charAt(0),!(h.call(e,m)>=0)))throw new s("Unexpected characters ("+t.slice(a)+").")}else{if(e){if(c=e.join("|"),null==(p=this.PATTERN_SCALAR_BY_DELIMITERS[c])&&(p=new o("^(.+?)("+c+")"),this.PATTERN_SCALAR_BY_DELIMITERS[c]=p),!(u=p.exec(t.slice(a))))throw new s("Malformed inline YAML string ("+t+").");a+=(d=u[1]).length}else a+=(d=t.slice(a)).length,-1!==(g=d.indexOf(" #"))&&(d=l.rtrim(d.slice(0,g)));r&&(d=this.evaluateScalar(d,n))}return n.i=a,d},t.parseQuotedScalar=function(t,e){var i,n,r;if(i=e.i,!(n=this.PATTERN_QUOTED_SCALAR.exec(t.slice(i))))throw new s("Malformed inline YAML string ("+t.slice(i)+").");return r=n[0].substr(1,n[0].length-2),r='"'===t.charAt(i)?a.unescapeDoubleQuotedString(r):a.unescapeSingleQuotedString(r),i+=n[0].length,e.i=i,r},t.parseSequence=function(t,e){var i,n,r,o,a,l;for(o=[],r=t.length,i=e.i,i+=1;i<r;){switch(e.i=i,t.charAt(i)){case"[":o.push(this.parseSequence(t,e)),i=e.i;break;case"{":o.push(this.parseMapping(t,e)),i=e.i;break;case"]":return o;case",":case" ":case"\n":break;default:if(n='"'===(a=t.charAt(i))||"'"===a,l=this.parseScalar(t,[",","]"],['"',"'"],e),i=e.i,!n&&"string"==typeof l&&(-1!==l.indexOf(": ")||-1!==l.indexOf(":\n")))try{l=this.parseMapping("{"+l+"}")}catch(t){t}o.push(l),--i}++i}throw new s("Malformed inline YAML string "+t)},t.parseMapping=function(t,e){var i,n,r,o,a,l,h;for(a={},o=t.length,n=e.i,n+=1,l=!1;n<o;){switch(e.i=n,t.charAt(n)){case" ":case",":case"\n":++n,e.i=n,l=!0;break;case"}":return a}if(l)l=!1;else for(r=this.parseScalar(t,[":"," ","\n"],['"',"'"],e,!1),n=e.i,i=!1;n<o;){switch(e.i=n,t.charAt(n)){case"[":h=this.parseSequence(t,e),n=e.i,void 0===a[r]&&(a[r]=h),i=!0;break;case"{":h=this.parseMapping(t,e),n=e.i,void 0===a[r]&&(a[r]=h),i=!0;break;case":":case" ":case"\n":break;default:h=this.parseScalar(t,[",","}"],['"',"'"],e),n=e.i,void 0===a[r]&&(a[r]=h),i=!0,--n}if(++n,i)break}}throw new s("Malformed inline YAML string "+t)},t.evaluateScalar=function(t,e){var i,n,r,o,a,h,c,u,d;switch(t=l.trim(t),c=t.toLowerCase()){case"null":case"":case"~":return null;case"true":return!0;case"false":return!1;case".inf":return 1/0;case".nan":return NaN;case"-.inf":return 1/0;default:switch(c.charAt(0)){case"!":switch(o=t.indexOf(" "),-1===o?c:c.slice(0,o)){case"!":return-1!==o?parseInt(this.parseScalar(t.slice(2))):null;case"!str":return l.ltrim(t.slice(4));case"!!str":return l.ltrim(t.slice(5));case"!!int":return parseInt(this.parseScalar(t.slice(5)));case"!!bool":return l.parseBoolean(this.parseScalar(t.slice(6)),!1);case"!!float":return parseFloat(this.parseScalar(t.slice(7)));case"!!timestamp":return l.stringToDate(l.ltrim(t.slice(11)));default:if(null==e&&(e={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}),a=e.objectDecoder,r=e.exceptionOnInvalidType,a)return d=l.rtrim(t),-1===(o=d.indexOf(" "))?a(d,null):((u=l.ltrim(d.slice(o+1))).length>0||(u=null),a(d.slice(0,o),u));if(r)throw new s("Custom object support when parsing a YAML file has been disabled.");return null}break;case"0":return"0x"===t.slice(0,2)?l.hexDec(t):l.isDigits(t)?l.octDec(t):l.isNumeric(t)?parseFloat(t):t;case"+":return l.isDigits(t)?(h=t,i=parseInt(h),h===String(i)?i:h):l.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t;case"-":return l.isDigits(t.slice(1))?"0"===t.charAt(1)?-l.octDec(t.slice(1)):(h=t.slice(1),i=parseInt(h),h===String(i)?-i:-h):l.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t;default:return(n=l.stringToDate(t))?n:l.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t}}},t}(),e.exports=r},{"./Escaper":2,"./Exception/DumpException":3,"./Exception/ParseException":4,"./Pattern":7,"./Unescaper":8,"./Utils":9}],6:[function(t,e,i){var n,r,s,o,a;n=t("./Inline"),o=t("./Pattern"),a=t("./Utils"),r=t("./Exception/ParseException"),s=function(){function t(t){this.offset=null!=t?t:0,this.lines=[],this.currentLineNb=-1,this.currentLine="",this.refs={}}return t.prototype.PATTERN_FOLDED_SCALAR_ALL=new o("^(?:(?<type>![^\\|>]*)\\s+)?(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),t.prototype.PATTERN_FOLDED_SCALAR_END=new o("(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),t.prototype.PATTERN_SEQUENCE_ITEM=new o("^\\-((?<leadspaces>\\s+)(?<value>.+?))?\\s*$"),t.prototype.PATTERN_ANCHOR_VALUE=new o("^&(?<ref>[^ ]+) *(?<value>.*)"),t.prototype.PATTERN_COMPACT_NOTATION=new o("^(?<key>"+n.REGEX_QUOTED_STRING+"|[^ '\"\\{\\[].*?) *\\:(\\s+(?<value>.+?))?\\s*$"),t.prototype.PATTERN_MAPPING_ITEM=new o("^(?<key>"+n.REGEX_QUOTED_STRING+"|[^ '\"\\[\\{].*?) *\\:(\\s+(?<value>.+?))?\\s*$"),t.prototype.PATTERN_DECIMAL=new o("\\d+"),t.prototype.PATTERN_INDENT_SPACES=new o("^ +"),t.prototype.PATTERN_TRAILING_LINES=new o("(\n*)$"),t.prototype.PATTERN_YAML_HEADER=new o("^\\%YAML[: ][\\d\\.]+.*\n"),t.prototype.PATTERN_LEADING_COMMENTS=new o("^(\\#.*?\n)+"),t.prototype.PATTERN_DOCUMENT_MARKER_START=new o("^\\-\\-\\-.*?\n"),t.prototype.PATTERN_DOCUMENT_MARKER_END=new o("^\\.\\.\\.\\s*$"),t.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION={},t.prototype.CONTEXT_NONE=0,t.prototype.CONTEXT_SEQUENCE=1,t.prototype.CONTEXT_MAPPING=2,t.prototype.parse=function(e,i,s){var o,l,h,c,u,d,p,f,m,g,v,y,b,x,_,w,E,T,M,S,C,A,P,R,L,D,I,N,O,k,z,H,F,U,B,j;for(null==i&&(i=!1),null==s&&(s=null),this.currentLineNb=-1,this.currentLine="",this.lines=this.cleanup(e).split("\n"),d=null,u=this.CONTEXT_NONE,l=!1;this.moveToNextLine();)if(!this.isCurrentLineEmpty()){if("\t"===this.currentLine[0])throw new r("A YAML file cannot contain tabs as indentation.",this.getRealCurrentLineNb()+1,this.currentLine);if(v=R=!1,j=this.PATTERN_SEQUENCE_ITEM.exec(this.currentLine)){if(this.CONTEXT_MAPPING===u)throw new r("You cannot define a sequence item when in a mapping");u=this.CONTEXT_SEQUENCE,null==d&&(d=[]),null!=j.value&&(P=this.PATTERN_ANCHOR_VALUE.exec(j.value))&&(v=P.ref,j.value=P.value),null==j.value||""===a.trim(j.value," ")||0===a.ltrim(j.value," ").indexOf("#")?this.currentLineNb<this.lines.length-1&&!this.isNextLineUnIndentedCollection()?((O=new t(c=this.getRealCurrentLineNb()+1)).refs=this.refs,d.push(O.parse(this.getNextEmbedBlock(null,!0),i,s))):d.push(null):(null!=(k=j.leadspaces)?k.length:void 0)&&(P=this.PATTERN_COMPACT_NOTATION.exec(j.value))?((O=new t(c=this.getRealCurrentLineNb())).refs=this.refs,h=j.value,g=this.getCurrentLineIndentation(),this.isNextLineIndented(!1)&&(h+="\n"+this.getNextEmbedBlock(g+j.leadspaces.length+1,!0)),d.push(O.parse(h,i,s))):d.push(this.parseValue(j.value,i,s))}else{if(!(j=this.PATTERN_MAPPING_ITEM.exec(this.currentLine))||-1!==j.key.indexOf(" #")){if(1===(C=this.lines.length)||2===C&&a.isEmpty(this.lines[1])){try{e=n.parse(this.lines[0],i,s)}catch(t){throw p=t,p.parsedLine=this.getRealCurrentLineNb()+1,p.snippet=this.currentLine,p}if("object"==typeof e){if(e instanceof Array)f=e[0];else for(x in e){f=e[x];break}if("string"==typeof f&&0===f.indexOf("*")){for(d=[],L=0,S=e.length;L<S;L++)o=e[L],d.push(this.refs[o.slice(1)]);e=d}}return e}if("["===(H=a.ltrim(e).charAt(0))||"{"===H)try{return n.parse(e,i,s)}catch(t){throw p=t,p.parsedLine=this.getRealCurrentLineNb()+1,p.snippet=this.currentLine,p}throw new r("Unable to parse.",this.getRealCurrentLineNb()+1,this.currentLine)}if(this.CONTEXT_SEQUENCE===u)throw new r("You cannot define a mapping item when in a sequence");u=this.CONTEXT_MAPPING,null==d&&(d={}),n.configure(i,s);try{x=n.parseScalar(j.key)}catch(t){throw p=t,p.parsedLine=this.getRealCurrentLineNb()+1,p.snippet=this.currentLine,p}if("<<"===x)if(R=!0,l=!0,0===(null!=(z=j.value)?z.indexOf("*"):void 0)){if(F=j.value.slice(1),null==this.refs[F])throw new r('Reference "'+F+'" does not exist.',this.getRealCurrentLineNb()+1,this.currentLine);if("object"!=typeof(U=this.refs[F]))throw new r("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(U instanceof Array)for(m=y=0,E=U.length;y<E;m=++y)e=U[m],null==d[D=String(m)]&&(d[D]=e);else for(x in U)e=U[x],null==d[x]&&(d[x]=e)}else{if(e=null!=j.value&&""!==j.value?j.value:this.getNextEmbedBlock(),c=this.getRealCurrentLineNb()+1,O=new t(c),O.refs=this.refs,"object"!=typeof(I=O.parse(e,i)))throw new r("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(I instanceof Array)for(_=0,T=I.length;_<T;_++){if("object"!=typeof(N=I[_]))throw new r("Merge items must be objects.",this.getRealCurrentLineNb()+1,N);if(N instanceof Array)for(m=A=0,M=N.length;A<M;m=++A)e=N[m],b=String(m),d.hasOwnProperty(b)||(d[b]=e);else for(x in N)e=N[x],d.hasOwnProperty(x)||(d[x]=e)}else for(x in I)e=I[x],d.hasOwnProperty(x)||(d[x]=e)}else null!=j.value&&(P=this.PATTERN_ANCHOR_VALUE.exec(j.value))&&(v=P.ref,j.value=P.value);R||(null==j.value||""===a.trim(j.value," ")||0===a.ltrim(j.value," ").indexOf("#")?this.isNextLineIndented()||this.isNextLineUnIndentedCollection()?((O=new t(c=this.getRealCurrentLineNb()+1)).refs=this.refs,B=O.parse(this.getNextEmbedBlock(),i,s),(l||void 0===d[x])&&(d[x]=B)):(l||void 0===d[x])&&(d[x]=null):(B=this.parseValue(j.value,i,s),(l||void 0===d[x])&&(d[x]=B)))}if(v)if(d instanceof Array)this.refs[v]=d[d.length-1];else{w=null;for(x in d)w=x;this.refs[v]=d[w]}}return a.isEmpty(d)?null:d},t.prototype.getRealCurrentLineNb=function(){return this.currentLineNb+this.offset},t.prototype.getCurrentLineIndentation=function(){return this.currentLine.length-a.ltrim(this.currentLine," ").length},t.prototype.getNextEmbedBlock=function(t,e){var i,n,s,o,l,h,c;if(null==t&&(t=null),null==e&&(e=!1),this.moveToNextLine(),null==t){if(o=this.getCurrentLineIndentation(),c=this.isStringUnIndentedCollectionItem(this.currentLine),!this.isCurrentLineEmpty()&&0===o&&!c)throw new r("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}else o=t;for(i=[this.currentLine.slice(o)],e||(s=this.isStringUnIndentedCollectionItem(this.currentLine)),l=!(h=this.PATTERN_FOLDED_SCALAR_END).test(this.currentLine);this.moveToNextLine();){if((n=this.getCurrentLineIndentation())===o&&(l=!h.test(this.currentLine)),s&&!this.isStringUnIndentedCollectionItem(this.currentLine)&&n===o){this.moveToPreviousLine();break}if(this.isCurrentLineBlank())i.push(this.currentLine.slice(o));else if(!l||!this.isCurrentLineComment()||n!==o)if(n>=o)i.push(this.currentLine.slice(o));else if("#"!==a.ltrim(this.currentLine).charAt(0)){if(0===n){this.moveToPreviousLine();break}throw new r("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}}return i.join("\n")},t.prototype.moveToNextLine=function(){return!(this.currentLineNb>=this.lines.length-1)&&(this.currentLine=this.lines[++this.currentLineNb],!0)},t.prototype.moveToPreviousLine=function(){this.currentLine=this.lines[--this.currentLineNb]},t.prototype.parseValue=function(t,e,i){var s,o,a,l,h,c,u,d;if(0===t.indexOf("*")){if(h=t.indexOf("#"),t=-1!==h?t.substr(1,h-2):t.slice(1),void 0===this.refs[t])throw new r('Reference "'+t+'" does not exist.',this.currentLine);return this.refs[t]}if(a=this.PATTERN_FOLDED_SCALAR_ALL.exec(t))return l=null!=(c=a.modifiers)?c:"",o=Math.abs(parseInt(l)),isNaN(o)&&(o=0),d=this.parseFoldedScalar(a.separator,this.PATTERN_DECIMAL.replace(l,""),o),null!=a.type?(n.configure(e,i),n.parseScalar(a.type+" "+d)):d;try{return n.parse(t,e,i)}catch(o){if(s=o,"["!==(u=t.charAt(0))&&"{"!==u||!(s instanceof r)||!this.isNextLineIndented())throw s.parsedLine=this.getRealCurrentLineNb()+1,s.snippet=this.currentLine,s;t+="\n"+this.getNextEmbedBlock();try{return n.parse(t,e,i)}catch(t){throw s=t,s.parsedLine=this.getRealCurrentLineNb()+1,s.snippet=this.currentLine,s}}},t.prototype.parseFoldedScalar=function(e,i,n){var r,s,l,h,c,u,d,p,f,m;if(null==i&&(i=""),null==n&&(n=0),!(d=this.moveToNextLine()))return"";for(r=this.isCurrentLineBlank(),m="";d&&r;)(d=this.moveToNextLine())&&(m+="\n",r=this.isCurrentLineBlank());if(0===n&&(c=this.PATTERN_INDENT_SPACES.exec(this.currentLine))&&(n=c[0].length),n>0)for(null==(p=this.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n])&&(p=new o("^ {"+n+"}(.*)$"),t.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n]=p);d&&(r||(c=p.exec(this.currentLine)));)m+=r?this.currentLine.slice(n):c[1],(d=this.moveToNextLine())&&(m+="\n",r=this.isCurrentLineBlank());else d&&(m+="\n");if(d&&this.moveToPreviousLine(),">"===e){for(u="",s=0,l=(f=m.split("\n")).length;s<l;s++)0===(h=f[s]).length||" "===h.charAt(0)?u=a.rtrim(u," ")+h+"\n":u+=h+" ";m=u}return"+"!==i&&(m=a.rtrim(m)),""===i?m=this.PATTERN_TRAILING_LINES.replace(m,"\n"):"-"===i&&(m=this.PATTERN_TRAILING_LINES.replace(m,"")),m},t.prototype.isNextLineIndented=function(t){var e,i,n;if(null==t&&(t=!0),i=this.getCurrentLineIndentation(),e=!this.moveToNextLine(),t)for(;!e&&this.isCurrentLineEmpty();)e=!this.moveToNextLine();else for(;!e&&this.isCurrentLineBlank();)e=!this.moveToNextLine();return!e&&(n=!1,this.getCurrentLineIndentation()>i&&(n=!0),this.moveToPreviousLine(),n)},t.prototype.isCurrentLineEmpty=function(){var t;return 0===(t=a.trim(this.currentLine," ")).length||"#"===t.charAt(0)},t.prototype.isCurrentLineBlank=function(){return""===a.trim(this.currentLine," ")},t.prototype.isCurrentLineComment=function(){return"#"===a.ltrim(this.currentLine," ").charAt(0)},t.prototype.cleanup=function(t){var e,i,n,r,s,o,l,h,c,u,d,p,f,m;for(-1!==t.indexOf("\r")&&(t=t.split("\r\n").join("\n").split("\r").join("\n")),e=0,t=(u=this.PATTERN_YAML_HEADER.replaceAll(t,""))[0],e=u[1],this.offset+=e,m=(d=this.PATTERN_LEADING_COMMENTS.replaceAll(t,"",1))[0],1===(e=d[1])&&(this.offset+=a.subStrCount(t,"\n")-a.subStrCount(m,"\n"),t=m),m=(p=this.PATTERN_DOCUMENT_MARKER_START.replaceAll(t,"",1))[0],1===(e=p[1])&&(this.offset+=a.subStrCount(t,"\n")-a.subStrCount(m,"\n"),t=m,t=this.PATTERN_DOCUMENT_MARKER_END.replace(t,"")),f=-1,r=0,o=(c=t.split("\n")).length;r<o;r++)h=c[r],0!==a.trim(h," ").length&&(n=h.length-a.ltrim(h).length,(-1===f||n<f)&&(f=n));if(f>0){for(i=s=0,l=c.length;s<l;i=++s)h=c[i],c[i]=h.slice(f);t=c.join("\n")}return t},t.prototype.isNextLineUnIndentedCollection=function(t){var e,i;for(null==t&&(t=null),null==t&&(t=this.getCurrentLineIndentation()),e=this.moveToNextLine();e&&this.isCurrentLineEmpty();)e=this.moveToNextLine();return!1!==e&&(i=!1,this.getCurrentLineIndentation()===t&&this.isStringUnIndentedCollectionItem(this.currentLine)&&(i=!0),this.moveToPreviousLine(),i)},t.prototype.isStringUnIndentedCollectionItem=function(){return"-"===this.currentLine||"- "===this.currentLine.slice(0,2)},t}(),e.exports=s},{"./Exception/ParseException":4,"./Inline":5,"./Pattern":7,"./Utils":9}],7:[function(t,e,i){var n;n=function(){function t(t,e){var i,n,r,s,o,a,l,h,c;for(null==e&&(e=""),r="",o=t.length,a=null,n=0,s=0;s<o;){if("\\"===(i=t.charAt(s)))r+=t.slice(s,+(s+1)+1||9e9),s++;else if("("===i)if(s<o-2)if("(?:"===(h=t.slice(s,+(s+2)+1||9e9)))s+=2,r+=h;else if("(?<"===h)for(n++,s+=2,l="";s+1<o;){if(">"===(c=t.charAt(s+1))){r+="(",s++,l.length>0&&(null==a&&(a={}),a[l]=n);break}l+=c,s++}else r+=i,n++;else r+=i;else r+=i;s++}this.rawRegex=t,this.cleanedRegex=r,this.regex=new RegExp(this.cleanedRegex,"g"+e.replace("g","")),this.mapping=a}return t.prototype.regex=null,t.prototype.rawRegex=null,t.prototype.cleanedRegex=null,t.prototype.mapping=null,t.prototype.exec=function(t){var e,i,n,r;if(this.regex.lastIndex=0,null==(i=this.regex.exec(t)))return null;if(null!=this.mapping){r=this.mapping;for(n in r)e=r[n],i[n]=i[e]}return i},t.prototype.test=function(t){return this.regex.lastIndex=0,this.regex.test(t)},t.prototype.replace=function(t,e){return this.regex.lastIndex=0,t.replace(this.regex,e)},t.prototype.replaceAll=function(t,e,i){var n;for(null==i&&(i=0),this.regex.lastIndex=0,n=0;this.regex.test(t)&&(0===i||n<i);)this.regex.lastIndex=0,t=t.replace(this.regex,""),n++;return[t,n]},t}(),e.exports=n},{}],8:[function(t,e,i){var n,r,s;s=t("./Utils"),n=t("./Pattern"),r=function(){function t(){}return t.PATTERN_ESCAPED_CHARACTER=new n('\\\\([0abt\tnvfre "\\/\\\\N_LP]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|U[0-9a-fA-F]{8})'),t.unescapeSingleQuotedString=function(t){return t.replace(/\'\'/g,"'")},t.unescapeDoubleQuotedString=function(t){return null==this._unescapeCallback&&(this._unescapeCallback=function(t){return function(e){return t.unescapeCharacter(e)}}(this)),this.PATTERN_ESCAPED_CHARACTER.replace(t,this._unescapeCallback)},t.unescapeCharacter=function(t){var e;switch(e=String.fromCharCode,t.charAt(1)){case"0":return e(0);case"a":return e(7);case"b":return e(8);case"t":case"\t":return"\t";case"n":return"\n";case"v":return e(11);case"f":return e(12);case"r":return e(13);case"e":return e(27);case" ":return" ";case'"':return'"';case"/":return"/";case"\\":return"\\";case"N":return e(133);case"_":return e(160);case"L":return e(8232);case"P":return e(8233);case"x":return s.utf8chr(s.hexDec(t.substr(2,2)));case"u":return s.utf8chr(s.hexDec(t.substr(2,4)));case"U":return s.utf8chr(s.hexDec(t.substr(2,8)));default:return""}},t}(),e.exports=r},{"./Pattern":7,"./Utils":9}],9:[function(t,e,i){var n,r;n=t("./Pattern"),r=function(){function e(){}return e.REGEX_LEFT_TRIM_BY_CHAR={},e.REGEX_RIGHT_TRIM_BY_CHAR={},e.REGEX_SPACES=/\s+/g,e.REGEX_DIGITS=/^\d+$/,e.REGEX_OCTAL=/[^0-7]/gi,e.REGEX_HEXADECIMAL=/[^a-f0-9]/gi,e.PATTERN_DATE=new n("^(?<year>[0-9][0-9][0-9][0-9])-(?<month>[0-9][0-9]?)-(?<day>[0-9][0-9]?)(?:(?:[Tt]|[ \t]+)(?<hour>[0-9][0-9]?):(?<minute>[0-9][0-9]):(?<second>[0-9][0-9])(?:.(?<fraction>[0-9]*))?(?:[ \t]*(?<tz>Z|(?<tz_sign>[-+])(?<tz_hour>[0-9][0-9]?)(?::(?<tz_minute>[0-9][0-9]))?))?)?$","i"),e.LOCAL_TIMEZONE_OFFSET=60*(new Date).getTimezoneOffset()*1e3,e.trim=function(t,e){return null==e&&(e="\\s"),t.trim()},e.ltrim=function(t,e){var i;return null==e&&(e="\\s"),null==(i=this.REGEX_LEFT_TRIM_BY_CHAR[e])&&(this.REGEX_LEFT_TRIM_BY_CHAR[e]=i=new RegExp("^"+e+e+"*")),i.lastIndex=0,t.replace(i,"")},e.rtrim=function(t,e){var i;return null==e&&(e="\\s"),null==(i=this.REGEX_RIGHT_TRIM_BY_CHAR[e])&&(this.REGEX_RIGHT_TRIM_BY_CHAR[e]=i=new RegExp(e+""+e+"*$")),i.lastIndex=0,t.replace(i,"")},e.isEmpty=function(t){return!t||""===t||"0"===t||t instanceof Array&&0===t.length},e.subStrCount=function(t,e,i,n){var r,s,o,a,l,h;for(r=0,t=""+t,e=""+e,null!=i&&(t=t.slice(i)),null!=n&&(t=t.slice(0,n)),a=t.length,h=e.length,s=o=0,l=a;0<=l?o<l:o>l;s=0<=l?++o:--o)e===t.slice(s,h)&&(r++,s+=h-1);return r},e.isDigits=function(t){return this.REGEX_DIGITS.lastIndex=0,this.REGEX_DIGITS.test(t)},e.octDec=function(t){return this.REGEX_OCTAL.lastIndex=0,parseInt((t+"").replace(this.REGEX_OCTAL,""),8)},e.hexDec=function(t){return this.REGEX_HEXADECIMAL.lastIndex=0,"0x"===((t=this.trim(t))+"").slice(0,2)&&(t=(t+"").slice(2)),parseInt((t+"").replace(this.REGEX_HEXADECIMAL,""),16)},e.utf8chr=function(t){var e;return e=String.fromCharCode,128>(t%=2097152)?e(t):2048>t?e(192|t>>6)+e(128|63&t):65536>t?e(224|t>>12)+e(128|t>>6&63)+e(128|63&t):e(240|t>>18)+e(128|t>>12&63)+e(128|t>>6&63)+e(128|63&t)},e.parseBoolean=function(t,e){var i;return null==e&&(e=!0),"string"==typeof t?(i=t.toLowerCase(),!(!e&&"no"===i)&&("0"!==i&&("false"!==i&&""!==i))):!!t},e.isNumeric=function(t){return this.REGEX_SPACES.lastIndex=0,"number"==typeof t||"string"==typeof t&&!isNaN(t)&&""!==t.replace(this.REGEX_SPACES,"")},e.stringToDate=function(t){var e,i,n,r,s,o,a,l,h,c;if(!(null!=t?t.length:void 0))return null;if(!(s=this.PATTERN_DATE.exec(t)))return null;if(c=parseInt(s.year,10),a=parseInt(s.month,10)-1,i=parseInt(s.day,10),null==s.hour)return e=new Date(Date.UTC(c,a,i));if(r=parseInt(s.hour,10),o=parseInt(s.minute,10),l=parseInt(s.second,10),null!=s.fraction){for(n=s.fraction.slice(0,3);n.length<3;)n+="0";n=parseInt(n,10)}else n=0;return null!=s.tz&&(h=6e4*(60*parseInt(s.tz_hour,10)+(null!=s.tz_minute?parseInt(s.tz_minute,10):0)),"-"===s.tz_sign&&(h*=-1)),e=new Date(Date.UTC(c,a,i,r,o,l,n)),h&&e.setTime(e.getTime()+h),e},e.strRepeat=function(t,e){var i,n;for(n="",i=0;i<e;)n+=t,i++;return n},e.getStringFromFile=function(e,i){var n,r,s,o,a,l,h,c;if(null==i&&(i=null),c=null,"undefined"!=typeof window&&null!==window)if(window.XMLHttpRequest)c=new XMLHttpRequest;else if(window.ActiveXObject)for(s=0,o=(l=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"]).length;s<o;s++){a=l[s];try{c=new ActiveXObject(a)}catch(t){}}return null!=c?null!=i?(c.onreadystatechange=function(){if(4===c.readyState)return 200===c.status||0===c.status?i(c.responseText):i(null)},c.open("GET",e,!0),c.send(null)):(c.open("GET",e,!1),c.send(null),200===c.status||0===c.status?c.responseText:null):(h=t,r=h("fs"),null!=i?r.readFile(e,function(t,e){return i(t?null:String(e))}):null!=(n=r.readFileSync(e))?String(n):null)},e}(),e.exports=r},{"./Pattern":7}],10:[function(t,e,i){var n,r,s,o;r=t("./Parser"),n=t("./Dumper"),s=t("./Utils"),o=function(){function e(){}return e.parse=function(t,e,i){return null==e&&(e=!1),null==i&&(i=null),(new r).parse(t,e,i)},e.parseFile=function(t,e,i,n){var r;return null==e&&(e=null),null==i&&(i=!1),null==n&&(n=null),null!=e?s.getStringFromFile(t,function(t){return function(r){var s;s=null,null!=r&&(s=t.parse(r,i,n)),e(s)}}(this)):null!=(r=s.getStringFromFile(t))?this.parse(r,i,n):null},e.dump=function(t,e,i,r,s){var o;return null==e&&(e=2),null==i&&(i=4),null==r&&(r=!1),null==s&&(s=null),o=new n,o.indentation=i,o.dump(t,e,0,r,s)},e.register=function(){var e;if(e=function(t,e){return t.exports=YAML.parseFile(e)},null!=(void 0!==t&&null!==t?t.extensions:void 0))return t.extensions[".yml"]=e,t.extensions[".yaml"]=e},e.stringify=function(t,e,i,n,r){return this.dump(t,e,i,n,r)},e.load=function(t,e,i,n){return this.parseFile(t,e,i,n)},e}(),"undefined"!=typeof window&&null!==window&&(window.YAML=o),"undefined"!=typeof window&&null!==window||(this.YAML=o),e.exports=o},{"./Dumper":1,"./Parser":6,"./Utils":9}]},{},[10]),Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]}),Array.prototype.getIndexCyclic||(Array.prototype.getIndexCyclic=function(t){return this[t%this.length]}),Array.prototype.getNextCyclic||(Array.prototype.getNextCyclic=function(t){return t%=this.length,this.length-1==t?this[0]:this[t+1]}),Array.prototype.getPreviousCyclic||(Array.prototype.getPreviousCyclic=function(t){return 0==(t%=this.length)?this[this.length-1]:this[t-1]}),window.randomColors=["red","blue","green","black","yellow","purple"],BounceGA.prototype.getBouncePath=function(t){var e=cloneObject(this.fitnessConfig.p0),i=cloneObject(t),n=[],r=[];n.push(cloneObject(e)),r.push(cloneObject(i));for(var s=0;s<this.fitnessConfig.surfaces.length;s++)this.fitnessConfig.surfaces[s].bounces=0,this.fitnessConfig.surfaces[s].colliding=!1;for(var o=0,a=[],l=[],h=0;h<=this.fitnessConfig.maxT;h+=this.fitnessConfig.dt){add(e,multiply(cloneObject(i),this.fitnessConfig.dt)),i.y+=this.fitnessConfig.G*this.fitnessConfig.dt,n.push(cloneObject(e)),r.push(cloneObject(i));for(s=0;s<this.fitnessConfig.surfaces.length;s++){var c=this.fitnessConfig.surfaces[s],u=c.normal.x*e.x+c.normal.y*e.y+c.normal.z*e.z-c.normal.x*c.position.x-c.normal.y*c.position.y-c.normal.z*c.position.z;if(Math.abs(u)<=this.fitnessConfig.R&&Math.abs(dot(sub(cloneObject(e),c.position),normalize(cloneObject(c.axis1))))<=c.scale&&Math.abs(dot(sub(cloneObject(e),c.position),normalize(cloneObject(c.axis2))))<=c.scale&&!c.colliding){c.colliding=!0,c.bounces++,a.push(s),o++;var d=(new THREE.Vector3).copy(c.normal);multiply(d=cloneObject(c.normal),dot(i,c.normal)),multiply(d,2*this.fitnessConfig.C),negate(d),add(i,d)}else Math.abs(u)>this.fitnessConfig.R&&c.colliding&&(c.colliding=!1)}if(h>=this.fitnessConfig.minT||h+this.fitnessConfig.dt>this.fitnessConfig.maxT){var p=!0;this.fitnessConfig.surfaceBounceOrder&&a.toString()!=this.fitnessConfig.surfaceBounceOrder.toString()&&(p=!1);var f=!1;o==this.fitnessConfig.numBounces&&(f=!0),p&&f&&(1==this.fitnessConfig.catchSign&&i.y>=0||-1==this.fitnessConfig.catchSign&&i.y<=0||void 0==this.fitnessConfig.catchSign)&&(1==this.fitnessConfig.tossSign&&t.y>=0||-1==this.fitnessConfig.tossSign&&t.y<=0||void 0==this.fitnessConfig.tossSign)&&l.push({pT:cloneObject(e),T:h,actualpT:this.fitnessConfig.pT})}}return l.length>0?(l.sort(function(t,e){return magnitude(sub(cloneObject(t.pT),t.actualpT))-magnitude(sub(cloneObject(e.pT),t.actualpT))}),{path:n.splice(0,l[0].T/this.fitnessConfig.dt),velocities:r.splice(0,l[0].T/this.fitnessConfig.dt),T:l[0].T}):{path:void 0,velocities:void 0,T:void 0}},BounceGA.prototype.generateMember=function(t){var e={x:0,y:0,z:0};if(t&&t.fitness<100)Math.random()<this.gaConfig.mutationChance?(e.y=(1-2*Math.random())*(t.fitness<this.gaConfig.mutationScale?t.fitness:this.gaConfig.mutationScale),this.simple||(e.x=(1-2*Math.random())*(t.fitness<this.gaConfig.mutationScale?t.fitness:this.gaConfig.mutationScale),e.z=(1-2*Math.random())*(t.fitness<this.gaConfig.mutationScale?t.fitness:this.gaConfig.mutationScale)),add(e,t.v)):e=cloneObject(t.v);else if(this.simple)e.x=(this.fitnessConfig.pT.x-this.fitnessConfig.p0.x)/this.fitnessConfig.minT,e.z=(this.fitnessConfig.pT.z-this.fitnessConfig.p0.z)/this.fitnessConfig.minT,e.y=this.fitnessConfig.tossSign*Math.random()*this.gaConfig.initialScale;else{var i;add(e=cloneObject((i=this.fitnessConfig.surfaceBounceOrder?this.fitnessConfig.surfaces[this.fitnessConfig.surfaceBounceOrder[0]]:this.fitnessConfig.surfaces[Math.floor(Math.random()*this.fitnessConfig.surfaces.length)]).position),multiply(cloneObject(i.axis1),1-2*Math.random())),add(e,multiply(cloneObject(i.axis2),1-2*Math.random()));var n=e.y;e.y=0;var r=cloneObject(this.fitnessConfig.p0);r.y=0;cloneObject(this.fitnessConfig.pT).y=0;var s=0,o=this.gaConfig.initialScale;sub(e,r),normalize(e),multiply(e,s+(o-s)*Math.random()),s=1==this.fitnessConfig.tossSign||n>this.fitnessConfig.p0.y?0:-2*(this.fitnessConfig.p0.y-n)/this.fitnessConfig.minT,o=this.gaConfig.initialScale,e.y=s+(o-s)*Math.random()}var a=this.getBouncePath(e);return{v:e,T:a.T,fitness:a.path?magnitude(sub(cloneObject(a.path[a.path.length-1]),this.fitnessConfig.pT)):100}},BounceGA.prototype.evolve=function(){if(this.generations>=this.gaConfig.maxGenerations)this.ableToFindSolution=!1;else if(this.rankedPopulation.length>0&&this.rankedPopulation[0].fitness<=this.gaConfig.fitnessThreshold)this.ableToFindSolution=!0;else{if(0==this.rankedPopulation.length||this.gaConfig.noGA){this.rankedPopulation=[];for(var t=0;t<this.gaConfig.populationSize;t++)this.rankedPopulation.push(this.generateMember(void 0))}else{var e=0,i=[];for(t=0;t<this.rankedPopulation.length;t++)e+=1/this.rankedPopulation[t].fitness,i.push(e);var n=[];for(t=0;t<this.gaConfig.populationSize;t++)if(t<.5*this.gaConfig.populationSize)n.push(this.generateMember(void 0));else for(var r=Math.random()*e,s=0;s<i.length;s++)if(r<i[s]){n.push(this.generateMember(this.rankedPopulation[s]));break}this.rankedPopulation=n}this.rankedPopulation.sort(function(t,e){return t.fitness-e.fitness});var o=this.rankedPopulation[0];this.fittestMembers.push(o),this.generations++,this.generations%100==0&&console.log(this.generations+" "+o.fitness),this.evolve()}},function(t){t.interpolateBezierSpline=function(t,e,i,n,r,s,o){var a;if(0==e)a=t[0];else if(1==e)a=t.last();else{1==t.length&&t.push(t[0]);for(var l=[{x:t[0].x+i.dx*r,y:t[0].y+i.dy*r,z:t[0].z+i.dz*r},{x:t.last().x-n.dx*s,y:t.last().y-n.dy*s,z:t.last().z-n.dz*s}],h=[],c=[],u=0;u<t.length-1;u++){var d,p=t[u],f=t[u+1];if(0==u)g=l[0];else{var m=h[h.length-1],g={x:p.x+(p.x-m.x),y:p.y+(p.y-m.y),z:p.z+(p.z-m.z)};h.push(g)}if(u+1==t.length-1)d=l[1];else{var v=(t[u].x+t[u+1].x)/2,y=(t[u].y+t[u+1].y)/2,b=(t[u].z+t[u+1].z)/2,x=(t[u+1].x+t[u+2].x)/2,_=(t[u+1].y+t[u+2].y)/2,w=(t[u+1].z+t[u+2].z)/2,E=Math.sqrt(Math.pow(t[u].x-t[u+1].x,2)+Math.pow(t[u].y-t[u+1].y,2)+Math.pow(t[u].z-t[u+1].z,2)),T=(1-(C=E/(E+Math.sqrt(Math.pow(t[u+1].x-t[u+2].x,2)+Math.pow(t[u+1].y-t[u+2].y,2)+Math.pow(t[u+1].z-t[u+2].z,2)))))*v+C*x,M=(1-C)*y+C*_,S=(1-C)*b+C*w;d={x:f.x+(v-T),y:f.y+(y-M),z:f.z+(b-S)},h.push(d)}for(var C=0;C<=1+1e-5;C+=.02)c.push({x:Math.pow(1-C,3)*p.x+3*Math.pow(1-C,2)*C*g.x+3*(1-C)*Math.pow(C,2)*d.x+Math.pow(C,3)*f.x,y:Math.pow(1-C,3)*p.y+3*Math.pow(1-C,2)*C*g.y+3*(1-C)*Math.pow(C,2)*d.y+Math.pow(C,3)*f.y,z:Math.pow(1-C,3)*p.z+3*Math.pow(1-C,2)*C*g.z+3*(1-C)*Math.pow(C,2)*d.z+Math.pow(C,3)*f.z}),1==c.length?c.last().dist=0:c.last().dist=c[c.length-2].dist+Math.sqrt(Math.pow(c.last().x-c[c.length-2].x,2)+Math.pow(c.last().y-c[c.length-2].y,2)+Math.pow(c.last().z-c[c.length-2].z,2))}var A;if(o){var P=Math.sqrt(Math.pow(i.dx,2)+Math.pow(i.dy,2)+Math.pow(i.dz,2)),R=Math.sqrt(Math.pow(n.dx,2)+Math.pow(n.dy,2)+Math.pow(n.dz,2)),L=c.last().dist,D=siteswap.dwellDuration,I=(6*D*(R+P)-12*L)/Math.pow(D,3),N=e*D,O=P*N+.5*((R-P-.5*I*Math.pow(D,2))/D)*Math.pow(N,2)+1/6*I*Math.pow(N,3);A=0;for(u=0;u<c.length;u++)c[u].dist<=O&&(A=u)}else A=Math.floor(e*c.length);a=c[A<0?0:A]}return a}}("undefined"==typeof exports?this.Bezier={}:exports),function(t){function e(t){for(var e=0,i=0;i<t.length;i++)parseInt(t[i])?e+=parseInt(t[i]):t.charCodeAt(i)>=97&&t.charCodeAt(i)<=119&&(e+=t.charCodeAt(i)-87),"P"!=t[i]&&"S"!=t[i]||!parseInt(t[i+1])||i++,"B"!=t[i]&&"D"!=t[i]&&"T"!=t[i]&&"C"!=t[i]&&"S"!=t[i]||"{"!=t[i+1]||(i=t.indexOf("}",i));return e}var i={},n=0,r=1;t.CreateSiteswap=function(t,s){function o(t,e,i,s,a,l){if(e.match(g)){(p=e.match(m)).map(function(e,i){l=o(t,e,i,void 0,void 0,l)})}else if(e.match(f)){var h=(p=e.split(","))[0].substr(1),c=p[1].substr(0,p[1].length-1);l=o(t,h,i,!0,n,l),l=o(t,c,i,!0,r,l)}else if(e.match(d)){var p;(p=e.match(u)).map(function(e,n,r){l=o(t,e,i,void 0,a,l),n<r.length-1&&(0==l?l=b.dwellPath.length-1:l--)})}else{var v=e[0].charCodeAt(0)>=97&&e[0].charCodeAt(0)<=119?e[0].charCodeAt(0)-87:parseInt(e[0]),y=i,x=e.indexOf("P"),_=!1;x>0&&"}"!=e[x+1]&&(y=b.numJugglers>2?parseInt(e[x+1])-1:1-i,_=!0);var w,E=e.indexOf("D");w=E>0?b.beatDuration*parseFloat(e.substring(E+2,e.indexOf("}"))):b.dwellDuration;var T=0,M=[],S=e.indexOf("B");if(S>0){var C;if(C=isNaN(e[S+3])?isNaN(e[S+4])?2:4:3,"{"==e[S+1]&&void 0!=C){T=parseInt(e[S+C]);for(var A=S+C+1;A<e.length&&!isNaN(e[A]);A++){var P=parseInt(e[A]);if(P>=b.surfaces.length)throw{message:"Bounce surface index out of range"};M.push(P)}}else T=1,M=[0];if(M.length<T){var R=M.length;for(A=0;A<T-R;A++)M.push(0)}}var L=void 0;if(T>0)if(e.match("HF"))L="HF";else if(e.match("HL"))L="HL";else if(e.match("F"))L="F";else if(e.match("L"))L="L";else{var D=b.beatDuration*v-w;L=D<.68?"HF":D<1.25?"F":"L"}var I=e.indexOf("T"),N="standard";if(I>0){var O=e.substring(I+2,e.indexOf("}",I));O.match("C")?N="claw":O.match("P")&&(O="penguin")}var k=e.indexOf("C"),z="standard";if(k>0){var H=e.substring(k+2,e.indexOf("}",k));H.match("C")?z="claw":H.match("P")&&(z="penguin")}var F=v%2==1;e.length>1&&"x"==e[1]&&(F=!F),"R"==e[0]?a=r:"L"==e[0]&&(a=n);var U,B=normalize({x:.1,y:.1,z:1}),j=e.indexOf("S");if(j>0){var G=e.substring(j+2,e.indexOf("}",j)).match(/-?\d+(\.\d+)?/g);U=parseFloat(G[0]),G.length>1&&(B.x=parseFloat(G[1]),B.y=parseFloat(G[2]),B.z=parseFloat(G[3]),normalize(B))}else{var W=!0;b.props.forEach(function(t){"ball"!=t.type&&(W=!1)}),W?U=0:(U=Math.floor(v/2)+.2,_&&(U+=.1))}t.push({juggler:i,targetJuggler:y,hand:a,crossing:F,numBeats:v,siteswapStr:e,numBounces:T,bounceOrder:M,bounceType:L,numSpins:U,dwellPathIx:l,dwellDuration:w,tossType:N,catchType:z,tossOrientation:B,rotationAxis:{x:1,y:0,z:0},hold:2==v&&!F&&-1==e.indexOf("A")}),v>0&&(l==b.dwellPath.length-1?l=0:l++)}return l}function a(t,e,n,r,s){n=parseFloat(n.toFixed(2)),void 0==s&&(s={}),s.bounceType||(s.bounceType="L"),s.dt||(s.dt=.01),s.eps||(s.eps=.01),s.dv||(s.dv=.01),s.numBounces||(s.numBounces=0),s.bounceOrder||(s.bounceOrder=[0]),s.G||(s.G=-9.8),s.C||(s.C=.95),s.tries||(s.tries=1e4),s.R||(s.R=.1);var o=JSON.stringify({p0:t,p1:e,T:n,options:s});if(0==s.numBounces)return{x:t.x+(e.x-t.x)*r/n,y:t.y+(e.y-t.y-.5*s.G*n*n)*r/n+.5*s.G*r*r,z:t.z+(e.z-t.z)*r/n,dx:(e.x-t.x)/n,dy:(e.y-t.y-.5*s.G*n*n)/n+s.G*r,dz:(e.z-t.z)/n};if(void 0==i[o]){var a={p0:t,pT:e,minT:n,maxT:n,R:s.R,C:s.C,dt:s.dt,G:-9.8,numBounces:s.numBounces,surfaceBounceOrder:s.bounceOrder,tossSign:"L"==s.bounceType||"HL"==s.bounceType?1:-1,catchSign:"L"==s.bounceType||"HF"==s.bounceType?1:-1,surfaces:b.surfaces};if(ga=new BounceGA({maxGenerations:500,populationSize:50,mutationChance:.7,mutationScale:5,initialScale:40,fitnessThreshold:.05,noGA:!1},a),ga.evolve(),!ga.ableToFindSolution)throw{message:"Unable to calculate bounce path"};var l=ga.getBouncePath(ga.fittestMembers[ga.fittestMembers.length-1].v);i[o]={path:l.path,velocities:l.velocities}}var h=i[o];return{x:h.path[Math.floor((h.path.length-1)*r/n)].x,y:h.path[Math.floor((h.path.length-1)*r/n)].y,z:h.path[Math.floor((h.path.length-1)*r/n)].z,dx:h.velocities[Math.floor((h.velocities.length-1)*r/n)].x,dy:h.velocities[Math.floor((h.velocities.length-1)*r/n)].y,dz:h.velocities[Math.floor((h.velocities.length-1)*r/n)].z}}function l(t){for(var e=[],i=0;i<t.length;i++)t[i].empty||e.push(t[i]);return e}function h(t,e,i,r,s,o,a,l,h){i==n&&(s||o)&&(s.dx*=-1,o.dx*=-1);var c=Bezier.interpolateBezierSpline(t,r,s,o,a,l,h);return{x:b.jugglers[e].position.x+(i==n?-1:1)*c.x*Math.cos(b.jugglers[e].rotation)-(c.z-.4125)*Math.sin(b.jugglers[e].rotation),y:1.0125+c.y,z:b.jugglers[e].position.z+(i==n?-1:1)*c.x*Math.sin(b.jugglers[e].rotation)+(c.z-.4125)*Math.cos(b.jugglers[e].rotation)}}function c(t,e,i,r,s){T=new THREE.Vector3(t.x,t.y,t.z),R=new THREE.Vector3(e.x,e.y,e.z),C=new THREE.Vector3(0,-1,0),s==n&&(T.x*=-1,R.x*=-1);var o=new THREE.Quaternion;o.setFromAxisAngle(new THREE.Vector3(0,-1,0),i),T.applyQuaternion(o);var a=new THREE.Quaternion;a.setFromAxisAngle(new THREE.Vector3(T.z,0,-T.x),Math.acos(T.y));var l=new THREE.Quaternion;l.setFromAxisAngle(new THREE.Vector3(0,1,0),Math.acos(-R.z*T.x+R.x*T.z)),R.applyQuaternion(l);var h=new THREE.Quaternion;h.setFromAxisAngle(R,r);new THREE.Quaternion;return(new THREE.Quaternion).multiplyQuaternions(a,h)}var u,d,p,f,m,g,v,y,b={siteswap:t,validSyntax:!1,validPattern:!1,collision:void 0,multiplex:void 0,sync:void 0,pass:void 0,startingHand:r,numJugglers:void 0,numProps:void 0,maxHeight:void 0,tosses:void 0,beats:void 0,states:void 0,propOrbits:void 0,propPositions:void 0,propRotations:void 0,jugglerHandPositions:void 0,jugglerElbowPositions:void 0,jugglers:void 0,validationOnly:void 0,numStepsPerBeat:void 0,numSteps:void 0,beatDuration:void 0,dwellDuration:void 0,props:void 0,dwellPath:void 0,tossMatchVelocity:void 0,catchMatchVelocity:void 0,dwellCatchScale:void 0,dwellTossScale:void 0,emptyTossScale:void 0,emptyCatchScale:void 0,armAngle:void 0,surfaces:void 0,errorMessage:void 0,stateDiagram:void 0};return function(){t=t.replace(/\s/g,"");var e=1;if(/<[^ ]+>/.test(t)){var i=t.match(/<[^ <>]+>/g);if(1==(e=i[0].split("|").length))return b;var n=e;i.map(function(t){if(t.split("|").length!=n)return b})}var r="";2==e?r="P":e>2&&(r="P[1-"+e+"]");var s="([\\da-o])x?A?("+r+")?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?",o="\\[("+s+")+\\]",a=s+"|"+o,l="\\(("+a+"),("+a+")\\)",h="("+a+"|"+l+")",c="<"+h+"(\\|"+h+")+>",x="^("+c+")+|("+h+")+\\*?$",_="<"+h+"+(\\|"+h+"+)+>";if(u=new RegExp(s,"g"),d=new RegExp(o,"g"),p=new RegExp(a,"g"),f=new RegExp(l,"g"),m=new RegExp(h,"g"),g=new RegExp(c,"g"),v=new RegExp(x,"g"),y=new RegExp(_,"g"),t.match(y)==t){for(var w="",E=t.split("|"),T=[],M=0;M<E.length;M++)T.push(E[M].match(m));for(M=0;M<T[0].length;M++){w+="<";for(var S=0;S<T.length;S++)w+=T[S][M],S<T.length-1&&(w+="|");w+=">"}t=w}if("*"==t.charAt(t.length-1)){var C=(w=t.slice(0,-1)).match(f);if(null!==C){for(M=0;M<C.length;M++)w+="("+C[M].match(p).reverse().join(",")+")";t=w}}t.match(v)==t?(b.validSyntax=!0,b.multiplex=!!t.match(d),b.sync=!!t.match(f),b.pass=!!t.match(g),b.numJugglers=e):b.errorMessage="Invalid syntax"}(),function(){function t(t,e,i){var n,r=t.match(/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?/g)[0].match(/-?\d+(\.\d+)?/g),s=t.match(/\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\}/g);s&&(n=s[0].match(/-?\d+(\.\d+)?/g));var o;return o=n?{x:parseFloat(n[0]),y:parseFloat(n[1]),z:parseFloat(n[2]),th:parseFloat(n[3])}:"club"==b.props[0].type?{x:4,y:0,z:0==e?-1:1,th:Math.PI/2+(0==e?.5:-.7)}:"ring"==b.props[0].type?{x:0,y:1,z:0,th:Math.PI/2}:{x:1,y:0,z:0,th:0},{x:parseFloat(r[0])/100,y:r[1]?parseFloat(r[1])/100:0,z:r[2]?parseFloat(r[2])/100:0,rotation:o,empty:i}}if(void 0===s&&(s={}),b.validationOnly=void 0!==s.validationOnly&&s.validationOnly,b.beatDuration=void 0===s.beatDuration?.2:s.beatDuration,b.dwellDuration=void 0===s.dwellRatio?.5*b.beatDuration:b.beatDuration*s.dwellRatio,b.numStepsPerBeat=void 0===s.numStepsPerBeat?Math.floor(200*b.beatDuration):s.numStepsPerBeat,b.matchVelocity=void 0!==s.matchVelocity&&s.matchVelocity,b.dwellCatchScale=void 0===s.dwellCatchScale?.05:s.dwellCatchScale,b.dwellTossScale=void 0===s.dwellTossScale?.05:s.dwellTossScale,b.emptyTossScale=void 0===s.emptyTossScale?.05:s.emptyTossScale,b.emptyCatchScale=void 0===s.emptyCatchScale?.05:s.emptyCatchScale,b.armAngle=void 0===s.armAngle?.1:s.armAngle,"L"==s.startingHand||"LEFT"==s.startingHand?b.startingHand=n:b.startingHand=r,void 0===s.props?b.props=[{type:"ball",radius:.05,C:.95}]:b.props=s.props,void 0===s.dwellPath)b.dwellPath=[[{x:.3,y:0,z:0,rotation:{x:4,y:0,z:-1,th:Math.PI/2},empty:!1},{x:.1,y:0,z:0,rotation:{x:4,y:0,z:1,th:Math.PI/2},empty:!1}]];else{var e=s.dwellPath.split(").").map(function(t,e,i){return e<i.length-1?t+")":t});b.dwellPath=[];for(var i=0;i<e.length;i++){-1==e[i].indexOf("e")&&(e[i]+="e");var o,a=e[i].split("e")[0].match(/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?(,\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\})?\)/g),l=e[i].split("e")[1].match(/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?(,\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\})?\)/g);null==l?(l=[],o=0):o=l.reduce(function(t,e){return t+e}).length,a.reduce(function(t,e){return t+e}).length==e[i].split("e")[0].length&&o==e[i].split("e")[1].length?b.dwellPath.push(a.map(function(e,i){return t(e,i,!1)}).concat(l.map(function(e,i){return t(e,i,!0)}))):b.errorMessage="Invalid custom dwell path"}}if(void 0===s.surfaces?b.surfaces=[{position:{x:0,y:0,z:0},normal:{x:0,y:1,z:0},scale:5,color:"grey"}]:b.surfaces=s.surfaces,b.jugglers=[],void 0===s.jugglers||b.numJugglers!=s.jugglers.length)if(1==b.numJugglers)b.jugglers.push({position:{x:0,z:-2*i},rotation:i*Math.PI,color:"grey"});else for(i=0;i<b.numJugglers;i++){var h=2*i*Math.PI/b.numJugglers;b.jugglers.push({position:{x:Math.cos(h),z:Math.sin(h)},rotation:h-Math.PI/2,color:"grey"})}else for(i=0;i<s.jugglers.length;i++)b.jugglers.push({position:s.jugglers[i].position,rotation:s.jugglers[i].rotation,color:s.jugglers[i].color});for(i=0;i<b.surfaces.length;i++){var c=b.surfaces[i];normalize(c.normal);var u;u=0==c.normal.x&&0==c.normal.z?{x:1,y:0,z:0}:{x:-c.normal.z,y:0,z:c.normal.x};var d=cross(c.normal,u);normalize(u),multiply(u,c.scale),normalize(d),multiply(d,c.scale),c.axis1=u,c.axis2=d}}(),b.errorMessage?b:(function(){b.beats=b.pass?t.match(g):t.match(m);for(var i=0;i<b.beats.length;i++)b.beats[i].match(f)&&(b.beats.splice(i+1,0,"(0,0)"),i++);var s=0;if(b.beats.map(function(t){if(t.match(g))for(var i=t.split("|"),n=0;n<i.length;n++)0==n&&(i[n]=i[n].substr(1)),n==i.length-1&&(i[n]=i[n].substr(0,i[n].length-1)),s+=e(i[n]);else s+=e(t)}),s/b.beats.length%1==0&&s/b.beats.length>0){for(b.numProps=s/b.beats.length;b.props.length<b.numProps;)b.props.push(cloneObject(b.props.last()));for(;b.props.length>b.numProps;)b.props.pop();b.tosses=[];var a=0;for(i=0;i<b.beats.length;i++){var l=[];a=o(l,b.beats[i],0,0,void 0,a),b.tosses.push(l),i==b.beats.length-1&&0!=a&&(i=-1)}for(b.maxHeight=0,i=0;i<b.tosses.length;i++)for(var h=0;h<b.tosses[i].length;h++)b.tosses[i][h].numBeats>b.maxHeight&&(b.maxHeight=b.tosses[i][h].numBeats);var c=[];for(i=0;i<b.numProps;i++)c.push(i);b.states=[],b.propOrbits=[],b.stateDiagram=[];var u=[];for(h=0;h<b.numJugglers;h++){u.push([[],[]]);for(var d=0;d<b.maxHeight;d++)u[h][n].push(void 0),u[h][r].push(void 0)}for(var p=!1,v=!1,y=0,x=0,_=b.startingHand;!p;){b.stateDiagram.push([1==_?"R":"L"]),0==y&&v&&(b.stateDiagram[x][0]+="*");var w=cloneObject(b.propOrbits),E=[];for(h=0;h<b.numJugglers;h++){var T=u[h][n].shift();if(T)for(d=0;d<T.length;d++)E.push({propId:T[d],juggler:h,hand:n});var M=u[h][r].shift();if(M)for(d=0;d<M.length;d++)E.push({propId:M[d],juggler:h,hand:r});u[h][n].push(void 0),u[h][r].push(void 0)}var S="";for(h=0;h<b.tosses[y%b.tosses.length].length;h++){var C=b.tosses[y%b.tosses.length][h],A=void 0==C.hand?_:C.hand,P=C.crossing?1-A:A,R=void 0;for(d=0;d<E.length;d++)if(E[d].juggler==C.juggler&&E[d].hand==A){if(0==C.numBeats)return void(b.errorMessage="Prop landing on 0 toss at beat "+y);R=E.splice(d,1)[0].propId;break}if(void 0==R&&C.numBeats>0&&(R=c.shift()),void 0==R&&C.numBeats>0)return void(b.errorMessage="No prop available to toss at beat "+y);S+=(void 0===R?"X":R)+"-"+C.siteswapStr,h<b.tosses[y%b.tosses.length].length-1&&(S+=","),C.numBeats>0&&(w[R]||(w[R]=[]),w[R].push({beat:y,numBeats:C.numBeats,juggler:C.juggler,hand:A,numBounces:C.numBounces,bounceType:C.bounceType,bounceOrder:C.bounceOrder,numSpins:C.numSpins,dwellPathIx:C.dwellPathIx,dwellDuration:C.dwellDuration,tossType:C.tossType,catchType:C.catchType,tossOrientation:C.tossOrientation,rotationAxis:C.rotationAxis,hold:C.hold}),void 0==u[C.targetJuggler][P][C.numBeats-1]?u[C.targetJuggler][P][C.numBeats-1]=[R]:u[C.targetJuggler][P][C.numBeats-1].push(R))}if(b.stateDiagram[x].push(S),u[0][0].map(function(t){void 0==t?b.stateDiagram[x].push("X"):b.stateDiagram[x].push(t.reduce(function(t,e){return t.toString()+e.toString()}))}),u[0][1].map(function(t){void 0==t?b.stateDiagram[x].push("X"):b.stateDiagram[x].push(t.reduce(function(t,e){return t.toString()+e.toString()}))}),v&&y%b.tosses.length==0&&arraysEqual(b.states[0],u)?p=!0:(b.states.push(cloneObject(u)),b.propOrbits=w),0!=c.length||(y+1)%b.tosses.length!=0||v||(v=!0,y=-1,b.states=[],b.propOrbits=[]),y++,x++,_=1-_,y>1e3)return void(b.errorMessage="Pattern took more than 1000 beats to repeat states")}for(i=0;i<b.tosses.length;i++)for(h=0;h<b.tosses[i].length;h++)b.tosses[i][h].numBeats>0&&b.tosses[i][h].dwellDuration>=b.beatDuration*b.tosses[i][h].numBeats&&(b.errorMessage="Cannot have a '1' toss with a dwellRatio >= 1");b.numSteps=b.states.length*b.numStepsPerBeat,b.validPattern=!0}else b.errorMessage="Cannot determine number of props"}(),b.errorMessage?b:(b.validationOnly||function(){try{i={};for(var t=[],e=0;e<b.numProps;e++)t.push([]);var s=[];for(e=0;e<b.numProps;e++)s.push([]);var o=[];for(e=0;e<b.numJugglers;e++)o.push([[],[]]);var u=[];for(e=0;e<b.numJugglers;e++)u.push([[],[]]);for(var d=0;d<b.numSteps;d++){var p=[];for(e=0;e<b.numJugglers;e++)p.push([void 0,void 0]);for(var f=Math.floor(d*b.states.length/b.numSteps),m=b.beatDuration*d*b.states.length/b.numSteps,g=0;g<b.numProps;g++){var v=void 0,y=void 0,x=void 0,_=!1;for(e=0;e<b.propOrbits[g].length;e++)!_&&(e==b.propOrbits[g].length-1||b.propOrbits[g][e].beat<=f&&b.propOrbits[g][e+1].beat>f)&&(v=b.propOrbits[g].getPreviousCyclic(e),y=b.propOrbits[g][e],x=b.propOrbits[g].getNextCyclic(e),_=!0);var w=y.beat*b.beatDuration+y.dwellDuration,E=x.beat*b.beatDuration;w>E&&E<=m?E+=b.beatDuration*b.states.length:w>E&&E>m&&(w-=b.beatDuration*b.states.length);var T=v.beat*b.beatDuration+v.dwellDuration,M=y.beat*b.beatDuration;if(T>M&&M<=m?M+=b.beatDuration*b.states.length:T>M&&M>m&&(T-=b.beatDuration*b.states.length),m<w){var S=[],C=[];if(b.multiplex)for(e=0;e<b.propOrbits.length;e++)if(e!=g)for(j=0;j<b.propOrbits[e].length;j++){var A=b.propOrbits[e][j];if(y.beat==A.beat&&y.juggler==A.juggler&&y.hand==A.hand){var P=j==b.propOrbits[e].length-1?b.propOrbits[e][0]:b.propOrbits[e][j+1],R=0==j?b.propOrbits[e][b.propOrbits[e].length-1]:b.propOrbits[e][j-1],L=A.beat*b.beatDuration+A.dwellDuration,D=P.beat*b.beatDuration;L>D&&D<=m?D+=b.beatDuration*b.states.length:L>D&&D>m&&(L-=b.beatDuration*b.states.length);var I=R.beat*b.beatDuration+R.dwellDuration,N=A.beat*b.beatDuration;I>N&&N<=m?N+=b.beatDuration*b.states.length:I>N&&N>m&&(I-=b.beatDuration*b.states.length),S.push(a(h(l(b.dwellPath[A.dwellPathIx]),A.juggler,A.hand,1),h(l(b.dwellPath[P.dwellPathIx]),P.juggler,P.hand,0),D-L,0,{numBounces:A.numBounces,bounceType:A.bounceType,bounceOrder:A.bounceOrder,R:b.props[e].radius,C:b.props[e].C})),C.push(a(h(l(b.dwellPath[R.dwellPathIx]),R.juggler,R.hand,1),h(l(b.dwellPath[A.dwellPathIx]),A.juggler,A.hand,0),N-I,N-I,{numBounces:R.numBounces,bounceType:R.bounceType,bounceOrder:R.bounceOrder,R:b.props[e].radius,C:b.props[e].C}))}}S.push(a(h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,1),h(l(b.dwellPath[x.dwellPathIx]),x.juggler,x.hand,0),E-w,0,{numBounces:y.numBounces,bounceType:y.bounceType,bounceOrder:y.bounceOrder,R:b.props[g].radius,C:b.props[g].C})),C.push(a(h(l(b.dwellPath[v.dwellPathIx]),v.juggler,v.hand,1),h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,0),M-T,M-T,{numBounces:v.numBounces,bounceType:v.bounceType,bounceOrder:v.bounceOrder,R:b.props[g].radius,C:b.props[g].C}));var O={dx:0,dy:0,dz:0,x:0,y:0,z:0},k={dx:0,dy:0,dz:0,x:0,y:0,z:0};for(e=0;e<C.length;e++)O.dx+=C[e].dx/C.length,O.dy+=C[e].dy/C.length,O.dz+=C[e].dz/C.length,O.x+=C[e].x/C.length,O.y+=C[e].y/C.length,O.z+=C[e].z/C.length,k.dx+=S[e].dx/C.length,k.dy+=S[e].dy/C.length,k.dz+=S[e].dz/C.length,k.x+=S[e].x/C.length,k.y+=S[e].y/C.length,k.z+=S[e].z/C.length;var z=1-(w-m)/y.dwellDuration,H=h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,z,O,k,b.dwellCatchScale,b.dwellTossScale),F=h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,0),U=O.x-F.x,B=O.y-F.y,G=O.z-F.z;H.x+=(1-z)*U,H.y+=(1-z)*B,H.z+=(1-z)*G;var W=Math.atan2(-O.dx,-O.dy),V=Math.atan2(k.dx,k.dy);"claw"==y.tossType?V-=Math.PI:"penguin"==y.tossTypeId&&(V-=2*Math.PI),"claw"==y.catchType?W-=Math.PI:"penguin"==y.catchType&&(W-=2*Math.PI),H.angle=W+z*(V-W),y.hand==r&&(H.angle*=-1),H.dwell=!0,t[g].push(H),void 0==p[y.juggler][y.hand]&&(p[y.juggler][y.hand]=H);var q=c(v.tossOrientation,v.rotationAxis,b.jugglers[v.juggler].rotation,2*v.numSpins*Math.PI,v.hand),X=c(y.tossOrientation,y.rotationAxis,b.jugglers[y.juggler].rotation,0,y.hand);q.slerp(X,z),s[g].push(q)}else if(y.hold){var Y=[b.dwellPath[y.dwellPathIx].last(),b.dwellPath[x.dwellPathIx][0]],$=y.numBeats*b.beatDuration-y.dwellDuration,J=a(h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,1),h(l(b.dwellPath[x.dwellPathIx]),x.juggler,x.hand,0),$,0),Z=a(h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,1),h(l(b.dwellPath[x.dwellPathIx]),x.juggler,x.hand,0),$,$);H=h(l(Y),y.juggler,y.hand,(m-w)/(E-w),J,Z,b.emptyTossScale,b.emptyCatchScale),W=Math.atan2(-J.dx,-J.dy),V=Math.atan2(Z.dx,Z.dy),"claw"==y.tossType?V-=Math.PI:"penguin"==y.tossTypeId&&(V-=2*Math.PI),"claw"==y.catchType?W-=Math.PI:"penguin"==y.catchType&&(W-=2*Math.PI),H.angle=W+(m-(w-y.dwellDuration))/(E-(w-y.dwellDuration))*(V-W),y.hand==r&&(H.angle*=-1),H.dwell=!0,t[g].push(H),void 0==p[y.juggler][y.hand]&&(p[y.juggler][y.hand]=H),q=c(y.tossOrientation,y.rotationAxis,b.jugglers[y.juggler].rotation,0,y.hand),X=c(x.tossOrientation,x.rotationAxis,b.jugglers[x.juggler].rotation,0,x.hand),q.slerp(X,(m-(w-y.dwellDuration))/(E-(w-y.dwellDuration))),s[g].push(q)}else{$=E-w,z=m-w,(H=a(h(l(b.dwellPath[y.dwellPathIx]),y.juggler,y.hand,1),h(l(b.dwellPath[x.dwellPathIx]),x.juggler,x.hand,0),$,z,{numBounces:y.numBounces,bounceType:y.bounceType,bounceOrder:y.bounceOrder,R:b.props[g].radius,C:b.props[g].C})).dwell=!1,t[g].push(H);var K=0+z/$*(2*y.numSpins*Math.PI-0);s[g].push(c(y.tossOrientation,y.rotationAxis,b.jugglers[y.juggler].rotation,K,y.hand))}}for(var Q=0;Q<b.numJugglers;Q++)for(var tt=0;tt<=1;tt++){if(void 0==p[Q][tt]){x=void 0;var et=void 0,it=void 0,nt=void 0,rt=void 0,st=void 0,ot=void 0,at=void 0,lt=void 0,ht=void 0,ct=void 0,ut=void 0,dt=void 0,pt=void 0;for(g=0;g<b.propOrbits.length;g++)for(var ft=0;ft<b.propOrbits[g].length;ft++)b.propOrbits[g][ft].juggler==Q&&b.propOrbits[g][ft].hand==tt&&((void 0==et||b.propOrbits[g][ft].beat<et.beat)&&(et=b.propOrbits[g][ft],rt=g,st=ft),b.propOrbits[g][ft].beat>f&&(void 0==x||b.propOrbits[g][ft].beat<x.beat)&&(x=b.propOrbits[g][ft],ot=g,at=ft),(void 0==nt||b.propOrbits[g][ft].beat>nt.beat)&&(nt=b.propOrbits[g][ft],lt=g,ht=ft),b.propOrbits[g][ft].beat<=f&&(void 0==it||b.propOrbits[g][ft].beat>it.beat)&&(it=b.propOrbits[g][ft],ct=g,ut=ft));if(void 0==x&&(x=et,ot=rt,at=st),void 0==it&&(it=nt,ct=lt,ut=ht),void 0==x&&void 0==it)(H=h([{x:.2,y:0,z:0}],Q,tt,0)).angle=0;else{dt=0==at?b.propOrbits[ot].last():b.propOrbits[ot][at-1],pt=ut==b.propOrbits[ct].length-1?b.propOrbits[ct][0]:b.propOrbits[ct][ut+1];var mt=x.beat*b.beatDuration;mt<m&&(mt+=b.beatDuration*b.states.length);var gt=it.beat*b.beatDuration+it.dwellDuration;gt>m&&(gt-=b.beatDuration*b.states.length);var vt=pt.beat*b.beatDuration;vt<gt&&(vt+=b.beatDuration*b.states.length);var yt=dt.beat*b.beatDuration+dt.dwellDuration;yt>mt&&(yt-=b.beatDuration*b.states.length),J=a(h(l(b.dwellPath[it.dwellPathIx]),it.juggler,it.hand,1),h(l(b.dwellPath[pt.dwellPathIx]),pt.juggler,pt.hand,0),it.numBeats*b.beatDuration-it.dwellDuration,0,{numBounces:it.numBounces,bounceType:it.bounceType,bounceOrder:it.bounceOrder,R:b.props[ct].radius,C:b.props[ct].C}),Z=a(h(l(b.dwellPath[dt.dwellPathIx]),dt.juggler,dt.hand,1),h(l(b.dwellPath[x.dwellPathIx]),x.juggler,x.hand,0),dt.numBeats*b.beatDuration-dt.dwellDuration,dt.numBeats*b.beatDuration-dt.dwellDuration,{numBounces:dt.numBounces,bounceType:dt.bounceType,bounceOrder:dt.bounceOrder,R:b.props[ot].radius,C:b.props[ot].C}),z=(m-gt)/(mt-gt);var bt=[],xt=b.dwellPath[it.dwellPathIx];for(e=0;e<xt.length;e++)xt[e].empty&&(0==bt.length&&bt.push(xt[e-1]),bt.push(xt[e]));0==bt.length&&bt.push(xt.last()),bt.push(b.dwellPath[x.dwellPathIx][0]),H=h(bt,it.juggler,it.hand,z,J,Z,b.emptyTossScale,b.emptyCatchScale);var _t=h(bt,it.juggler,it.hand,1),wt=Z.x-_t.x,Et=Z.y-_t.y,Tt=Z.z-_t.z;H.x+=z*wt,H.y+=z*Et,H.z+=z*Tt,W=Math.atan2(-Z.dx,-Z.dy),V=Math.atan2(J.dx,J.dy),"claw"==it.tossType?V-=Math.PI:"penguin"==it.tossType&&(V-=2*Math.PI),"claw"==x.catchType?W-=Math.PI:"penguin"==x.catchType&&(W-=2*Math.PI),H.angle=V+z*(W-V),tt==r&&(H.angle*=-1)}p[Q][tt]=H}o[Q][tt].push(p[Q][tt]),u[Q][tt].push(function(t,e,i,n,r){n*=-1;var s={};s.x=e.x-t.x,s.y=e.y-t.y,s.z=e.z-t.z;var o={};o.x=Math.sqrt(s.x*s.x+s.z*s.z),o.y=s.y,o.z=0;var a=Math.atan2(s.z,s.x),l=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z);2*i<l&&(i=l/2);var h={};h.x=o.y/l,h.y=-o.x/l,h.z=0;var c={x:0,y:0};c.z=1==r?-1:1;var u=Math.sqrt(i*i-.25*l*l),d={};d.x=o.x/2+u*h.x*Math.cos(n)+u*c.x*Math.sin(n),d.y=o.y/2+u*h.y*Math.cos(n)+u*c.y*Math.sin(n),d.z=o.z/2+u*h.z*Math.cos(n)+u*c.z*Math.sin(n);var p={};p.x=d.x*Math.cos(a)-d.z*Math.sin(a),p.y=d.y,p.z=d.x*Math.sin(a)+d.z*Math.cos(a);var f={};return f.x=p.x+t.x,f.y=p.y+t.y,f.z=p.z+t.z,f}({x:b.jugglers[Q].position.x+Math.cos(b.jugglers[Q].rotation)*(tt==n?-1:1)*.225,y:1.425,z:b.jugglers[Q].position.z+Math.sin(b.jugglers[Q].rotation)*(tt==n?-1:1)*.225},p[Q][tt],.45,b.armAngle,tt))}}b.propPositions=t,b.propRotations=s,b.jugglerHandPositions=o,b.jugglerElbowPositions=u,b.collision=function(){for(var t,e,i=0;i<b.propPositions.length;i++){t=b.props[i].radius;for(var n=0;n<b.propPositions[i].length;n++)for(var r=i+1;r<b.propPositions.length;r++)if(e=b.props[i].radius,Math.sqrt(Math.pow(b.propPositions[i][n].x-b.propPositions[r][n].x,2)+Math.pow(b.propPositions[i][n].y-b.propPositions[r][n].y,2)+Math.pow(b.propPositions[i][n].z-b.propPositions[r][n].z,2))<=t+e)return!0}return!1}()}catch(t){b.errorMessage=t.message}}(),b))}}("undefined"==typeof exports?this.SiteswapJS={}:exports),function(t){t.SiteswapAnimator=function(t,e){function i(t){return new THREE.Vector3(t.x,t.y,t.z)}function n(){for(var t=0;t<b.propPositions.length;t++){for(var e=new THREE.Geometry,i=0;i<b.propPositions[t].length;i++){var n=b.propPositions[t][i];e.vertices.push(new THREE.Vector3(n.x+.001*(Math.random()-.5),n.y+.001*(Math.random()-.5),n.z+.001*(Math.random()-.5)))}var r=new THREE.Line(e,new THREE.LineBasicMaterial({color:b.props[t].color}));A.push(r),c.add(r)}}function r(){if("sky"==T.mode){g&&(g.visible=!0),h.position.x=w*Math.sin(x)*Math.cos(_),h.position.y=w*Math.sin(_),h.position.z=w*Math.cos(x)*Math.cos(_);var t=new THREE.Vector3(0,0,0);if(void 0!==b){for(var e=0;e<b.jugglers.length;e++)t.x+=b.jugglers[e].position.x,t.z+=b.jugglers[e].position.z;t.x/=b.jugglers.length,t.z/=b.jugglers.length,t.y=v/2}h.lookAt(t)}else"juggler"==T.mode?(g&&(g.visible=!1),h.position.x=0,h.position.y=1.6125,h.position.z=0,h.lookAt(new THREE.Vector3(Math.sin(x)*Math.cos(_),1.6125-Math.sin(_),Math.cos(x)*Math.cos(_)))):"custom"==T.mode&&(g&&(g.visible=!0),h.position.set(T.x,T.y,T.z),h.lookAt(new THREE.Vector3(h.position.x-Math.sin(x)*Math.cos(_),h.position.y-Math.sin(_),h.position.z-Math.cos(x)*Math.cos(_))))}function s(t){t.preventDefault(),E=!1}var o,a,l,h,c,u,d,p,f,m,g,v,y,b,x=Math.PI,_=.7,w=5,E=!1,T={mode:"sky"},M=[],S=[],C=[],A=[],P=[],R=!1;this.displayPropPaths=!0===e.displayPropPaths,this.step=0,this.usingSlider=!1,o=$("#"+t),this.slider=o.find("input"),a=o.width(),l=o.height(),h=new THREE.PerspectiveCamera(90,a/l,.05,100),r(),c=new THREE.Scene,(u=window.WebGLRenderingContext?new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}):new THREE.CanvasRenderer).setSize(a,l),o.prepend(u.domElement),u.domElement.addEventListener("mousemove",function(t){if(t.preventDefault(),E){x=-.01*(t.clientX-f.x)+d;var e=.01*(t.clientY-f.y)+p;e<Math.PI/2&&e>-Math.PI/2&&(_=e)}r(),u.render(c,h)},!1),u.domElement.addEventListener("touchmove",function(t){if(t.preventDefault(),E){x=-.01*(t.changedTouches[0].clientX-f.x)+d;var e=.01*(t.changedTouches[0].clientY-f.y)+p;e<Math.PI/2&&e>-Math.PI/2&&(_=e)}r(),u.render(c,h)},!1),u.domElement.addEventListener("mousedown",function(t){E=!0,d=x,p=_,f.x=t.clientX,f.y=t.clientY},!1),u.domElement.addEventListener("touchstart",function(t){E=!0,d=x,p=_,f.x=t.changedTouches[0].clientX,f.y=t.changedTouches[0].clientY},!1),u.domElement.addEventListener("mouseup",s,!1),u.domElement.addEventListener("touchend",s,!1),u.domElement.addEventListener("mousewheel",function(t){w-=.002*t.wheelDeltaY},!1),f=new THREE.Vector2,u.setClearColor(16777215,1),u.render(c,h),this.renderer=u,this.oneCycleComplete=!1,this.paused=!1,this.animationSpeed=.6,this.resize=function(t,e){a=t,l=e,h=new THREE.PerspectiveCamera(75,a/l,.05,100),r(),u.setSize(a,l)},this.init=function(t,e){if(this.paused=!1,y=0,(b=t).errorMessage)$("#errorMessage").html("ERROR: "+b.errorMessage),$("#errorMessage").show();else{v=0;for(var i=0;i<b.propPositions.length;i++)for(var r=0;r<b.propPositions[i].length;r++)b.propPositions[i][r].y>v&&(v=b.propPositions[i][r].y);if(w=v+.5,b.pass){for(i=0;i<b.props.length;i++)if("club"==b.props[i].type||"club"==b.props[i].type){$("#errorMessage").html("WARNING: Passing patterns with clubs/rings may look weird. Still working out kinks with prop orientation."),$("#errorMessage").show();break}x+=Math.PI/3,w+=1}for(i=c.children.length-1;i>=0;i--)c.remove(c.children[i]);var s=new THREE.HemisphereLight(16777215,526368,1);c.add(s);var o=new THREE.PointLight(8947848,1,100);for(o.position.set(0,0,-2),c.add(o),c.background=new THREE.Color(e.backgroundColor),M=[],S=[],m=[],P=[],A=[],R=e.drawHands?e.drawHands:0,b.surfaces.map(function(t){var e={position:new THREE.Vector3(t.position.x,t.position.y,t.position.z),normal:new THREE.Vector3(t.normal.x,t.normal.y,t.normal.z),axis1:new THREE.Vector3(t.axis1.x,t.axis1.y,t.axis1.z),axis2:new THREE.Vector3(t.axis2.x,t.axis2.y,t.axis2.z),scale:t.scale},i=new THREE.Geometry;i.vertices.push((new THREE.Vector3).copy(e.position).add((new THREE.Vector3).add(e.axis1).add(e.axis2))),i.vertices.push((new THREE.Vector3).copy(e.position).add((new THREE.Vector3).add(e.axis1).negate().add(e.axis2))),i.vertices.push((new THREE.Vector3).copy(e.position).add((new THREE.Vector3).add(e.axis1).add(e.axis2).negate())),i.vertices.push((new THREE.Vector3).copy(e.position).add((new THREE.Vector3).add(e.axis2).negate().add(e.axis1))),i.faces.push(new THREE.Face3(0,1,2)),i.faces.push(new THREE.Face3(2,0,3));var n=new THREE.Mesh(i,new THREE.MeshBasicMaterial({color:t.color?t.color:"grey",side:THREE.DoubleSide}));C.push(n),c.add(n)}),function(){function t(t,i,n){return new THREE.Vector3(b.jugglers[e].position.x+(Math.cos(b.jugglers[e].rotation)*t-Math.sin(b.jugglers[e].rotation)*n),i,b.jugglers[e].position.z+(Math.cos(b.jugglers[e].rotation)*n+Math.sin(b.jugglers[e].rotation)*t))}for(var e=0;e<b.numJugglers;e++){m.push([[],[]]),P.push([]);var i=b.jugglers[e].color,n=new THREE.Object3D,r=new THREE.CylinderGeometry(.15,0,.625,20,20);(g=new THREE.Mesh(r,new THREE.MeshLambertMaterial({color:i}))).position.set(b.jugglers[e].position.x+0*Math.cos(b.jugglers[e].rotation),1.11,b.jugglers[e].position.z+0*Math.sin(b.jugglers[e].rotation));var s=new THREE.SphereGeometry(.03,20,20),o=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:i}));o.position.copy(t(-.225,1.425,0));var a=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:i}));a.position.copy(t(.225,1.425,0));for(var l=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:i})),h=new THREE.Mesh(s,new THREE.MeshLambertMaterial({color:i})),u=-1;u<=1;u+=2){var d=-1==u?0:1;armG=new THREE.Geometry,armG.vertices.push(t(.225*u,1.425,0)),0==d?(l.position.copy(t(.225*u,1.0125,0)),armG.vertices.push(l.position)):(h.position.copy(t(.225*u,1.0125,0)),armG.vertices.push(h.position)),m[e][d].push(t(.225*u,1.0125,-.4125)),armG.vertices.push(m[e][d][0]),armG.dynamic=!0;var p=new THREE.Line(armG,new THREE.LineBasicMaterial({color:"black"}));if(n.add(p),R){var f=new THREE.Geometry;m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),f.vertices.push(m[e][d][1]),f.vertices.push(m[e][d][2]),f.vertices.push(m[e][d][3]),f.vertices.push(m[e][d][4]),f.faces.push(new THREE.Face3(0,1,2)),f.faces.push(new THREE.Face3(2,0,3)),f.dynamic=!0;var v=new THREE.Mesh(f,new THREE.MeshLambertMaterial({color:i,side:THREE.DoubleSide}));n.add(v);var y=new THREE.Geometry;m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),y.vertices.push(m[e][d][5]),y.vertices.push(m[e][d][6]),y.vertices.push(m[e][d][7]),y.dynamic=!0;var x=new THREE.Line(y,new THREE.LineBasicMaterial({color:"black"}));n.add(x),y=new THREE.Geometry,m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),y.vertices.push(m[e][d][8]),y.vertices.push(m[e][d][9]),y.vertices.push(m[e][d][10]),y.dynamic=!0,x=new THREE.Line(y,new THREE.LineBasicMaterial({color:"black"})),n.add(x),y=new THREE.Geometry,m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),y.vertices.push(m[e][d][11]),y.vertices.push(m[e][d][12]),y.vertices.push(m[e][d][13]),y.dynamic=!0,x=new THREE.Line(y,new THREE.LineBasicMaterial({color:"black"})),n.add(x),y=new THREE.Geometry,m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),m[e][d].push(new THREE.Vector3),y.vertices.push(m[e][d][14]),y.vertices.push(m[e][d][15]),y.vertices.push(m[e][d][16]),y.dynamic=!0,x=new THREE.Line(y,new THREE.LineBasicMaterial({color:"black"})),n.add(x)}}var _=new THREE.Mesh(new THREE.SphereGeometry(.1125,20,20),new THREE.MeshLambertMaterial({color:i}));_.position.set(b.jugglers[e].position.x+0*Math.cos(b.jugglers[e].rotation),1.6125,b.jugglers[e].position.z+0*Math.sin(b.jugglers[e].rotation)),n.add(g),n.add(o),n.add(a),n.add(l),n.add(h),n.add(_),c.add(n),S.push(n),P[e].push(l),P[e].push(h)}}(),i=0;i<b.numProps;i++){var a;if("ball"==b.props[i].type)a=new THREE.SphereGeometry(b.props[i].radius,20);else if("club"==b.props[i].type){(a=new THREE.CylinderGeometry(.008,.02,.02,7,5)).vertices.map(function(t){t.y+=.01});var l=new THREE.CylinderGeometry(.015,.008,.18,7,5);l.vertices.map(function(t){t.y+=.11});var h=new THREE.CylinderGeometry(.04,.015,.18,7,5);h.vertices.map(function(t){t.y+=.29});var u=new THREE.CylinderGeometry(.02,.04,.11,7,5);u.vertices.map(function(t){t.y+=.43}),THREE.GeometryUtils.merge(a,l),THREE.GeometryUtils.merge(a,h),THREE.GeometryUtils.merge(a,u),a.vertices.map(function(t){t.y-=.2})}else if("ring"==b.props[i].type){var d=[];d.push(new THREE.Vector3(.14,0,.01)),d.push(new THREE.Vector3(.18,0,.01)),d.push(new THREE.Vector3(.18,0,-.01)),d.push(new THREE.Vector3(.14,0,-.01)),d.push(new THREE.Vector3(.14,0,.01)),a=new THREE.LatheGeometry(d)}if(e.motionBlur)var p=2;else p=0;var f=[],_="random"==b.props[i].color?randomColors.getIndexCyclic(i):b.props[i].color;for(r=0;r<=p;r++){var E;E=0==r?new THREE.MeshLambertMaterial({color:_}):new THREE.MeshLambertMaterial({color:_,transparent:!0,opacity:1-1/(p+1)*r});var T=new THREE.Mesh(a,E);c.add(T),f.push(T)}M.push(f)}this.displayPropPaths&&n()}},this.animate=function(){0===y&&(y=(new Date).getTime());var t=((new Date).getTime()-y)*this.animationSpeed;if(t>b.states.length*b.beatDuration*1e3&&(this.oneCycleComplete=!0),this.usingSlider)this.step=Math.floor(this.slider.val()*(b.numSteps-1));else{var e=t%(b.states.length*b.beatDuration*1e3);this.step=Math.floor(e/(b.states.length*b.beatDuration*1e3)*b.numSteps),this.slider.val(this.step/b.numSteps)}if(this.render(),!this.paused){var i=this;requestAnimationFrame(function(){i.animate()})}},this.render=function(){for(var t=0;t<M.length;t++)for(var e=0;e<M[t].length;e++){var i=this.step-e*Math.floor(b.numStepsPerBeat/8);if(i<0&&(i+=b.numSteps),M[t][e].position.x=b.propPositions[t][i].x,M[t][e].position.y=b.propPositions[t][i].y,M[t][e].position.z=b.propPositions[t][i].z,M[t][e].quaternion.set(1,0,0,0),"ring"==b.props[t].type){var n=new THREE.Quaternion;n.setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI/2),M[t][e].quaternion.multiply(n)}var s=b.propRotations[t][i];M[t][e].quaternion.multiplyQuaternions(s,M[t][e].quaternion)}for(this.updateHandAndElbowPositions(),r(),t=0;t<S.length;t++)for(e=0;e<S[t].children.length;e++)S[t].children[e].geometry.verticesNeedUpdate=!0;try{u.render(c,h)}catch(t){console.log("Error rendering")}},this.hidePropPaths=function(){A.map(function(t){t.visible=!1})},this.showPropPaths=function(){0==A.length?n():A.map(function(t){t.visible=!0})},this.updateHandAndElbowPositions=function(){for(var t=0;t<m.length;t++){for(var e=0;e<2;e++)if(R)for(var n=[new THREE.Vector3(0,0,.06),new THREE.Vector3(-.03,0,0),new THREE.Vector3(.03,0,0),new THREE.Vector3(.03,0,.06),new THREE.Vector3(-.03,0,.06),new THREE.Vector3(0,0,0),new THREE.Vector3(0,.01,-.03),new THREE.Vector3(0,.05,-.06),new THREE.Vector3(.03,0,0),new THREE.Vector3(.03,.01,-.03),new THREE.Vector3(.03,.05,-.06),new THREE.Vector3(-.03,0,0),new THREE.Vector3(-.03,.01,-.03),new THREE.Vector3(-.03,.05,-.06),new THREE.Vector3(.03*(0==e?-1:1),0,.06),new THREE.Vector3(2*(0==e?-1:1)*.03,0,.06-.02),new THREE.Vector3(2*(0==e?-1:1)*.03,.02,.06-.04)],r=b.jugglerHandPositions[t][e][this.step].angle,s=b.props[0].radius,o=i(b.jugglerHandPositions[t][e][this.step]).add(new THREE.Vector3(s*Math.sin(r),-s*Math.cos(r),0)),a=-Math.atan2(b.jugglerElbowPositions[t][e][this.step].x-b.jugglerHandPositions[t][e][this.step].x,b.jugglerElbowPositions[t][e][this.step].z-b.jugglerHandPositions[t][e][this.step].z),l=0;l<n.length;l++){var h=n[l].x*Math.cos(r)-n[l].y*Math.sin(r),c=n[l].y*Math.cos(r)+n[l].x*Math.sin(r);h=h*Math.cos(a)-n[l].z*Math.sin(a);var u=n[l].z*Math.cos(a)+h*Math.sin(a);n[l].x=h*Math.cos(b.jugglers[t].rotation)-u*Math.sin(b.jugglers[t].rotation),n[l].y=c,n[l].z=u*Math.cos(b.jugglers[t].rotation)+h*Math.sin(b.jugglers[t].rotation),m[t][e][l].copy((new THREE.Vector3).copy(o).add(n[l]))}else m[t][e][0].copy(i(b.jugglerHandPositions[t][e][this.step]));P[t][0].position.set(b.jugglerElbowPositions[t][0][this.step].x,b.jugglerElbowPositions[t][0][this.step].y,b.jugglerElbowPositions[t][0][this.step].z),P[t][1].position.set(b.jugglerElbowPositions[t][1][this.step].x,b.jugglerElbowPositions[t][1][this.step].y,b.jugglerElbowPositions[t][1][this.step].z)}},this.zoomIn=function(){w-=.1},this.zoomOut=function(){w+=.1},this.updateAnimationSpeed=function(t){this.animationSpeed=t},this.updateCameraMode=function(t){T=t}}}("undefined"==typeof exports?this.SiteswapAnimator={}:exports),function(t){Array.prototype.last||(Array.prototype.last=function(){return this[this.length-1]}),Array.prototype.sum||(Array.prototype.sum=function(){return this.reduce(function(t,e){return t+e})}),t.siteswapGraph=function(t,e){function i(e,r,l){if(e.length==t.maxPeriod){if(e.reduce(function(t,e){return t+e})==t.numProps&&o.push({value:e,edges:[]}),t.callbacks.updateGraphProgress){t.callbacks.updateGraphProgress(1)}l&&function(){for(var e=0;e<o.length;e++){if(t.callbacks.updateGraphProgress){var i=(e+1)/o.length;t.callbacks.updateGraphProgress(i)}for(var r=0;r<o.length;r++)setTimeout(function(t,e){for(var i=n(o[t].value,o[e].value),r=0;r<i.length;r++)o[t].edges.push(a.push({source:t,target:e,value:i[r]})-1)},0,e,r)}t.callbacks.graphDone&&setTimeout(t.callbacks.graphDone);t.async?setTimeout(s,0,0,[]):s(0,[])}()}else r.map(function(n,r,s){var o=e.slice();o.push(n);var a=o.reduce(function(t,e){return t+e})-t.numProps,l=[];l=0==a?[0]:1==a?[1,0]:t.includeMultiplex?[1,2,0]:[1,0];var h=this.last&&r==s.length-1;t.async?setTimeout(i,0,o,l,h):i(o,l,h)},{last:l})}function n(t,e){var i=[],n=t[0],r=t.slice(1,t.length);r.push(0);var s=!1;0==n?i.push("0"):n>1?(s=!0,i.push("[")):i.push("");for(var o=0;o<r.length;o++){var a=o+1;if(a>9&&(a=String.fromCharCode(87+a)),r[o]!=e[o]){if(!(n>=e[o]-r[o]))return[];i[0]+=a,1==--n&&e[o]-r[o]==2&&(i[0]+=a,n--)}}return s&&(i[0]+="]"),i}function r(e,i){if(e.length!=i.length)return!1;for(var n=0;n<=e.length;n++){if(e.toString()==i.toString())return!0;e.push(e[0]),e=e.slice(1),t.sync&&(e.push(e[0]),e=e.slice(1))}}function s(e,i){if(++c<=t.maxSearches&&l.length<t.maxSiteswaps){var n=e,u=!1,d=void 0;if(i.length>0&&i.length<=t.maxPeriod){if(i.length>=t.minPeriod&&(!t.sync||i.length%2==0))if(a[i.last()].target==e)u=!0,d=0;else if(t.includeExcited)for(var p=0;p<i.length;p++)a[i.last()].target!=a[i[p]].source||t.sync&&p%2!=0||(u=!0,d=p);if(u){var f=i.map(function(e,i){if(t.sync){for(var n="",r=a[e].value,s=0;s<r.length;s++)"["==r[s]||"]"==r[s]||parseInt(r[s])%2==0?n+=r[s]:n+=i%2==0?parseInt(r[s])-1+"x":parseInt(r[s])+1+"x";return n}return a[e].value}).slice(d),m=!1;for(p=0;p<l.length;p++){if(r(l[p].map(function(e,i){if(t.sync){for(var n="",r=a[e].value,s=0;s<r.length;s++)"["==r[s]||"]"==r[s]||parseInt(r[s])%2==0?n+=r[s]:n+=i%2==0?parseInt(r[s])-1+"x":parseInt(r[s])+1+"x";return n}return a[e].value}),f.slice())){m=!0;break}}if(!m){var g=l.push(i.slice(d))-1;if(t.callbacks.siteswapFound){for(p=0;p<f.length;p++)f[p]>9&&(f[p]=String.fromCharCode(87+parseInt(f[p])));var v="";if(t.sync)for(p=0;p<f.length;p++)v+=p%2==0?"("+f[p]+",":f[p]+")";else v=f.join("");h.push(v),t.callbacks.siteswapFound(v,g,d>0)}}u=!0}n=a[i.last()].target}(!u||d>0)&&i.length<t.maxPeriod&&o[n].edges.map(function(n){function r(){for(var r=!1,o=0;o<t.exclude.length;o++)if(t.exclude[o]==a[n].value){r=!0;break}if(t.sync&&i.length%2==0&&a[n].value.indexOf(1)>-1&&(r=!0),!r){var l=i.slice();l.push(n),s(e,l)}}t.async?setTimeout(r,0):r()})}}t.minPeriod=void 0===t.minPeriod?[]:t.minPeriod,t.async=void 0===t.async?[]:t.async,t.callbacks=void 0===t.callbacks?[]:t.callbacks,t.exclude=void 0===t.exclude?[]:t.exclude,t.includeExcited=void 0===t.includeExcited||t.includeExcited,t.maxSearches=void 0===t.maxSearches?99999999:t.maxSearches,t.maxSiteswaps=void 0===t.maxSiteswaps?1e3:t.maxSiteswaps,t.includeMultiplex=void 0!==t.includeMultiplex&&t.includeMultiplex,t.sync=void 0!==t.sync&&t.sync;var o=[],a=[],l=[],h=[];(e=void 0===e?{}:e).graph={nodes:o,edges:a,siteswaps:l,formattedSiteswaps:h};var c=0,u=[];if(u.push(1),u.push(0),t.includeMultiplex&&u.push(2),t.async?setTimeout(i,0,[],u.slice(),!0):i([],u.slice(),!0),!t.async)return e}}("undefined"==typeof exports?this.SiteswapGraph={}:exports);var DEFAULT_INPUTS,twoWindow=!1;window.onload=function(){displayMenu("pattern"),window.animator=new SiteswapAnimator.SiteswapAnimator("animatorCanvasContainer",{displayPropPaths:!1}),window.onresize(),buildExamples(),refreshSavedSiteswapsList(),$.get("defaultPattern.yml",function(t){DEFAULT_INPUTS=YAML.parse(t);var e=getURLQueryStringParameterByName("patternId");void 0!=e?runSavedSiteswap(e,!1):($("#inputsAdvanced").val(YAML.stringify(DEFAULT_INPUTS.inputs,1,1)),go())})},window.onresize=function(){var t=$(window).width()-5,e=$(window).height()-10,i=500,n=t-i,r=e-30;n>400?($("#nav #animator").hide(),$("#animatorCanvasContainer").appendTo($("body")),$("#animatorMenu").removeClass("controlDiv"),$(".navText").show(),twoWindow=!0):(i>t&&(i=t),$("#nav #animator").show(),$("#animatorCanvasContainer").appendTo($("#controlsContainer #animatorMenu")),$("#animatorMenu").addClass("controlDiv"),n=t-15,i=t,twoWindow=!1,r-=$("#animatorCanvasContainer").offset().top,$(".navText").hide()),$("#controlsContainer").height(e),$("#controlsContainer").width(i),$("#animatorCanvasContainer").height(r),$("#animatorCanvasContainer").width(n),$("#generatedSiteswaps").height(e-$("#generatedSiteswaps").offset().top-10),$("#exampleSiteswaps").height(e-$("#exampleSiteswaps").offset().top-10),$("#stateDiagramTableContainer").height(e-$("#exampleSiteswaps").offset().top-10),$("#savedSiteswaps").height(e-$("#exampleSiteswaps").offset().top-10),$("#patternMenu").height(e-$("#patternMenu").offset().top-10),animator.resize&&animator.resize(n,r)};