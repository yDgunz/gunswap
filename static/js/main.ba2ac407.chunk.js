(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(t,e,n){t.exports=n(159)},111:function(t,e,n){},112:function(t,e,n){},150:function(t,e){},152:function(t,e){},159:function(t,e,n){"use strict";n.r(e);var s,a,i,o,r=n(0),d=n.n(r),h=n(31),l=n.n(h),u=(n(111),n(112),n(8)),c=n(11),p=n(18),g=n(17),f=n(9),m=n(19),v="([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?",w="\\[("+v+")+\\]",P=v+"|"+w,S="\\(("+P+"),("+P+")\\)",y="("+P+"|"+S+")",M="<"+y+"(\\|"+y+")+>",C=new RegExp(v,"g"),T=new RegExp(w,"g"),x=new RegExp(P,"g"),E=new RegExp(S,"g"),B=new RegExp(y,"g"),L=new RegExp(M,"g"),R=new RegExp("^(<(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))(\\|(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\)))+>)+|((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\)))+\\*?$","g"),H=new RegExp("<(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))+(\\|(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))+)+>","g"),D=n(4);!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Any=2]="Any"}(s||(s={})),function(t){t[t.Force=0]="Force",t[t.HyperForce=1]="HyperForce",t[t.Lift=2]="Lift",t[t.HyperLift=3]="HyperLift",t[t.Any=4]="Any"}(a||(a={})),function(t){t[t.Standard=0]="Standard",t[t.Claw=1]="Claw",t[t.Penguin=2]="Penguin"}(i||(i={})),function(t){t[t.Standard=0]="Standard",t[t.Claw=1]="Claw",t[t.Penguin=2]="Penguin"}(o||(o={}));var b,j,F=new D.vec3([.1,.1,1]).normalize(),O=function t(e,n,r,d,h,l,c){Object(u.a)(this,t),this.Juggler=void 0,this.TargetJuggler=void 0,this.Hand=void 0,this.Crossing=void 0,this.NumBeats=void 0,this.Siteswap=void 0,this.NumBounces=void 0,this.BounceOrder=void 0,this.BounceType=void 0,this.NumSpins=void 0,this.DwellPath=void 0,this.DwellRatio=void 0,this.TossType=void 0,this.CatchType=void 0,this.TossOrientation=void 0,this.RotationAxis=void 0,this.Hold=void 0,this.Juggler=n,this.Hand=r,this.Siteswap=e,this.DwellPath=d;var p=e.match(C);if(!p||p.length>1)throw"Invalid toss string";this.NumBeats=e[0].charCodeAt(0)>=97&&e[0].charCodeAt(0)<=119?e[0].charCodeAt(0)-87:parseInt(e[0]),this.TargetJuggler=n;var g=!1,f=e.indexOf("P");f>0&&"}"!=e[f+1]&&(this.TargetJuggler=h>2?parseInt(e[f+1])-1:1-n,g=!0);var m=e.indexOf("D");this.DwellRatio=m>0?parseFloat(e.substring(m+2,e.indexOf("}"))):l,this.NumBounces=0,this.BounceOrder=[];var v=e.indexOf("B");if(v>0){var w=e.slice(v).search(/\d/)+v;if("{"==e[v+1]&&void 0!=w){this.NumBounces=parseInt(e[w]);for(var P=w+1;P<e.length&&!isNaN(e[P]);P++){var S=parseInt(e[P]);if(S>=c)throw"Bounce surface index out of range";this.BounceOrder.push(S)}}else this.NumBounces=1,this.BounceOrder=[0];if(this.BounceOrder.length<this.NumBounces){var y=this.NumBounces-this.BounceOrder.length;for(P=0;P<y;P++)this.BounceOrder.push(0)}}this.NumBounces>0&&(e.match("HF")?this.BounceType=a.HyperForce:e.match("HL")?this.BounceType=a.HyperLift:e.match("F")?this.BounceType=a.Force:e.match("L")?this.BounceType=a.Lift:this.BounceType=a.Any);var M=e.indexOf("T");if(this.TossType=i.Standard,M>0){var T=e.substring(M+2,e.indexOf("}",M));T.match("C")?this.TossType=i.Claw:T.match("P")&&(this.TossType=i.Penguin)}var x=e.indexOf("C");if(this.CatchType=o.Standard,x>0){var E=e.substring(x+2,e.indexOf("}",x));E.match("C")?this.CatchType=o.Claw:E.match("P")&&(this.CatchType=o.Penguin)}this.Crossing=this.NumBeats%2==1,e.length>1&&"x"==e[1]&&(this.Crossing=!this.Crossing),"R"==e[0]?this.Hand=s.Right:"L"==e[0]&&(this.Hand=s.Left),this.TossOrientation=F;var B=e.indexOf("S");if(B>0){var L=e.substring(B+2,e.indexOf("}",B)).match(/-?\d+(\.\d+)?/g);if(!L)throw"Invalid spin configuration";this.NumSpins=parseFloat(L[0]),L.length>1&&(this.TossOrientation=new D.vec3([parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])]).normalize())}else this.NumSpins=Math.floor(this.NumBeats/2)+.2,g&&(this.NumSpins+=.1);this.Hold=2==this.NumBeats&&!this.Crossing&&-1==e.indexOf("A"),this.RotationAxis=new D.vec3([1,0,0])},k=function(){function t(e){var n=this;if(Object(u.a)(this,t),this.Siteswap=void 0,this.Beats=void 0,this.IsSync=void 0,this.IsMultiplex=void 0,this.IsPassingPattern=void 0,this.NumJugglers=void 0,this.Siteswap=e.toString().replace(/\s/g,""),this.NumJugglers=1,this.IsPassingPattern=/<[^ ]+>/.test(this.Siteswap),this.IsPassingPattern){var s=this.Siteswap.match(/<[^ <>]+>/g);if(s){if(this.NumJugglers=s[0].split("|").length,1==this.NumJugglers)throw new Error("Cannot have passing pattern with 1 juggler.");s.forEach(function(t){if(t.split("|").length!=n.NumJugglers)throw new Error("Each beat in passing siteswap must contain same number of jugglers")})}}var a=this.Siteswap.match(H);null!=a&&a[0]==this.Siteswap&&(this.Siteswap=this.transformPassingShorthand()),"*"==this.Siteswap.charAt(this.Siteswap.length-1)&&(this.Siteswap=this.transformSymmetricSyncShorthand());var i=this.Siteswap.match(R);if(null===i||i[0]!==this.Siteswap)throw"Invalid siteswap syntax.";this.IsMultiplex=!!this.Siteswap.match(T),this.IsSync=!!this.Siteswap.match(E);var o=this.IsPassingPattern?this.Siteswap.match(L):this.Siteswap.match(B);this.Beats=[],o&&o.forEach(function(t){n.Beats.push(t)});for(var r=0;r<this.Beats.length;r++)this.Beats[r].match(E)&&(this.Beats.splice(r+1,0,"(0,0)"),r++)}return Object(c.a)(t,[{key:"transformPassingShorthand",value:function(){for(var t="",e=this.Siteswap.split("|"),n=[],s=0;s<e.length;s++)n.push(e[s].match(B));for(s=0;s<n[0].length;s++){t+="<";for(var a=0;a<n.length;a++)t+=n[a][s],a<n.length-1&&(t+="|");t+=">"}return t}},{key:"transformSymmetricSyncShorthand",value:function(){var t=this.Siteswap.slice(0,-1),e=t.match(E);if(null!==e)for(var n=0;n<e.length;n++)t+="("+e[n].match(x).reverse().join(",")+")";return t}},{key:"GetTossCollection",value:function(t,e,n){var a=[],i=0,o=0;do{var r=this.Beats[i];++i==this.Beats.length&&(i=0);var d=[];(r.match(L)?r.match(B):[r]).forEach(function(a,i,r){var h=[];if(a.match(E)){var l=a.split(",");h.push({hand:s.Left,toss:l[0]}),h.push({hand:s.Right,toss:l[1]})}else h.push({hand:s.Any,toss:a});h.forEach(function(s){var a=t[o];++o==t.length&&(o=0),s.toss.match(C).forEach(function(h){var l=new O(h,i,s.hand,a,r.length,e,n);d.push(l),0==l.NumBeats&&--o<0&&(o=t.length-1)})})}),a.push(d)}while(0!=i||0!=o);return a}}]),t}(),z=n(98);(j=b||(b={}))[j.Ball=0]="Ball",j[j.Club=1]="Club",j[j.Ring=2]="Ring";var A=function(){function t(e,n,s,a){Object(u.a)(this,t),this.Id=e,this.PropType=n,this.C=s,this.Radius=a,this.TossSchedule=void 0,this.TossSchedule=[]}return Object(c.a)(t,[{key:"GetPreviousCurrentAndNextTossForBeat",value:function(t){for(var e=0;e<this.TossSchedule.length;e++){if(e==this.TossSchedule.length-1||this.TossSchedule[e].Beat<=t&&this.TossSchedule[e+1].Beat>t)return[0==e?this.TossSchedule[this.TossSchedule.length-1]:this.TossSchedule[e-1],this.TossSchedule[e],e==this.TossSchedule.length-1?this.TossSchedule[0]:this.TossSchedule[e+1]]}throw"Unable to determine previous, current, and next toss for beat"}}]),t}();function J(t,e,n,s,a,i,o,r){var d=t.Toss.DwellPath.GetPosition(1,t.Hand,new D.vec3,new D.vec3,0,0,null,a,i),h=e.Toss.DwellPath.GetPosition(0,e.Hand,new D.vec3,new D.vec3,0,0,null,o,r);return[new D.vec3([d.x+(h.x-d.x)*n/s,d.y+(h.y-d.y+4.9*s*s)*n/s-4.9*n*n,d.z+(h.z-d.z)*n/s]),new D.vec3([(h.x-d.x)/s,(h.y-d.y+4.9*s*s)/s-9.8*n,(h.z-d.z)/s])]}function N(t,e,n,s,a,i,o){var r;if(0==e)r=t[0];else if(1==e)r=t[t.length-1];else{1==t.length&&t.push(t[0]);var d=t[0].copy();d.add(n.copy().scale(a)),d.add(n.copy().normalize().scale(.1));var h=t[t.length-1].copy();h.add(s.copy().scale(-i)),h.add(s.copy().normalize().scale(-.1));for(var l=[d,h],u=[],c=[],p=0;p<t.length-1;p++){var g,f=t[p],m=t[p+1];if(0==p)w=l[0];else{var v=u[u.length-1],w=new D.vec3([f.x+(f.x-v.x),f.y+(f.y-v.y),f.z+(f.z-v.z)]);u.push(w)}if(p+1==t.length-1)g=l[1];else{var P=new D.vec3([(t[p].x+t[p+1].x)/2,(t[p].y+t[p+1].y)/2,(t[p].z+t[p+1].z)/2]),S=new D.vec3([(t[p+1].x+t[p+2].x)/2,(t[p+1].y+t[p+2].y)/2,(t[p+1].z+t[p+2].z)/2]),y=Math.sqrt(Math.pow(t[p].x-t[p+1].x,2)+Math.pow(t[p].y-t[p+1].y,2)+Math.pow(t[p].z-t[p+1].z,2)),M=y/(y+Math.sqrt(Math.pow(t[p+1].x-t[p+2].x,2)+Math.pow(t[p+1].y-t[p+2].y,2)+Math.pow(t[p+1].z-t[p+2].z,2))),C=new D.vec3([(1-M)*P.x+M*S.x,(1-M)*P.y+M*S.y,(1-M)*P.z+M*S.z]);g=new D.vec3([m.x+(P.x-C.x),m.y+(P.y-C.y),m.z+(P.z-C.z)]),u.push(g)}for(M=0;M<=1+1e-5;M+=.02)c.push(new D.vec3([Math.pow(1-M,3)*f.x+3*Math.pow(1-M,2)*M*w.x+3*(1-M)*Math.pow(M,2)*g.x+Math.pow(M,3)*m.x,Math.pow(1-M,3)*f.y+3*Math.pow(1-M,2)*M*w.y+3*(1-M)*Math.pow(M,2)*g.y+Math.pow(M,3)*m.y,Math.pow(1-M,3)*f.z+3*Math.pow(1-M,2)*M*w.z+3*(1-M)*Math.pow(M,2)*g.z+Math.pow(M,3)*m.z]))}var T=Math.floor(e*c.length);r=c[T<0?0:T]}return r}var I=1.05,V=function(){function t(e,n,a,i){Object(u.a)(this,t),this.Siteswap=e,this.DwellPaths=n,this.Props=void 0,this.TossCollection=void 0,this.States=void 0,this.Simulation=void 0,this.TossCollection=e.GetTossCollection(n,a,i);var o=0,r=this;if(e.Beats.map(function(t){if(t.match(L))for(var e=t.split("|"),n=0;n<e.length;n++)0==n&&(e[n]=e[n].substr(1)),n==e.length-1&&(e[n]=e[n].substr(0,e[n].length-1)),o+=r.sumThrows(e[n]);else o+=r.sumThrows(t)}),!(o/e.Beats.length%1==0&&o/e.Beats.length>0))throw"Cannot determine number of props";var d=o/e.Beats.length;this.Props=[];for(var h=0;h<d;h++)this.Props.push(new A(h,b.Ball,.5,.1));var l=0;this.TossCollection.forEach(function(t){t.forEach(function(t){t.NumBeats>l&&(l=t.NumBeats)})});var c=this.Props.slice(0);this.States=[];for(var p=[],g=0;g<e.NumJugglers;g++){p.push([[],[]]);for(var f=0;f<l;f++)p[g][s.Left].push(null),p[g][s.Right].push(null)}for(var m=!1,v=!1,w=0,P=s.Left;!m;){var S=[];if(p.forEach(function(t,e){var n=t[s.Left].shift();t[s.Left].push(null),n&&n.forEach(function(t){S.push({Prop:t,Juggler:e,Hand:s.Left})});var a=t[s.Right].shift();t[s.Right].push(null),a&&a.forEach(function(t){S.push({Prop:t,Juggler:e,Hand:s.Right})})}),this.TossCollection[w%this.TossCollection.length].forEach(function(t){for(var e=t.Hand==s.Any?P:t.Hand,n=t.Crossing?1-e:e,a=void 0,i=0;i<S.length;i++){var o=S[i];if(o.Hand==e&&o.Juggler==t.Juggler){if(0==t.NumBeats)throw"Prop landing on 0 toss at beat ".concat(w);a=o.Prop,S.splice(i,1);break}}if(void 0===a&&t.NumBeats>0&&(a=c.shift()),void 0===a&&t.NumBeats>0)throw"No prop available to toss at beat ".concat(w);t.NumBeats>0&&(v&&a.TossSchedule.push({Toss:t,Beat:w,Hand:e}),p[t.TargetJuggler][n][t.NumBeats-1]?p[t.TargetJuggler][n][t.NumBeats-1].push(a):p[t.TargetJuggler][n][t.NumBeats-1]=[a])}),v?w%this.TossCollection.length==0&&JSON.stringify(this.States[0],["Id"])==JSON.stringify(p,["Id"])?(m=!0,this.Props.forEach(function(t){t.TossSchedule[t.TossSchedule.length-1].Beat==w&&t.TossSchedule.pop()})):this.States.push(JSON.parse(JSON.stringify(p,["Id"]))):0==c.length&&(w+1)%this.TossCollection.length==0&&(v=!0,w=-1,this.States=[]),P=1-P,++w>1e3)throw"Pattern took more than 1000 beats to repeat states"}}return Object(c.a)(t,[{key:"sumThrows",value:function(t){for(var e=0,n=0;n<t.length;n++)parseInt(t[n])?e+=parseInt(t[n]):t.charCodeAt(n)>=97&&t.charCodeAt(n)<=119&&(e+=t.charCodeAt(n)-87),"P"!=t[n]&&"S"!=t[n]||!parseInt(t[n+1])||n++,"B"!=t[n]&&"D"!=t[n]&&"T"!=t[n]&&"C"!=t[n]&&"S"!=t[n]||"{"!=t[n+1]||(n=t.indexOf("}",n));return e}},{key:"Simulate",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.States.length,d=r*t,h=!1,l={Props:[],Jugglers:[],BeatDuration:e,NumStepsPerBeat:t};this.Props.forEach(function(t){return l.Props.push({Positions:[],Rotations:[]})}),this.States[0].forEach(function(t,e,n){var s,a;if(1==n.length)s=new D.vec3([0,0,0]),a=0;else{a=e/n.length*Math.PI*2,s=new D.vec3([-1*Math.sin(a),0,1*Math.cos(a)])}l.Jugglers.push({BodyPositions:Array(d).fill(s),BodyRotations:Array(d).fill(a),LeftHandPositions:[],RightHandPositions:[],LeftElbowPositions:[],RightElbowPositions:[],LeftHandDirections:[],RightHandDirections:[]})});for(var u=0;u<d;u++){var c=Math.floor(u*r/d),p=e*u*r/d;this.Props.forEach(function(t,a){var d,h,g,f=t.GetPreviousCurrentAndNextTossForBeat(c),m=Object(z.a)(f,3);d=m[0],h=m[1],g=m[2];var v=p,w=d.Beat;w>=h.Beat&&(w-=r);var P=g.Beat,S=h.Beat;P<=h.Beat&&(w-=r,S-=r);var y=S*e+h.Toss.DwellRatio*e,M=P*e,C=w*e+d.Toss.DwellRatio*e,T=S*e;v>=M&&(v-=r*e);var x=l.Jugglers[d.Toss.Juggler].BodyPositions[u],E=l.Jugglers[d.Toss.Juggler].BodyRotations[u],B=l.Jugglers[h.Toss.Juggler].BodyPositions[u],L=l.Jugglers[h.Toss.Juggler].BodyRotations[u],R=l.Jugglers[g.Toss.Juggler].BodyPositions[u],H=l.Jugglers[g.Toss.Juggler].BodyRotations[u];if(v<y||h.Toss.Hold){var D=T-C,b=J(d,h,D,D,x,E,B,L)[1],j=J(h,g,0,M-y,B,L,R,H)[1];if(h.Toss.Hold)var F=1-(M-v)/(M-T);else F=1-(y-v)/(y-T);var O=h.Toss.DwellPath.GetPosition(F,h.Hand,b,j,.01,.015,h.Toss.Hold?g.Toss.DwellPath.Snapshots[0]:null,B,L);l.Props[a].Positions.push(O);var k=n.interpolateHandDirection(b.copy().scale(h.Toss.CatchType==o.Claw?1:-1),j.copy().scale(h.Toss.TossType==i.Claw?-1:1),F);h.Hand===s.Left?(l.Jugglers[h.Toss.Juggler].LeftHandPositions[u]=O,l.Jugglers[h.Toss.Juggler].LeftHandDirections[u]=k):(l.Jugglers[h.Toss.Juggler].RightHandPositions[u]=O,l.Jugglers[h.Toss.Juggler].RightHandDirections[u]=k)}else{O=J(h,g,F=v-y,M-y,B,L,R,H)[0];l.Props[a].Positions.push(O)}});for(var g=0;g<this.Props.length;g++)for(var f=g+1;f<this.Props.length;f++){var m=l.Props[g].Positions[u],v=l.Props[f].Positions[u],w=D.vec3.distance(m,v);if(w<this.Props[g].Radius||w<this.Props[f].Radius){if(a)return!1;h=!0}}l.Jugglers.forEach(function(t,a){[s.Left,s.Right].forEach(function(d){if(d===s.Left&&void 0===t.LeftHandPositions[u]||d===s.Right&&void 0===t.RightHandPositions[u]){var h,g,f=0;n.Props.forEach(function(t){t.TossSchedule.forEach(function(t){var e=t.Beat;e<=c&&(e+=r),e>c&&t.Toss.Juggler==a&&t.Hand==d&&(void 0===h||e<f)&&(h=t,f=e)})});var m,v=0;if(n.Props.forEach(function(t){t.TossSchedule.forEach(function(t){var e=t.Beat;e>c&&(e-=r),e<=c&&t.Toss.Juggler==a&&t.Hand==d&&(void 0===g||e>v)&&(g=t,v=e)})}),void 0===g||void 0===h)m=new D.vec3([.3*d==s.Left?-1:1,I,0]),O=new D.vec3([0,1,0]);else{var w,P,S=[];S.push(g.Toss.DwellPath.Snapshots[g.Toss.DwellPath.Snapshots.length-1].Position.copy()),S.push(h.Toss.DwellPath.Snapshots[0].Position.copy()),n.Props.forEach(function(t){t.TossSchedule.forEach(function(t,e,n){t.Hand===d&&t.Beat===h.Beat&&t.Toss.Juggler===a&&(w=0==e?n[n.length-1]:n[e-1])})}),n.Props.forEach(function(t){t.TossSchedule.forEach(function(t,e,n){t===g&&(P=e===n.length-1?n[0]:n[e+1])})});var y=t.BodyPositions[u],M=t.BodyRotations[u],C=l.Jugglers[g.Toss.TargetJuggler].BodyPositions[u],T=l.Jugglers[g.Toss.TargetJuggler].BodyRotations[u],x=l.Jugglers[w.Toss.Juggler].BodyPositions[u],E=l.Jugglers[w.Toss.Juggler].BodyRotations[u],B=J(g,P,0,g.Toss.NumBeats*e,y,M,C,T)[1],L=J(w,h,w.Toss.NumBeats*e-w.Toss.DwellRatio*e,w.Toss.NumBeats*e-w.Toss.DwellRatio*e,x,E,y,M)[1];d===s.Left&&S.forEach(function(t){return t.x*=-1});var R=p;R>f*e&&(R-=r*e);var H=f*e-(v*e+g.Toss.DwellRatio*e),b=(R-(v*e+g.Toss.DwellRatio*e))/H;b<0&&(b=1),b>1&&(b=0);for(var j=0;j<S.length;j++){var F=S[j].copy();S[j].x=F.x*Math.cos(M)-F.z*Math.sin(M),S[j].y=F.y+I,S[j].z=F.x*Math.sin(M)+F.z*Math.cos(M),S[j].add(y)}m=N(S,b,B,L,.01,.01);var O=n.interpolateHandDirection(B.copy().scale(g.Toss.TossType==i.Claw?-1:1),L.copy().scale(h.Toss.CatchType==o.Claw?1:-1),b)}d===s.Left?(t.LeftHandPositions[u]=m,t.LeftHandDirections[u]=O):(t.RightHandPositions[u]=m,t.RightHandDirections[u]=O)}var k=t.BodyRotations[u],z=t.BodyPositions[u],A=.225*(d===s.Left?-1:1),V=new D.vec3([z.x+(A*Math.cos(k)-.25*Math.sin(k)),1.425,z.z+(A*Math.sin(k)+.25*Math.cos(k))]),U=n.getElbowPosition(V,d===s.Left?t.LeftHandPositions[u]:t.RightHandPositions[u],.2,d);d===s.Left?t.LeftElbowPositions[u]=U:t.RightElbowPositions[u]=U})})}return this.Simulation=l,h}},{key:"getElbowPosition",value:function(t,e,n,s){var a=.3;n*=-1;var i=new D.vec3;i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z;var o=new D.vec3;o.x=Math.sqrt(i.x*i.x+i.z*i.z),o.y=i.y,o.z=0;var r=Math.atan2(i.z,i.x),d=Math.sqrt(i.x*i.x+i.y*i.y+i.z*i.z);2*a<d&&(a=d/2);var h=new D.vec3;h.x=o.y/d,h.y=-o.x/d,h.z=0;var l=new D.vec3([0,0,0]);l.z=1==s?-1:1;var u=Math.sqrt(a*a-.25*d*d),c=new D.vec3;c.x=o.x/2+u*h.x*Math.cos(n)+u*l.x*Math.sin(n),c.y=o.y/2+u*h.y*Math.cos(n)+u*l.y*Math.sin(n),c.z=o.z/2+u*h.z*Math.cos(n)+u*l.z*Math.sin(n);var p=new D.vec3;p.x=c.x*Math.cos(r)-c.z*Math.sin(r),p.y=c.y,p.z=c.x*Math.sin(r)+c.z*Math.cos(r);var g=new D.vec3;return g.x=p.x+t.x,g.y=p.y+t.y,g.z=p.z+t.z,g}},{key:"interpolateHandDirection",value:function(t,e,n){t=t.copy().normalize(),e=e.copy().normalize();var s=D.vec3.dot(t,e);if(s>.9995)return e.subtract(t).scale(n).add(t),e;var a=n*Math.acos(s),i=e.copy().subtract(t.copy().scale(s)).normalize();return t.scale(Math.cos(a)).add(i.scale(Math.sin(a)))}},{key:"GetHeighestAndLowestPositionInSimulation",value:function(){var t=I,e=I;return this.Simulation&&this.Simulation.Props.forEach(function(n){n.Positions.forEach(function(n){n.y>t&&(t=n.y),n.y<e&&(e=n.y)})}),[t,e]}}]),t}(),U=(new D.vec4([4,0,1,Math.PI/2]),new D.vec4([0,1,0,Math.PI/2]),new D.vec4([0,0,0,0])),G=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;Object(u.a)(this,t),this.Position=void 0,this.Rotation=void 0,this.Empty=void 0,this.Empty=n;var a=e.match(/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?/g);if(!a)throw"Could not find position for dwell path snapshot.";var i=a[0].match(/-?\d+(\.\d+)?/g);if(!i)throw"Could not find position for dwell path snapshot.";this.Position=new D.vec3([parseFloat(i[0])/100,i[1]?parseFloat(i[1])/100:0,i[2]?parseFloat(i[2])/100:0]);var o=e.match(/\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\}/g);if(o){var r=o[0].match(/-?\d+(\.\d+)?/g);if(!r||4!=r.length)throw"Could not find 4 rotation values";this.Rotation=new D.vec4([parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])])}else this.Rotation=s},W=function(){function t(e){var n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U;Object(u.a)(this,t),this.Snapshots=void 0,this.Snapshots=[],-1==e.indexOf("e")&&(e+="e");var a=/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?(,\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\})?\)/g,i=e.split("e")[0].match(a),o=e.split("e")[1].match(a);if(!i)throw new Error("Invalid dwell path");i.forEach(function(t){n.Snapshots.push(new G(t,!1,s))}),o&&o.forEach(function(t){n.Snapshots.push(new G(t,!0,s))})}return Object(c.a)(t,[{key:"GetPosition",value:function(t,e,n,s,a,i,o,r,d){var h=this.Snapshots.map(function(t){return q(t,e,r,d)});o&&h.push(q(o,e,r,d));new D.vec3;return 0==t?h[0].copy():1==t?h[h.length-1].copy():N(h,t,n,s,a,i)}}]),t}();function q(t,e,n,a){var i=t.Position.copy();return e==s.Left&&(i.x*=-1),i.y+=I,i.x=i.x*Math.cos(a)-i.z*Math.sin(a),i.z=i.x*Math.sin(a)+i.z*Math.cos(a),i.add(n),i}function Y(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=t.split(").").map(function(t,e,n){return e<n.length-1?t+")":t});if(e)return e.map(function(t){return new W(t)});throw new Error("Could not determine dwell paths")}var X=n(183),Q=n(96),$=n(181),K=n(190),Z=n(6),_=n(186),tt=n(180),et=n(99),nt=n(189),st=n(184),at=(n(61),n(24));function it(t,e){var n="",s=t.LandingSchedule[0],a=t.LandingSchedule.slice(1,e.LandingSchedule.length);a.push(0);var i=!1;0==s?n="0":s>1&&(i=!0,n="[");for(var o=0;o<a.length;o++){var r=o+1,d=r.toString();if(r>9&&(d=String.fromCharCode(87+r)),a[o]!=e.LandingSchedule[o]){if(!(s>=e.LandingSchedule[o]-a[o]))return null;n+=d,1==--s&&e.LandingSchedule[o]-a[o]==2&&(n+=d,s--)}}return i&&(n+="]"),n}function ot(t){return t[t.length-1]}function rt(t){var e=function(t,e,n){var s=[],a=[1,0];return n&&a.push(2),function a(i,o,r){i.LandingSchedule.length==t?i.LandingSchedule.reduce(function(t,e){return t+e})==e&&s.push(i):o.map(function(t,s,o){var d={LandingSchedule:i.LandingSchedule.slice(),Edges:[]};d.LandingSchedule.push(t);var h=d.LandingSchedule.reduce(function(t,e){return t+e})-e;a(d,0==h?[0]:1==h?[1,0]:n?[1,2,0]:[1,0],r&&s==o.length-1)})}({LandingSchedule:[],Edges:[]},a,!1),s}(t.maxPeriod,t.numProps,t.includeMultiplex),n=function(t){for(var e=[],n=0;n<t.length;n++)for(var s=0;s<t.length;s++){var a=it(t[n],t[s]);a&&t[n].Edges.push(e.push({SourceNode:n,TargetNode:s,Value:a})-1)}return e}(e),s=0,a=[],i=[];return function r(d,h){s++;if(s<=t.maxSearches&&a.length<t.maxSiteswaps){var l=d,u=!1,c=void 0;if(h.length>0&&h.length<=t.maxPeriod){if(h.length>=t.minPeriod&&(!t.sync||h.length%2==0))if(n[ot(h)].TargetNode==d)u=!0,c=0;else if(t.includeExcited)for(var p=0;p<h.length;p++)n[ot(h)].TargetNode!=n[h[p]].SourceNode||t.sync&&p%2!=0||(u=!0,c=p);if(u){for(var g=h.map(function(e,s){if(t.sync){for(var a="",i=n[e].Value,o=0;o<i.length;o++)"["==i[o]||"]"==i[o]||parseInt(i[o])%2==0?a+=i[o]:a+=s%2==0?parseInt(i[o])-1+"x":parseInt(i[o])+1+"x";return a}return n[e].Value}).slice(c),f=!1,p=0;p<a.length;p++){var m=a[p].map(function(e,s){if(t.sync){for(var a="",i=n[e].Value,o=0;o<i.length;o++)"["==i[o]||"]"==i[o]||parseInt(i[o])%2==0?a+=i[o]:a+=s%2==0?parseInt(i[o])-1+"x":parseInt(i[o])+1+"x";return a}return n[e].Value});if(o(m,g.slice())){f=!0;break}}if(!f){a.push(h.slice(c));for(var p=0;p<g.length;p++)parseInt(g[p])>9&&(g[p]=String.fromCharCode(87+parseInt(g[p])));var v="";if(t.sync)for(var p=0;p<g.length;p++)v+=p%2==0?"("+g[p]+",":g[p]+")";else v=g.join("");i.push(v)}u=!0}l=n[ot(h)].TargetNode}(!u||c>0)&&h.length<t.maxPeriod&&e[l].Edges.map(function(e){for(var s=!1,a=0;a<t.exclude.length;a++)if(t.exclude[a]==n[e].Value){s=!0;break}if(t.sync&&h.length%2==0&&n[e].Value.indexOf("1")>-1&&(s=!0),!s){var i=h.slice();i.push(e),r(d,i)}})}}(0,[]),i;function o(e,n){if(e.length!=n.length)return!1;for(var s=0;s<=e.length;s++){if(e.toString()==n.toString())return!0;e.push(e[0]),e=e.slice(1),t.sync&&(e.push(e[0]),e=e.slice(1))}}}var dt=n(191),ht=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).examplePatternListDomElement=void 0,n.onRenderCell=n.onRenderCell.bind(Object(f.a)(n)),n.jugglePattern=n.jugglePattern.bind(Object(f.a)(n)),n.examplePatternListDomElement=d.a.createRef(),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"jugglePattern",value:function(t){var e=new k(t.siteswap),n=new V(e,Y(t.dwellPath),t.dwellRatio,1);n.Simulate(100,t.beatDuration),this.props.updatePattern(n,t)}},{key:"onRenderCell",value:function(t,e){var n=this;return d.a.createElement("div",{id:e.toString()},d.a.createElement(_.a,{onClick:function(){n.jugglePattern(t.patternSettings)}},t.name))}},{key:"componentDidMount",value:function(){var t=l.a.findDOMNode(this.examplePatternListDomElement.current);t&&(t.style.height=(window.innerHeight-t.offsetTop-40).toString()+"px",t.style.overflow="auto")}},{key:"render",value:function(){return d.a.createElement(dt.a,{items:[{name:"Cascade",patternSettings:{siteswap:"3",dwellPath:"(30)(10)",beatDuration:.24,dwellRatio:.8}},{name:"Reverse Cascade",patternSettings:{siteswap:"3",dwellPath:"(10)(30)",beatDuration:.24,dwellRatio:.8}},{name:"Columns",patternSettings:{siteswap:"(4,4)(4,0)",dwellPath:"(20).(20).(0)",beatDuration:.24,dwellRatio:.8}},{name:"Yo-Yo",patternSettings:{siteswap:"(4,2)",dwellPath:"(20).(0,60).(0).(0,25)",beatDuration:.2,dwellRatio:1.1}},{name:"Tennis",patternSettings:{siteswap:"3",dwellPath:"(35,15).(20)(7).(20)(7)",beatDuration:.24,dwellRatio:.9}},{name:"423",patternSettings:{siteswap:"423",dwellPath:"(30).(30).(30)(10)",beatDuration:.24,dwellRatio:.8}},{name:"Factory",patternSettings:{siteswap:"(2,4)(2,4x)(2x,4)",dwellPath:"(20).(20).(30,40).(0).(-20,40).(30)(0)",beatDuration:.24,dwellRatio:1.2}},{name:"Mill's Mess",patternSettings:{siteswap:"3",dwellPath:"(0,10)(-20,10).(0)(20).(0,0)(-20,0)",beatDuration:.24,dwellRatio:1}}],onRenderCell:this.onRenderCell,ref:this.examplePatternListDomElement})}}]),e}(r.Component),lt=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).state={input:at.safeDump(n.props.patternSettings).replace(/'/g,""),errorMessage:null,showSyntaxHelp:!1},n.updatePatternSettingsInput=n.updatePatternSettingsInput.bind(Object(f.a)(n)),n.juggleRandomPattern=n.juggleRandomPattern.bind(Object(f.a)(n)),n.juggleInputPattern=n.juggleInputPattern.bind(Object(f.a)(n)),n.juggleExamplePattern=n.juggleExamplePattern.bind(Object(f.a)(n)),n.juggle=n.juggle.bind(Object(f.a)(n)),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"updatePatternSettingsInput",value:function(t){this.setState({input:t.target.value})}},{key:"juggle",value:function(t){try{var e=new k(t.siteswap.toString()),n=new V(e,Y(t.dwellPath),t.dwellRatio,1);n.Simulate(100,t.beatDuration),this.props.updatePattern(n,t),this.setState({errorMessage:null})}catch(a){var s;s=a.message?a.message:a,this.setState({errorMessage:s})}}},{key:"juggleRandomPattern",value:function(){var t=function(){for(var t=rt({numProps:3+Math.round(Math.random()),minPeriod:1,maxPeriod:6,includeMultiplex:!1,includeExcited:!0,maxSearches:1e3,maxSiteswaps:100,sync:Math.random()<.3,exclude:[]}),e=[-20,-10,0,10,20,30],n=[0,0,10,20,20,30],s=[],a=0;a<e.length;a++)for(var i=0;i<n.length;i++)s.push("(".concat(e[a],",").concat(n[i],")"));return function e(){for(var n=t[Math.floor(Math.random()*t.length)],a=[],i=0;i<1+Math.round(Math.random());i++){for(var o="",r=0;r<1+Math.round(Math.random());r++)o+=s[Math.floor(Math.random()*s.length)];a.push(o)}o=a.join(".");var d=new k(n),h=Y(o);return new V(d,h,.8,0).Simulate(20,.2,!1)?e():{siteswap:n,beatDuration:.2,dwellPath:o,dwellRatio:.8}}()}();this.setState({input:at.safeDump(t).replace(/'/g,"")}),this.juggle(t)}},{key:"juggleInputPattern",value:function(){var t;try{t=at.safeLoad(this.state.input)}catch(e){this.setState({errorMessage:"Invalid pattern settings."})}t&&this.juggle(t)}},{key:"juggleExamplePattern",value:function(t,e){this.setState({input:at.safeDump(e).replace(/'/g,"")}),this.props.updatePattern(t,e)}},{key:"render",value:function(){return d.a.createElement($.a,null,d.a.createElement(K.a,{messageBarType:Z.a.info},"Due to some hosting issues the old version of Gunswap is no longer available. This version is not frequently updated, but you can follow progress on GitHub at ",d.a.createElement(_.a,{href:"https://github.com/ydgunz/gunswap"},"https://github.com/ydgunz/gunswap"),"."),this.state.errorMessage&&d.a.createElement(K.a,{messageBarType:Z.a.severeWarning,isMultiline:!1},this.state.errorMessage),d.a.createElement($.a,{horizontal:!0},d.a.createElement(tt.a,{className:"panel-main-button",text:"Juggle",onClick:this.juggleInputPattern}),d.a.createElement(et.a,{className:"panel-main-button",text:"Random Pattern",onClick:this.juggleRandomPattern})),d.a.createElement(nt.a,null,"Pattern Settings"),d.a.createElement(st.a,{value:this.state.input,multiline:!0,onChange:this.updatePatternSettingsInput,autoAdjustHeight:!0}),d.a.createElement(nt.a,null,"Example Patterns"),d.a.createElement(ht,{updatePattern:this.juggleExamplePattern}))}}]),e}(r.Component),ut=n(5),ct=new ut.f({color:"grey"}),pt=function(){function t(e,n,s,a,i){var o=this;Object(u.a)(this,t),this.scene=void 0,this.camera=void 0,this.renderer=void 0,this.propMeshes=void 0,this.jugglerMeshes=void 0,this.camRadius=void 0,this.camPhi=void 0,this.camTheta=void 0,this.startTime=void 0,this.pattern=void 0,this.isMouseDown=void 0,this.onMouseDownPosition=void 0,this.onMouseDownTheta=void 0,this.onMouseDownPhi=void 0,this.positionToLookAt=void 0,this.currentStep=void 0,this.userControllingStep=void 0,this.animationSpeed=void 0,this.isPlaying=void 0,this.scene=new ut.j,this.camera=new ut.h(75,s/a,.1,1e3),this.positionToLookAt=new D.vec3,this.renderer=new ut.n({antialias:!0,preserveDrawingBuffer:!0}),this.scene.add(new ut.d(16777215,0,1)),this.propMeshes=[],this.jugglerMeshes=[],this.camRadius=1,this.camPhi=0,this.camTheta=Math.PI,this.startTime=(new Date).getTime(),this.pattern=n,n&&this.UpdatePattern(n),this.isMouseDown=!1,this.onMouseDownPosition=new D.vec3,this.onMouseDownTheta=0,this.onMouseDownPhi=0,this.userControllingStep=!1,this.currentStep=0,this.animationSpeed=i,this.isPlaying=!0,this.renderer.setSize(s,a),this.renderer.domElement.addEventListener("mousemove",function(t){o.onDocumentMouseMove(t)},!1),this.renderer.domElement.addEventListener("mousedown",function(t){o.onDocumentMouseDown(t)},!1),this.renderer.domElement.addEventListener("mouseup",function(t){o.onDocumentMouseUp(t)},!1),this.renderer.domElement.addEventListener("wheel",function(t){o.onDocumentMouseWheel(t)},!1),this.renderer.domElement.addEventListener("touchmove",function(t){o.onDocumentTouchMove(t)},!1),this.renderer.domElement.addEventListener("touchstart",function(t){o.onDocumentTouchStart(t)},!1),this.renderer.domElement.addEventListener("touchmove",function(t){o.onDocumentTouchEnd(t)},!1),e.append(this.renderer.domElement),this.animate()}return Object(c.a)(t,[{key:"UpdateStep",value:function(t){this.currentStep=Math.floor(this.pattern.States.length*this.pattern.Simulation.NumStepsPerBeat*t),this.userControllingStep=!0}},{key:"UpdatePattern",value:function(t){if(this.pattern=t,t){var e=t.GetHeighestAndLowestPositionInSimulation();this.positionToLookAt.y=e[0]-(e[0]-e[1])/2,this.camRadius=e[0]-(e[0]-e[1])/2-I/2,this.updateCamera()}}},{key:"Resize",value:function(t,e){this.renderer.setSize(t,e),this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}},{key:"onDocumentMouseDown",value:function(t){this.isMouseDown=!0,this.onMouseDownTheta=this.camTheta,this.onMouseDownPhi=this.camPhi,this.onMouseDownPosition.x=t.clientX,this.onMouseDownPosition.y=t.clientY}},{key:"onDocumentTouchStart",value:function(t){this.isMouseDown=!0,this.onMouseDownTheta=this.camTheta,this.onMouseDownPhi=this.camPhi,this.onMouseDownPosition.x=t.touches[0].clientX,this.onMouseDownPosition.y=t.touches[0].clientY}},{key:"onMove",value:function(t,e){if(this.isMouseDown){this.camTheta=-.01*(t-this.onMouseDownPosition.x)+this.onMouseDownTheta;var n=.01*(e-this.onMouseDownPosition.y)+this.onMouseDownPhi;n<Math.PI/2&&n>-Math.PI/2&&(this.camPhi=n),this.updateCamera()}}},{key:"onDocumentMouseMove",value:function(t){t.preventDefault(),this.onMove(t.clientX,t.clientY)}},{key:"onDocumentTouchMove",value:function(t){t.preventDefault(),this.onMove(t.touches[0].clientX,t.touches[0].clientY)}},{key:"onDocumentMouseUp",value:function(t){t.preventDefault(),this.isMouseDown=!1}},{key:"onDocumentTouchEnd",value:function(t){t.preventDefault(),this.isMouseDown=!1}},{key:"onDocumentMouseWheel",value:function(t){this.camRadius+=.05*t.deltaY,this.updateCamera()}},{key:"updateCamera",value:function(){this.camera.position.x=this.camRadius*Math.sin(this.camTheta)*Math.cos(this.camPhi),this.camera.position.y=this.camRadius*Math.sin(this.camPhi)+this.positionToLookAt.y,this.camera.position.z=this.camRadius*Math.cos(this.camTheta)*Math.cos(this.camPhi),this.camera.lookAt(this.positionToLookAt.x,this.positionToLookAt.y,this.positionToLookAt.z)}},{key:"animate",value:function(){var t=this;if(this.pattern&&this.pattern.Simulation&&(this.isPlaying||this.userControllingStep)){if(!this.userControllingStep){var e=((new Date).getTime()-this.startTime)%(this.pattern.States.length*this.pattern.Simulation.BeatDuration*1e3/this.animationSpeed);this.currentStep=Math.floor(e/(this.pattern.States.length*this.pattern.Simulation.BeatDuration*1e3/this.animationSpeed)*(this.pattern.Simulation.NumStepsPerBeat*this.pattern.States.length))}for(;this.pattern.Props.length<this.propMeshes.length;){var n=this.propMeshes.pop();this.scene.remove(n)}for(;this.pattern.Props.length>this.propMeshes.length;){var s=new ut.l(.05,40),a=new ut.f({color:65280}),i=new ut.e(s,a);this.propMeshes.push(i),this.scene.add(i)}for(this.propMeshes.forEach(function(e,n){var s=t.pattern.Simulation.Props[n].Positions[t.currentStep];e.position.set(s.x,s.y,s.z)});this.pattern.Simulation.Jugglers.length>this.jugglerMeshes.length;)this.addJugglerMeshes();this.jugglerMeshes.forEach(function(e,n){var s=t.pattern.Simulation.Jugglers[n];e.BodyMesh.position.set(-.25*Math.sin(s.BodyRotations[t.currentStep]),1.225,.25*Math.cos(s.BodyRotations[t.currentStep])),e.BodyMesh.position.add(t.vec3ToTHREEVector3(s.BodyPositions[t.currentStep])),e.HeadMesh.position.set(-.25*Math.sin(s.BodyRotations[t.currentStep]),1.595,.25*Math.cos(s.BodyRotations[t.currentStep])),e.HeadMesh.position.add(t.vec3ToTHREEVector3(s.BodyPositions[t.currentStep]));var a=new ut.m(-.225*Math.cos(s.BodyRotations[t.currentStep])-.25*Math.sin(s.BodyRotations[t.currentStep]),1.425,-.225*Math.sin(s.BodyRotations[t.currentStep])+.25*Math.cos(s.BodyRotations[t.currentStep]));a.add(t.vec3ToTHREEVector3(s.BodyPositions[t.currentStep]));var i=new ut.m(.225*Math.cos(s.BodyRotations[t.currentStep])-.25*Math.sin(s.BodyRotations[t.currentStep]),1.425,.225*Math.sin(s.BodyRotations[t.currentStep])+.25*Math.cos(s.BodyRotations[t.currentStep]));i.add(t.vec3ToTHREEVector3(s.BodyPositions[t.currentStep]));var o=t.vec3ToTHREEVector3(s.LeftHandPositions[t.currentStep]),r=t.vec3ToTHREEVector3(s.RightHandPositions[t.currentStep]),d=t.vec3ToTHREEVector3(s.LeftElbowPositions[t.currentStep]),h=t.vec3ToTHREEVector3(s.RightElbowPositions[t.currentStep]);e.LeftHandMesh.position.copy(o),e.RightHandMesh.position.copy(r),e.LeftElbowMesh.position.copy(d),e.RightElbowMesh.position.copy(h),e.LeftShoulderMesh.position.copy(a),e.RightShoulderMesh.position.copy(i),t.positionAndRotateArm(d,a,o,e.LeftBicepMesh,e.LeftForearmMesh,e.LeftWristMesh),t.positionAndRotateArm(h,i,r,e.RightBicepMesh,e.RightForearmMesh,e.RightWristMesh);var l=new ut.i;l.setFromUnitVectors(new ut.m(0,1,0),t.vec3ToTHREEVector3(s.LeftHandDirections[t.currentStep])),e.LeftHandMesh.setRotationFromQuaternion(l),l.setFromUnitVectors(new ut.m(0,1,0),t.vec3ToTHREEVector3(s.RightHandDirections[t.currentStep])),e.RightHandMesh.setRotationFromQuaternion(l)})}requestAnimationFrame(function(){return t.animate()}),this.renderer.render(this.scene,this.camera)}},{key:"vec3ToTHREEVector3",value:function(t){return new ut.m(t.x,t.y,t.z)}},{key:"positionAndRotateArm",value:function(t,e,n,s,a,i){var o=(new ut.m).subVectors(t,e),r=new ut.a(o.clone().normalize(),e);s.rotation.setFromVector3(r.rotation.toVector3());var d=(new ut.m).addVectors(e,o.multiplyScalar(.5));s.position.copy(d),o=(new ut.m).subVectors(t,n),r=new ut.a(o.clone().normalize(),n),a.rotation.setFromVector3(r.rotation.toVector3()),d=(new ut.m).addVectors(n,o.multiplyScalar(.5)).add(o.clone().normalize().multiplyScalar(.04)),a.position.copy(d),d=n.clone().add(o.clone().normalize().multiplyScalar(.08)),i.position.copy(d)}},{key:"getHandMesh",value:function(){var t=new ut.k(.06,20,20,0,2*Math.PI,Math.PI/2,Math.PI),e=new ut.g({color:"grey",side:ut.c,flatShading:!0});return new ut.e(t,e)}},{key:"getJointMesh",value:function(t){var e=new ut.l(t,20);return new ut.e(e,ct)}},{key:"getArmCylinder",value:function(t,e,n){var s=new ut.b(e,t,n,20,20);return new ut.e(s,ct)}},{key:"addJugglerMeshes",value:function(){var t={LeftHandMesh:this.getHandMesh(),RightHandMesh:this.getHandMesh(),LeftElbowMesh:this.getJointMesh(.04),RightElbowMesh:this.getJointMesh(.04),LeftShoulderMesh:this.getJointMesh(.025),RightShoulderMesh:this.getJointMesh(.025),LeftWristMesh:this.getJointMesh(.02),RightWristMesh:this.getJointMesh(.02),LeftBicepMesh:this.getArmCylinder(.025,.04,.3),LeftForearmMesh:this.getArmCylinder(.02,.04,.21),RightBicepMesh:this.getArmCylinder(.025,.04,.3),RightForearmMesh:this.getArmCylinder(.02,.04,.21),BodyMesh:new ut.e(new ut.b(.15,.05,.4,20,20,!1),ct),HeadMesh:new ut.e(new ut.k(.1,20,20),ct)};this.jugglerMeshes.push(t),this.scene.add(t.LeftElbowMesh),this.scene.add(t.LeftShoulderMesh),this.scene.add(t.RightElbowMesh),this.scene.add(t.RightShoulderMesh),this.scene.add(t.LeftBicepMesh),this.scene.add(t.LeftForearmMesh),this.scene.add(t.RightBicepMesh),this.scene.add(t.RightForearmMesh),this.scene.add(t.LeftWristMesh),this.scene.add(t.RightWristMesh),this.scene.add(t.BodyMesh),this.scene.add(t.HeadMesh)}}]),t}(),gt=n(195),ft=n(187),mt=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).CanvasContainerRef=void 0,n.jugglingScene=void 0,n.CanvasContainerRef=null,n.state={debugInfo:null,userControllingStep:!1,isPlaying:!0,animationSpeed:.5},n.userUpdateStep=n.userUpdateStep.bind(Object(f.a)(n)),n.play=n.play.bind(Object(f.a)(n)),n.pause=n.pause.bind(Object(f.a)(n)),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"play",value:function(){this.jugglingScene&&(this.jugglingScene.isPlaying=!0,this.jugglingScene.userControllingStep=!1,this.setState({isPlaying:!0,userControllingStep:!1}))}},{key:"pause",value:function(){this.jugglingScene&&(this.jugglingScene.isPlaying=!1,this.setState({isPlaying:!1}))}},{key:"userUpdateStep",value:function(t){this.jugglingScene&&(this.jugglingScene.UpdateStep(t),this.setState({debugInfo:{step:this.jugglingScene.currentStep},userControllingStep:!0}))}},{key:"componentDidUpdate",value:function(){this.jugglingScene&&this.jugglingScene.pattern!==this.props.pattern&&(this.jugglingScene.userControllingStep=!1,this.jugglingScene.isPlaying=!0,this.setState({userControllingStep:!1,debugInfo:null,isPlaying:!0}),this.jugglingScene.UpdatePattern(this.props.pattern))}},{key:"componentDidMount",value:function(){var t=this,e=this.CanvasContainerRef.offsetWidth,n=window.innerHeight-32;this.jugglingScene=new pt(this.CanvasContainerRef,this.props.pattern,e,n,this.state.animationSpeed),window.jugglingScene=this.jugglingScene,window.addEventListener("resize",function(){if(t.CanvasContainerRef){var e=t.CanvasContainerRef.offsetWidth,n=window.innerHeight-32;t.jugglingScene&&t.jugglingScene.Resize(e,n)}})}},{key:"render",value:function(){var t,e=this,n=d.a.createElement("div",null);return this.state.debugInfo&&(n=d.a.createElement("div",null,this.state.debugInfo.step)),t=this.state.isPlaying&&!this.state.userControllingStep?d.a.createElement(gt.a,{iconProps:{iconName:"Pause"},onClick:this.pause}):d.a.createElement(gt.a,{iconProps:{iconName:"Play"},onClick:this.play}),d.a.createElement("div",null,d.a.createElement("div",{className:"debug-info"},n),d.a.createElement("div",{ref:function(t){e.CanvasContainerRef=t}}),d.a.createElement($.a,{horizontal:!0},t,d.a.createElement(ft.a,{className:"viewport-slider",min:0,max:.99,step:.005,showValue:!1,onChange:function(t){return e.userUpdateStep(t)}})))}}]),e}(r.Component),vt=function(t){function e(t){var n;Object(u.a)(this,e);return(n=Object(p.a)(this,Object(g.a)(e).call(this,t))).state={siteswaps:[],input:at.safeDump({numProps:3,minPeriod:1,maxPeriod:5,includeMultiplex:!1,includeExcited:!0,maxSearches:1e3,maxSiteswaps:100,sync:!1,exclude:[]})},n.onRenderCell=n.onRenderCell.bind(Object(f.a)(n)),n.findSiteswaps=n.findSiteswaps.bind(Object(f.a)(n)),n.updateInput=n.updateInput.bind(Object(f.a)(n)),n.juggleSiteswap=n.juggleSiteswap.bind(Object(f.a)(n)),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"juggleSiteswap",value:function(t){var e={siteswap:t,dwellPath:"(30)(10)",beatDuration:.24,dwellRatio:.8},n=new k(e.siteswap),s=new V(n,Y(e.dwellPath),e.dwellRatio,1);s.Simulate(100,e.beatDuration),this.props.updatePattern(s,e)}},{key:"findSiteswaps",value:function(){var t;try{t=at.safeLoad(this.state.input)}catch(n){}if(t){var e=rt(t);this.setState({siteswaps:e})}}},{key:"onRenderCell",value:function(t,e){var n=this;return d.a.createElement("div",{id:e.toString()},d.a.createElement(_.a,{onClick:function(){n.juggleSiteswap(t)}},t))}},{key:"updateInput",value:function(t){this.setState({input:t.target.value})}},{key:"componentDidUpdate",value:function(){var t=document.getElementsByClassName("siteswap-list");t&&(t[0].style.height=(window.innerHeight-t[0].offsetTop).toString()+"px",t[0].style.overflow="auto")}},{key:"render",value:function(){return d.a.createElement($.a,null,d.a.createElement(tt.a,{className:"panel-main-button",text:"Find Siteswaps",onClick:this.findSiteswaps}),d.a.createElement(nt.a,null,"Search Settings"),d.a.createElement(st.a,{value:this.state.input,multiline:!0,onChange:this.updateInput,autoAdjustHeight:!0}),d.a.createElement(dt.a,{className:"siteswap-list",items:this.state.siteswaps,onRenderCell:this.onRenderCell}))}}]),e}(r.Component),wt=n(95),Pt=n(69),St={siteswap:"51",beatDuration:.24,dwellPath:"(30)(10)",dwellRatio:.8},yt=function(t){function e(t){var n;Object(u.a)(this,e),n=Object(p.a)(this,Object(g.a)(e).call(this,t));var s=Object(wt.parse)(window.location.search);if(s.siteswap&&(St.siteswap=s.siteswap.toString()),s.patternSettings){var a=JSON.parse(Pt.decompress(s.patternSettings,{inputEncoding:"Base64"}));St=a}return n.state={pattern:new V(new k(St.siteswap),Y(St.dwellPath),St.dwellRatio,0),patternSettings:St},n.state.pattern.Simulate(100,.24),window.onresize=function(){n.forceUpdate()},n.updatePattern=n.updatePattern.bind(Object(f.a)(n)),n}return Object(m.a)(e,t),Object(c.a)(e,[{key:"updatePattern",value:function(t,e){var n=encodeURIComponent(Pt.compress(JSON.stringify(e),{outputEncoding:"Base64"}));window.history.pushState("pattern","pattern",window.location.origin+window.location.pathname+"?patternSettings="+n),this.setState({pattern:t,patternSettings:e})}},{key:"render",value:function(){var t=d.a.createElement(lt,{updatePattern:this.updatePattern,patternSettings:this.state.patternSettings}),e=d.a.createElement(vt,{updatePattern:this.updatePattern}),n=d.a.createElement(mt,{pattern:this.state.pattern});return window.innerWidth>900?d.a.createElement("div",{className:"ms-Grid",dir:"ltr"},d.a.createElement("div",{className:"ms-Grid-row"},d.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md4 ms-lg4"},d.a.createElement(X.a,null,d.a.createElement(Q.a,{headerText:"Pattern",itemIcon:"Settings"},t),d.a.createElement(Q.a,{headerText:"Siteswaps",itemIcon:"Search"},e))),d.a.createElement("div",{className:"animator-layout-right ms-Grid-col ms-sm6 ms-md8 ms-lg8"},n))):d.a.createElement(X.a,null,d.a.createElement(Q.a,{headerText:"Animator",itemIcon:"Video"},n),d.a.createElement(Q.a,{headerText:"Pattern",itemIcon:"Settings"},t),d.a.createElement(Q.a,{headerText:"Siteswaps",itemIcon:"Search"},e))}}]),e}(r.Component),Mt=n(97);Object(Mt.a)();var Ct=function(){return d.a.createElement(yt,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(d.a.createElement(Ct,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[106,1,2]]]);
//# sourceMappingURL=main.ba2ac407.chunk.js.map