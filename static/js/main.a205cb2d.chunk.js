(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,n){"use strict";n.r(t);var a,s,i,o,r=n(0),d=n.n(r),h=n(43),l=n.n(h),c=(n(95),n(96),n(9)),u=n(11),p=n(20),g=n(19),m=n(15),f=n(21),v="([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?",w="\\[("+v+")+\\]",S=v+"|"+w,P="\\(("+S+"),("+S+")\\)",y="("+S+"|"+P+")",M="<"+y+"(\\|"+y+")+>",C=new RegExp(v,"g"),T=new RegExp(w,"g"),x=new RegExp(S,"g"),E=new RegExp(P,"g"),H=new RegExp(y,"g"),B=new RegExp(M,"g"),L=new RegExp("^(<(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))(\\|(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\)))+>)+|((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\)))+\\*?$","g"),b=new RegExp("<(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))+(\\|(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]|\\((([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\]),(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?|\\[(([\\da-o])x?A?(P\\d?)?(C{(C|P)?})?(T{(C|P)?})?(B({\\d*(L|HL|F|HF)?\\d*})?)?(S{-?\\d+(.\\d+)?(,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?,-?\\d+(.\\d+)?)?})?(D{\\d*\\.?\\d*})?)+\\])\\))+)+>","g"),R=n(4);!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Any=2]="Any"}(a||(a={})),function(e){e[e.Force=0]="Force",e[e.HyperForce=1]="HyperForce",e[e.Lift=2]="Lift",e[e.HyperLift=3]="HyperLift",e[e.Any=4]="Any"}(s||(s={})),function(e){e[e.Standard=0]="Standard",e[e.Claw=1]="Claw",e[e.Penguin=2]="Penguin"}(i||(i={})),function(e){e[e.Standard=0]="Standard",e[e.Claw=1]="Claw",e[e.Penguin=2]="Penguin"}(o||(o={}));var D,F,j=new R.vec3([.1,.1,1]).normalize(),A=function e(t,n,r,d,h,l,u){Object(c.a)(this,e),this.Juggler=void 0,this.TargetJuggler=void 0,this.Hand=void 0,this.Crossing=void 0,this.NumBeats=void 0,this.Siteswap=void 0,this.NumBounces=void 0,this.BounceOrder=void 0,this.BounceType=void 0,this.NumSpins=void 0,this.DwellPath=void 0,this.DwellRatio=void 0,this.TossType=void 0,this.CatchType=void 0,this.TossOrientation=void 0,this.RotationAxis=void 0,this.Hold=void 0,this.Juggler=n,this.Hand=r,this.Siteswap=t,this.DwellPath=d;var p=t.match(C);if(!p||p.length>1)throw"Invalid toss string";this.NumBeats=t[0].charCodeAt(0)>=97&&t[0].charCodeAt(0)<=119?t[0].charCodeAt(0)-87:parseInt(t[0]),this.TargetJuggler=n;var g=!1,m=t.indexOf("P");m>0&&"}"!=t[m+1]&&(this.TargetJuggler=h>2?parseInt(t[m+1])-1:1-n,g=!0);var f=t.indexOf("D");this.DwellRatio=f>0?parseFloat(t.substring(f+2,t.indexOf("}"))):l,this.NumBounces=0,this.BounceOrder=[];var v=t.indexOf("B");if(v>0){var w=t.slice(v).search(/\d/)+v;if("{"==t[v+1]&&void 0!=w){this.NumBounces=parseInt(t[w]);for(var S=w+1;S<t.length&&!isNaN(t[S]);S++){var P=parseInt(t[S]);if(P>=u)throw"Bounce surface index out of range";this.BounceOrder.push(P)}}else this.NumBounces=1,this.BounceOrder=[0];if(this.BounceOrder.length<this.NumBounces){var y=this.NumBounces-this.BounceOrder.length;for(S=0;S<y;S++)this.BounceOrder.push(0)}}this.NumBounces>0&&(t.match("HF")?this.BounceType=s.HyperForce:t.match("HL")?this.BounceType=s.HyperLift:t.match("F")?this.BounceType=s.Force:t.match("L")?this.BounceType=s.Lift:this.BounceType=s.Any);var M=t.indexOf("T");if(this.TossType=i.Standard,M>0){var T=t.substring(M+2,t.indexOf("}",M));T.match("C")?this.TossType=i.Claw:T.match("P")&&(this.TossType=i.Penguin)}var x=t.indexOf("C");if(this.CatchType=o.Standard,x>0){var E=t.substring(x+2,t.indexOf("}",x));E.match("C")?this.CatchType=o.Claw:E.match("P")&&(this.CatchType=o.Penguin)}this.Crossing=this.NumBeats%2==1,t.length>1&&"x"==t[1]&&(this.Crossing=!this.Crossing),"R"==t[0]?this.Hand=a.Right:"L"==t[0]&&(this.Hand=a.Left),this.TossOrientation=j;var H=t.indexOf("S");if(H>0){var B=t.substring(H+2,t.indexOf("}",H)).match(/-?\d+(\.\d+)?/g);if(!B)throw"Invalid spin configuration";this.NumSpins=parseFloat(B[0]),B.length>1&&(this.TossOrientation=new R.vec3([parseFloat(B[1]),parseFloat(B[2]),parseFloat(B[3])]).normalize())}else this.NumSpins=Math.floor(this.NumBeats/2)+.2,g&&(this.NumSpins+=.1);this.Hold=2==this.NumBeats&&!this.Crossing&&-1==t.indexOf("A"),this.RotationAxis=new R.vec3([1,0,0])},k=function(){function e(t){var n=this;if(Object(c.a)(this,e),this.Siteswap=void 0,this.Beats=void 0,this.IsSync=void 0,this.IsMultiplex=void 0,this.IsPassingPattern=void 0,this.NumJugglers=void 0,this.Siteswap=t.replace(/\s/g,""),this.NumJugglers=1,this.IsPassingPattern=/<[^ ]+>/.test(this.Siteswap),this.IsPassingPattern){var a=this.Siteswap.match(/<[^ <>]+>/g);if(a){if(this.NumJugglers=a[0].split("|").length,1==this.NumJugglers)throw new Error("Cannot have passing pattern with 1 juggler.");a.forEach(function(e){if(e.split("|").length!=n.NumJugglers)throw new Error("Each beat in passing siteswap must contain same number of jugglers")})}}var s=this.Siteswap.match(b);null!=s&&s[0]==this.Siteswap&&(this.Siteswap=this.transformPassingShorthand()),"*"==this.Siteswap.charAt(this.Siteswap.length-1)&&(this.Siteswap=this.transformSymmetricSyncShorthand());var i=this.Siteswap.match(L);if(null===i||i[0]!==this.Siteswap)throw"Invalid siteswap syntax.";this.IsMultiplex=!!this.Siteswap.match(T),this.IsSync=!!this.Siteswap.match(E);var o=this.IsPassingPattern?this.Siteswap.match(B):this.Siteswap.match(H);this.Beats=[],o&&o.forEach(function(e){n.Beats.push(e)});for(var r=0;r<this.Beats.length;r++)this.Beats[r].match(E)&&(this.Beats.splice(r+1,0,"(0,0)"),r++)}return Object(u.a)(e,[{key:"transformPassingShorthand",value:function(){for(var e="",t=this.Siteswap.split("|"),n=[],a=0;a<t.length;a++)n.push(t[a].match(H));for(a=0;a<n[0].length;a++){e+="<";for(var s=0;s<n.length;s++)e+=n[s][a],s<n.length-1&&(e+="|");e+=">"}return e}},{key:"transformSymmetricSyncShorthand",value:function(){var e=this.Siteswap.slice(0,-1),t=e.match(E);if(null!==t)for(var n=0;n<t.length;n++)e+="("+t[n].match(x).reverse().join(",")+")";return e}},{key:"GetTossCollection",value:function(e,t,n){var s=[],i=0,o=0;do{var r=this.Beats[i];++i==this.Beats.length&&(i=0);var d=[];(r.match(B)?r.match(H):[r]).forEach(function(s,i,r){var h=[];if(s.match(E)){var l=s.split(",");h.push({hand:a.Left,toss:l[0]}),h.push({hand:a.Right,toss:l[1]})}else h.push({hand:a.Any,toss:s});h.forEach(function(a){var s=e[o];++o==e.length&&(o=0),a.toss.match(C).forEach(function(h){var l=new A(h,i,a.hand,s,r.length,t,n);d.push(l),0==l.NumBeats&&--o<0&&(o=e.length-1)})})}),s.push(d)}while(0!=i||0!=o);return s}}]),e}(),O=n(81);(F=D||(D={}))[F.Ball=0]="Ball",F[F.Club=1]="Club",F[F.Ring=2]="Ring";var z=function(){function e(t,n,a,s){Object(c.a)(this,e),this.Id=t,this.PropType=n,this.C=a,this.Radius=s,this.TossSchedule=void 0,this.TossSchedule=[]}return Object(u.a)(e,[{key:"GetPreviousCurrentAndNextTossForBeat",value:function(e){for(var t=0;t<this.TossSchedule.length;t++){if(t==this.TossSchedule.length-1||this.TossSchedule[t].Beat<=e&&this.TossSchedule[t+1].Beat>e)return[0==t?this.TossSchedule[this.TossSchedule.length-1]:this.TossSchedule[t-1],this.TossSchedule[t],t==this.TossSchedule.length-1?this.TossSchedule[0]:this.TossSchedule[t+1]]}throw"Unable to determine previous, current, and next toss for beat"}}]),e}();function N(e,t,n,a,s,i,o,r){var d=e.Toss.DwellPath.GetPosition(1,e.Hand,new R.vec3,new R.vec3,0,0,null,s,i),h=t.Toss.DwellPath.GetPosition(0,t.Hand,new R.vec3,new R.vec3,0,0,null,o,r);return[new R.vec3([d.x+(h.x-d.x)*n/a,d.y+(h.y-d.y+4.9*a*a)*n/a-4.9*n*n,d.z+(h.z-d.z)*n/a]),new R.vec3([(h.x-d.x)/a,(h.y-d.y+4.9*a*a)/a-9.8*n,(h.z-d.z)/a])]}function I(e,t,n,a,s,i,o){var r;if(0==t)r=e[0];else if(1==t)r=e[e.length-1];else{1==e.length&&e.push(e[0]);var d=e[0].copy();d.add(n.copy().scale(s)),d.add(n.copy().normalize().scale(.1));var h=e[e.length-1].copy();h.add(a.copy().scale(-i)),h.add(a.copy().normalize().scale(-.1));for(var l=[d,h],c=[],u=[],p=0;p<e.length-1;p++){var g,m=e[p],f=e[p+1];if(0==p)w=l[0];else{var v=c[c.length-1],w=new R.vec3([m.x+(m.x-v.x),m.y+(m.y-v.y),m.z+(m.z-v.z)]);c.push(w)}if(p+1==e.length-1)g=l[1];else{var S=new R.vec3([(e[p].x+e[p+1].x)/2,(e[p].y+e[p+1].y)/2,(e[p].z+e[p+1].z)/2]),P=new R.vec3([(e[p+1].x+e[p+2].x)/2,(e[p+1].y+e[p+2].y)/2,(e[p+1].z+e[p+2].z)/2]),y=Math.sqrt(Math.pow(e[p].x-e[p+1].x,2)+Math.pow(e[p].y-e[p+1].y,2)+Math.pow(e[p].z-e[p+1].z,2)),M=y/(y+Math.sqrt(Math.pow(e[p+1].x-e[p+2].x,2)+Math.pow(e[p+1].y-e[p+2].y,2)+Math.pow(e[p+1].z-e[p+2].z,2))),C=new R.vec3([(1-M)*S.x+M*P.x,(1-M)*S.y+M*P.y,(1-M)*S.z+M*P.z]);g=new R.vec3([f.x+(S.x-C.x),f.y+(S.y-C.y),f.z+(S.z-C.z)]),c.push(g)}for(M=0;M<=1+1e-5;M+=.02)u.push(new R.vec3([Math.pow(1-M,3)*m.x+3*Math.pow(1-M,2)*M*w.x+3*(1-M)*Math.pow(M,2)*g.x+Math.pow(M,3)*f.x,Math.pow(1-M,3)*m.y+3*Math.pow(1-M,2)*M*w.y+3*(1-M)*Math.pow(M,2)*g.y+Math.pow(M,3)*f.y,Math.pow(1-M,3)*m.z+3*Math.pow(1-M,2)*M*w.z+3*(1-M)*Math.pow(M,2)*g.z+Math.pow(M,3)*f.z]))}var T=Math.floor(t*u.length);r=u[T<0?0:T]}return r}var J=1.05,V=function(){function e(t,n,s,i){Object(c.a)(this,e),this.Siteswap=t,this.DwellPaths=n,this.Props=void 0,this.TossCollection=void 0,this.States=void 0,this.Simulation=void 0,this.TossCollection=t.GetTossCollection(n,s,i);var o=0,r=this;if(t.Beats.map(function(e){if(e.match(B))for(var t=e.split("|"),n=0;n<t.length;n++)0==n&&(t[n]=t[n].substr(1)),n==t.length-1&&(t[n]=t[n].substr(0,t[n].length-1)),o+=r.sumThrows(t[n]);else o+=r.sumThrows(e)}),!(o/t.Beats.length%1==0&&o/t.Beats.length>0))throw"Cannot determine number of props";var d=o/t.Beats.length;this.Props=[];for(var h=0;h<d;h++)this.Props.push(new z(h,D.Ball,.5,.1));var l=0;this.TossCollection.forEach(function(e){e.forEach(function(e){e.NumBeats>l&&(l=e.NumBeats)})});var u=this.Props.slice(0);this.States=[];for(var p=[],g=0;g<t.NumJugglers;g++){p.push([[],[]]);for(var m=0;m<l;m++)p[g][a.Left].push(null),p[g][a.Right].push(null)}for(var f=!1,v=!1,w=0,S=a.Left;!f;){var P=[];if(p.forEach(function(e,t){var n=e[a.Left].shift();e[a.Left].push(null),n&&n.forEach(function(e){P.push({Prop:e,Juggler:t,Hand:a.Left})});var s=e[a.Right].shift();e[a.Right].push(null),s&&s.forEach(function(e){P.push({Prop:e,Juggler:t,Hand:a.Right})})}),this.TossCollection[w%this.TossCollection.length].forEach(function(e){for(var t=e.Hand==a.Any?S:e.Hand,n=e.Crossing?1-t:t,s=void 0,i=0;i<P.length;i++){var o=P[i];if(o.Hand==t&&o.Juggler==e.Juggler){if(0==e.NumBeats)throw"Prop landing on 0 toss at beat ".concat(w);s=o.Prop,P.splice(i,1);break}}if(void 0===s&&e.NumBeats>0&&(s=u.shift()),void 0===s&&e.NumBeats>0)throw"No prop available to toss at beat ".concat(w);e.NumBeats>0&&(v&&s.TossSchedule.push({Toss:e,Beat:w,Hand:t}),p[e.TargetJuggler][n][e.NumBeats-1]?p[e.TargetJuggler][n][e.NumBeats-1].push(s):p[e.TargetJuggler][n][e.NumBeats-1]=[s])}),v?w%this.TossCollection.length==0&&JSON.stringify(this.States[0],["Id"])==JSON.stringify(p,["Id"])?(f=!0,this.Props.forEach(function(e){e.TossSchedule[e.TossSchedule.length-1].Beat==w&&e.TossSchedule.pop()})):this.States.push(JSON.parse(JSON.stringify(p,["Id"]))):0==u.length&&(w+1)%this.TossCollection.length==0&&(v=!0,w=-1,this.States=[]),S=1-S,++w>1e3)throw"Pattern took more than 1000 beats to repeat states"}}return Object(u.a)(e,[{key:"sumThrows",value:function(e){for(var t=0,n=0;n<e.length;n++)parseInt(e[n])?t+=parseInt(e[n]):e.charCodeAt(n)>=97&&e.charCodeAt(n)<=119&&(t+=e.charCodeAt(n)-87),"P"!=e[n]&&"S"!=e[n]||!parseInt(e[n+1])||n++,"B"!=e[n]&&"D"!=e[n]&&"T"!=e[n]&&"C"!=e[n]&&"S"!=e[n]||"{"!=e[n+1]||(n=e.indexOf("}",n));return t}},{key:"Simulate",value:function(e,t){var n=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.States.length,o=i*e,r=!1,d={Props:[],Jugglers:[],BeatDuration:t,NumStepsPerBeat:e};this.Props.forEach(function(e){return d.Props.push({Positions:[],Rotations:[]})}),this.States[0].forEach(function(e,t,n){var a,s;if(1==n.length)a=new R.vec3([0,0,0]),s=0;else{s=t/n.length*Math.PI*2,a=new R.vec3([-1*Math.sin(s),0,1*Math.cos(s)])}d.Jugglers.push({BodyPositions:Array(o).fill(a),BodyRotations:Array(o).fill(s),LeftHandPositions:[],RightHandPositions:[],LeftElbowPositions:[],RightElbowPositions:[],LeftHandDirections:[],RightHandDirections:[]})});for(var h=0;h<o;h++){var l=Math.floor(h*i/o),c=t*h*i/o;this.Props.forEach(function(e,n){var s,o,r,u=e.GetPreviousCurrentAndNextTossForBeat(l),p=Object(O.a)(u,3);s=p[0],o=p[1],r=p[2];var g=c,m=s.Beat;m>=o.Beat&&(m-=i);var f=r.Beat,v=o.Beat;f<=o.Beat&&(m-=i,v-=i);var w=v*t+o.Toss.DwellRatio*t,S=f*t,P=m*t+s.Toss.DwellRatio*t,y=v*t;g>S&&(g-=i*t);var M=d.Jugglers[o.Toss.Juggler].BodyPositions[h],C=d.Jugglers[o.Toss.Juggler].BodyRotations[h],T=d.Jugglers[r.Toss.Juggler].BodyPositions[h],x=d.Jugglers[r.Toss.Juggler].BodyRotations[h];if(g<w||o.Toss.Hold){var E=y-P,H=N(s,o,E,E,M,C,T,x)[1],B=N(o,r,0,S-w,M,C,T,x)[1];if(o.Toss.Hold)var L=1-(S-g)/(S-y);else L=1-(w-g)/(w-y);var b=o.Toss.DwellPath.GetPosition(L,o.Hand,H,B,.01,.015,o.Toss.Hold?r.Toss.DwellPath.Snapshots[0]:null,M,C);d.Props[n].Positions.push(b);var R=H.copy().normalize().scale(L-1);R.add(B.copy().normalize().scale(L)),o.Hand===a.Left?(d.Jugglers[o.Toss.Juggler].LeftHandPositions[h]=b,d.Jugglers[o.Toss.Juggler].LeftHandDirections[h]=R):(d.Jugglers[o.Toss.Juggler].RightHandPositions[h]=b,d.Jugglers[o.Toss.Juggler].RightHandDirections[h]=R)}else{b=N(o,r,L=g-w,S-w,M,C,T,x)[0];d.Props[n].Positions.push(b)}});for(var u=0;u<this.Props.length;u++)for(var p=u+1;p<this.Props.length;p++){var g=d.Props[u].Positions[h],m=d.Props[p].Positions[h],f=R.vec3.distance(g,m);if(f<this.Props[u].Radius||f<this.Props[p].Radius){if(s)return!1;r=!0}}d.Jugglers.forEach(function(e,s){[a.Left,a.Right].forEach(function(o){if(o===a.Left&&void 0===e.LeftHandPositions[h]||o===a.Right&&void 0===e.RightHandPositions[h]){var r,u,p=0;n.Props.forEach(function(e){e.TossSchedule.forEach(function(e){var t=e.Beat;t<l&&(t+=i),t>l&&e.Toss.Juggler==s&&e.Hand==o&&(void 0===r?(p=(r=e).Beat)<l&&(p+=i):t<p&&(p=(r=e).Beat)<l&&(p+=i))})});var g,m,f=0;if(n.Props.forEach(function(e){e.TossSchedule.forEach(function(e){var t=e.Beat;t>l&&(t-=i),t<=l&&e.Toss.Juggler==s&&e.Hand==o&&(void 0===u?(f=(u=e).Beat)>l&&(f-=i):t>f&&(f=(u=e).Beat)>l&&(f-=i))})}),void 0===u||void 0===r)g=new R.vec3([.3*o==a.Left?-1:1,J,0]),m=new R.vec3([0,1,0]);else{var v,w,S=[];S.push(u.Toss.DwellPath.Snapshots[u.Toss.DwellPath.Snapshots.length-1].Position.copy()),S.push(r.Toss.DwellPath.Snapshots[0].Position.copy()),n.Props.forEach(function(e){e.TossSchedule.forEach(function(e,t,n){e.Hand===o&&e.Beat===r.Beat&&(v=0==t?n[n.length-1]:n[t-1])})}),n.Props.forEach(function(e){e.TossSchedule.forEach(function(e,t,n){e===u&&(w=t===n.length-1?n[0]:n[t+1])})});var P=e.BodyPositions[h],y=e.BodyRotations[h],M=d.Jugglers[w.Toss.Juggler].BodyPositions[h],C=d.Jugglers[w.Toss.Juggler].BodyRotations[h],T=d.Jugglers[v.Toss.Juggler].BodyPositions[h],x=d.Jugglers[v.Toss.Juggler].BodyRotations[h],E=N(u,w,0,u.Toss.NumBeats*t,P,y,M,C)[1],H=N(v,r,v.Toss.NumBeats*t-v.Toss.DwellRatio*t,v.Toss.NumBeats*t-v.Toss.DwellRatio*t,T,x,P,y)[1];o===a.Left&&S.forEach(function(e){return e.x*=-1});var B=c;B>p*t&&(B-=i*t);var L=p*t-(f*t+u.Toss.DwellRatio*t),b=(B-(f*t+u.Toss.DwellRatio*t))/L;b<0&&(b=1),b>1&&(b=0);for(var D=0;D<S.length;D++){var F=S[D].copy();S[D].x=F.x*Math.cos(y)-F.z*Math.sin(y),S[D].y=F.y+J,S[D].z=F.x*Math.sin(y)+F.z*Math.cos(y),S[D].add(P)}g=I(S,b,E,H,.01,.01),(m=E.copy().normalize().scale(1-b)).add(H.copy().normalize().scale(-b))}o===a.Left?(e.LeftHandPositions[h]=g,e.LeftHandDirections[h]=m):(e.RightHandPositions[h]=g,e.RightHandDirections[h]=m)}var j=e.BodyRotations[h],A=e.BodyPositions[h],k=.225*(o===a.Left?-1:1),O=new R.vec3([A.x+(k*Math.cos(j)-.25*Math.sin(j)),1.425,A.z+(k*Math.sin(j)+.25*Math.cos(j))]),z=n.getElbowPosition(O,o===a.Left?e.LeftHandPositions[h]:e.RightHandPositions[h],.2,o);o===a.Left?e.LeftElbowPositions[h]=z:e.RightElbowPositions[h]=z})})}return this.Simulation=d,r}},{key:"getElbowPosition",value:function(e,t,n,a){var s=.3;n*=-1;var i=new R.vec3;i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z;var o=new R.vec3;o.x=Math.sqrt(i.x*i.x+i.z*i.z),o.y=i.y,o.z=0;var r=Math.atan2(i.z,i.x),d=Math.sqrt(i.x*i.x+i.y*i.y+i.z*i.z);2*s<d&&(s=d/2);var h=new R.vec3;h.x=o.y/d,h.y=-o.x/d,h.z=0;var l=new R.vec3([0,0,0]);l.z=1==a?-1:1;var c=Math.sqrt(s*s-.25*d*d),u=new R.vec3;u.x=o.x/2+c*h.x*Math.cos(n)+c*l.x*Math.sin(n),u.y=o.y/2+c*h.y*Math.cos(n)+c*l.y*Math.sin(n),u.z=o.z/2+c*h.z*Math.cos(n)+c*l.z*Math.sin(n);var p=new R.vec3;p.x=u.x*Math.cos(r)-u.z*Math.sin(r),p.y=u.y,p.z=u.x*Math.sin(r)+u.z*Math.cos(r);var g=new R.vec3;return g.x=p.x+e.x,g.y=p.y+e.y,g.z=p.z+e.z,g}},{key:"GetHeighestAndLowestPositionInSimulation",value:function(){var e=J,t=J;return this.Simulation&&this.Simulation.Props.forEach(function(n){n.Positions.forEach(function(n){n.y>e&&(e=n.y),n.y<t&&(t=n.y)})}),[e,t]}}]),e}(),G=(new R.vec4([4,0,1,Math.PI/2]),new R.vec4([0,1,0,Math.PI/2]),new R.vec4([0,0,0,0])),W=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G;Object(c.a)(this,e),this.Position=void 0,this.Rotation=void 0,this.Empty=void 0,this.Empty=n;var s=t.match(/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?/g);if(!s)throw"Could not find position for dwell path snapshot.";var i=s[0].match(/-?\d+(\.\d+)?/g);if(!i)throw"Could not find position for dwell path snapshot.";this.Position=new R.vec3([parseFloat(i[0])/100,i[1]?parseFloat(i[1])/100:0,i[2]?parseFloat(i[2])/100:0]);var o=t.match(/\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\}/g);if(o){var r=o[0].match(/-?\d+(\.\d+)?/g);if(!r||4!=r.length)throw"Could not find 4 rotation values";this.Rotation=new R.vec4([parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])])}else this.Rotation=a},U=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;Object(c.a)(this,e),this.Snapshots=void 0,this.Snapshots=[],-1==t.indexOf("e")&&(t+="e");var s=/\(-?\d+(\.\d+)?(,-?\d+(\.\d+)?)?(,-?\d+(\.\d+)?)?(,\{-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?,-?\d+(\.\d+)?\})?\)/g,i=t.split("e")[0].match(s),o=t.split("e")[1].match(s);if(!i)throw new Error("Invalid dwell path");i.forEach(function(e){n.Snapshots.push(new W(e,!1,a))}),o&&o.forEach(function(e){n.Snapshots.push(new W(e,!0,a))})}return Object(u.a)(e,[{key:"GetPosition",value:function(e,t,n,a,s,i,o,r,d){var h=this.Snapshots.map(function(e){return Y(e,t,r,d)});o&&h.push(Y(o,t,r,d));new R.vec3;return 0==e?h[0].copy():1==e?h[h.length-1].copy():I(h,e,n,a,s,i)}}]),e}();function Y(e,t,n,s){var i=e.Position.copy();return t==a.Left&&(i.x*=-1),i.y+=J,i.x=i.x*Math.cos(s)-i.z*Math.sin(s),i.z=i.x*Math.sin(s)+i.z*Math.cos(s),i.add(n),i}function q(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=e.split(").").map(function(e,t,n){return t<n.length-1?e+")":e});if(t)return t.map(function(e){return new U(e)});throw new Error("Could not determine dwell paths")}var X=n(155),Q=n(79),$=n(152),K=n(158),Z=n(7),_=n(159),ee=n(150),te=n(82),ne=n(160),ae=n(151),se=n(156),ie=n(162),oe=(n(57),n(26)),re=n(164),de=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).examplePatternSettings=d.a.createElement("div",{className:"example-pattern-settings"},d.a.createElement("code",null,"siteswap: 3 ",d.a.createElement("br",null),"beatDuration: 0.28 ",d.a.createElement("br",null),"dwellPath: (30)(10) ",d.a.createElement("br",null),"dwellRatio: 0.8")),n.syntaxExplanation=d.a.createElement("div",null,d.a.createElement("p",null,"Patterns can be defined using a YAML based configuration input. All parameters are optional. The example below demonstrates a complete configuration using all the defaults."),d.a.createElement("p",null,d.a.createElement("code",null,"siteswap")," - siteswap string. Supports standard vanilla like ",d.a.createElement("code",null,"531"),", multiplex like ",d.a.createElement("code",null,"33[33]"),", and synchronous like ",d.a.createElement("code",null,"(4,6x)(6x,4)"),'. 2\'s are held by default, make them active by using "2A" like ',d.a.createElement("code",null,"42A3"),". Passing patterns wrap each beat in <> with each juggler pipe delimited, so ",d.a.createElement("code",null,"<3|3>")," is two jugglers both running 3 ball cascade. Use P to indicate a pass, so",d.a.createElement("code",null,"<3P|3P>")," is a pass on every throw. For multiple jugglers include the index of the juggler who is the target of the pass (starting at 1), so ",d.a.createElement("code",null,"<3P3|3|3P1>")," is two jugglers passing while a third runs 3 ball cascade. You can also use a shorthand for expressing passing patterns like this: ",d.a.createElement("code",null,"<3P333|3P333>"),", which would be the equivalent of ",d.a.createElement("code",null,"<3P|3P><3|3><3|3><3|3>"),". ",d.a.createElement("i",null,'If you input a passing siteswap you need to specify all the juggler positions and rotations, see "Juggler Positions" below'),". Modify the number of spins with S, so ",d.a.createElement("code",null,"3S",0,"3S",2)," is alternating flats and doubles. You can optionally specify the club toss orientation by adding the x,y,z components of the vector representing the direction the club handle is pointing in the right hand. So ",d.a.createElement("code",null,"3S{2,.1,.1,1}")," is a toss that does 2 full rotations and is pointing slightly down and slighly inwards. Modify the dwell ratio with D, so ",d.a.createElement("code",null,"3D",.2,"3D",.8)," is a 3 ball pattern where one hand is rushing the throw (good for animating half shower patterns). Modify the catch and throw by using C and T, respectively, so ",d.a.createElement("code",null,"3C{P}T{C}")," is penguin (P) catches followed by claw (C) throws. Bounce using B and optionally specify the bounce type. If no bounce type is specified then a bounce type that will work within the timing constraints of the pattern will be selected. So ",d.a.createElement("code",null,"5B")," is a 5 ball lift bounce and ",d.a.createElement("code",null,"5B{HL}")," is a 5 ball hyperlift bounce (ie. the ball is traveling down when it is caught). Options are L for lift, HL for hyperlift, F for force, and HF for hyperforce. You can also specify the number of bounces within the braces, so ","5B{2}"," would be a 5 ball pattern with 2 bounces. ","5B{HL2}"," is also a valid 2 bounce pattern. You can use the standard * notation to repeat patterns symmetrically, so ",d.a.createElement("code",null,"(4,2x)*")," would be the equivalent of ",d.a.createElement("code",null,"(4,2x)(2x,4).")," Patterns can contain any amount of whitespace between beats, so ",d.a.createElement("code",null,"5 3  1")," would be the same as ",d.a.createElement("code",null,"531"),".")),n.close=n.close.bind(Object(m.a)(n)),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"close",value:function(){this.props.closeSyntaxHelp()}},{key:"render",value:function(){return d.a.createElement("div",{className:"ms-Grid",dir:"ltr"},d.a.createElement("div",{className:"ms-Grid-row"},d.a.createElement("div",{className:"ms-Grid-col ms-md10"},d.a.createElement("h1",null,"Syntax Help")),d.a.createElement("div",{className:"ms-Grid-col ms-md2"},d.a.createElement(re.a,{className:"close-button",iconProps:{iconName:"ChromeClose"},onClick:this.close}))),d.a.createElement("div",{className:"ms-Grid-row"},d.a.createElement("div",{className:"ms-Grid-col ms-md9"},this.syntaxExplanation),d.a.createElement("div",{className:"ms-Grid-col ms-md3"},this.examplePatternSettings)))}}]),t}(r.Component);function he(e,t){var n="",a=e.LandingSchedule[0],s=e.LandingSchedule.slice(1,t.LandingSchedule.length);s.push(0);var i=!1;0==a?n="0":a>1&&(i=!0,n="[");for(var o=0;o<s.length;o++){var r=o+1,d=r.toString();if(r>9&&(d=String.fromCharCode(87+r)),s[o]!=t.LandingSchedule[o]){if(!(a>=t.LandingSchedule[o]-s[o]))return null;n+=d,1==--a&&t.LandingSchedule[o]-s[o]==2&&(n+=d,a--)}}return i&&(n+="]"),n}function le(e){return e[e.length-1]}function ce(e){var t=function(e,t,n){var a=[],s=[1,0];return n&&s.push(2),function s(i,o,r){i.LandingSchedule.length==e?i.LandingSchedule.reduce(function(e,t){return e+t})==t&&a.push(i):o.map(function(e,a,o){var d={LandingSchedule:i.LandingSchedule.slice(),Edges:[]};d.LandingSchedule.push(e);var h=d.LandingSchedule.reduce(function(e,t){return e+t})-t;s(d,0==h?[0]:1==h?[1,0]:n?[1,2,0]:[1,0],r&&a==o.length-1)})}({LandingSchedule:[],Edges:[]},s,!1),a}(e.MaxPeriod,e.NumProps,e.IncludeMultiplex),n=function(e){for(var t=[],n=0;n<e.length;n++)for(var a=0;a<e.length;a++){var s=he(e[n],e[a]);s&&e[n].Edges.push(t.push({SourceNode:n,TargetNode:a,Value:s})-1)}return t}(t),a=0,s=[],i=[];return function r(d,h){a++;if(a<=e.MaxSearches&&s.length<e.MaxSiteswaps){var l=d,c=!1,u=void 0;if(h.length>0&&h.length<=e.MaxPeriod){if(h.length>=e.MinPeriod&&(!e.Sync||h.length%2==0))if(n[le(h)].TargetNode==d)c=!0,u=0;else if(e.IncludeExcited)for(var p=0;p<h.length;p++)n[le(h)].TargetNode!=n[h[p]].SourceNode||e.Sync&&p%2!=0||(c=!0,u=p);if(c){for(var g=h.map(function(t,a){if(e.Sync){for(var s="",i=n[t].Value,o=0;o<i.length;o++)"["==i[o]||"]"==i[o]||parseInt(i[o])%2==0?s+=i[o]:s+=a%2==0?parseInt(i[o])-1+"x":parseInt(i[o])+1+"x";return s}return n[t].Value}).slice(u),m=!1,p=0;p<s.length;p++){var f=s[p].map(function(t,a){if(e.Sync){for(var s="",i=n[t].Value,o=0;o<i.length;o++)"["==i[o]||"]"==i[o]||parseInt(i[o])%2==0?s+=i[o]:s+=a%2==0?parseInt(i[o])-1+"x":parseInt(i[o])+1+"x";return s}return n[t].Value});if(o(f,g.slice())){m=!0;break}}if(!m){s.push(h.slice(u));for(var p=0;p<g.length;p++)parseInt(g[p])>9&&(g[p]=String.fromCharCode(87+parseInt(g[p])));var v="";if(e.Sync)for(var p=0;p<g.length;p++)v+=p%2==0?"("+g[p]+",":g[p]+")";else v=g.join("");i.push(v)}c=!0}l=n[le(h)].TargetNode}(!c||u>0)&&h.length<e.MaxPeriod&&t[l].Edges.map(function(t){for(var a=!1,s=0;s<e.Exclude.length;s++)if(e.Exclude[s]==n[t].Value){a=!0;break}if(e.Sync&&h.length%2==0&&n[t].Value.indexOf("1")>-1&&(a=!0),!a){var i=h.slice();i.push(t),r(d,i)}})}}(0,[]),i;function o(t,n){if(t.length!=n.length)return!1;for(var a=0;a<=t.length;a++){if(t.toString()==n.toString())return!0;t.push(t[0]),t=t.slice(1),e.Sync&&(t.push(t[0]),t=t.slice(1))}}}var ue={siteswap:"3",beatDuration:.24,dwellPath:"(30)(10)",dwellRatio:.8},pe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={input:oe.safeDump(ue),errorMessage:null,showSyntaxHelp:!1},n.updatePatternSettingsInput=n.updatePatternSettingsInput.bind(Object(m.a)(n)),n.closeSyntaxHelp=n.closeSyntaxHelp.bind(Object(m.a)(n)),n.showSyntaxHelp=n.showSyntaxHelp.bind(Object(m.a)(n)),n.juggleRandomPattern=n.juggleRandomPattern.bind(Object(m.a)(n)),n.juggleInputPattern=n.juggleInputPattern.bind(Object(m.a)(n)),n.juggle=n.juggle.bind(Object(m.a)(n)),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"showSyntaxHelp",value:function(){this.setState({showSyntaxHelp:!0})}},{key:"closeSyntaxHelp",value:function(){this.setState({showSyntaxHelp:!1})}},{key:"updatePatternSettingsInput",value:function(e){this.setState({input:e.target.value})}},{key:"juggle",value:function(e){try{var t=new k(e.siteswap.toString()),n=new V(t,q(e.dwellPath),e.dwellRatio,1);n.Simulate(30,e.beatDuration),this.props.updatePattern(n),this.setState({errorMessage:null})}catch(s){var a;a=s.message?s.message:s,this.setState({errorMessage:a})}}},{key:"juggleRandomPattern",value:function(){var e=function(){for(var e=ce({NumProps:3+Math.round(Math.random()),MinPeriod:1,MaxPeriod:6,IncludeMultiplex:!1,IncludeExcited:!0,MaxSearches:1e3,MaxSiteswaps:100,Sync:Math.random()<.3,Exclude:[]}),t=[-20,-10,0,10,10,20,20,30],n=[0,0,10,20,20,30],a=[],s=0;s<t.length;s++)for(var i=0;i<n.length;i++)a.push("(".concat(t[s],",").concat(n[i],")"));return function t(){for(var n=e[Math.floor(Math.random()*e.length)],s=[],i=0;i<1+5*Math.random();i++){for(var o="",r=0;r<1+4*Math.round(Math.random());r++)o+=a[Math.floor(Math.random()*a.length)];s.push(o)}o=s.join(".");var d=new k(n),h=q(o);return new V(d,h,.8,0).Simulate(20,.2,!1)?t():{siteswap:n,beatDuration:.2,dwellPath:o,dwellRatio:.8}}()}();this.setState({input:oe.safeDump(e)}),this.juggle(e)}},{key:"juggleInputPattern",value:function(){var e;try{e=oe.safeLoad(this.state.input)}catch(t){this.setState({errorMessage:"Invalid pattern settings."})}e&&this.juggle(e)}},{key:"updateAnimationSpeed",value:function(e){var t=1e3*e+5e3*(1-e);this.props.updateAnimationSpeed(t)}},{key:"render",value:function(){var e=this;return d.a.createElement($.a,null,d.a.createElement(K.a,{messageBarType:Z.a.info},"This is a new version of Gunswap still in development. The old version is still available at ",d.a.createElement(_.a,{href:"https://www.gunswap.co"},"gunswap.co"),". Found a bug or have an enhancement idea? ",d.a.createElement(_.a,{href:"https://github.com/yDgunz/gunswap/issues"},"Open a ticket in Github")," or email me at ",d.a.createElement(_.a,{href:"mailto:gunswapjuggling@gmail.com"},"gunswapjuggling@gmail.com"),"."),this.state.errorMessage&&d.a.createElement(K.a,{messageBarType:Z.a.severeWarning,isMultiline:!1},this.state.errorMessage),d.a.createElement($.a,{horizontal:!0},d.a.createElement(ee.a,{className:"panel-main-button",text:"Juggle",onClick:this.juggleInputPattern}),d.a.createElement(te.a,{className:"panel-main-button",text:"Random Pattern",onClick:this.juggleRandomPattern})),d.a.createElement(ne.a,null,"Advanced Pattern Settings | ",d.a.createElement(_.a,{onClick:this.showSyntaxHelp},"Syntax Help")),d.a.createElement(ae.a,{isOpen:this.state.showSyntaxHelp,onDismiss:this.closeSyntaxHelp,isBlocking:!1},d.a.createElement(de,{closeSyntaxHelp:this.closeSyntaxHelp})),d.a.createElement(se.a,{value:this.state.input,multiline:!0,onChange:this.updatePatternSettingsInput,autoAdjustHeight:!0}),d.a.createElement("br",null),d.a.createElement(ie.a,{label:"Animation Speed",min:0,max:1,step:.01,defaultValue:.5,showValue:!1,onChanged:function(t,n){return e.updateAnimationSpeed(n)}}))}}]),t}(r.Component),ge=n(5),me=new ge.f({color:"grey"}),fe=function(){function e(t,n,a,s,i){var o=this;Object(c.a)(this,e),this.scene=void 0,this.camera=void 0,this.renderer=void 0,this.propMeshes=void 0,this.jugglerMeshes=void 0,this.camRadius=void 0,this.camPhi=void 0,this.camTheta=void 0,this.startTime=void 0,this.pattern=void 0,this.isMouseDown=void 0,this.onMouseDownPosition=void 0,this.onMouseDownTheta=void 0,this.onMouseDownPhi=void 0,this.positionToLookAt=void 0,this.currentStep=void 0,this.userControllingStep=void 0,this.animationSpeed=void 0,this.scene=new ge.j,this.camera=new ge.h(75,a/s,.1,1e3),this.positionToLookAt=new R.vec3,this.renderer=new ge.n({antialias:!0}),this.scene.add(new ge.d(16777215,0,1)),this.propMeshes=[],this.jugglerMeshes=[],this.camRadius=1,this.camPhi=.3,this.camTheta=Math.PI,this.startTime=(new Date).getTime(),this.pattern=n,n&&this.UpdatePattern(n),this.isMouseDown=!1,this.onMouseDownPosition=new R.vec3,this.onMouseDownTheta=0,this.onMouseDownPhi=0,this.userControllingStep=!1,this.currentStep=0,this.animationSpeed=i,this.renderer.setSize(a,s),this.renderer.domElement.addEventListener("mousemove",function(e){o.onDocumentMouseMove(e)},!1),this.renderer.domElement.addEventListener("mousedown",function(e){o.onDocumentMouseDown(e)},!1),this.renderer.domElement.addEventListener("mouseup",function(e){o.onDocumentMouseUp(e)},!1),this.renderer.domElement.addEventListener("wheel",function(e){o.onDocumentMouseWheel(e)},!1),this.renderer.domElement.addEventListener("touchmove",function(e){o.onDocumentTouchMove(e)},!1),this.renderer.domElement.addEventListener("touchstart",function(e){o.onDocumentTouchStart(e)},!1),this.renderer.domElement.addEventListener("touchmove",function(e){o.onDocumentTouchEnd(e)},!1),t.append(this.renderer.domElement),this.animate()}return Object(u.a)(e,[{key:"UpdateStep",value:function(e){this.currentStep=Math.floor(this.pattern.States.length*this.pattern.Simulation.NumStepsPerBeat*e),this.userControllingStep=!0}},{key:"UpdatePattern",value:function(e){if(this.pattern=e,e){var t=e.GetHeighestAndLowestPositionInSimulation();this.positionToLookAt.y=t[0]-(t[0]-t[1])/2,this.updateCamera()}}},{key:"Resize",value:function(e,t){this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"onDocumentMouseDown",value:function(e){this.isMouseDown=!0,this.onMouseDownTheta=this.camTheta,this.onMouseDownPhi=this.camPhi,this.onMouseDownPosition.x=e.clientX,this.onMouseDownPosition.y=e.clientY}},{key:"onDocumentTouchStart",value:function(e){this.isMouseDown=!0,this.onMouseDownTheta=this.camTheta,this.onMouseDownPhi=this.camPhi,this.onMouseDownPosition.x=e.touches[0].clientX,this.onMouseDownPosition.y=e.touches[0].clientY}},{key:"onMove",value:function(e,t){if(this.isMouseDown){this.camTheta=-.01*(e-this.onMouseDownPosition.x)+this.onMouseDownTheta;var n=.01*(t-this.onMouseDownPosition.y)+this.onMouseDownPhi;n<Math.PI/2&&n>-Math.PI/2&&(this.camPhi=n),this.updateCamera()}}},{key:"onDocumentMouseMove",value:function(e){e.preventDefault(),this.onMove(e.clientX,e.clientY)}},{key:"onDocumentTouchMove",value:function(e){e.preventDefault(),this.onMove(e.touches[0].clientX,e.touches[0].clientY)}},{key:"onDocumentMouseUp",value:function(e){e.preventDefault(),this.isMouseDown=!1}},{key:"onDocumentTouchEnd",value:function(e){e.preventDefault(),this.isMouseDown=!1}},{key:"onDocumentMouseWheel",value:function(e){this.camRadius+=.05*e.deltaY,this.updateCamera()}},{key:"updateCamera",value:function(){this.camera.position.x=this.camRadius*Math.sin(this.camTheta)*Math.cos(this.camPhi),this.camera.position.y=this.camRadius*Math.sin(this.camPhi)+this.positionToLookAt.y,this.camera.position.z=this.camRadius*Math.cos(this.camTheta)*Math.cos(this.camPhi),this.camera.lookAt(this.positionToLookAt.x,this.positionToLookAt.y,this.positionToLookAt.z)}},{key:"animate",value:function(){var e=this;if(this.pattern&&this.pattern.Simulation){if(!this.userControllingStep){var t=((new Date).getTime()-this.startTime)%(this.pattern.States.length*this.pattern.Simulation.BeatDuration*this.animationSpeed);this.currentStep=Math.floor(t/(this.pattern.States.length*this.pattern.Simulation.BeatDuration*this.animationSpeed)*(this.pattern.Simulation.NumStepsPerBeat*this.pattern.States.length))}for(;this.pattern.Props.length<this.propMeshes.length;){var n=this.propMeshes.pop();this.scene.remove(n)}for(;this.pattern.Props.length>this.propMeshes.length;){var a=new ge.l(.05,40),s=new ge.f({color:65280}),i=new ge.e(a,s);this.propMeshes.push(i),this.scene.add(i)}for(this.propMeshes.forEach(function(t,n){var a=e.pattern.Simulation.Props[n].Positions[e.currentStep];t.position.set(a.x,a.y,a.z)});this.pattern.Simulation.Jugglers.length>this.jugglerMeshes.length;)this.addJugglerMeshes();this.jugglerMeshes.forEach(function(t,n){var a=e.pattern.Simulation.Jugglers[n];t.BodyMesh.position.set(-.25*Math.sin(a.BodyRotations[e.currentStep]),1.225,.25*Math.cos(a.BodyRotations[e.currentStep])),t.BodyMesh.position.add(e.vec3ToTHREEVector3(a.BodyPositions[e.currentStep])),t.HeadMesh.position.set(-.25*Math.sin(a.BodyRotations[e.currentStep]),1.595,.25*Math.cos(a.BodyRotations[e.currentStep])),t.HeadMesh.position.add(e.vec3ToTHREEVector3(a.BodyPositions[e.currentStep]));var s=new ge.m(-.225*Math.cos(a.BodyRotations[e.currentStep])-.25*Math.sin(a.BodyRotations[e.currentStep]),1.425,-.225*Math.sin(a.BodyRotations[e.currentStep])+.25*Math.cos(a.BodyRotations[e.currentStep]));s.add(e.vec3ToTHREEVector3(a.BodyPositions[e.currentStep]));var i=new ge.m(.225*Math.cos(a.BodyRotations[e.currentStep])-.25*Math.sin(a.BodyRotations[e.currentStep]),1.425,.225*Math.sin(a.BodyRotations[e.currentStep])+.25*Math.cos(a.BodyRotations[e.currentStep]));i.add(e.vec3ToTHREEVector3(a.BodyPositions[e.currentStep]));var o=e.vec3ToTHREEVector3(a.LeftHandPositions[e.currentStep]),r=e.vec3ToTHREEVector3(a.RightHandPositions[e.currentStep]),d=e.vec3ToTHREEVector3(a.LeftElbowPositions[e.currentStep]),h=e.vec3ToTHREEVector3(a.RightElbowPositions[e.currentStep]);t.LeftHandMesh.position.copy(o),t.RightHandMesh.position.copy(r),t.LeftElbowMesh.position.copy(d),t.RightElbowMesh.position.copy(h),t.LeftShoulderMesh.position.copy(s),t.RightShoulderMesh.position.copy(i),e.positionAndRotateArm(d,s,o,t.LeftBicepMesh,t.LeftForearmMesh,t.LeftWristMesh),e.positionAndRotateArm(h,i,r,t.RightBicepMesh,t.RightForearmMesh,t.RightWristMesh);var l=new ge.i;l.setFromUnitVectors(new ge.m(0,1,0),e.vec3ToTHREEVector3(a.LeftHandDirections[e.currentStep])),t.LeftHandMesh.setRotationFromQuaternion(l),l.setFromUnitVectors(new ge.m(0,1,0),e.vec3ToTHREEVector3(a.RightHandDirections[e.currentStep])),t.RightHandMesh.setRotationFromQuaternion(l)})}requestAnimationFrame(function(){return e.animate()}),this.renderer.render(this.scene,this.camera)}},{key:"vec3ToTHREEVector3",value:function(e){return new ge.m(e.x,e.y,e.z)}},{key:"positionAndRotateArm",value:function(e,t,n,a,s,i){var o=(new ge.m).subVectors(e,t),r=new ge.a(o.clone().normalize(),t);a.rotation.setFromVector3(r.rotation.toVector3());var d=(new ge.m).addVectors(t,o.multiplyScalar(.5));a.position.copy(d),o=(new ge.m).subVectors(e,n),r=new ge.a(o.clone().normalize(),n),s.rotation.setFromVector3(r.rotation.toVector3()),d=(new ge.m).addVectors(n,o.multiplyScalar(.5)).add(o.clone().normalize().multiplyScalar(.04)),s.position.copy(d),d=n.clone().add(o.clone().normalize().multiplyScalar(.08)),i.position.copy(d)}},{key:"getHandMesh",value:function(){var e=new ge.k(.06,20,20,0,2*Math.PI,Math.PI/2,Math.PI),t=new ge.g({color:"grey",side:ge.c,flatShading:!0});return new ge.e(e,t)}},{key:"getJointMesh",value:function(e){var t=new ge.l(e,20);return new ge.e(t,me)}},{key:"getArmCylinder",value:function(e,t,n){var a=new ge.b(t,e,n,20,20);return new ge.e(a,me)}},{key:"addJugglerMeshes",value:function(){var e={LeftHandMesh:this.getHandMesh(),RightHandMesh:this.getHandMesh(),LeftElbowMesh:this.getJointMesh(.04),RightElbowMesh:this.getJointMesh(.04),LeftShoulderMesh:this.getJointMesh(.025),RightShoulderMesh:this.getJointMesh(.025),LeftWristMesh:this.getJointMesh(.02),RightWristMesh:this.getJointMesh(.02),LeftBicepMesh:this.getArmCylinder(.025,.04,.3),LeftForearmMesh:this.getArmCylinder(.02,.04,.21),RightBicepMesh:this.getArmCylinder(.025,.04,.3),RightForearmMesh:this.getArmCylinder(.02,.04,.21),BodyMesh:new ge.e(new ge.b(.15,.05,.4,20,20,!1),me),HeadMesh:new ge.e(new ge.k(.1,20,20),me)};this.jugglerMeshes.push(e),this.scene.add(e.LeftElbowMesh),this.scene.add(e.LeftHandMesh),this.scene.add(e.LeftShoulderMesh),this.scene.add(e.RightElbowMesh),this.scene.add(e.RightHandMesh),this.scene.add(e.RightShoulderMesh),this.scene.add(e.LeftBicepMesh),this.scene.add(e.LeftForearmMesh),this.scene.add(e.RightBicepMesh),this.scene.add(e.RightForearmMesh),this.scene.add(e.LeftWristMesh),this.scene.add(e.RightWristMesh),this.scene.add(e.BodyMesh),this.scene.add(e.HeadMesh)}}]),e}(),ve=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).CanvasContainerRef=void 0,n.jugglingScene=void 0,n.CanvasContainerRef=null,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"updateStep",value:function(e){this.jugglingScene&&this.jugglingScene.UpdateStep(e)}},{key:"componentDidUpdate",value:function(){this.jugglingScene&&(this.jugglingScene.UpdatePattern(this.props.pattern),this.jugglingScene.userControllingStep=!1,this.jugglingScene.animationSpeed=this.props.animationSpeed)}},{key:"componentDidMount",value:function(){var e=this,t=this.CanvasContainerRef.offsetWidth,n=window.innerHeight-28;this.jugglingScene=new fe(this.CanvasContainerRef,this.props.pattern,t,n,this.props.animationSpeed),window.jugglingScene=this.jugglingScene,window.addEventListener("resize",function(){if(e.CanvasContainerRef){var t=e.CanvasContainerRef.offsetWidth,n=window.innerHeight-28;e.jugglingScene&&e.jugglingScene.Resize(t,n)}})}},{key:"render",value:function(){var e=this;return d.a.createElement("div",null,d.a.createElement("div",{ref:function(t){e.CanvasContainerRef=t}}),d.a.createElement(ie.a,{min:0,max:.99,step:.005,showValue:!1,onChange:function(t){return e.updateStep(t)}}))}}]),t}(r.Component),we=n(163),Se=function(e){function t(e){var n;Object(c.a)(this,t);return(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={Siteswaps:[],Input:oe.safeDump({NumProps:3,MinPeriod:1,MaxPeriod:5,IncludeMultiplex:!1,IncludeExcited:!0,MaxSearches:1e3,MaxSiteswaps:100,Sync:!1,Exclude:[]})},n.onRenderCell=n.onRenderCell.bind(Object(m.a)(n)),n.findSiteswaps=n.findSiteswaps.bind(Object(m.a)(n)),n.updateInput=n.updateInput.bind(Object(m.a)(n)),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"findSiteswaps",value:function(){var e;try{e=oe.safeLoad(this.state.Input)}catch(n){}if(e){var t=ce(e);this.setState({Siteswaps:t})}}},{key:"onRenderCell",value:function(e,t){return d.a.createElement("div",{id:t.toString()},e)}},{key:"updateInput",value:function(e){this.setState({Input:e.target.value})}},{key:"render",value:function(){return d.a.createElement($.a,null,d.a.createElement(ee.a,{className:"panel-main-button",text:"Find Siteswaps",onClick:this.findSiteswaps}),d.a.createElement(ne.a,null,"Search Settings"),d.a.createElement(se.a,{value:this.state.Input,multiline:!0,onChange:this.updateInput,autoAdjustHeight:!0}),d.a.createElement(we.a,{items:this.state.Siteswaps,onRenderCell:this.onRenderCell}))}}]),t}(r.Component),Pe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={pattern:new V(new k("3"),q("(30)(10)"),.8,0),animationSpeed:3e3},n.state.pattern.Simulate(100,.24),window.onresize=function(){n.forceUpdate()},n.updatePattern=n.updatePattern.bind(Object(m.a)(n)),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"updatePattern",value:function(e){this.setState({pattern:e})}},{key:"updateAnimationSpeed",value:function(e){this.setState({animationSpeed:e})}},{key:"render",value:function(){var e=d.a.createElement(X.a,null,d.a.createElement(Q.a,{headerText:"Pattern",itemIcon:"Settings"},d.a.createElement(pe,{updatePattern:this.updatePattern,updateAnimationSpeed:this.updateAnimationSpeed})),d.a.createElement(Q.a,{headerText:"Siteswaps",itemIcon:"Search"},d.a.createElement(Se,null))),t=d.a.createElement(ve,{pattern:this.state.pattern,animationSpeed:this.state.animationSpeed});return window.innerWidth>900?d.a.createElement("div",{className:"ms-Grid",dir:"ltr"},d.a.createElement("div",{className:"ms-Grid-row"},d.a.createElement("div",{style:{height:"100vh",overflow:"auto"},className:"ms-Grid-col ms-sm6 ms-md4 ms-lg4"},e),d.a.createElement("div",{className:"ms-Grid-col ms-sm6 ms-md8 ms-lg8"},t))):d.a.createElement(X.a,null,d.a.createElement(Q.a,{headerText:"Controls"},e),d.a.createElement(Q.a,{headerText:"Animator"},t))}}]),t}(r.Component),ye=n(80);Object(ye.a)();var Me=function(){return d.a.createElement(Pe,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(d.a.createElement(Me,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},90:function(e,t,n){e.exports=n(123)},95:function(e,t,n){},96:function(e,t,n){}},[[90,1,2]]]);
//# sourceMappingURL=main.a205cb2d.chunk.js.map